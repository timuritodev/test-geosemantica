var j2=Object.defineProperty;var $2=(t,i,l)=>i in t?j2(t,i,{enumerable:!0,configurable:!0,writable:!0,value:l}):t[i]=l;var qf=(t,i,l)=>($2(t,typeof i!="symbol"?i+"":i,l),l);function q2(t,i){for(var l=0;l<i.length;l++){const p=i[l];if(typeof p!="string"&&!Array.isArray(p)){for(const _ in p)if(_!=="default"&&!(_ in t)){const b=Object.getOwnPropertyDescriptor(p,_);b&&Object.defineProperty(t,_,b.get?b:{enumerable:!0,get:()=>p[_]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const _ of document.querySelectorAll('link[rel="modulepreload"]'))p(_);new MutationObserver(_=>{for(const b of _)if(b.type==="childList")for(const I of b.addedNodes)I.tagName==="LINK"&&I.rel==="modulepreload"&&p(I)}).observe(document,{childList:!0,subtree:!0});function l(_){const b={};return _.integrity&&(b.integrity=_.integrity),_.referrerPolicy&&(b.referrerPolicy=_.referrerPolicy),_.crossOrigin==="use-credentials"?b.credentials="include":_.crossOrigin==="anonymous"?b.credentials="omit":b.credentials="same-origin",b}function p(_){if(_.ep)return;_.ep=!0;const b=l(_);fetch(_.href,b)}})();var Z2=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function J0(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ex={exports:{}},mp={},tx={exports:{}},It={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qc=Symbol.for("react.element"),G2=Symbol.for("react.portal"),W2=Symbol.for("react.fragment"),H2=Symbol.for("react.strict_mode"),X2=Symbol.for("react.profiler"),K2=Symbol.for("react.provider"),Y2=Symbol.for("react.context"),Q2=Symbol.for("react.forward_ref"),J2=Symbol.for("react.suspense"),eS=Symbol.for("react.memo"),tS=Symbol.for("react.lazy"),yv=Symbol.iterator;function rS(t){return t===null||typeof t!="object"?null:(t=yv&&t[yv]||t["@@iterator"],typeof t=="function"?t:null)}var rx={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},nx=Object.assign,ix={};function Wl(t,i,l){this.props=t,this.context=i,this.refs=ix,this.updater=l||rx}Wl.prototype.isReactComponent={};Wl.prototype.setState=function(t,i){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,i,"setState")};Wl.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function sx(){}sx.prototype=Wl.prototype;function Ig(t,i,l){this.props=t,this.context=i,this.refs=ix,this.updater=l||rx}var Cg=Ig.prototype=new sx;Cg.constructor=Ig;nx(Cg,Wl.prototype);Cg.isPureReactComponent=!0;var _v=Array.isArray,ox=Object.prototype.hasOwnProperty,Pg={current:null},ax={key:!0,ref:!0,__self:!0,__source:!0};function lx(t,i,l){var p,_={},b=null,I=null;if(i!=null)for(p in i.ref!==void 0&&(I=i.ref),i.key!==void 0&&(b=""+i.key),i)ox.call(i,p)&&!ax.hasOwnProperty(p)&&(_[p]=i[p]);var u=arguments.length-2;if(u===1)_.children=l;else if(1<u){for(var B=Array(u),D=0;D<u;D++)B[D]=arguments[D+2];_.children=B}if(t&&t.defaultProps)for(p in u=t.defaultProps,u)_[p]===void 0&&(_[p]=u[p]);return{$$typeof:qc,type:t,key:b,ref:I,props:_,_owner:Pg.current}}function nS(t,i){return{$$typeof:qc,type:t.type,key:i,ref:t.ref,props:t.props,_owner:t._owner}}function zg(t){return typeof t=="object"&&t!==null&&t.$$typeof===qc}function iS(t){var i={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(l){return i[l]})}var vv=/\/+/g;function Zf(t,i){return typeof t=="object"&&t!==null&&t.key!=null?iS(""+t.key):i.toString(36)}function bd(t,i,l,p,_){var b=typeof t;(b==="undefined"||b==="boolean")&&(t=null);var I=!1;if(t===null)I=!0;else switch(b){case"string":case"number":I=!0;break;case"object":switch(t.$$typeof){case qc:case G2:I=!0}}if(I)return I=t,_=_(I),t=p===""?"."+Zf(I,0):p,_v(_)?(l="",t!=null&&(l=t.replace(vv,"$&/")+"/"),bd(_,i,l,"",function(D){return D})):_!=null&&(zg(_)&&(_=nS(_,l+(!_.key||I&&I.key===_.key?"":(""+_.key).replace(vv,"$&/")+"/")+t)),i.push(_)),1;if(I=0,p=p===""?".":p+":",_v(t))for(var u=0;u<t.length;u++){b=t[u];var B=p+Zf(b,u);I+=bd(b,i,l,B,_)}else if(B=rS(t),typeof B=="function")for(t=B.call(t),u=0;!(b=t.next()).done;)b=b.value,B=p+Zf(b,u++),I+=bd(b,i,l,B,_);else if(b==="object")throw i=String(t),Error("Objects are not valid as a React child (found: "+(i==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":i)+"). If you meant to render a collection of children, use an array instead.");return I}function nd(t,i,l){if(t==null)return t;var p=[],_=0;return bd(t,p,"","",function(b){return i.call(l,b,_++)}),p}function sS(t){if(t._status===-1){var i=t._result;i=i(),i.then(function(l){(t._status===0||t._status===-1)&&(t._status=1,t._result=l)},function(l){(t._status===0||t._status===-1)&&(t._status=2,t._result=l)}),t._status===-1&&(t._status=0,t._result=i)}if(t._status===1)return t._result.default;throw t._result}var Nn={current:null},Sd={transition:null},oS={ReactCurrentDispatcher:Nn,ReactCurrentBatchConfig:Sd,ReactCurrentOwner:Pg};It.Children={map:nd,forEach:function(t,i,l){nd(t,function(){i.apply(this,arguments)},l)},count:function(t){var i=0;return nd(t,function(){i++}),i},toArray:function(t){return nd(t,function(i){return i})||[]},only:function(t){if(!zg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};It.Component=Wl;It.Fragment=W2;It.Profiler=X2;It.PureComponent=Ig;It.StrictMode=H2;It.Suspense=J2;It.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=oS;It.cloneElement=function(t,i,l){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var p=nx({},t.props),_=t.key,b=t.ref,I=t._owner;if(i!=null){if(i.ref!==void 0&&(b=i.ref,I=Pg.current),i.key!==void 0&&(_=""+i.key),t.type&&t.type.defaultProps)var u=t.type.defaultProps;for(B in i)ox.call(i,B)&&!ax.hasOwnProperty(B)&&(p[B]=i[B]===void 0&&u!==void 0?u[B]:i[B])}var B=arguments.length-2;if(B===1)p.children=l;else if(1<B){u=Array(B);for(var D=0;D<B;D++)u[D]=arguments[D+2];p.children=u}return{$$typeof:qc,type:t.type,key:_,ref:b,props:p,_owner:I}};It.createContext=function(t){return t={$$typeof:Y2,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:K2,_context:t},t.Consumer=t};It.createElement=lx;It.createFactory=function(t){var i=lx.bind(null,t);return i.type=t,i};It.createRef=function(){return{current:null}};It.forwardRef=function(t){return{$$typeof:Q2,render:t}};It.isValidElement=zg;It.lazy=function(t){return{$$typeof:tS,_payload:{_status:-1,_result:t},_init:sS}};It.memo=function(t,i){return{$$typeof:eS,type:t,compare:i===void 0?null:i}};It.startTransition=function(t){var i=Sd.transition;Sd.transition={};try{t()}finally{Sd.transition=i}};It.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};It.useCallback=function(t,i){return Nn.current.useCallback(t,i)};It.useContext=function(t){return Nn.current.useContext(t)};It.useDebugValue=function(){};It.useDeferredValue=function(t){return Nn.current.useDeferredValue(t)};It.useEffect=function(t,i){return Nn.current.useEffect(t,i)};It.useId=function(){return Nn.current.useId()};It.useImperativeHandle=function(t,i,l){return Nn.current.useImperativeHandle(t,i,l)};It.useInsertionEffect=function(t,i){return Nn.current.useInsertionEffect(t,i)};It.useLayoutEffect=function(t,i){return Nn.current.useLayoutEffect(t,i)};It.useMemo=function(t,i){return Nn.current.useMemo(t,i)};It.useReducer=function(t,i,l){return Nn.current.useReducer(t,i,l)};It.useRef=function(t){return Nn.current.useRef(t)};It.useState=function(t){return Nn.current.useState(t)};It.useSyncExternalStore=function(t,i,l){return Nn.current.useSyncExternalStore(t,i,l)};It.useTransition=function(){return Nn.current.useTransition()};It.version="18.2.0";tx.exports=It;var hr=tx.exports;const Mg=J0(hr),bm=q2({__proto__:null,default:Mg},[hr]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aS=hr,lS=Symbol.for("react.element"),uS=Symbol.for("react.fragment"),cS=Object.prototype.hasOwnProperty,hS=aS.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,dS={key:!0,ref:!0,__self:!0,__source:!0};function ux(t,i,l){var p,_={},b=null,I=null;l!==void 0&&(b=""+l),i.key!==void 0&&(b=""+i.key),i.ref!==void 0&&(I=i.ref);for(p in i)cS.call(i,p)&&!dS.hasOwnProperty(p)&&(_[p]=i[p]);if(t&&t.defaultProps)for(p in i=t.defaultProps,i)_[p]===void 0&&(_[p]=i[p]);return{$$typeof:lS,type:t,key:b,ref:I,props:_,_owner:hS.current}}mp.Fragment=uS;mp.jsx=ux;mp.jsxs=ux;ex.exports=mp;var Ur=ex.exports,Sm={},cx={exports:{}},gi={},hx={exports:{}},dx={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function i(He,ht){var mt=He.length;He.push(ht);e:for(;0<mt;){var Vt=mt-1>>>1,Ft=He[Vt];if(0<_(Ft,ht))He[Vt]=ht,He[mt]=Ft,mt=Vt;else break e}}function l(He){return He.length===0?null:He[0]}function p(He){if(He.length===0)return null;var ht=He[0],mt=He.pop();if(mt!==ht){He[0]=mt;e:for(var Vt=0,Ft=He.length,At=Ft>>>1;Vt<At;){var or=2*(Vt+1)-1,ri=He[or],dn=or+1,ni=He[dn];if(0>_(ri,mt))dn<Ft&&0>_(ni,ri)?(He[Vt]=ni,He[dn]=mt,Vt=dn):(He[Vt]=ri,He[or]=mt,Vt=or);else if(dn<Ft&&0>_(ni,mt))He[Vt]=ni,He[dn]=mt,Vt=dn;else break e}}return ht}function _(He,ht){var mt=He.sortIndex-ht.sortIndex;return mt!==0?mt:He.id-ht.id}if(typeof performance=="object"&&typeof performance.now=="function"){var b=performance;t.unstable_now=function(){return b.now()}}else{var I=Date,u=I.now();t.unstable_now=function(){return I.now()-u}}var B=[],D=[],ne=1,re=null,te=3,_e=!1,be=!1,ke=!1,we=typeof setTimeout=="function"?setTimeout:null,K=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ce(He){for(var ht=l(D);ht!==null;){if(ht.callback===null)p(D);else if(ht.startTime<=He)p(D),ht.sortIndex=ht.expirationTime,i(B,ht);else break;ht=l(D)}}function ye(He){if(ke=!1,ce(He),!be)if(l(B)!==null)be=!0,En(Pe);else{var ht=l(D);ht!==null&&$r(ye,ht.startTime-He)}}function Pe(He,ht){be=!1,ke&&(ke=!1,K(Ze),Ze=-1),_e=!0;var mt=te;try{for(ce(ht),re=l(B);re!==null&&(!(re.expirationTime>ht)||He&&!Mr());){var Vt=re.callback;if(typeof Vt=="function"){re.callback=null,te=re.priorityLevel;var Ft=Vt(re.expirationTime<=ht);ht=t.unstable_now(),typeof Ft=="function"?re.callback=Ft:re===l(B)&&p(B),ce(ht)}else p(B);re=l(B)}if(re!==null)var At=!0;else{var or=l(D);or!==null&&$r(ye,or.startTime-ht),At=!1}return At}finally{re=null,te=mt,_e=!1}}var Le=!1,je=null,Ze=-1,kt=5,rt=-1;function Mr(){return!(t.unstable_now()-rt<kt)}function Lr(){if(je!==null){var He=t.unstable_now();rt=He;var ht=!0;try{ht=je(!0,He)}finally{ht?hn():(Le=!1,je=null)}}else Le=!1}var hn;if(typeof ee=="function")hn=function(){ee(Lr)};else if(typeof MessageChannel<"u"){var Ar=new MessageChannel,Qr=Ar.port2;Ar.port1.onmessage=Lr,hn=function(){Qr.postMessage(null)}}else hn=function(){we(Lr,0)};function En(He){je=He,Le||(Le=!0,hn())}function $r(He,ht){Ze=we(function(){He(t.unstable_now())},ht)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(He){He.callback=null},t.unstable_continueExecution=function(){be||_e||(be=!0,En(Pe))},t.unstable_forceFrameRate=function(He){0>He||125<He?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):kt=0<He?Math.floor(1e3/He):5},t.unstable_getCurrentPriorityLevel=function(){return te},t.unstable_getFirstCallbackNode=function(){return l(B)},t.unstable_next=function(He){switch(te){case 1:case 2:case 3:var ht=3;break;default:ht=te}var mt=te;te=ht;try{return He()}finally{te=mt}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(He,ht){switch(He){case 1:case 2:case 3:case 4:case 5:break;default:He=3}var mt=te;te=He;try{return ht()}finally{te=mt}},t.unstable_scheduleCallback=function(He,ht,mt){var Vt=t.unstable_now();switch(typeof mt=="object"&&mt!==null?(mt=mt.delay,mt=typeof mt=="number"&&0<mt?Vt+mt:Vt):mt=Vt,He){case 1:var Ft=-1;break;case 2:Ft=250;break;case 5:Ft=1073741823;break;case 4:Ft=1e4;break;default:Ft=5e3}return Ft=mt+Ft,He={id:ne++,callback:ht,priorityLevel:He,startTime:mt,expirationTime:Ft,sortIndex:-1},mt>Vt?(He.sortIndex=mt,i(D,He),l(B)===null&&He===l(D)&&(ke?(K(Ze),Ze=-1):ke=!0,$r(ye,mt-Vt))):(He.sortIndex=Ft,i(B,He),be||_e||(be=!0,En(Pe))),He},t.unstable_shouldYield=Mr,t.unstable_wrapCallback=function(He){var ht=te;return function(){var mt=te;te=ht;try{return He.apply(this,arguments)}finally{te=mt}}}})(dx);hx.exports=dx;var pS=hx.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var px=hr,pi=pS;function Fe(t){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+t,l=1;l<arguments.length;l++)i+="&args[]="+encodeURIComponent(arguments[l]);return"Minified React error #"+t+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var fx=new Set,Tc={};function Aa(t,i){Nl(t,i),Nl(t+"Capture",i)}function Nl(t,i){for(Tc[t]=i,t=0;t<i.length;t++)fx.add(i[t])}var Xs=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Tm=Object.prototype.hasOwnProperty,fS=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,xv={},wv={};function mS(t){return Tm.call(wv,t)?!0:Tm.call(xv,t)?!1:fS.test(t)?wv[t]=!0:(xv[t]=!0,!1)}function gS(t,i,l,p){if(l!==null&&l.type===0)return!1;switch(typeof i){case"function":case"symbol":return!0;case"boolean":return p?!1:l!==null?!l.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function yS(t,i,l,p){if(i===null||typeof i>"u"||gS(t,i,l,p))return!0;if(p)return!1;if(l!==null)switch(l.type){case 3:return!i;case 4:return i===!1;case 5:return isNaN(i);case 6:return isNaN(i)||1>i}return!1}function Vn(t,i,l,p,_,b,I){this.acceptsBooleans=i===2||i===3||i===4,this.attributeName=p,this.attributeNamespace=_,this.mustUseProperty=l,this.propertyName=t,this.type=i,this.sanitizeURL=b,this.removeEmptyString=I}var cn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){cn[t]=new Vn(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var i=t[0];cn[i]=new Vn(i,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){cn[t]=new Vn(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){cn[t]=new Vn(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){cn[t]=new Vn(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){cn[t]=new Vn(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){cn[t]=new Vn(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){cn[t]=new Vn(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){cn[t]=new Vn(t,5,!1,t.toLowerCase(),null,!1,!1)});var Ag=/[\-:]([a-z])/g;function Dg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var i=t.replace(Ag,Dg);cn[i]=new Vn(i,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var i=t.replace(Ag,Dg);cn[i]=new Vn(i,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var i=t.replace(Ag,Dg);cn[i]=new Vn(i,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){cn[t]=new Vn(t,1,!1,t.toLowerCase(),null,!1,!1)});cn.xlinkHref=new Vn("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){cn[t]=new Vn(t,1,!1,t.toLowerCase(),null,!0,!0)});function Lg(t,i,l,p){var _=cn.hasOwnProperty(i)?cn[i]:null;(_!==null?_.type!==0:p||!(2<i.length)||i[0]!=="o"&&i[0]!=="O"||i[1]!=="n"&&i[1]!=="N")&&(yS(i,l,_,p)&&(l=null),p||_===null?mS(i)&&(l===null?t.removeAttribute(i):t.setAttribute(i,""+l)):_.mustUseProperty?t[_.propertyName]=l===null?_.type===3?!1:"":l:(i=_.attributeName,p=_.attributeNamespace,l===null?t.removeAttribute(i):(_=_.type,l=_===3||_===4&&l===!0?"":""+l,p?t.setAttributeNS(p,i,l):t.setAttribute(i,l))))}var eo=px.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,id=Symbol.for("react.element"),wl=Symbol.for("react.portal"),bl=Symbol.for("react.fragment"),Rg=Symbol.for("react.strict_mode"),km=Symbol.for("react.profiler"),mx=Symbol.for("react.provider"),gx=Symbol.for("react.context"),Fg=Symbol.for("react.forward_ref"),Em=Symbol.for("react.suspense"),Im=Symbol.for("react.suspense_list"),Bg=Symbol.for("react.memo"),Eo=Symbol.for("react.lazy"),yx=Symbol.for("react.offscreen"),bv=Symbol.iterator;function rc(t){return t===null||typeof t!="object"?null:(t=bv&&t[bv]||t["@@iterator"],typeof t=="function"?t:null)}var yr=Object.assign,Gf;function cc(t){if(Gf===void 0)try{throw Error()}catch(l){var i=l.stack.trim().match(/\n( *(at )?)/);Gf=i&&i[1]||""}return`
`+Gf+t}var Wf=!1;function Hf(t,i){if(!t||Wf)return"";Wf=!0;var l=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(D){var p=D}Reflect.construct(t,[],i)}else{try{i.call()}catch(D){p=D}t.call(i.prototype)}else{try{throw Error()}catch(D){p=D}t()}}catch(D){if(D&&p&&typeof D.stack=="string"){for(var _=D.stack.split(`
`),b=p.stack.split(`
`),I=_.length-1,u=b.length-1;1<=I&&0<=u&&_[I]!==b[u];)u--;for(;1<=I&&0<=u;I--,u--)if(_[I]!==b[u]){if(I!==1||u!==1)do if(I--,u--,0>u||_[I]!==b[u]){var B=`
`+_[I].replace(" at new "," at ");return t.displayName&&B.includes("<anonymous>")&&(B=B.replace("<anonymous>",t.displayName)),B}while(1<=I&&0<=u);break}}}finally{Wf=!1,Error.prepareStackTrace=l}return(t=t?t.displayName||t.name:"")?cc(t):""}function _S(t){switch(t.tag){case 5:return cc(t.type);case 16:return cc("Lazy");case 13:return cc("Suspense");case 19:return cc("SuspenseList");case 0:case 2:case 15:return t=Hf(t.type,!1),t;case 11:return t=Hf(t.type.render,!1),t;case 1:return t=Hf(t.type,!0),t;default:return""}}function Cm(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case bl:return"Fragment";case wl:return"Portal";case km:return"Profiler";case Rg:return"StrictMode";case Em:return"Suspense";case Im:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case gx:return(t.displayName||"Context")+".Consumer";case mx:return(t._context.displayName||"Context")+".Provider";case Fg:var i=t.render;return t=t.displayName,t||(t=i.displayName||i.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Bg:return i=t.displayName||null,i!==null?i:Cm(t.type)||"Memo";case Eo:i=t._payload,t=t._init;try{return Cm(t(i))}catch{}}return null}function vS(t){var i=t.type;switch(t.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=i.render,t=t.displayName||t.name||"",i.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Cm(i);case 8:return i===Rg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function Uo(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function _x(t){var i=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function xS(t){var i=_x(t)?"checked":"value",l=Object.getOwnPropertyDescriptor(t.constructor.prototype,i),p=""+t[i];if(!t.hasOwnProperty(i)&&typeof l<"u"&&typeof l.get=="function"&&typeof l.set=="function"){var _=l.get,b=l.set;return Object.defineProperty(t,i,{configurable:!0,get:function(){return _.call(this)},set:function(I){p=""+I,b.call(this,I)}}),Object.defineProperty(t,i,{enumerable:l.enumerable}),{getValue:function(){return p},setValue:function(I){p=""+I},stopTracking:function(){t._valueTracker=null,delete t[i]}}}}function sd(t){t._valueTracker||(t._valueTracker=xS(t))}function vx(t){if(!t)return!1;var i=t._valueTracker;if(!i)return!0;var l=i.getValue(),p="";return t&&(p=_x(t)?t.checked?"true":"false":t.value),t=p,t!==l?(i.setValue(t),!0):!1}function Vd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Pm(t,i){var l=i.checked;return yr({},i,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:l??t._wrapperState.initialChecked})}function Sv(t,i){var l=i.defaultValue==null?"":i.defaultValue,p=i.checked!=null?i.checked:i.defaultChecked;l=Uo(i.value!=null?i.value:l),t._wrapperState={initialChecked:p,initialValue:l,controlled:i.type==="checkbox"||i.type==="radio"?i.checked!=null:i.value!=null}}function xx(t,i){i=i.checked,i!=null&&Lg(t,"checked",i,!1)}function zm(t,i){xx(t,i);var l=Uo(i.value),p=i.type;if(l!=null)p==="number"?(l===0&&t.value===""||t.value!=l)&&(t.value=""+l):t.value!==""+l&&(t.value=""+l);else if(p==="submit"||p==="reset"){t.removeAttribute("value");return}i.hasOwnProperty("value")?Mm(t,i.type,l):i.hasOwnProperty("defaultValue")&&Mm(t,i.type,Uo(i.defaultValue)),i.checked==null&&i.defaultChecked!=null&&(t.defaultChecked=!!i.defaultChecked)}function Tv(t,i,l){if(i.hasOwnProperty("value")||i.hasOwnProperty("defaultValue")){var p=i.type;if(!(p!=="submit"&&p!=="reset"||i.value!==void 0&&i.value!==null))return;i=""+t._wrapperState.initialValue,l||i===t.value||(t.value=i),t.defaultValue=i}l=t.name,l!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,l!==""&&(t.name=l)}function Mm(t,i,l){(i!=="number"||Vd(t.ownerDocument)!==t)&&(l==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+l&&(t.defaultValue=""+l))}var hc=Array.isArray;function Dl(t,i,l,p){if(t=t.options,i){i={};for(var _=0;_<l.length;_++)i["$"+l[_]]=!0;for(l=0;l<t.length;l++)_=i.hasOwnProperty("$"+t[l].value),t[l].selected!==_&&(t[l].selected=_),_&&p&&(t[l].defaultSelected=!0)}else{for(l=""+Uo(l),i=null,_=0;_<t.length;_++){if(t[_].value===l){t[_].selected=!0,p&&(t[_].defaultSelected=!0);return}i!==null||t[_].disabled||(i=t[_])}i!==null&&(i.selected=!0)}}function Am(t,i){if(i.dangerouslySetInnerHTML!=null)throw Error(Fe(91));return yr({},i,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function kv(t,i){var l=i.value;if(l==null){if(l=i.children,i=i.defaultValue,l!=null){if(i!=null)throw Error(Fe(92));if(hc(l)){if(1<l.length)throw Error(Fe(93));l=l[0]}i=l}i==null&&(i=""),l=i}t._wrapperState={initialValue:Uo(l)}}function wx(t,i){var l=Uo(i.value),p=Uo(i.defaultValue);l!=null&&(l=""+l,l!==t.value&&(t.value=l),i.defaultValue==null&&t.defaultValue!==l&&(t.defaultValue=l)),p!=null&&(t.defaultValue=""+p)}function Ev(t){var i=t.textContent;i===t._wrapperState.initialValue&&i!==""&&i!==null&&(t.value=i)}function bx(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Dm(t,i){return t==null||t==="http://www.w3.org/1999/xhtml"?bx(i):t==="http://www.w3.org/2000/svg"&&i==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var od,Sx=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(i,l,p,_){MSApp.execUnsafeLocalFunction(function(){return t(i,l,p,_)})}:t}(function(t,i){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=i;else{for(od=od||document.createElement("div"),od.innerHTML="<svg>"+i.valueOf().toString()+"</svg>",i=od.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;i.firstChild;)t.appendChild(i.firstChild)}});function kc(t,i){if(i){var l=t.firstChild;if(l&&l===t.lastChild&&l.nodeType===3){l.nodeValue=i;return}}t.textContent=i}var mc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},wS=["Webkit","ms","Moz","O"];Object.keys(mc).forEach(function(t){wS.forEach(function(i){i=i+t.charAt(0).toUpperCase()+t.substring(1),mc[i]=mc[t]})});function Tx(t,i,l){return i==null||typeof i=="boolean"||i===""?"":l||typeof i!="number"||i===0||mc.hasOwnProperty(t)&&mc[t]?(""+i).trim():i+"px"}function kx(t,i){t=t.style;for(var l in i)if(i.hasOwnProperty(l)){var p=l.indexOf("--")===0,_=Tx(l,i[l],p);l==="float"&&(l="cssFloat"),p?t.setProperty(l,_):t[l]=_}}var bS=yr({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Lm(t,i){if(i){if(bS[t]&&(i.children!=null||i.dangerouslySetInnerHTML!=null))throw Error(Fe(137,t));if(i.dangerouslySetInnerHTML!=null){if(i.children!=null)throw Error(Fe(60));if(typeof i.dangerouslySetInnerHTML!="object"||!("__html"in i.dangerouslySetInnerHTML))throw Error(Fe(61))}if(i.style!=null&&typeof i.style!="object")throw Error(Fe(62))}}function Rm(t,i){if(t.indexOf("-")===-1)return typeof i.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fm=null;function Og(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Bm=null,Ll=null,Rl=null;function Iv(t){if(t=Wc(t)){if(typeof Bm!="function")throw Error(Fe(280));var i=t.stateNode;i&&(i=xp(i),Bm(t.stateNode,t.type,i))}}function Ex(t){Ll?Rl?Rl.push(t):Rl=[t]:Ll=t}function Ix(){if(Ll){var t=Ll,i=Rl;if(Rl=Ll=null,Iv(t),i)for(t=0;t<i.length;t++)Iv(i[t])}}function Cx(t,i){return t(i)}function Px(){}var Xf=!1;function zx(t,i,l){if(Xf)return t(i,l);Xf=!0;try{return Cx(t,i,l)}finally{Xf=!1,(Ll!==null||Rl!==null)&&(Px(),Ix())}}function Ec(t,i){var l=t.stateNode;if(l===null)return null;var p=xp(l);if(p===null)return null;l=p[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(p=!p.disabled)||(t=t.type,p=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!p;break e;default:t=!1}if(t)return null;if(l&&typeof l!="function")throw Error(Fe(231,i,typeof l));return l}var Om=!1;if(Xs)try{var nc={};Object.defineProperty(nc,"passive",{get:function(){Om=!0}}),window.addEventListener("test",nc,nc),window.removeEventListener("test",nc,nc)}catch{Om=!1}function SS(t,i,l,p,_,b,I,u,B){var D=Array.prototype.slice.call(arguments,3);try{i.apply(l,D)}catch(ne){this.onError(ne)}}var gc=!1,Ud=null,jd=!1,Nm=null,TS={onError:function(t){gc=!0,Ud=t}};function kS(t,i,l,p,_,b,I,u,B){gc=!1,Ud=null,SS.apply(TS,arguments)}function ES(t,i,l,p,_,b,I,u,B){if(kS.apply(this,arguments),gc){if(gc){var D=Ud;gc=!1,Ud=null}else throw Error(Fe(198));jd||(jd=!0,Nm=D)}}function Da(t){var i=t,l=t;if(t.alternate)for(;i.return;)i=i.return;else{t=i;do i=t,i.flags&4098&&(l=i.return),t=i.return;while(t)}return i.tag===3?l:null}function Mx(t){if(t.tag===13){var i=t.memoizedState;if(i===null&&(t=t.alternate,t!==null&&(i=t.memoizedState)),i!==null)return i.dehydrated}return null}function Cv(t){if(Da(t)!==t)throw Error(Fe(188))}function IS(t){var i=t.alternate;if(!i){if(i=Da(t),i===null)throw Error(Fe(188));return i!==t?null:t}for(var l=t,p=i;;){var _=l.return;if(_===null)break;var b=_.alternate;if(b===null){if(p=_.return,p!==null){l=p;continue}break}if(_.child===b.child){for(b=_.child;b;){if(b===l)return Cv(_),t;if(b===p)return Cv(_),i;b=b.sibling}throw Error(Fe(188))}if(l.return!==p.return)l=_,p=b;else{for(var I=!1,u=_.child;u;){if(u===l){I=!0,l=_,p=b;break}if(u===p){I=!0,p=_,l=b;break}u=u.sibling}if(!I){for(u=b.child;u;){if(u===l){I=!0,l=b,p=_;break}if(u===p){I=!0,p=b,l=_;break}u=u.sibling}if(!I)throw Error(Fe(189))}}if(l.alternate!==p)throw Error(Fe(190))}if(l.tag!==3)throw Error(Fe(188));return l.stateNode.current===l?t:i}function Ax(t){return t=IS(t),t!==null?Dx(t):null}function Dx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var i=Dx(t);if(i!==null)return i;t=t.sibling}return null}var Lx=pi.unstable_scheduleCallback,Pv=pi.unstable_cancelCallback,CS=pi.unstable_shouldYield,PS=pi.unstable_requestPaint,zr=pi.unstable_now,zS=pi.unstable_getCurrentPriorityLevel,Ng=pi.unstable_ImmediatePriority,Rx=pi.unstable_UserBlockingPriority,$d=pi.unstable_NormalPriority,MS=pi.unstable_LowPriority,Fx=pi.unstable_IdlePriority,gp=null,ws=null;function AS(t){if(ws&&typeof ws.onCommitFiberRoot=="function")try{ws.onCommitFiberRoot(gp,t,void 0,(t.current.flags&128)===128)}catch{}}var es=Math.clz32?Math.clz32:RS,DS=Math.log,LS=Math.LN2;function RS(t){return t>>>=0,t===0?32:31-(DS(t)/LS|0)|0}var ad=64,ld=4194304;function dc(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function qd(t,i){var l=t.pendingLanes;if(l===0)return 0;var p=0,_=t.suspendedLanes,b=t.pingedLanes,I=l&268435455;if(I!==0){var u=I&~_;u!==0?p=dc(u):(b&=I,b!==0&&(p=dc(b)))}else I=l&~_,I!==0?p=dc(I):b!==0&&(p=dc(b));if(p===0)return 0;if(i!==0&&i!==p&&!(i&_)&&(_=p&-p,b=i&-i,_>=b||_===16&&(b&4194240)!==0))return i;if(p&4&&(p|=l&16),i=t.entangledLanes,i!==0)for(t=t.entanglements,i&=p;0<i;)l=31-es(i),_=1<<l,p|=t[l],i&=~_;return p}function FS(t,i){switch(t){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function BS(t,i){for(var l=t.suspendedLanes,p=t.pingedLanes,_=t.expirationTimes,b=t.pendingLanes;0<b;){var I=31-es(b),u=1<<I,B=_[I];B===-1?(!(u&l)||u&p)&&(_[I]=FS(u,i)):B<=i&&(t.expiredLanes|=u),b&=~u}}function Vm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function Bx(){var t=ad;return ad<<=1,!(ad&4194240)&&(ad=64),t}function Kf(t){for(var i=[],l=0;31>l;l++)i.push(t);return i}function Zc(t,i,l){t.pendingLanes|=i,i!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,i=31-es(i),t[i]=l}function OS(t,i){var l=t.pendingLanes&~i;t.pendingLanes=i,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=i,t.mutableReadLanes&=i,t.entangledLanes&=i,i=t.entanglements;var p=t.eventTimes;for(t=t.expirationTimes;0<l;){var _=31-es(l),b=1<<_;i[_]=0,p[_]=-1,t[_]=-1,l&=~b}}function Vg(t,i){var l=t.entangledLanes|=i;for(t=t.entanglements;l;){var p=31-es(l),_=1<<p;_&i|t[p]&i&&(t[p]|=i),l&=~_}}var $t=0;function Ox(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Nx,Ug,Vx,Ux,jx,Um=!1,ud=[],Ao=null,Do=null,Lo=null,Ic=new Map,Cc=new Map,Co=[],NS="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function zv(t,i){switch(t){case"focusin":case"focusout":Ao=null;break;case"dragenter":case"dragleave":Do=null;break;case"mouseover":case"mouseout":Lo=null;break;case"pointerover":case"pointerout":Ic.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cc.delete(i.pointerId)}}function ic(t,i,l,p,_,b){return t===null||t.nativeEvent!==b?(t={blockedOn:i,domEventName:l,eventSystemFlags:p,nativeEvent:b,targetContainers:[_]},i!==null&&(i=Wc(i),i!==null&&Ug(i)),t):(t.eventSystemFlags|=p,i=t.targetContainers,_!==null&&i.indexOf(_)===-1&&i.push(_),t)}function VS(t,i,l,p,_){switch(i){case"focusin":return Ao=ic(Ao,t,i,l,p,_),!0;case"dragenter":return Do=ic(Do,t,i,l,p,_),!0;case"mouseover":return Lo=ic(Lo,t,i,l,p,_),!0;case"pointerover":var b=_.pointerId;return Ic.set(b,ic(Ic.get(b)||null,t,i,l,p,_)),!0;case"gotpointercapture":return b=_.pointerId,Cc.set(b,ic(Cc.get(b)||null,t,i,l,p,_)),!0}return!1}function $x(t){var i=xa(t.target);if(i!==null){var l=Da(i);if(l!==null){if(i=l.tag,i===13){if(i=Mx(l),i!==null){t.blockedOn=i,jx(t.priority,function(){Vx(l)});return}}else if(i===3&&l.stateNode.current.memoizedState.isDehydrated){t.blockedOn=l.tag===3?l.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Td(t){if(t.blockedOn!==null)return!1;for(var i=t.targetContainers;0<i.length;){var l=jm(t.domEventName,t.eventSystemFlags,i[0],t.nativeEvent);if(l===null){l=t.nativeEvent;var p=new l.constructor(l.type,l);Fm=p,l.target.dispatchEvent(p),Fm=null}else return i=Wc(l),i!==null&&Ug(i),t.blockedOn=l,!1;i.shift()}return!0}function Mv(t,i,l){Td(t)&&l.delete(i)}function US(){Um=!1,Ao!==null&&Td(Ao)&&(Ao=null),Do!==null&&Td(Do)&&(Do=null),Lo!==null&&Td(Lo)&&(Lo=null),Ic.forEach(Mv),Cc.forEach(Mv)}function sc(t,i){t.blockedOn===i&&(t.blockedOn=null,Um||(Um=!0,pi.unstable_scheduleCallback(pi.unstable_NormalPriority,US)))}function Pc(t){function i(_){return sc(_,t)}if(0<ud.length){sc(ud[0],t);for(var l=1;l<ud.length;l++){var p=ud[l];p.blockedOn===t&&(p.blockedOn=null)}}for(Ao!==null&&sc(Ao,t),Do!==null&&sc(Do,t),Lo!==null&&sc(Lo,t),Ic.forEach(i),Cc.forEach(i),l=0;l<Co.length;l++)p=Co[l],p.blockedOn===t&&(p.blockedOn=null);for(;0<Co.length&&(l=Co[0],l.blockedOn===null);)$x(l),l.blockedOn===null&&Co.shift()}var Fl=eo.ReactCurrentBatchConfig,Zd=!0;function jS(t,i,l,p){var _=$t,b=Fl.transition;Fl.transition=null;try{$t=1,jg(t,i,l,p)}finally{$t=_,Fl.transition=b}}function $S(t,i,l,p){var _=$t,b=Fl.transition;Fl.transition=null;try{$t=4,jg(t,i,l,p)}finally{$t=_,Fl.transition=b}}function jg(t,i,l,p){if(Zd){var _=jm(t,i,l,p);if(_===null)om(t,i,p,Gd,l),zv(t,p);else if(VS(_,t,i,l,p))p.stopPropagation();else if(zv(t,p),i&4&&-1<NS.indexOf(t)){for(;_!==null;){var b=Wc(_);if(b!==null&&Nx(b),b=jm(t,i,l,p),b===null&&om(t,i,p,Gd,l),b===_)break;_=b}_!==null&&p.stopPropagation()}else om(t,i,p,null,l)}}var Gd=null;function jm(t,i,l,p){if(Gd=null,t=Og(p),t=xa(t),t!==null)if(i=Da(t),i===null)t=null;else if(l=i.tag,l===13){if(t=Mx(i),t!==null)return t;t=null}else if(l===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;t=null}else i!==t&&(t=null);return Gd=t,null}function qx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(zS()){case Ng:return 1;case Rx:return 4;case $d:case MS:return 16;case Fx:return 536870912;default:return 16}default:return 16}}var zo=null,$g=null,kd=null;function Zx(){if(kd)return kd;var t,i=$g,l=i.length,p,_="value"in zo?zo.value:zo.textContent,b=_.length;for(t=0;t<l&&i[t]===_[t];t++);var I=l-t;for(p=1;p<=I&&i[l-p]===_[b-p];p++);return kd=_.slice(t,1<p?1-p:void 0)}function Ed(t){var i=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&i===13&&(t=13)):t=i,t===10&&(t=13),32<=t||t===13?t:0}function cd(){return!0}function Av(){return!1}function yi(t){function i(l,p,_,b,I){this._reactName=l,this._targetInst=_,this.type=p,this.nativeEvent=b,this.target=I,this.currentTarget=null;for(var u in t)t.hasOwnProperty(u)&&(l=t[u],this[u]=l?l(b):b[u]);return this.isDefaultPrevented=(b.defaultPrevented!=null?b.defaultPrevented:b.returnValue===!1)?cd:Av,this.isPropagationStopped=Av,this}return yr(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var l=this.nativeEvent;l&&(l.preventDefault?l.preventDefault():typeof l.returnValue!="unknown"&&(l.returnValue=!1),this.isDefaultPrevented=cd)},stopPropagation:function(){var l=this.nativeEvent;l&&(l.stopPropagation?l.stopPropagation():typeof l.cancelBubble!="unknown"&&(l.cancelBubble=!0),this.isPropagationStopped=cd)},persist:function(){},isPersistent:cd}),i}var Hl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},qg=yi(Hl),Gc=yr({},Hl,{view:0,detail:0}),qS=yi(Gc),Yf,Qf,oc,yp=yr({},Gc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zg,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==oc&&(oc&&t.type==="mousemove"?(Yf=t.screenX-oc.screenX,Qf=t.screenY-oc.screenY):Qf=Yf=0,oc=t),Yf)},movementY:function(t){return"movementY"in t?t.movementY:Qf}}),Dv=yi(yp),ZS=yr({},yp,{dataTransfer:0}),GS=yi(ZS),WS=yr({},Gc,{relatedTarget:0}),Jf=yi(WS),HS=yr({},Hl,{animationName:0,elapsedTime:0,pseudoElement:0}),XS=yi(HS),KS=yr({},Hl,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),YS=yi(KS),QS=yr({},Hl,{data:0}),Lv=yi(QS),JS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},eT={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},tT={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function rT(t){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(t):(t=tT[t])?!!i[t]:!1}function Zg(){return rT}var nT=yr({},Gc,{key:function(t){if(t.key){var i=JS[t.key]||t.key;if(i!=="Unidentified")return i}return t.type==="keypress"?(t=Ed(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?eT[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zg,charCode:function(t){return t.type==="keypress"?Ed(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Ed(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),iT=yi(nT),sT=yr({},yp,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Rv=yi(sT),oT=yr({},Gc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zg}),aT=yi(oT),lT=yr({},Hl,{propertyName:0,elapsedTime:0,pseudoElement:0}),uT=yi(lT),cT=yr({},yp,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),hT=yi(cT),dT=[9,13,27,32],Gg=Xs&&"CompositionEvent"in window,yc=null;Xs&&"documentMode"in document&&(yc=document.documentMode);var pT=Xs&&"TextEvent"in window&&!yc,Gx=Xs&&(!Gg||yc&&8<yc&&11>=yc),Fv=String.fromCharCode(32),Bv=!1;function Wx(t,i){switch(t){case"keyup":return dT.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Sl=!1;function fT(t,i){switch(t){case"compositionend":return Hx(i);case"keypress":return i.which!==32?null:(Bv=!0,Fv);case"textInput":return t=i.data,t===Fv&&Bv?null:t;default:return null}}function mT(t,i){if(Sl)return t==="compositionend"||!Gg&&Wx(t,i)?(t=Zx(),kd=$g=zo=null,Sl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Gx&&i.locale!=="ko"?null:i.data;default:return null}}var gT={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ov(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i==="input"?!!gT[t.type]:i==="textarea"}function Xx(t,i,l,p){Ex(p),i=Wd(i,"onChange"),0<i.length&&(l=new qg("onChange","change",null,l,p),t.push({event:l,listeners:i}))}var _c=null,zc=null;function yT(t){o1(t,0)}function _p(t){var i=El(t);if(vx(i))return t}function _T(t,i){if(t==="change")return i}var Kx=!1;if(Xs){var em;if(Xs){var tm="oninput"in document;if(!tm){var Nv=document.createElement("div");Nv.setAttribute("oninput","return;"),tm=typeof Nv.oninput=="function"}em=tm}else em=!1;Kx=em&&(!document.documentMode||9<document.documentMode)}function Vv(){_c&&(_c.detachEvent("onpropertychange",Yx),zc=_c=null)}function Yx(t){if(t.propertyName==="value"&&_p(zc)){var i=[];Xx(i,zc,t,Og(t)),zx(yT,i)}}function vT(t,i,l){t==="focusin"?(Vv(),_c=i,zc=l,_c.attachEvent("onpropertychange",Yx)):t==="focusout"&&Vv()}function xT(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return _p(zc)}function wT(t,i){if(t==="click")return _p(i)}function bT(t,i){if(t==="input"||t==="change")return _p(i)}function ST(t,i){return t===i&&(t!==0||1/t===1/i)||t!==t&&i!==i}var ns=typeof Object.is=="function"?Object.is:ST;function Mc(t,i){if(ns(t,i))return!0;if(typeof t!="object"||t===null||typeof i!="object"||i===null)return!1;var l=Object.keys(t),p=Object.keys(i);if(l.length!==p.length)return!1;for(p=0;p<l.length;p++){var _=l[p];if(!Tm.call(i,_)||!ns(t[_],i[_]))return!1}return!0}function Uv(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function jv(t,i){var l=Uv(t);t=0;for(var p;l;){if(l.nodeType===3){if(p=t+l.textContent.length,t<=i&&p>=i)return{node:l,offset:i-t};t=p}e:{for(;l;){if(l.nextSibling){l=l.nextSibling;break e}l=l.parentNode}l=void 0}l=Uv(l)}}function Qx(t,i){return t&&i?t===i?!0:t&&t.nodeType===3?!1:i&&i.nodeType===3?Qx(t,i.parentNode):"contains"in t?t.contains(i):t.compareDocumentPosition?!!(t.compareDocumentPosition(i)&16):!1:!1}function Jx(){for(var t=window,i=Vd();i instanceof t.HTMLIFrameElement;){try{var l=typeof i.contentWindow.location.href=="string"}catch{l=!1}if(l)t=i.contentWindow;else break;i=Vd(t.document)}return i}function Wg(t){var i=t&&t.nodeName&&t.nodeName.toLowerCase();return i&&(i==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||i==="textarea"||t.contentEditable==="true")}function TT(t){var i=Jx(),l=t.focusedElem,p=t.selectionRange;if(i!==l&&l&&l.ownerDocument&&Qx(l.ownerDocument.documentElement,l)){if(p!==null&&Wg(l)){if(i=p.start,t=p.end,t===void 0&&(t=i),"selectionStart"in l)l.selectionStart=i,l.selectionEnd=Math.min(t,l.value.length);else if(t=(i=l.ownerDocument||document)&&i.defaultView||window,t.getSelection){t=t.getSelection();var _=l.textContent.length,b=Math.min(p.start,_);p=p.end===void 0?b:Math.min(p.end,_),!t.extend&&b>p&&(_=p,p=b,b=_),_=jv(l,b);var I=jv(l,p);_&&I&&(t.rangeCount!==1||t.anchorNode!==_.node||t.anchorOffset!==_.offset||t.focusNode!==I.node||t.focusOffset!==I.offset)&&(i=i.createRange(),i.setStart(_.node,_.offset),t.removeAllRanges(),b>p?(t.addRange(i),t.extend(I.node,I.offset)):(i.setEnd(I.node,I.offset),t.addRange(i)))}}for(i=[],t=l;t=t.parentNode;)t.nodeType===1&&i.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof l.focus=="function"&&l.focus(),l=0;l<i.length;l++)t=i[l],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var kT=Xs&&"documentMode"in document&&11>=document.documentMode,Tl=null,$m=null,vc=null,qm=!1;function $v(t,i,l){var p=l.window===l?l.document:l.nodeType===9?l:l.ownerDocument;qm||Tl==null||Tl!==Vd(p)||(p=Tl,"selectionStart"in p&&Wg(p)?p={start:p.selectionStart,end:p.selectionEnd}:(p=(p.ownerDocument&&p.ownerDocument.defaultView||window).getSelection(),p={anchorNode:p.anchorNode,anchorOffset:p.anchorOffset,focusNode:p.focusNode,focusOffset:p.focusOffset}),vc&&Mc(vc,p)||(vc=p,p=Wd($m,"onSelect"),0<p.length&&(i=new qg("onSelect","select",null,i,l),t.push({event:i,listeners:p}),i.target=Tl)))}function hd(t,i){var l={};return l[t.toLowerCase()]=i.toLowerCase(),l["Webkit"+t]="webkit"+i,l["Moz"+t]="moz"+i,l}var kl={animationend:hd("Animation","AnimationEnd"),animationiteration:hd("Animation","AnimationIteration"),animationstart:hd("Animation","AnimationStart"),transitionend:hd("Transition","TransitionEnd")},rm={},e1={};Xs&&(e1=document.createElement("div").style,"AnimationEvent"in window||(delete kl.animationend.animation,delete kl.animationiteration.animation,delete kl.animationstart.animation),"TransitionEvent"in window||delete kl.transitionend.transition);function vp(t){if(rm[t])return rm[t];if(!kl[t])return t;var i=kl[t],l;for(l in i)if(i.hasOwnProperty(l)&&l in e1)return rm[t]=i[l];return t}var t1=vp("animationend"),r1=vp("animationiteration"),n1=vp("animationstart"),i1=vp("transitionend"),s1=new Map,qv="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Zo(t,i){s1.set(t,i),Aa(i,[t])}for(var nm=0;nm<qv.length;nm++){var im=qv[nm],ET=im.toLowerCase(),IT=im[0].toUpperCase()+im.slice(1);Zo(ET,"on"+IT)}Zo(t1,"onAnimationEnd");Zo(r1,"onAnimationIteration");Zo(n1,"onAnimationStart");Zo("dblclick","onDoubleClick");Zo("focusin","onFocus");Zo("focusout","onBlur");Zo(i1,"onTransitionEnd");Nl("onMouseEnter",["mouseout","mouseover"]);Nl("onMouseLeave",["mouseout","mouseover"]);Nl("onPointerEnter",["pointerout","pointerover"]);Nl("onPointerLeave",["pointerout","pointerover"]);Aa("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Aa("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Aa("onBeforeInput",["compositionend","keypress","textInput","paste"]);Aa("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Aa("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Aa("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var pc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),CT=new Set("cancel close invalid load scroll toggle".split(" ").concat(pc));function Zv(t,i,l){var p=t.type||"unknown-event";t.currentTarget=l,ES(p,i,void 0,t),t.currentTarget=null}function o1(t,i){i=(i&4)!==0;for(var l=0;l<t.length;l++){var p=t[l],_=p.event;p=p.listeners;e:{var b=void 0;if(i)for(var I=p.length-1;0<=I;I--){var u=p[I],B=u.instance,D=u.currentTarget;if(u=u.listener,B!==b&&_.isPropagationStopped())break e;Zv(_,u,D),b=B}else for(I=0;I<p.length;I++){if(u=p[I],B=u.instance,D=u.currentTarget,u=u.listener,B!==b&&_.isPropagationStopped())break e;Zv(_,u,D),b=B}}}if(jd)throw t=Nm,jd=!1,Nm=null,t}function ir(t,i){var l=i[Xm];l===void 0&&(l=i[Xm]=new Set);var p=t+"__bubble";l.has(p)||(a1(i,t,2,!1),l.add(p))}function sm(t,i,l){var p=0;i&&(p|=4),a1(l,t,p,i)}var dd="_reactListening"+Math.random().toString(36).slice(2);function Ac(t){if(!t[dd]){t[dd]=!0,fx.forEach(function(l){l!=="selectionchange"&&(CT.has(l)||sm(l,!1,t),sm(l,!0,t))});var i=t.nodeType===9?t:t.ownerDocument;i===null||i[dd]||(i[dd]=!0,sm("selectionchange",!1,i))}}function a1(t,i,l,p){switch(qx(i)){case 1:var _=jS;break;case 4:_=$S;break;default:_=jg}l=_.bind(null,i,l,t),_=void 0,!Om||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(_=!0),p?_!==void 0?t.addEventListener(i,l,{capture:!0,passive:_}):t.addEventListener(i,l,!0):_!==void 0?t.addEventListener(i,l,{passive:_}):t.addEventListener(i,l,!1)}function om(t,i,l,p,_){var b=p;if(!(i&1)&&!(i&2)&&p!==null)e:for(;;){if(p===null)return;var I=p.tag;if(I===3||I===4){var u=p.stateNode.containerInfo;if(u===_||u.nodeType===8&&u.parentNode===_)break;if(I===4)for(I=p.return;I!==null;){var B=I.tag;if((B===3||B===4)&&(B=I.stateNode.containerInfo,B===_||B.nodeType===8&&B.parentNode===_))return;I=I.return}for(;u!==null;){if(I=xa(u),I===null)return;if(B=I.tag,B===5||B===6){p=b=I;continue e}u=u.parentNode}}p=p.return}zx(function(){var D=b,ne=Og(l),re=[];e:{var te=s1.get(t);if(te!==void 0){var _e=qg,be=t;switch(t){case"keypress":if(Ed(l)===0)break e;case"keydown":case"keyup":_e=iT;break;case"focusin":be="focus",_e=Jf;break;case"focusout":be="blur",_e=Jf;break;case"beforeblur":case"afterblur":_e=Jf;break;case"click":if(l.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":_e=Dv;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":_e=GS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":_e=aT;break;case t1:case r1:case n1:_e=XS;break;case i1:_e=uT;break;case"scroll":_e=qS;break;case"wheel":_e=hT;break;case"copy":case"cut":case"paste":_e=YS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":_e=Rv}var ke=(i&4)!==0,we=!ke&&t==="scroll",K=ke?te!==null?te+"Capture":null:te;ke=[];for(var ee=D,ce;ee!==null;){ce=ee;var ye=ce.stateNode;if(ce.tag===5&&ye!==null&&(ce=ye,K!==null&&(ye=Ec(ee,K),ye!=null&&ke.push(Dc(ee,ye,ce)))),we)break;ee=ee.return}0<ke.length&&(te=new _e(te,be,null,l,ne),re.push({event:te,listeners:ke}))}}if(!(i&7)){e:{if(te=t==="mouseover"||t==="pointerover",_e=t==="mouseout"||t==="pointerout",te&&l!==Fm&&(be=l.relatedTarget||l.fromElement)&&(xa(be)||be[Ks]))break e;if((_e||te)&&(te=ne.window===ne?ne:(te=ne.ownerDocument)?te.defaultView||te.parentWindow:window,_e?(be=l.relatedTarget||l.toElement,_e=D,be=be?xa(be):null,be!==null&&(we=Da(be),be!==we||be.tag!==5&&be.tag!==6)&&(be=null)):(_e=null,be=D),_e!==be)){if(ke=Dv,ye="onMouseLeave",K="onMouseEnter",ee="mouse",(t==="pointerout"||t==="pointerover")&&(ke=Rv,ye="onPointerLeave",K="onPointerEnter",ee="pointer"),we=_e==null?te:El(_e),ce=be==null?te:El(be),te=new ke(ye,ee+"leave",_e,l,ne),te.target=we,te.relatedTarget=ce,ye=null,xa(ne)===D&&(ke=new ke(K,ee+"enter",be,l,ne),ke.target=ce,ke.relatedTarget=we,ye=ke),we=ye,_e&&be)t:{for(ke=_e,K=be,ee=0,ce=ke;ce;ce=xl(ce))ee++;for(ce=0,ye=K;ye;ye=xl(ye))ce++;for(;0<ee-ce;)ke=xl(ke),ee--;for(;0<ce-ee;)K=xl(K),ce--;for(;ee--;){if(ke===K||K!==null&&ke===K.alternate)break t;ke=xl(ke),K=xl(K)}ke=null}else ke=null;_e!==null&&Gv(re,te,_e,ke,!1),be!==null&&we!==null&&Gv(re,we,be,ke,!0)}}e:{if(te=D?El(D):window,_e=te.nodeName&&te.nodeName.toLowerCase(),_e==="select"||_e==="input"&&te.type==="file")var Pe=_T;else if(Ov(te))if(Kx)Pe=bT;else{Pe=xT;var Le=vT}else(_e=te.nodeName)&&_e.toLowerCase()==="input"&&(te.type==="checkbox"||te.type==="radio")&&(Pe=wT);if(Pe&&(Pe=Pe(t,D))){Xx(re,Pe,l,ne);break e}Le&&Le(t,te,D),t==="focusout"&&(Le=te._wrapperState)&&Le.controlled&&te.type==="number"&&Mm(te,"number",te.value)}switch(Le=D?El(D):window,t){case"focusin":(Ov(Le)||Le.contentEditable==="true")&&(Tl=Le,$m=D,vc=null);break;case"focusout":vc=$m=Tl=null;break;case"mousedown":qm=!0;break;case"contextmenu":case"mouseup":case"dragend":qm=!1,$v(re,l,ne);break;case"selectionchange":if(kT)break;case"keydown":case"keyup":$v(re,l,ne)}var je;if(Gg)e:{switch(t){case"compositionstart":var Ze="onCompositionStart";break e;case"compositionend":Ze="onCompositionEnd";break e;case"compositionupdate":Ze="onCompositionUpdate";break e}Ze=void 0}else Sl?Wx(t,l)&&(Ze="onCompositionEnd"):t==="keydown"&&l.keyCode===229&&(Ze="onCompositionStart");Ze&&(Gx&&l.locale!=="ko"&&(Sl||Ze!=="onCompositionStart"?Ze==="onCompositionEnd"&&Sl&&(je=Zx()):(zo=ne,$g="value"in zo?zo.value:zo.textContent,Sl=!0)),Le=Wd(D,Ze),0<Le.length&&(Ze=new Lv(Ze,t,null,l,ne),re.push({event:Ze,listeners:Le}),je?Ze.data=je:(je=Hx(l),je!==null&&(Ze.data=je)))),(je=pT?fT(t,l):mT(t,l))&&(D=Wd(D,"onBeforeInput"),0<D.length&&(ne=new Lv("onBeforeInput","beforeinput",null,l,ne),re.push({event:ne,listeners:D}),ne.data=je))}o1(re,i)})}function Dc(t,i,l){return{instance:t,listener:i,currentTarget:l}}function Wd(t,i){for(var l=i+"Capture",p=[];t!==null;){var _=t,b=_.stateNode;_.tag===5&&b!==null&&(_=b,b=Ec(t,l),b!=null&&p.unshift(Dc(t,b,_)),b=Ec(t,i),b!=null&&p.push(Dc(t,b,_))),t=t.return}return p}function xl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Gv(t,i,l,p,_){for(var b=i._reactName,I=[];l!==null&&l!==p;){var u=l,B=u.alternate,D=u.stateNode;if(B!==null&&B===p)break;u.tag===5&&D!==null&&(u=D,_?(B=Ec(l,b),B!=null&&I.unshift(Dc(l,B,u))):_||(B=Ec(l,b),B!=null&&I.push(Dc(l,B,u)))),l=l.return}I.length!==0&&t.push({event:i,listeners:I})}var PT=/\r\n?/g,zT=/\u0000|\uFFFD/g;function Wv(t){return(typeof t=="string"?t:""+t).replace(PT,`
`).replace(zT,"")}function pd(t,i,l){if(i=Wv(i),Wv(t)!==i&&l)throw Error(Fe(425))}function Hd(){}var Zm=null,Gm=null;function Wm(t,i){return t==="textarea"||t==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Hm=typeof setTimeout=="function"?setTimeout:void 0,MT=typeof clearTimeout=="function"?clearTimeout:void 0,Hv=typeof Promise=="function"?Promise:void 0,AT=typeof queueMicrotask=="function"?queueMicrotask:typeof Hv<"u"?function(t){return Hv.resolve(null).then(t).catch(DT)}:Hm;function DT(t){setTimeout(function(){throw t})}function am(t,i){var l=i,p=0;do{var _=l.nextSibling;if(t.removeChild(l),_&&_.nodeType===8)if(l=_.data,l==="/$"){if(p===0){t.removeChild(_),Pc(i);return}p--}else l!=="$"&&l!=="$?"&&l!=="$!"||p++;l=_}while(l);Pc(i)}function Ro(t){for(;t!=null;t=t.nextSibling){var i=t.nodeType;if(i===1||i===3)break;if(i===8){if(i=t.data,i==="$"||i==="$!"||i==="$?")break;if(i==="/$")return null}}return t}function Xv(t){t=t.previousSibling;for(var i=0;t;){if(t.nodeType===8){var l=t.data;if(l==="$"||l==="$!"||l==="$?"){if(i===0)return t;i--}else l==="/$"&&i++}t=t.previousSibling}return null}var Xl=Math.random().toString(36).slice(2),xs="__reactFiber$"+Xl,Lc="__reactProps$"+Xl,Ks="__reactContainer$"+Xl,Xm="__reactEvents$"+Xl,LT="__reactListeners$"+Xl,RT="__reactHandles$"+Xl;function xa(t){var i=t[xs];if(i)return i;for(var l=t.parentNode;l;){if(i=l[Ks]||l[xs]){if(l=i.alternate,i.child!==null||l!==null&&l.child!==null)for(t=Xv(t);t!==null;){if(l=t[xs])return l;t=Xv(t)}return i}t=l,l=t.parentNode}return null}function Wc(t){return t=t[xs]||t[Ks],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function El(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(Fe(33))}function xp(t){return t[Lc]||null}var Km=[],Il=-1;function Go(t){return{current:t}}function sr(t){0>Il||(t.current=Km[Il],Km[Il]=null,Il--)}function Jt(t,i){Il++,Km[Il]=t.current,t.current=i}var jo={},kn=Go(jo),Jn=Go(!1),Ea=jo;function Vl(t,i){var l=t.type.contextTypes;if(!l)return jo;var p=t.stateNode;if(p&&p.__reactInternalMemoizedUnmaskedChildContext===i)return p.__reactInternalMemoizedMaskedChildContext;var _={},b;for(b in l)_[b]=i[b];return p&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=i,t.__reactInternalMemoizedMaskedChildContext=_),_}function ei(t){return t=t.childContextTypes,t!=null}function Xd(){sr(Jn),sr(kn)}function Kv(t,i,l){if(kn.current!==jo)throw Error(Fe(168));Jt(kn,i),Jt(Jn,l)}function l1(t,i,l){var p=t.stateNode;if(i=i.childContextTypes,typeof p.getChildContext!="function")return l;p=p.getChildContext();for(var _ in p)if(!(_ in i))throw Error(Fe(108,vS(t)||"Unknown",_));return yr({},l,p)}function Kd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||jo,Ea=kn.current,Jt(kn,t),Jt(Jn,Jn.current),!0}function Yv(t,i,l){var p=t.stateNode;if(!p)throw Error(Fe(169));l?(t=l1(t,i,Ea),p.__reactInternalMemoizedMergedChildContext=t,sr(Jn),sr(kn),Jt(kn,t)):sr(Jn),Jt(Jn,l)}var Zs=null,wp=!1,lm=!1;function u1(t){Zs===null?Zs=[t]:Zs.push(t)}function FT(t){wp=!0,u1(t)}function Wo(){if(!lm&&Zs!==null){lm=!0;var t=0,i=$t;try{var l=Zs;for($t=1;t<l.length;t++){var p=l[t];do p=p(!0);while(p!==null)}Zs=null,wp=!1}catch(_){throw Zs!==null&&(Zs=Zs.slice(t+1)),Lx(Ng,Wo),_}finally{$t=i,lm=!1}}return null}var Cl=[],Pl=0,Yd=null,Qd=0,Pi=[],zi=0,Ia=null,Gs=1,Ws="";function ya(t,i){Cl[Pl++]=Qd,Cl[Pl++]=Yd,Yd=t,Qd=i}function c1(t,i,l){Pi[zi++]=Gs,Pi[zi++]=Ws,Pi[zi++]=Ia,Ia=t;var p=Gs;t=Ws;var _=32-es(p)-1;p&=~(1<<_),l+=1;var b=32-es(i)+_;if(30<b){var I=_-_%5;b=(p&(1<<I)-1).toString(32),p>>=I,_-=I,Gs=1<<32-es(i)+_|l<<_|p,Ws=b+t}else Gs=1<<b|l<<_|p,Ws=t}function Hg(t){t.return!==null&&(ya(t,1),c1(t,1,0))}function Xg(t){for(;t===Yd;)Yd=Cl[--Pl],Cl[Pl]=null,Qd=Cl[--Pl],Cl[Pl]=null;for(;t===Ia;)Ia=Pi[--zi],Pi[zi]=null,Ws=Pi[--zi],Pi[zi]=null,Gs=Pi[--zi],Pi[zi]=null}var di=null,ci=null,cr=!1,Qi=null;function h1(t,i){var l=Mi(5,null,null,0);l.elementType="DELETED",l.stateNode=i,l.return=t,i=t.deletions,i===null?(t.deletions=[l],t.flags|=16):i.push(l)}function Qv(t,i){switch(t.tag){case 5:var l=t.type;return i=i.nodeType!==1||l.toLowerCase()!==i.nodeName.toLowerCase()?null:i,i!==null?(t.stateNode=i,di=t,ci=Ro(i.firstChild),!0):!1;case 6:return i=t.pendingProps===""||i.nodeType!==3?null:i,i!==null?(t.stateNode=i,di=t,ci=null,!0):!1;case 13:return i=i.nodeType!==8?null:i,i!==null?(l=Ia!==null?{id:Gs,overflow:Ws}:null,t.memoizedState={dehydrated:i,treeContext:l,retryLane:1073741824},l=Mi(18,null,null,0),l.stateNode=i,l.return=t,t.child=l,di=t,ci=null,!0):!1;default:return!1}}function Ym(t){return(t.mode&1)!==0&&(t.flags&128)===0}function Qm(t){if(cr){var i=ci;if(i){var l=i;if(!Qv(t,i)){if(Ym(t))throw Error(Fe(418));i=Ro(l.nextSibling);var p=di;i&&Qv(t,i)?h1(p,l):(t.flags=t.flags&-4097|2,cr=!1,di=t)}}else{if(Ym(t))throw Error(Fe(418));t.flags=t.flags&-4097|2,cr=!1,di=t}}}function Jv(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;di=t}function fd(t){if(t!==di)return!1;if(!cr)return Jv(t),cr=!0,!1;var i;if((i=t.tag!==3)&&!(i=t.tag!==5)&&(i=t.type,i=i!=="head"&&i!=="body"&&!Wm(t.type,t.memoizedProps)),i&&(i=ci)){if(Ym(t))throw d1(),Error(Fe(418));for(;i;)h1(t,i),i=Ro(i.nextSibling)}if(Jv(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(Fe(317));e:{for(t=t.nextSibling,i=0;t;){if(t.nodeType===8){var l=t.data;if(l==="/$"){if(i===0){ci=Ro(t.nextSibling);break e}i--}else l!=="$"&&l!=="$!"&&l!=="$?"||i++}t=t.nextSibling}ci=null}}else ci=di?Ro(t.stateNode.nextSibling):null;return!0}function d1(){for(var t=ci;t;)t=Ro(t.nextSibling)}function Ul(){ci=di=null,cr=!1}function Kg(t){Qi===null?Qi=[t]:Qi.push(t)}var BT=eo.ReactCurrentBatchConfig;function Ki(t,i){if(t&&t.defaultProps){i=yr({},i),t=t.defaultProps;for(var l in t)i[l]===void 0&&(i[l]=t[l]);return i}return i}var Jd=Go(null),ep=null,zl=null,Yg=null;function Qg(){Yg=zl=ep=null}function Jg(t){var i=Jd.current;sr(Jd),t._currentValue=i}function Jm(t,i,l){for(;t!==null;){var p=t.alternate;if((t.childLanes&i)!==i?(t.childLanes|=i,p!==null&&(p.childLanes|=i)):p!==null&&(p.childLanes&i)!==i&&(p.childLanes|=i),t===l)break;t=t.return}}function Bl(t,i){ep=t,Yg=zl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&i&&(Qn=!0),t.firstContext=null)}function Di(t){var i=t._currentValue;if(Yg!==t)if(t={context:t,memoizedValue:i,next:null},zl===null){if(ep===null)throw Error(Fe(308));zl=t,ep.dependencies={lanes:0,firstContext:t}}else zl=zl.next=t;return i}var wa=null;function ey(t){wa===null?wa=[t]:wa.push(t)}function p1(t,i,l,p){var _=i.interleaved;return _===null?(l.next=l,ey(i)):(l.next=_.next,_.next=l),i.interleaved=l,Ys(t,p)}function Ys(t,i){t.lanes|=i;var l=t.alternate;for(l!==null&&(l.lanes|=i),l=t,t=t.return;t!==null;)t.childLanes|=i,l=t.alternate,l!==null&&(l.childLanes|=i),l=t,t=t.return;return l.tag===3?l.stateNode:null}var Io=!1;function ty(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function f1(t,i){t=t.updateQueue,i.updateQueue===t&&(i.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Hs(t,i){return{eventTime:t,lane:i,tag:0,payload:null,callback:null,next:null}}function Fo(t,i,l){var p=t.updateQueue;if(p===null)return null;if(p=p.shared,Dt&2){var _=p.pending;return _===null?i.next=i:(i.next=_.next,_.next=i),p.pending=i,Ys(t,l)}return _=p.interleaved,_===null?(i.next=i,ey(p)):(i.next=_.next,_.next=i),p.interleaved=i,Ys(t,l)}function Id(t,i,l){if(i=i.updateQueue,i!==null&&(i=i.shared,(l&4194240)!==0)){var p=i.lanes;p&=t.pendingLanes,l|=p,i.lanes=l,Vg(t,l)}}function e0(t,i){var l=t.updateQueue,p=t.alternate;if(p!==null&&(p=p.updateQueue,l===p)){var _=null,b=null;if(l=l.firstBaseUpdate,l!==null){do{var I={eventTime:l.eventTime,lane:l.lane,tag:l.tag,payload:l.payload,callback:l.callback,next:null};b===null?_=b=I:b=b.next=I,l=l.next}while(l!==null);b===null?_=b=i:b=b.next=i}else _=b=i;l={baseState:p.baseState,firstBaseUpdate:_,lastBaseUpdate:b,shared:p.shared,effects:p.effects},t.updateQueue=l;return}t=l.lastBaseUpdate,t===null?l.firstBaseUpdate=i:t.next=i,l.lastBaseUpdate=i}function tp(t,i,l,p){var _=t.updateQueue;Io=!1;var b=_.firstBaseUpdate,I=_.lastBaseUpdate,u=_.shared.pending;if(u!==null){_.shared.pending=null;var B=u,D=B.next;B.next=null,I===null?b=D:I.next=D,I=B;var ne=t.alternate;ne!==null&&(ne=ne.updateQueue,u=ne.lastBaseUpdate,u!==I&&(u===null?ne.firstBaseUpdate=D:u.next=D,ne.lastBaseUpdate=B))}if(b!==null){var re=_.baseState;I=0,ne=D=B=null,u=b;do{var te=u.lane,_e=u.eventTime;if((p&te)===te){ne!==null&&(ne=ne.next={eventTime:_e,lane:0,tag:u.tag,payload:u.payload,callback:u.callback,next:null});e:{var be=t,ke=u;switch(te=i,_e=l,ke.tag){case 1:if(be=ke.payload,typeof be=="function"){re=be.call(_e,re,te);break e}re=be;break e;case 3:be.flags=be.flags&-65537|128;case 0:if(be=ke.payload,te=typeof be=="function"?be.call(_e,re,te):be,te==null)break e;re=yr({},re,te);break e;case 2:Io=!0}}u.callback!==null&&u.lane!==0&&(t.flags|=64,te=_.effects,te===null?_.effects=[u]:te.push(u))}else _e={eventTime:_e,lane:te,tag:u.tag,payload:u.payload,callback:u.callback,next:null},ne===null?(D=ne=_e,B=re):ne=ne.next=_e,I|=te;if(u=u.next,u===null){if(u=_.shared.pending,u===null)break;te=u,u=te.next,te.next=null,_.lastBaseUpdate=te,_.shared.pending=null}}while(1);if(ne===null&&(B=re),_.baseState=B,_.firstBaseUpdate=D,_.lastBaseUpdate=ne,i=_.shared.interleaved,i!==null){_=i;do I|=_.lane,_=_.next;while(_!==i)}else b===null&&(_.shared.lanes=0);Pa|=I,t.lanes=I,t.memoizedState=re}}function t0(t,i,l){if(t=i.effects,i.effects=null,t!==null)for(i=0;i<t.length;i++){var p=t[i],_=p.callback;if(_!==null){if(p.callback=null,p=l,typeof _!="function")throw Error(Fe(191,_));_.call(p)}}}var m1=new px.Component().refs;function eg(t,i,l,p){i=t.memoizedState,l=l(p,i),l=l==null?i:yr({},i,l),t.memoizedState=l,t.lanes===0&&(t.updateQueue.baseState=l)}var bp={isMounted:function(t){return(t=t._reactInternals)?Da(t)===t:!1},enqueueSetState:function(t,i,l){t=t._reactInternals;var p=On(),_=Oo(t),b=Hs(p,_);b.payload=i,l!=null&&(b.callback=l),i=Fo(t,b,_),i!==null&&(ts(i,t,_,p),Id(i,t,_))},enqueueReplaceState:function(t,i,l){t=t._reactInternals;var p=On(),_=Oo(t),b=Hs(p,_);b.tag=1,b.payload=i,l!=null&&(b.callback=l),i=Fo(t,b,_),i!==null&&(ts(i,t,_,p),Id(i,t,_))},enqueueForceUpdate:function(t,i){t=t._reactInternals;var l=On(),p=Oo(t),_=Hs(l,p);_.tag=2,i!=null&&(_.callback=i),i=Fo(t,_,p),i!==null&&(ts(i,t,p,l),Id(i,t,p))}};function r0(t,i,l,p,_,b,I){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(p,b,I):i.prototype&&i.prototype.isPureReactComponent?!Mc(l,p)||!Mc(_,b):!0}function g1(t,i,l){var p=!1,_=jo,b=i.contextType;return typeof b=="object"&&b!==null?b=Di(b):(_=ei(i)?Ea:kn.current,p=i.contextTypes,b=(p=p!=null)?Vl(t,_):jo),i=new i(l,b),t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=bp,t.stateNode=i,i._reactInternals=t,p&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=_,t.__reactInternalMemoizedMaskedChildContext=b),i}function n0(t,i,l,p){t=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(l,p),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(l,p),i.state!==t&&bp.enqueueReplaceState(i,i.state,null)}function tg(t,i,l,p){var _=t.stateNode;_.props=l,_.state=t.memoizedState,_.refs=m1,ty(t);var b=i.contextType;typeof b=="object"&&b!==null?_.context=Di(b):(b=ei(i)?Ea:kn.current,_.context=Vl(t,b)),_.state=t.memoizedState,b=i.getDerivedStateFromProps,typeof b=="function"&&(eg(t,i,b,l),_.state=t.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof _.getSnapshotBeforeUpdate=="function"||typeof _.UNSAFE_componentWillMount!="function"&&typeof _.componentWillMount!="function"||(i=_.state,typeof _.componentWillMount=="function"&&_.componentWillMount(),typeof _.UNSAFE_componentWillMount=="function"&&_.UNSAFE_componentWillMount(),i!==_.state&&bp.enqueueReplaceState(_,_.state,null),tp(t,l,_,p),_.state=t.memoizedState),typeof _.componentDidMount=="function"&&(t.flags|=4194308)}function ac(t,i,l){if(t=l.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(l._owner){if(l=l._owner,l){if(l.tag!==1)throw Error(Fe(309));var p=l.stateNode}if(!p)throw Error(Fe(147,t));var _=p,b=""+t;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===b?i.ref:(i=function(I){var u=_.refs;u===m1&&(u=_.refs={}),I===null?delete u[b]:u[b]=I},i._stringRef=b,i)}if(typeof t!="string")throw Error(Fe(284));if(!l._owner)throw Error(Fe(290,t))}return t}function md(t,i){throw t=Object.prototype.toString.call(i),Error(Fe(31,t==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":t))}function i0(t){var i=t._init;return i(t._payload)}function y1(t){function i(K,ee){if(t){var ce=K.deletions;ce===null?(K.deletions=[ee],K.flags|=16):ce.push(ee)}}function l(K,ee){if(!t)return null;for(;ee!==null;)i(K,ee),ee=ee.sibling;return null}function p(K,ee){for(K=new Map;ee!==null;)ee.key!==null?K.set(ee.key,ee):K.set(ee.index,ee),ee=ee.sibling;return K}function _(K,ee){return K=No(K,ee),K.index=0,K.sibling=null,K}function b(K,ee,ce){return K.index=ce,t?(ce=K.alternate,ce!==null?(ce=ce.index,ce<ee?(K.flags|=2,ee):ce):(K.flags|=2,ee)):(K.flags|=1048576,ee)}function I(K){return t&&K.alternate===null&&(K.flags|=2),K}function u(K,ee,ce,ye){return ee===null||ee.tag!==6?(ee=mm(ce,K.mode,ye),ee.return=K,ee):(ee=_(ee,ce),ee.return=K,ee)}function B(K,ee,ce,ye){var Pe=ce.type;return Pe===bl?ne(K,ee,ce.props.children,ye,ce.key):ee!==null&&(ee.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===Eo&&i0(Pe)===ee.type)?(ye=_(ee,ce.props),ye.ref=ac(K,ee,ce),ye.return=K,ye):(ye=Dd(ce.type,ce.key,ce.props,null,K.mode,ye),ye.ref=ac(K,ee,ce),ye.return=K,ye)}function D(K,ee,ce,ye){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==ce.containerInfo||ee.stateNode.implementation!==ce.implementation?(ee=gm(ce,K.mode,ye),ee.return=K,ee):(ee=_(ee,ce.children||[]),ee.return=K,ee)}function ne(K,ee,ce,ye,Pe){return ee===null||ee.tag!==7?(ee=ka(ce,K.mode,ye,Pe),ee.return=K,ee):(ee=_(ee,ce),ee.return=K,ee)}function re(K,ee,ce){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return ee=mm(""+ee,K.mode,ce),ee.return=K,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case id:return ce=Dd(ee.type,ee.key,ee.props,null,K.mode,ce),ce.ref=ac(K,null,ee),ce.return=K,ce;case wl:return ee=gm(ee,K.mode,ce),ee.return=K,ee;case Eo:var ye=ee._init;return re(K,ye(ee._payload),ce)}if(hc(ee)||rc(ee))return ee=ka(ee,K.mode,ce,null),ee.return=K,ee;md(K,ee)}return null}function te(K,ee,ce,ye){var Pe=ee!==null?ee.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number")return Pe!==null?null:u(K,ee,""+ce,ye);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case id:return ce.key===Pe?B(K,ee,ce,ye):null;case wl:return ce.key===Pe?D(K,ee,ce,ye):null;case Eo:return Pe=ce._init,te(K,ee,Pe(ce._payload),ye)}if(hc(ce)||rc(ce))return Pe!==null?null:ne(K,ee,ce,ye,null);md(K,ce)}return null}function _e(K,ee,ce,ye,Pe){if(typeof ye=="string"&&ye!==""||typeof ye=="number")return K=K.get(ce)||null,u(ee,K,""+ye,Pe);if(typeof ye=="object"&&ye!==null){switch(ye.$$typeof){case id:return K=K.get(ye.key===null?ce:ye.key)||null,B(ee,K,ye,Pe);case wl:return K=K.get(ye.key===null?ce:ye.key)||null,D(ee,K,ye,Pe);case Eo:var Le=ye._init;return _e(K,ee,ce,Le(ye._payload),Pe)}if(hc(ye)||rc(ye))return K=K.get(ce)||null,ne(ee,K,ye,Pe,null);md(ee,ye)}return null}function be(K,ee,ce,ye){for(var Pe=null,Le=null,je=ee,Ze=ee=0,kt=null;je!==null&&Ze<ce.length;Ze++){je.index>Ze?(kt=je,je=null):kt=je.sibling;var rt=te(K,je,ce[Ze],ye);if(rt===null){je===null&&(je=kt);break}t&&je&&rt.alternate===null&&i(K,je),ee=b(rt,ee,Ze),Le===null?Pe=rt:Le.sibling=rt,Le=rt,je=kt}if(Ze===ce.length)return l(K,je),cr&&ya(K,Ze),Pe;if(je===null){for(;Ze<ce.length;Ze++)je=re(K,ce[Ze],ye),je!==null&&(ee=b(je,ee,Ze),Le===null?Pe=je:Le.sibling=je,Le=je);return cr&&ya(K,Ze),Pe}for(je=p(K,je);Ze<ce.length;Ze++)kt=_e(je,K,Ze,ce[Ze],ye),kt!==null&&(t&&kt.alternate!==null&&je.delete(kt.key===null?Ze:kt.key),ee=b(kt,ee,Ze),Le===null?Pe=kt:Le.sibling=kt,Le=kt);return t&&je.forEach(function(Mr){return i(K,Mr)}),cr&&ya(K,Ze),Pe}function ke(K,ee,ce,ye){var Pe=rc(ce);if(typeof Pe!="function")throw Error(Fe(150));if(ce=Pe.call(ce),ce==null)throw Error(Fe(151));for(var Le=Pe=null,je=ee,Ze=ee=0,kt=null,rt=ce.next();je!==null&&!rt.done;Ze++,rt=ce.next()){je.index>Ze?(kt=je,je=null):kt=je.sibling;var Mr=te(K,je,rt.value,ye);if(Mr===null){je===null&&(je=kt);break}t&&je&&Mr.alternate===null&&i(K,je),ee=b(Mr,ee,Ze),Le===null?Pe=Mr:Le.sibling=Mr,Le=Mr,je=kt}if(rt.done)return l(K,je),cr&&ya(K,Ze),Pe;if(je===null){for(;!rt.done;Ze++,rt=ce.next())rt=re(K,rt.value,ye),rt!==null&&(ee=b(rt,ee,Ze),Le===null?Pe=rt:Le.sibling=rt,Le=rt);return cr&&ya(K,Ze),Pe}for(je=p(K,je);!rt.done;Ze++,rt=ce.next())rt=_e(je,K,Ze,rt.value,ye),rt!==null&&(t&&rt.alternate!==null&&je.delete(rt.key===null?Ze:rt.key),ee=b(rt,ee,Ze),Le===null?Pe=rt:Le.sibling=rt,Le=rt);return t&&je.forEach(function(Lr){return i(K,Lr)}),cr&&ya(K,Ze),Pe}function we(K,ee,ce,ye){if(typeof ce=="object"&&ce!==null&&ce.type===bl&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case id:e:{for(var Pe=ce.key,Le=ee;Le!==null;){if(Le.key===Pe){if(Pe=ce.type,Pe===bl){if(Le.tag===7){l(K,Le.sibling),ee=_(Le,ce.props.children),ee.return=K,K=ee;break e}}else if(Le.elementType===Pe||typeof Pe=="object"&&Pe!==null&&Pe.$$typeof===Eo&&i0(Pe)===Le.type){l(K,Le.sibling),ee=_(Le,ce.props),ee.ref=ac(K,Le,ce),ee.return=K,K=ee;break e}l(K,Le);break}else i(K,Le);Le=Le.sibling}ce.type===bl?(ee=ka(ce.props.children,K.mode,ye,ce.key),ee.return=K,K=ee):(ye=Dd(ce.type,ce.key,ce.props,null,K.mode,ye),ye.ref=ac(K,ee,ce),ye.return=K,K=ye)}return I(K);case wl:e:{for(Le=ce.key;ee!==null;){if(ee.key===Le)if(ee.tag===4&&ee.stateNode.containerInfo===ce.containerInfo&&ee.stateNode.implementation===ce.implementation){l(K,ee.sibling),ee=_(ee,ce.children||[]),ee.return=K,K=ee;break e}else{l(K,ee);break}else i(K,ee);ee=ee.sibling}ee=gm(ce,K.mode,ye),ee.return=K,K=ee}return I(K);case Eo:return Le=ce._init,we(K,ee,Le(ce._payload),ye)}if(hc(ce))return be(K,ee,ce,ye);if(rc(ce))return ke(K,ee,ce,ye);md(K,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"?(ce=""+ce,ee!==null&&ee.tag===6?(l(K,ee.sibling),ee=_(ee,ce),ee.return=K,K=ee):(l(K,ee),ee=mm(ce,K.mode,ye),ee.return=K,K=ee),I(K)):l(K,ee)}return we}var jl=y1(!0),_1=y1(!1),Hc={},bs=Go(Hc),Rc=Go(Hc),Fc=Go(Hc);function ba(t){if(t===Hc)throw Error(Fe(174));return t}function ry(t,i){switch(Jt(Fc,i),Jt(Rc,t),Jt(bs,Hc),t=i.nodeType,t){case 9:case 11:i=(i=i.documentElement)?i.namespaceURI:Dm(null,"");break;default:t=t===8?i.parentNode:i,i=t.namespaceURI||null,t=t.tagName,i=Dm(i,t)}sr(bs),Jt(bs,i)}function $l(){sr(bs),sr(Rc),sr(Fc)}function v1(t){ba(Fc.current);var i=ba(bs.current),l=Dm(i,t.type);i!==l&&(Jt(Rc,t),Jt(bs,l))}function ny(t){Rc.current===t&&(sr(bs),sr(Rc))}var mr=Go(0);function rp(t){for(var i=t;i!==null;){if(i.tag===13){var l=i.memoizedState;if(l!==null&&(l=l.dehydrated,l===null||l.data==="$?"||l.data==="$!"))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var um=[];function iy(){for(var t=0;t<um.length;t++)um[t]._workInProgressVersionPrimary=null;um.length=0}var Cd=eo.ReactCurrentDispatcher,cm=eo.ReactCurrentBatchConfig,Ca=0,gr=null,Vr=null,Kr=null,np=!1,xc=!1,Bc=0,OT=0;function bn(){throw Error(Fe(321))}function sy(t,i){if(i===null)return!1;for(var l=0;l<i.length&&l<t.length;l++)if(!ns(t[l],i[l]))return!1;return!0}function oy(t,i,l,p,_,b){if(Ca=b,gr=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,Cd.current=t===null||t.memoizedState===null?jT:$T,t=l(p,_),xc){b=0;do{if(xc=!1,Bc=0,25<=b)throw Error(Fe(301));b+=1,Kr=Vr=null,i.updateQueue=null,Cd.current=qT,t=l(p,_)}while(xc)}if(Cd.current=ip,i=Vr!==null&&Vr.next!==null,Ca=0,Kr=Vr=gr=null,np=!1,i)throw Error(Fe(300));return t}function ay(){var t=Bc!==0;return Bc=0,t}function vs(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kr===null?gr.memoizedState=Kr=t:Kr=Kr.next=t,Kr}function Li(){if(Vr===null){var t=gr.alternate;t=t!==null?t.memoizedState:null}else t=Vr.next;var i=Kr===null?gr.memoizedState:Kr.next;if(i!==null)Kr=i,Vr=t;else{if(t===null)throw Error(Fe(310));Vr=t,t={memoizedState:Vr.memoizedState,baseState:Vr.baseState,baseQueue:Vr.baseQueue,queue:Vr.queue,next:null},Kr===null?gr.memoizedState=Kr=t:Kr=Kr.next=t}return Kr}function Oc(t,i){return typeof i=="function"?i(t):i}function hm(t){var i=Li(),l=i.queue;if(l===null)throw Error(Fe(311));l.lastRenderedReducer=t;var p=Vr,_=p.baseQueue,b=l.pending;if(b!==null){if(_!==null){var I=_.next;_.next=b.next,b.next=I}p.baseQueue=_=b,l.pending=null}if(_!==null){b=_.next,p=p.baseState;var u=I=null,B=null,D=b;do{var ne=D.lane;if((Ca&ne)===ne)B!==null&&(B=B.next={lane:0,action:D.action,hasEagerState:D.hasEagerState,eagerState:D.eagerState,next:null}),p=D.hasEagerState?D.eagerState:t(p,D.action);else{var re={lane:ne,action:D.action,hasEagerState:D.hasEagerState,eagerState:D.eagerState,next:null};B===null?(u=B=re,I=p):B=B.next=re,gr.lanes|=ne,Pa|=ne}D=D.next}while(D!==null&&D!==b);B===null?I=p:B.next=u,ns(p,i.memoizedState)||(Qn=!0),i.memoizedState=p,i.baseState=I,i.baseQueue=B,l.lastRenderedState=p}if(t=l.interleaved,t!==null){_=t;do b=_.lane,gr.lanes|=b,Pa|=b,_=_.next;while(_!==t)}else _===null&&(l.lanes=0);return[i.memoizedState,l.dispatch]}function dm(t){var i=Li(),l=i.queue;if(l===null)throw Error(Fe(311));l.lastRenderedReducer=t;var p=l.dispatch,_=l.pending,b=i.memoizedState;if(_!==null){l.pending=null;var I=_=_.next;do b=t(b,I.action),I=I.next;while(I!==_);ns(b,i.memoizedState)||(Qn=!0),i.memoizedState=b,i.baseQueue===null&&(i.baseState=b),l.lastRenderedState=b}return[b,p]}function x1(){}function w1(t,i){var l=gr,p=Li(),_=i(),b=!ns(p.memoizedState,_);if(b&&(p.memoizedState=_,Qn=!0),p=p.queue,ly(T1.bind(null,l,p,t),[t]),p.getSnapshot!==i||b||Kr!==null&&Kr.memoizedState.tag&1){if(l.flags|=2048,Nc(9,S1.bind(null,l,p,_,i),void 0,null),Yr===null)throw Error(Fe(349));Ca&30||b1(l,i,_)}return _}function b1(t,i,l){t.flags|=16384,t={getSnapshot:i,value:l},i=gr.updateQueue,i===null?(i={lastEffect:null,stores:null},gr.updateQueue=i,i.stores=[t]):(l=i.stores,l===null?i.stores=[t]:l.push(t))}function S1(t,i,l,p){i.value=l,i.getSnapshot=p,k1(i)&&E1(t)}function T1(t,i,l){return l(function(){k1(i)&&E1(t)})}function k1(t){var i=t.getSnapshot;t=t.value;try{var l=i();return!ns(t,l)}catch{return!0}}function E1(t){var i=Ys(t,1);i!==null&&ts(i,t,1,-1)}function s0(t){var i=vs();return typeof t=="function"&&(t=t()),i.memoizedState=i.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Oc,lastRenderedState:t},i.queue=t,t=t.dispatch=UT.bind(null,gr,t),[i.memoizedState,t]}function Nc(t,i,l,p){return t={tag:t,create:i,destroy:l,deps:p,next:null},i=gr.updateQueue,i===null?(i={lastEffect:null,stores:null},gr.updateQueue=i,i.lastEffect=t.next=t):(l=i.lastEffect,l===null?i.lastEffect=t.next=t:(p=l.next,l.next=t,t.next=p,i.lastEffect=t)),t}function I1(){return Li().memoizedState}function Pd(t,i,l,p){var _=vs();gr.flags|=t,_.memoizedState=Nc(1|i,l,void 0,p===void 0?null:p)}function Sp(t,i,l,p){var _=Li();p=p===void 0?null:p;var b=void 0;if(Vr!==null){var I=Vr.memoizedState;if(b=I.destroy,p!==null&&sy(p,I.deps)){_.memoizedState=Nc(i,l,b,p);return}}gr.flags|=t,_.memoizedState=Nc(1|i,l,b,p)}function o0(t,i){return Pd(8390656,8,t,i)}function ly(t,i){return Sp(2048,8,t,i)}function C1(t,i){return Sp(4,2,t,i)}function P1(t,i){return Sp(4,4,t,i)}function z1(t,i){if(typeof i=="function")return t=t(),i(t),function(){i(null)};if(i!=null)return t=t(),i.current=t,function(){i.current=null}}function M1(t,i,l){return l=l!=null?l.concat([t]):null,Sp(4,4,z1.bind(null,i,t),l)}function uy(){}function A1(t,i){var l=Li();i=i===void 0?null:i;var p=l.memoizedState;return p!==null&&i!==null&&sy(i,p[1])?p[0]:(l.memoizedState=[t,i],t)}function D1(t,i){var l=Li();i=i===void 0?null:i;var p=l.memoizedState;return p!==null&&i!==null&&sy(i,p[1])?p[0]:(t=t(),l.memoizedState=[t,i],t)}function L1(t,i,l){return Ca&21?(ns(l,i)||(l=Bx(),gr.lanes|=l,Pa|=l,t.baseState=!0),i):(t.baseState&&(t.baseState=!1,Qn=!0),t.memoizedState=l)}function NT(t,i){var l=$t;$t=l!==0&&4>l?l:4,t(!0);var p=cm.transition;cm.transition={};try{t(!1),i()}finally{$t=l,cm.transition=p}}function R1(){return Li().memoizedState}function VT(t,i,l){var p=Oo(t);if(l={lane:p,action:l,hasEagerState:!1,eagerState:null,next:null},F1(t))B1(i,l);else if(l=p1(t,i,l,p),l!==null){var _=On();ts(l,t,p,_),O1(l,i,p)}}function UT(t,i,l){var p=Oo(t),_={lane:p,action:l,hasEagerState:!1,eagerState:null,next:null};if(F1(t))B1(i,_);else{var b=t.alternate;if(t.lanes===0&&(b===null||b.lanes===0)&&(b=i.lastRenderedReducer,b!==null))try{var I=i.lastRenderedState,u=b(I,l);if(_.hasEagerState=!0,_.eagerState=u,ns(u,I)){var B=i.interleaved;B===null?(_.next=_,ey(i)):(_.next=B.next,B.next=_),i.interleaved=_;return}}catch{}finally{}l=p1(t,i,_,p),l!==null&&(_=On(),ts(l,t,p,_),O1(l,i,p))}}function F1(t){var i=t.alternate;return t===gr||i!==null&&i===gr}function B1(t,i){xc=np=!0;var l=t.pending;l===null?i.next=i:(i.next=l.next,l.next=i),t.pending=i}function O1(t,i,l){if(l&4194240){var p=i.lanes;p&=t.pendingLanes,l|=p,i.lanes=l,Vg(t,l)}}var ip={readContext:Di,useCallback:bn,useContext:bn,useEffect:bn,useImperativeHandle:bn,useInsertionEffect:bn,useLayoutEffect:bn,useMemo:bn,useReducer:bn,useRef:bn,useState:bn,useDebugValue:bn,useDeferredValue:bn,useTransition:bn,useMutableSource:bn,useSyncExternalStore:bn,useId:bn,unstable_isNewReconciler:!1},jT={readContext:Di,useCallback:function(t,i){return vs().memoizedState=[t,i===void 0?null:i],t},useContext:Di,useEffect:o0,useImperativeHandle:function(t,i,l){return l=l!=null?l.concat([t]):null,Pd(4194308,4,z1.bind(null,i,t),l)},useLayoutEffect:function(t,i){return Pd(4194308,4,t,i)},useInsertionEffect:function(t,i){return Pd(4,2,t,i)},useMemo:function(t,i){var l=vs();return i=i===void 0?null:i,t=t(),l.memoizedState=[t,i],t},useReducer:function(t,i,l){var p=vs();return i=l!==void 0?l(i):i,p.memoizedState=p.baseState=i,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:i},p.queue=t,t=t.dispatch=VT.bind(null,gr,t),[p.memoizedState,t]},useRef:function(t){var i=vs();return t={current:t},i.memoizedState=t},useState:s0,useDebugValue:uy,useDeferredValue:function(t){return vs().memoizedState=t},useTransition:function(){var t=s0(!1),i=t[0];return t=NT.bind(null,t[1]),vs().memoizedState=t,[i,t]},useMutableSource:function(){},useSyncExternalStore:function(t,i,l){var p=gr,_=vs();if(cr){if(l===void 0)throw Error(Fe(407));l=l()}else{if(l=i(),Yr===null)throw Error(Fe(349));Ca&30||b1(p,i,l)}_.memoizedState=l;var b={value:l,getSnapshot:i};return _.queue=b,o0(T1.bind(null,p,b,t),[t]),p.flags|=2048,Nc(9,S1.bind(null,p,b,l,i),void 0,null),l},useId:function(){var t=vs(),i=Yr.identifierPrefix;if(cr){var l=Ws,p=Gs;l=(p&~(1<<32-es(p)-1)).toString(32)+l,i=":"+i+"R"+l,l=Bc++,0<l&&(i+="H"+l.toString(32)),i+=":"}else l=OT++,i=":"+i+"r"+l.toString(32)+":";return t.memoizedState=i},unstable_isNewReconciler:!1},$T={readContext:Di,useCallback:A1,useContext:Di,useEffect:ly,useImperativeHandle:M1,useInsertionEffect:C1,useLayoutEffect:P1,useMemo:D1,useReducer:hm,useRef:I1,useState:function(){return hm(Oc)},useDebugValue:uy,useDeferredValue:function(t){var i=Li();return L1(i,Vr.memoizedState,t)},useTransition:function(){var t=hm(Oc)[0],i=Li().memoizedState;return[t,i]},useMutableSource:x1,useSyncExternalStore:w1,useId:R1,unstable_isNewReconciler:!1},qT={readContext:Di,useCallback:A1,useContext:Di,useEffect:ly,useImperativeHandle:M1,useInsertionEffect:C1,useLayoutEffect:P1,useMemo:D1,useReducer:dm,useRef:I1,useState:function(){return dm(Oc)},useDebugValue:uy,useDeferredValue:function(t){var i=Li();return Vr===null?i.memoizedState=t:L1(i,Vr.memoizedState,t)},useTransition:function(){var t=dm(Oc)[0],i=Li().memoizedState;return[t,i]},useMutableSource:x1,useSyncExternalStore:w1,useId:R1,unstable_isNewReconciler:!1};function ql(t,i){try{var l="",p=i;do l+=_S(p),p=p.return;while(p);var _=l}catch(b){_=`
Error generating stack: `+b.message+`
`+b.stack}return{value:t,source:i,stack:_,digest:null}}function pm(t,i,l){return{value:t,source:null,stack:l??null,digest:i??null}}function rg(t,i){try{console.error(i.value)}catch(l){setTimeout(function(){throw l})}}var ZT=typeof WeakMap=="function"?WeakMap:Map;function N1(t,i,l){l=Hs(-1,l),l.tag=3,l.payload={element:null};var p=i.value;return l.callback=function(){op||(op=!0,dg=p),rg(t,i)},l}function V1(t,i,l){l=Hs(-1,l),l.tag=3;var p=t.type.getDerivedStateFromError;if(typeof p=="function"){var _=i.value;l.payload=function(){return p(_)},l.callback=function(){rg(t,i)}}var b=t.stateNode;return b!==null&&typeof b.componentDidCatch=="function"&&(l.callback=function(){rg(t,i),typeof p!="function"&&(Bo===null?Bo=new Set([this]):Bo.add(this));var I=i.stack;this.componentDidCatch(i.value,{componentStack:I!==null?I:""})}),l}function a0(t,i,l){var p=t.pingCache;if(p===null){p=t.pingCache=new ZT;var _=new Set;p.set(i,_)}else _=p.get(i),_===void 0&&(_=new Set,p.set(i,_));_.has(l)||(_.add(l),t=sk.bind(null,t,i,l),i.then(t,t))}function l0(t){do{var i;if((i=t.tag===13)&&(i=t.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return t;t=t.return}while(t!==null);return null}function u0(t,i,l,p,_){return t.mode&1?(t.flags|=65536,t.lanes=_,t):(t===i?t.flags|=65536:(t.flags|=128,l.flags|=131072,l.flags&=-52805,l.tag===1&&(l.alternate===null?l.tag=17:(i=Hs(-1,1),i.tag=2,Fo(l,i,1))),l.lanes|=1),t)}var GT=eo.ReactCurrentOwner,Qn=!1;function Bn(t,i,l,p){i.child=t===null?_1(i,null,l,p):jl(i,t.child,l,p)}function c0(t,i,l,p,_){l=l.render;var b=i.ref;return Bl(i,_),p=oy(t,i,l,p,b,_),l=ay(),t!==null&&!Qn?(i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~_,Qs(t,i,_)):(cr&&l&&Hg(i),i.flags|=1,Bn(t,i,p,_),i.child)}function h0(t,i,l,p,_){if(t===null){var b=l.type;return typeof b=="function"&&!yy(b)&&b.defaultProps===void 0&&l.compare===null&&l.defaultProps===void 0?(i.tag=15,i.type=b,U1(t,i,b,p,_)):(t=Dd(l.type,null,p,i,i.mode,_),t.ref=i.ref,t.return=i,i.child=t)}if(b=t.child,!(t.lanes&_)){var I=b.memoizedProps;if(l=l.compare,l=l!==null?l:Mc,l(I,p)&&t.ref===i.ref)return Qs(t,i,_)}return i.flags|=1,t=No(b,p),t.ref=i.ref,t.return=i,i.child=t}function U1(t,i,l,p,_){if(t!==null){var b=t.memoizedProps;if(Mc(b,p)&&t.ref===i.ref)if(Qn=!1,i.pendingProps=p=b,(t.lanes&_)!==0)t.flags&131072&&(Qn=!0);else return i.lanes=t.lanes,Qs(t,i,_)}return ng(t,i,l,p,_)}function j1(t,i,l){var p=i.pendingProps,_=p.children,b=t!==null?t.memoizedState:null;if(p.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Jt(Al,ui),ui|=l;else{if(!(l&1073741824))return t=b!==null?b.baseLanes|l:l,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:t,cachePool:null,transitions:null},i.updateQueue=null,Jt(Al,ui),ui|=t,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},p=b!==null?b.baseLanes:l,Jt(Al,ui),ui|=p}else b!==null?(p=b.baseLanes|l,i.memoizedState=null):p=l,Jt(Al,ui),ui|=p;return Bn(t,i,_,l),i.child}function $1(t,i){var l=i.ref;(t===null&&l!==null||t!==null&&t.ref!==l)&&(i.flags|=512,i.flags|=2097152)}function ng(t,i,l,p,_){var b=ei(l)?Ea:kn.current;return b=Vl(i,b),Bl(i,_),l=oy(t,i,l,p,b,_),p=ay(),t!==null&&!Qn?(i.updateQueue=t.updateQueue,i.flags&=-2053,t.lanes&=~_,Qs(t,i,_)):(cr&&p&&Hg(i),i.flags|=1,Bn(t,i,l,_),i.child)}function d0(t,i,l,p,_){if(ei(l)){var b=!0;Kd(i)}else b=!1;if(Bl(i,_),i.stateNode===null)zd(t,i),g1(i,l,p),tg(i,l,p,_),p=!0;else if(t===null){var I=i.stateNode,u=i.memoizedProps;I.props=u;var B=I.context,D=l.contextType;typeof D=="object"&&D!==null?D=Di(D):(D=ei(l)?Ea:kn.current,D=Vl(i,D));var ne=l.getDerivedStateFromProps,re=typeof ne=="function"||typeof I.getSnapshotBeforeUpdate=="function";re||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(u!==p||B!==D)&&n0(i,I,p,D),Io=!1;var te=i.memoizedState;I.state=te,tp(i,p,I,_),B=i.memoizedState,u!==p||te!==B||Jn.current||Io?(typeof ne=="function"&&(eg(i,l,ne,p),B=i.memoizedState),(u=Io||r0(i,l,u,p,te,B,D))?(re||typeof I.UNSAFE_componentWillMount!="function"&&typeof I.componentWillMount!="function"||(typeof I.componentWillMount=="function"&&I.componentWillMount(),typeof I.UNSAFE_componentWillMount=="function"&&I.UNSAFE_componentWillMount()),typeof I.componentDidMount=="function"&&(i.flags|=4194308)):(typeof I.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=p,i.memoizedState=B),I.props=p,I.state=B,I.context=D,p=u):(typeof I.componentDidMount=="function"&&(i.flags|=4194308),p=!1)}else{I=i.stateNode,f1(t,i),u=i.memoizedProps,D=i.type===i.elementType?u:Ki(i.type,u),I.props=D,re=i.pendingProps,te=I.context,B=l.contextType,typeof B=="object"&&B!==null?B=Di(B):(B=ei(l)?Ea:kn.current,B=Vl(i,B));var _e=l.getDerivedStateFromProps;(ne=typeof _e=="function"||typeof I.getSnapshotBeforeUpdate=="function")||typeof I.UNSAFE_componentWillReceiveProps!="function"&&typeof I.componentWillReceiveProps!="function"||(u!==re||te!==B)&&n0(i,I,p,B),Io=!1,te=i.memoizedState,I.state=te,tp(i,p,I,_);var be=i.memoizedState;u!==re||te!==be||Jn.current||Io?(typeof _e=="function"&&(eg(i,l,_e,p),be=i.memoizedState),(D=Io||r0(i,l,D,p,te,be,B)||!1)?(ne||typeof I.UNSAFE_componentWillUpdate!="function"&&typeof I.componentWillUpdate!="function"||(typeof I.componentWillUpdate=="function"&&I.componentWillUpdate(p,be,B),typeof I.UNSAFE_componentWillUpdate=="function"&&I.UNSAFE_componentWillUpdate(p,be,B)),typeof I.componentDidUpdate=="function"&&(i.flags|=4),typeof I.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof I.componentDidUpdate!="function"||u===t.memoizedProps&&te===t.memoizedState||(i.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&te===t.memoizedState||(i.flags|=1024),i.memoizedProps=p,i.memoizedState=be),I.props=p,I.state=be,I.context=B,p=D):(typeof I.componentDidUpdate!="function"||u===t.memoizedProps&&te===t.memoizedState||(i.flags|=4),typeof I.getSnapshotBeforeUpdate!="function"||u===t.memoizedProps&&te===t.memoizedState||(i.flags|=1024),p=!1)}return ig(t,i,l,p,b,_)}function ig(t,i,l,p,_,b){$1(t,i);var I=(i.flags&128)!==0;if(!p&&!I)return _&&Yv(i,l,!1),Qs(t,i,b);p=i.stateNode,GT.current=i;var u=I&&typeof l.getDerivedStateFromError!="function"?null:p.render();return i.flags|=1,t!==null&&I?(i.child=jl(i,t.child,null,b),i.child=jl(i,null,u,b)):Bn(t,i,u,b),i.memoizedState=p.state,_&&Yv(i,l,!0),i.child}function q1(t){var i=t.stateNode;i.pendingContext?Kv(t,i.pendingContext,i.pendingContext!==i.context):i.context&&Kv(t,i.context,!1),ry(t,i.containerInfo)}function p0(t,i,l,p,_){return Ul(),Kg(_),i.flags|=256,Bn(t,i,l,p),i.child}var sg={dehydrated:null,treeContext:null,retryLane:0};function og(t){return{baseLanes:t,cachePool:null,transitions:null}}function Z1(t,i,l){var p=i.pendingProps,_=mr.current,b=!1,I=(i.flags&128)!==0,u;if((u=I)||(u=t!==null&&t.memoizedState===null?!1:(_&2)!==0),u?(b=!0,i.flags&=-129):(t===null||t.memoizedState!==null)&&(_|=1),Jt(mr,_&1),t===null)return Qm(i),t=i.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(i.mode&1?t.data==="$!"?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(I=p.children,t=p.fallback,b?(p=i.mode,b=i.child,I={mode:"hidden",children:I},!(p&1)&&b!==null?(b.childLanes=0,b.pendingProps=I):b=Ep(I,p,0,null),t=ka(t,p,l,null),b.return=i,t.return=i,b.sibling=t,i.child=b,i.child.memoizedState=og(l),i.memoizedState=sg,t):cy(i,I));if(_=t.memoizedState,_!==null&&(u=_.dehydrated,u!==null))return WT(t,i,I,p,u,_,l);if(b){b=p.fallback,I=i.mode,_=t.child,u=_.sibling;var B={mode:"hidden",children:p.children};return!(I&1)&&i.child!==_?(p=i.child,p.childLanes=0,p.pendingProps=B,i.deletions=null):(p=No(_,B),p.subtreeFlags=_.subtreeFlags&14680064),u!==null?b=No(u,b):(b=ka(b,I,l,null),b.flags|=2),b.return=i,p.return=i,p.sibling=b,i.child=p,p=b,b=i.child,I=t.child.memoizedState,I=I===null?og(l):{baseLanes:I.baseLanes|l,cachePool:null,transitions:I.transitions},b.memoizedState=I,b.childLanes=t.childLanes&~l,i.memoizedState=sg,p}return b=t.child,t=b.sibling,p=No(b,{mode:"visible",children:p.children}),!(i.mode&1)&&(p.lanes=l),p.return=i,p.sibling=null,t!==null&&(l=i.deletions,l===null?(i.deletions=[t],i.flags|=16):l.push(t)),i.child=p,i.memoizedState=null,p}function cy(t,i){return i=Ep({mode:"visible",children:i},t.mode,0,null),i.return=t,t.child=i}function gd(t,i,l,p){return p!==null&&Kg(p),jl(i,t.child,null,l),t=cy(i,i.pendingProps.children),t.flags|=2,i.memoizedState=null,t}function WT(t,i,l,p,_,b,I){if(l)return i.flags&256?(i.flags&=-257,p=pm(Error(Fe(422))),gd(t,i,I,p)):i.memoizedState!==null?(i.child=t.child,i.flags|=128,null):(b=p.fallback,_=i.mode,p=Ep({mode:"visible",children:p.children},_,0,null),b=ka(b,_,I,null),b.flags|=2,p.return=i,b.return=i,p.sibling=b,i.child=p,i.mode&1&&jl(i,t.child,null,I),i.child.memoizedState=og(I),i.memoizedState=sg,b);if(!(i.mode&1))return gd(t,i,I,null);if(_.data==="$!"){if(p=_.nextSibling&&_.nextSibling.dataset,p)var u=p.dgst;return p=u,b=Error(Fe(419)),p=pm(b,p,void 0),gd(t,i,I,p)}if(u=(I&t.childLanes)!==0,Qn||u){if(p=Yr,p!==null){switch(I&-I){case 4:_=2;break;case 16:_=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:_=32;break;case 536870912:_=268435456;break;default:_=0}_=_&(p.suspendedLanes|I)?0:_,_!==0&&_!==b.retryLane&&(b.retryLane=_,Ys(t,_),ts(p,t,_,-1))}return gy(),p=pm(Error(Fe(421))),gd(t,i,I,p)}return _.data==="$?"?(i.flags|=128,i.child=t.child,i=ok.bind(null,t),_._reactRetry=i,null):(t=b.treeContext,ci=Ro(_.nextSibling),di=i,cr=!0,Qi=null,t!==null&&(Pi[zi++]=Gs,Pi[zi++]=Ws,Pi[zi++]=Ia,Gs=t.id,Ws=t.overflow,Ia=i),i=cy(i,p.children),i.flags|=4096,i)}function f0(t,i,l){t.lanes|=i;var p=t.alternate;p!==null&&(p.lanes|=i),Jm(t.return,i,l)}function fm(t,i,l,p,_){var b=t.memoizedState;b===null?t.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:p,tail:l,tailMode:_}:(b.isBackwards=i,b.rendering=null,b.renderingStartTime=0,b.last=p,b.tail=l,b.tailMode=_)}function G1(t,i,l){var p=i.pendingProps,_=p.revealOrder,b=p.tail;if(Bn(t,i,p.children,l),p=mr.current,p&2)p=p&1|2,i.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=i.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&f0(t,l,i);else if(t.tag===19)f0(t,l,i);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===i)break e;for(;t.sibling===null;){if(t.return===null||t.return===i)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}p&=1}if(Jt(mr,p),!(i.mode&1))i.memoizedState=null;else switch(_){case"forwards":for(l=i.child,_=null;l!==null;)t=l.alternate,t!==null&&rp(t)===null&&(_=l),l=l.sibling;l=_,l===null?(_=i.child,i.child=null):(_=l.sibling,l.sibling=null),fm(i,!1,_,l,b);break;case"backwards":for(l=null,_=i.child,i.child=null;_!==null;){if(t=_.alternate,t!==null&&rp(t)===null){i.child=_;break}t=_.sibling,_.sibling=l,l=_,_=t}fm(i,!0,l,null,b);break;case"together":fm(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function zd(t,i){!(i.mode&1)&&t!==null&&(t.alternate=null,i.alternate=null,i.flags|=2)}function Qs(t,i,l){if(t!==null&&(i.dependencies=t.dependencies),Pa|=i.lanes,!(l&i.childLanes))return null;if(t!==null&&i.child!==t.child)throw Error(Fe(153));if(i.child!==null){for(t=i.child,l=No(t,t.pendingProps),i.child=l,l.return=i;t.sibling!==null;)t=t.sibling,l=l.sibling=No(t,t.pendingProps),l.return=i;l.sibling=null}return i.child}function HT(t,i,l){switch(i.tag){case 3:q1(i),Ul();break;case 5:v1(i);break;case 1:ei(i.type)&&Kd(i);break;case 4:ry(i,i.stateNode.containerInfo);break;case 10:var p=i.type._context,_=i.memoizedProps.value;Jt(Jd,p._currentValue),p._currentValue=_;break;case 13:if(p=i.memoizedState,p!==null)return p.dehydrated!==null?(Jt(mr,mr.current&1),i.flags|=128,null):l&i.child.childLanes?Z1(t,i,l):(Jt(mr,mr.current&1),t=Qs(t,i,l),t!==null?t.sibling:null);Jt(mr,mr.current&1);break;case 19:if(p=(l&i.childLanes)!==0,t.flags&128){if(p)return G1(t,i,l);i.flags|=128}if(_=i.memoizedState,_!==null&&(_.rendering=null,_.tail=null,_.lastEffect=null),Jt(mr,mr.current),p)break;return null;case 22:case 23:return i.lanes=0,j1(t,i,l)}return Qs(t,i,l)}var W1,ag,H1,X1;W1=function(t,i){for(var l=i.child;l!==null;){if(l.tag===5||l.tag===6)t.appendChild(l.stateNode);else if(l.tag!==4&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===i)break;for(;l.sibling===null;){if(l.return===null||l.return===i)return;l=l.return}l.sibling.return=l.return,l=l.sibling}};ag=function(){};H1=function(t,i,l,p){var _=t.memoizedProps;if(_!==p){t=i.stateNode,ba(bs.current);var b=null;switch(l){case"input":_=Pm(t,_),p=Pm(t,p),b=[];break;case"select":_=yr({},_,{value:void 0}),p=yr({},p,{value:void 0}),b=[];break;case"textarea":_=Am(t,_),p=Am(t,p),b=[];break;default:typeof _.onClick!="function"&&typeof p.onClick=="function"&&(t.onclick=Hd)}Lm(l,p);var I;l=null;for(D in _)if(!p.hasOwnProperty(D)&&_.hasOwnProperty(D)&&_[D]!=null)if(D==="style"){var u=_[D];for(I in u)u.hasOwnProperty(I)&&(l||(l={}),l[I]="")}else D!=="dangerouslySetInnerHTML"&&D!=="children"&&D!=="suppressContentEditableWarning"&&D!=="suppressHydrationWarning"&&D!=="autoFocus"&&(Tc.hasOwnProperty(D)?b||(b=[]):(b=b||[]).push(D,null));for(D in p){var B=p[D];if(u=_!=null?_[D]:void 0,p.hasOwnProperty(D)&&B!==u&&(B!=null||u!=null))if(D==="style")if(u){for(I in u)!u.hasOwnProperty(I)||B&&B.hasOwnProperty(I)||(l||(l={}),l[I]="");for(I in B)B.hasOwnProperty(I)&&u[I]!==B[I]&&(l||(l={}),l[I]=B[I])}else l||(b||(b=[]),b.push(D,l)),l=B;else D==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,u=u?u.__html:void 0,B!=null&&u!==B&&(b=b||[]).push(D,B)):D==="children"?typeof B!="string"&&typeof B!="number"||(b=b||[]).push(D,""+B):D!=="suppressContentEditableWarning"&&D!=="suppressHydrationWarning"&&(Tc.hasOwnProperty(D)?(B!=null&&D==="onScroll"&&ir("scroll",t),b||u===B||(b=[])):(b=b||[]).push(D,B))}l&&(b=b||[]).push("style",l);var D=b;(i.updateQueue=D)&&(i.flags|=4)}};X1=function(t,i,l,p){l!==p&&(i.flags|=4)};function lc(t,i){if(!cr)switch(t.tailMode){case"hidden":i=t.tail;for(var l=null;i!==null;)i.alternate!==null&&(l=i),i=i.sibling;l===null?t.tail=null:l.sibling=null;break;case"collapsed":l=t.tail;for(var p=null;l!==null;)l.alternate!==null&&(p=l),l=l.sibling;p===null?i||t.tail===null?t.tail=null:t.tail.sibling=null:p.sibling=null}}function Sn(t){var i=t.alternate!==null&&t.alternate.child===t.child,l=0,p=0;if(i)for(var _=t.child;_!==null;)l|=_.lanes|_.childLanes,p|=_.subtreeFlags&14680064,p|=_.flags&14680064,_.return=t,_=_.sibling;else for(_=t.child;_!==null;)l|=_.lanes|_.childLanes,p|=_.subtreeFlags,p|=_.flags,_.return=t,_=_.sibling;return t.subtreeFlags|=p,t.childLanes=l,i}function XT(t,i,l){var p=i.pendingProps;switch(Xg(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Sn(i),null;case 1:return ei(i.type)&&Xd(),Sn(i),null;case 3:return p=i.stateNode,$l(),sr(Jn),sr(kn),iy(),p.pendingContext&&(p.context=p.pendingContext,p.pendingContext=null),(t===null||t.child===null)&&(fd(i)?i.flags|=4:t===null||t.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,Qi!==null&&(mg(Qi),Qi=null))),ag(t,i),Sn(i),null;case 5:ny(i);var _=ba(Fc.current);if(l=i.type,t!==null&&i.stateNode!=null)H1(t,i,l,p,_),t.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!p){if(i.stateNode===null)throw Error(Fe(166));return Sn(i),null}if(t=ba(bs.current),fd(i)){p=i.stateNode,l=i.type;var b=i.memoizedProps;switch(p[xs]=i,p[Lc]=b,t=(i.mode&1)!==0,l){case"dialog":ir("cancel",p),ir("close",p);break;case"iframe":case"object":case"embed":ir("load",p);break;case"video":case"audio":for(_=0;_<pc.length;_++)ir(pc[_],p);break;case"source":ir("error",p);break;case"img":case"image":case"link":ir("error",p),ir("load",p);break;case"details":ir("toggle",p);break;case"input":Sv(p,b),ir("invalid",p);break;case"select":p._wrapperState={wasMultiple:!!b.multiple},ir("invalid",p);break;case"textarea":kv(p,b),ir("invalid",p)}Lm(l,b),_=null;for(var I in b)if(b.hasOwnProperty(I)){var u=b[I];I==="children"?typeof u=="string"?p.textContent!==u&&(b.suppressHydrationWarning!==!0&&pd(p.textContent,u,t),_=["children",u]):typeof u=="number"&&p.textContent!==""+u&&(b.suppressHydrationWarning!==!0&&pd(p.textContent,u,t),_=["children",""+u]):Tc.hasOwnProperty(I)&&u!=null&&I==="onScroll"&&ir("scroll",p)}switch(l){case"input":sd(p),Tv(p,b,!0);break;case"textarea":sd(p),Ev(p);break;case"select":case"option":break;default:typeof b.onClick=="function"&&(p.onclick=Hd)}p=_,i.updateQueue=p,p!==null&&(i.flags|=4)}else{I=_.nodeType===9?_:_.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=bx(l)),t==="http://www.w3.org/1999/xhtml"?l==="script"?(t=I.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof p.is=="string"?t=I.createElement(l,{is:p.is}):(t=I.createElement(l),l==="select"&&(I=t,p.multiple?I.multiple=!0:p.size&&(I.size=p.size))):t=I.createElementNS(t,l),t[xs]=i,t[Lc]=p,W1(t,i,!1,!1),i.stateNode=t;e:{switch(I=Rm(l,p),l){case"dialog":ir("cancel",t),ir("close",t),_=p;break;case"iframe":case"object":case"embed":ir("load",t),_=p;break;case"video":case"audio":for(_=0;_<pc.length;_++)ir(pc[_],t);_=p;break;case"source":ir("error",t),_=p;break;case"img":case"image":case"link":ir("error",t),ir("load",t),_=p;break;case"details":ir("toggle",t),_=p;break;case"input":Sv(t,p),_=Pm(t,p),ir("invalid",t);break;case"option":_=p;break;case"select":t._wrapperState={wasMultiple:!!p.multiple},_=yr({},p,{value:void 0}),ir("invalid",t);break;case"textarea":kv(t,p),_=Am(t,p),ir("invalid",t);break;default:_=p}Lm(l,_),u=_;for(b in u)if(u.hasOwnProperty(b)){var B=u[b];b==="style"?kx(t,B):b==="dangerouslySetInnerHTML"?(B=B?B.__html:void 0,B!=null&&Sx(t,B)):b==="children"?typeof B=="string"?(l!=="textarea"||B!=="")&&kc(t,B):typeof B=="number"&&kc(t,""+B):b!=="suppressContentEditableWarning"&&b!=="suppressHydrationWarning"&&b!=="autoFocus"&&(Tc.hasOwnProperty(b)?B!=null&&b==="onScroll"&&ir("scroll",t):B!=null&&Lg(t,b,B,I))}switch(l){case"input":sd(t),Tv(t,p,!1);break;case"textarea":sd(t),Ev(t);break;case"option":p.value!=null&&t.setAttribute("value",""+Uo(p.value));break;case"select":t.multiple=!!p.multiple,b=p.value,b!=null?Dl(t,!!p.multiple,b,!1):p.defaultValue!=null&&Dl(t,!!p.multiple,p.defaultValue,!0);break;default:typeof _.onClick=="function"&&(t.onclick=Hd)}switch(l){case"button":case"input":case"select":case"textarea":p=!!p.autoFocus;break e;case"img":p=!0;break e;default:p=!1}}p&&(i.flags|=4)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Sn(i),null;case 6:if(t&&i.stateNode!=null)X1(t,i,t.memoizedProps,p);else{if(typeof p!="string"&&i.stateNode===null)throw Error(Fe(166));if(l=ba(Fc.current),ba(bs.current),fd(i)){if(p=i.stateNode,l=i.memoizedProps,p[xs]=i,(b=p.nodeValue!==l)&&(t=di,t!==null))switch(t.tag){case 3:pd(p.nodeValue,l,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&pd(p.nodeValue,l,(t.mode&1)!==0)}b&&(i.flags|=4)}else p=(l.nodeType===9?l:l.ownerDocument).createTextNode(p),p[xs]=i,i.stateNode=p}return Sn(i),null;case 13:if(sr(mr),p=i.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(cr&&ci!==null&&i.mode&1&&!(i.flags&128))d1(),Ul(),i.flags|=98560,b=!1;else if(b=fd(i),p!==null&&p.dehydrated!==null){if(t===null){if(!b)throw Error(Fe(318));if(b=i.memoizedState,b=b!==null?b.dehydrated:null,!b)throw Error(Fe(317));b[xs]=i}else Ul(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;Sn(i),b=!1}else Qi!==null&&(mg(Qi),Qi=null),b=!0;if(!b)return i.flags&65536?i:null}return i.flags&128?(i.lanes=l,i):(p=p!==null,p!==(t!==null&&t.memoizedState!==null)&&p&&(i.child.flags|=8192,i.mode&1&&(t===null||mr.current&1?jr===0&&(jr=3):gy())),i.updateQueue!==null&&(i.flags|=4),Sn(i),null);case 4:return $l(),ag(t,i),t===null&&Ac(i.stateNode.containerInfo),Sn(i),null;case 10:return Jg(i.type._context),Sn(i),null;case 17:return ei(i.type)&&Xd(),Sn(i),null;case 19:if(sr(mr),b=i.memoizedState,b===null)return Sn(i),null;if(p=(i.flags&128)!==0,I=b.rendering,I===null)if(p)lc(b,!1);else{if(jr!==0||t!==null&&t.flags&128)for(t=i.child;t!==null;){if(I=rp(t),I!==null){for(i.flags|=128,lc(b,!1),p=I.updateQueue,p!==null&&(i.updateQueue=p,i.flags|=4),i.subtreeFlags=0,p=l,l=i.child;l!==null;)b=l,t=p,b.flags&=14680066,I=b.alternate,I===null?(b.childLanes=0,b.lanes=t,b.child=null,b.subtreeFlags=0,b.memoizedProps=null,b.memoizedState=null,b.updateQueue=null,b.dependencies=null,b.stateNode=null):(b.childLanes=I.childLanes,b.lanes=I.lanes,b.child=I.child,b.subtreeFlags=0,b.deletions=null,b.memoizedProps=I.memoizedProps,b.memoizedState=I.memoizedState,b.updateQueue=I.updateQueue,b.type=I.type,t=I.dependencies,b.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),l=l.sibling;return Jt(mr,mr.current&1|2),i.child}t=t.sibling}b.tail!==null&&zr()>Zl&&(i.flags|=128,p=!0,lc(b,!1),i.lanes=4194304)}else{if(!p)if(t=rp(I),t!==null){if(i.flags|=128,p=!0,l=t.updateQueue,l!==null&&(i.updateQueue=l,i.flags|=4),lc(b,!0),b.tail===null&&b.tailMode==="hidden"&&!I.alternate&&!cr)return Sn(i),null}else 2*zr()-b.renderingStartTime>Zl&&l!==1073741824&&(i.flags|=128,p=!0,lc(b,!1),i.lanes=4194304);b.isBackwards?(I.sibling=i.child,i.child=I):(l=b.last,l!==null?l.sibling=I:i.child=I,b.last=I)}return b.tail!==null?(i=b.tail,b.rendering=i,b.tail=i.sibling,b.renderingStartTime=zr(),i.sibling=null,l=mr.current,Jt(mr,p?l&1|2:l&1),i):(Sn(i),null);case 22:case 23:return my(),p=i.memoizedState!==null,t!==null&&t.memoizedState!==null!==p&&(i.flags|=8192),p&&i.mode&1?ui&1073741824&&(Sn(i),i.subtreeFlags&6&&(i.flags|=8192)):Sn(i),null;case 24:return null;case 25:return null}throw Error(Fe(156,i.tag))}function KT(t,i){switch(Xg(i),i.tag){case 1:return ei(i.type)&&Xd(),t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 3:return $l(),sr(Jn),sr(kn),iy(),t=i.flags,t&65536&&!(t&128)?(i.flags=t&-65537|128,i):null;case 5:return ny(i),null;case 13:if(sr(mr),t=i.memoizedState,t!==null&&t.dehydrated!==null){if(i.alternate===null)throw Error(Fe(340));Ul()}return t=i.flags,t&65536?(i.flags=t&-65537|128,i):null;case 19:return sr(mr),null;case 4:return $l(),null;case 10:return Jg(i.type._context),null;case 22:case 23:return my(),null;case 24:return null;default:return null}}var yd=!1,Tn=!1,YT=typeof WeakSet=="function"?WeakSet:Set,tt=null;function Ml(t,i){var l=t.ref;if(l!==null)if(typeof l=="function")try{l(null)}catch(p){wr(t,i,p)}else l.current=null}function lg(t,i,l){try{l()}catch(p){wr(t,i,p)}}var m0=!1;function QT(t,i){if(Zm=Zd,t=Jx(),Wg(t)){if("selectionStart"in t)var l={start:t.selectionStart,end:t.selectionEnd};else e:{l=(l=t.ownerDocument)&&l.defaultView||window;var p=l.getSelection&&l.getSelection();if(p&&p.rangeCount!==0){l=p.anchorNode;var _=p.anchorOffset,b=p.focusNode;p=p.focusOffset;try{l.nodeType,b.nodeType}catch{l=null;break e}var I=0,u=-1,B=-1,D=0,ne=0,re=t,te=null;t:for(;;){for(var _e;re!==l||_!==0&&re.nodeType!==3||(u=I+_),re!==b||p!==0&&re.nodeType!==3||(B=I+p),re.nodeType===3&&(I+=re.nodeValue.length),(_e=re.firstChild)!==null;)te=re,re=_e;for(;;){if(re===t)break t;if(te===l&&++D===_&&(u=I),te===b&&++ne===p&&(B=I),(_e=re.nextSibling)!==null)break;re=te,te=re.parentNode}re=_e}l=u===-1||B===-1?null:{start:u,end:B}}else l=null}l=l||{start:0,end:0}}else l=null;for(Gm={focusedElem:t,selectionRange:l},Zd=!1,tt=i;tt!==null;)if(i=tt,t=i.child,(i.subtreeFlags&1028)!==0&&t!==null)t.return=i,tt=t;else for(;tt!==null;){i=tt;try{var be=i.alternate;if(i.flags&1024)switch(i.tag){case 0:case 11:case 15:break;case 1:if(be!==null){var ke=be.memoizedProps,we=be.memoizedState,K=i.stateNode,ee=K.getSnapshotBeforeUpdate(i.elementType===i.type?ke:Ki(i.type,ke),we);K.__reactInternalSnapshotBeforeUpdate=ee}break;case 3:var ce=i.stateNode.containerInfo;ce.nodeType===1?ce.textContent="":ce.nodeType===9&&ce.documentElement&&ce.removeChild(ce.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(Fe(163))}}catch(ye){wr(i,i.return,ye)}if(t=i.sibling,t!==null){t.return=i.return,tt=t;break}tt=i.return}return be=m0,m0=!1,be}function wc(t,i,l){var p=i.updateQueue;if(p=p!==null?p.lastEffect:null,p!==null){var _=p=p.next;do{if((_.tag&t)===t){var b=_.destroy;_.destroy=void 0,b!==void 0&&lg(i,l,b)}_=_.next}while(_!==p)}}function Tp(t,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var l=i=i.next;do{if((l.tag&t)===t){var p=l.create;l.destroy=p()}l=l.next}while(l!==i)}}function ug(t){var i=t.ref;if(i!==null){var l=t.stateNode;switch(t.tag){case 5:t=l;break;default:t=l}typeof i=="function"?i(t):i.current=t}}function K1(t){var i=t.alternate;i!==null&&(t.alternate=null,K1(i)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(i=t.stateNode,i!==null&&(delete i[xs],delete i[Lc],delete i[Xm],delete i[LT],delete i[RT])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function Y1(t){return t.tag===5||t.tag===3||t.tag===4}function g0(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||Y1(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function cg(t,i,l){var p=t.tag;if(p===5||p===6)t=t.stateNode,i?l.nodeType===8?l.parentNode.insertBefore(t,i):l.insertBefore(t,i):(l.nodeType===8?(i=l.parentNode,i.insertBefore(t,l)):(i=l,i.appendChild(t)),l=l._reactRootContainer,l!=null||i.onclick!==null||(i.onclick=Hd));else if(p!==4&&(t=t.child,t!==null))for(cg(t,i,l),t=t.sibling;t!==null;)cg(t,i,l),t=t.sibling}function hg(t,i,l){var p=t.tag;if(p===5||p===6)t=t.stateNode,i?l.insertBefore(t,i):l.appendChild(t);else if(p!==4&&(t=t.child,t!==null))for(hg(t,i,l),t=t.sibling;t!==null;)hg(t,i,l),t=t.sibling}var ln=null,Yi=!1;function ko(t,i,l){for(l=l.child;l!==null;)Q1(t,i,l),l=l.sibling}function Q1(t,i,l){if(ws&&typeof ws.onCommitFiberUnmount=="function")try{ws.onCommitFiberUnmount(gp,l)}catch{}switch(l.tag){case 5:Tn||Ml(l,i);case 6:var p=ln,_=Yi;ln=null,ko(t,i,l),ln=p,Yi=_,ln!==null&&(Yi?(t=ln,l=l.stateNode,t.nodeType===8?t.parentNode.removeChild(l):t.removeChild(l)):ln.removeChild(l.stateNode));break;case 18:ln!==null&&(Yi?(t=ln,l=l.stateNode,t.nodeType===8?am(t.parentNode,l):t.nodeType===1&&am(t,l),Pc(t)):am(ln,l.stateNode));break;case 4:p=ln,_=Yi,ln=l.stateNode.containerInfo,Yi=!0,ko(t,i,l),ln=p,Yi=_;break;case 0:case 11:case 14:case 15:if(!Tn&&(p=l.updateQueue,p!==null&&(p=p.lastEffect,p!==null))){_=p=p.next;do{var b=_,I=b.destroy;b=b.tag,I!==void 0&&(b&2||b&4)&&lg(l,i,I),_=_.next}while(_!==p)}ko(t,i,l);break;case 1:if(!Tn&&(Ml(l,i),p=l.stateNode,typeof p.componentWillUnmount=="function"))try{p.props=l.memoizedProps,p.state=l.memoizedState,p.componentWillUnmount()}catch(u){wr(l,i,u)}ko(t,i,l);break;case 21:ko(t,i,l);break;case 22:l.mode&1?(Tn=(p=Tn)||l.memoizedState!==null,ko(t,i,l),Tn=p):ko(t,i,l);break;default:ko(t,i,l)}}function y0(t){var i=t.updateQueue;if(i!==null){t.updateQueue=null;var l=t.stateNode;l===null&&(l=t.stateNode=new YT),i.forEach(function(p){var _=ak.bind(null,t,p);l.has(p)||(l.add(p),p.then(_,_))})}}function Xi(t,i){var l=i.deletions;if(l!==null)for(var p=0;p<l.length;p++){var _=l[p];try{var b=t,I=i,u=I;e:for(;u!==null;){switch(u.tag){case 5:ln=u.stateNode,Yi=!1;break e;case 3:ln=u.stateNode.containerInfo,Yi=!0;break e;case 4:ln=u.stateNode.containerInfo,Yi=!0;break e}u=u.return}if(ln===null)throw Error(Fe(160));Q1(b,I,_),ln=null,Yi=!1;var B=_.alternate;B!==null&&(B.return=null),_.return=null}catch(D){wr(_,i,D)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)J1(i,t),i=i.sibling}function J1(t,i){var l=t.alternate,p=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Xi(i,t),_s(t),p&4){try{wc(3,t,t.return),Tp(3,t)}catch(ke){wr(t,t.return,ke)}try{wc(5,t,t.return)}catch(ke){wr(t,t.return,ke)}}break;case 1:Xi(i,t),_s(t),p&512&&l!==null&&Ml(l,l.return);break;case 5:if(Xi(i,t),_s(t),p&512&&l!==null&&Ml(l,l.return),t.flags&32){var _=t.stateNode;try{kc(_,"")}catch(ke){wr(t,t.return,ke)}}if(p&4&&(_=t.stateNode,_!=null)){var b=t.memoizedProps,I=l!==null?l.memoizedProps:b,u=t.type,B=t.updateQueue;if(t.updateQueue=null,B!==null)try{u==="input"&&b.type==="radio"&&b.name!=null&&xx(_,b),Rm(u,I);var D=Rm(u,b);for(I=0;I<B.length;I+=2){var ne=B[I],re=B[I+1];ne==="style"?kx(_,re):ne==="dangerouslySetInnerHTML"?Sx(_,re):ne==="children"?kc(_,re):Lg(_,ne,re,D)}switch(u){case"input":zm(_,b);break;case"textarea":wx(_,b);break;case"select":var te=_._wrapperState.wasMultiple;_._wrapperState.wasMultiple=!!b.multiple;var _e=b.value;_e!=null?Dl(_,!!b.multiple,_e,!1):te!==!!b.multiple&&(b.defaultValue!=null?Dl(_,!!b.multiple,b.defaultValue,!0):Dl(_,!!b.multiple,b.multiple?[]:"",!1))}_[Lc]=b}catch(ke){wr(t,t.return,ke)}}break;case 6:if(Xi(i,t),_s(t),p&4){if(t.stateNode===null)throw Error(Fe(162));_=t.stateNode,b=t.memoizedProps;try{_.nodeValue=b}catch(ke){wr(t,t.return,ke)}}break;case 3:if(Xi(i,t),_s(t),p&4&&l!==null&&l.memoizedState.isDehydrated)try{Pc(i.containerInfo)}catch(ke){wr(t,t.return,ke)}break;case 4:Xi(i,t),_s(t);break;case 13:Xi(i,t),_s(t),_=t.child,_.flags&8192&&(b=_.memoizedState!==null,_.stateNode.isHidden=b,!b||_.alternate!==null&&_.alternate.memoizedState!==null||(py=zr())),p&4&&y0(t);break;case 22:if(ne=l!==null&&l.memoizedState!==null,t.mode&1?(Tn=(D=Tn)||ne,Xi(i,t),Tn=D):Xi(i,t),_s(t),p&8192){if(D=t.memoizedState!==null,(t.stateNode.isHidden=D)&&!ne&&t.mode&1)for(tt=t,ne=t.child;ne!==null;){for(re=tt=ne;tt!==null;){switch(te=tt,_e=te.child,te.tag){case 0:case 11:case 14:case 15:wc(4,te,te.return);break;case 1:Ml(te,te.return);var be=te.stateNode;if(typeof be.componentWillUnmount=="function"){p=te,l=te.return;try{i=p,be.props=i.memoizedProps,be.state=i.memoizedState,be.componentWillUnmount()}catch(ke){wr(p,l,ke)}}break;case 5:Ml(te,te.return);break;case 22:if(te.memoizedState!==null){v0(re);continue}}_e!==null?(_e.return=te,tt=_e):v0(re)}ne=ne.sibling}e:for(ne=null,re=t;;){if(re.tag===5){if(ne===null){ne=re;try{_=re.stateNode,D?(b=_.style,typeof b.setProperty=="function"?b.setProperty("display","none","important"):b.display="none"):(u=re.stateNode,B=re.memoizedProps.style,I=B!=null&&B.hasOwnProperty("display")?B.display:null,u.style.display=Tx("display",I))}catch(ke){wr(t,t.return,ke)}}}else if(re.tag===6){if(ne===null)try{re.stateNode.nodeValue=D?"":re.memoizedProps}catch(ke){wr(t,t.return,ke)}}else if((re.tag!==22&&re.tag!==23||re.memoizedState===null||re===t)&&re.child!==null){re.child.return=re,re=re.child;continue}if(re===t)break e;for(;re.sibling===null;){if(re.return===null||re.return===t)break e;ne===re&&(ne=null),re=re.return}ne===re&&(ne=null),re.sibling.return=re.return,re=re.sibling}}break;case 19:Xi(i,t),_s(t),p&4&&y0(t);break;case 21:break;default:Xi(i,t),_s(t)}}function _s(t){var i=t.flags;if(i&2){try{e:{for(var l=t.return;l!==null;){if(Y1(l)){var p=l;break e}l=l.return}throw Error(Fe(160))}switch(p.tag){case 5:var _=p.stateNode;p.flags&32&&(kc(_,""),p.flags&=-33);var b=g0(t);hg(t,b,_);break;case 3:case 4:var I=p.stateNode.containerInfo,u=g0(t);cg(t,u,I);break;default:throw Error(Fe(161))}}catch(B){wr(t,t.return,B)}t.flags&=-3}i&4096&&(t.flags&=-4097)}function JT(t,i,l){tt=t,ew(t)}function ew(t,i,l){for(var p=(t.mode&1)!==0;tt!==null;){var _=tt,b=_.child;if(_.tag===22&&p){var I=_.memoizedState!==null||yd;if(!I){var u=_.alternate,B=u!==null&&u.memoizedState!==null||Tn;u=yd;var D=Tn;if(yd=I,(Tn=B)&&!D)for(tt=_;tt!==null;)I=tt,B=I.child,I.tag===22&&I.memoizedState!==null?x0(_):B!==null?(B.return=I,tt=B):x0(_);for(;b!==null;)tt=b,ew(b),b=b.sibling;tt=_,yd=u,Tn=D}_0(t)}else _.subtreeFlags&8772&&b!==null?(b.return=_,tt=b):_0(t)}}function _0(t){for(;tt!==null;){var i=tt;if(i.flags&8772){var l=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:Tn||Tp(5,i);break;case 1:var p=i.stateNode;if(i.flags&4&&!Tn)if(l===null)p.componentDidMount();else{var _=i.elementType===i.type?l.memoizedProps:Ki(i.type,l.memoizedProps);p.componentDidUpdate(_,l.memoizedState,p.__reactInternalSnapshotBeforeUpdate)}var b=i.updateQueue;b!==null&&t0(i,b,p);break;case 3:var I=i.updateQueue;if(I!==null){if(l=null,i.child!==null)switch(i.child.tag){case 5:l=i.child.stateNode;break;case 1:l=i.child.stateNode}t0(i,I,l)}break;case 5:var u=i.stateNode;if(l===null&&i.flags&4){l=u;var B=i.memoizedProps;switch(i.type){case"button":case"input":case"select":case"textarea":B.autoFocus&&l.focus();break;case"img":B.src&&(l.src=B.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(i.memoizedState===null){var D=i.alternate;if(D!==null){var ne=D.memoizedState;if(ne!==null){var re=ne.dehydrated;re!==null&&Pc(re)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(Fe(163))}Tn||i.flags&512&&ug(i)}catch(te){wr(i,i.return,te)}}if(i===t){tt=null;break}if(l=i.sibling,l!==null){l.return=i.return,tt=l;break}tt=i.return}}function v0(t){for(;tt!==null;){var i=tt;if(i===t){tt=null;break}var l=i.sibling;if(l!==null){l.return=i.return,tt=l;break}tt=i.return}}function x0(t){for(;tt!==null;){var i=tt;try{switch(i.tag){case 0:case 11:case 15:var l=i.return;try{Tp(4,i)}catch(B){wr(i,l,B)}break;case 1:var p=i.stateNode;if(typeof p.componentDidMount=="function"){var _=i.return;try{p.componentDidMount()}catch(B){wr(i,_,B)}}var b=i.return;try{ug(i)}catch(B){wr(i,b,B)}break;case 5:var I=i.return;try{ug(i)}catch(B){wr(i,I,B)}}}catch(B){wr(i,i.return,B)}if(i===t){tt=null;break}var u=i.sibling;if(u!==null){u.return=i.return,tt=u;break}tt=i.return}}var ek=Math.ceil,sp=eo.ReactCurrentDispatcher,hy=eo.ReactCurrentOwner,Ai=eo.ReactCurrentBatchConfig,Dt=0,Yr=null,Dr=null,un=0,ui=0,Al=Go(0),jr=0,Vc=null,Pa=0,kp=0,dy=0,bc=null,Yn=null,py=0,Zl=1/0,qs=null,op=!1,dg=null,Bo=null,_d=!1,Mo=null,ap=0,Sc=0,pg=null,Md=-1,Ad=0;function On(){return Dt&6?zr():Md!==-1?Md:Md=zr()}function Oo(t){return t.mode&1?Dt&2&&un!==0?un&-un:BT.transition!==null?(Ad===0&&(Ad=Bx()),Ad):(t=$t,t!==0||(t=window.event,t=t===void 0?16:qx(t.type)),t):1}function ts(t,i,l,p){if(50<Sc)throw Sc=0,pg=null,Error(Fe(185));Zc(t,l,p),(!(Dt&2)||t!==Yr)&&(t===Yr&&(!(Dt&2)&&(kp|=l),jr===4&&Po(t,un)),ti(t,p),l===1&&Dt===0&&!(i.mode&1)&&(Zl=zr()+500,wp&&Wo()))}function ti(t,i){var l=t.callbackNode;BS(t,i);var p=qd(t,t===Yr?un:0);if(p===0)l!==null&&Pv(l),t.callbackNode=null,t.callbackPriority=0;else if(i=p&-p,t.callbackPriority!==i){if(l!=null&&Pv(l),i===1)t.tag===0?FT(w0.bind(null,t)):u1(w0.bind(null,t)),AT(function(){!(Dt&6)&&Wo()}),l=null;else{switch(Ox(p)){case 1:l=Ng;break;case 4:l=Rx;break;case 16:l=$d;break;case 536870912:l=Fx;break;default:l=$d}l=lw(l,tw.bind(null,t))}t.callbackPriority=i,t.callbackNode=l}}function tw(t,i){if(Md=-1,Ad=0,Dt&6)throw Error(Fe(327));var l=t.callbackNode;if(Ol()&&t.callbackNode!==l)return null;var p=qd(t,t===Yr?un:0);if(p===0)return null;if(p&30||p&t.expiredLanes||i)i=lp(t,p);else{i=p;var _=Dt;Dt|=2;var b=nw();(Yr!==t||un!==i)&&(qs=null,Zl=zr()+500,Ta(t,i));do try{nk();break}catch(u){rw(t,u)}while(1);Qg(),sp.current=b,Dt=_,Dr!==null?i=0:(Yr=null,un=0,i=jr)}if(i!==0){if(i===2&&(_=Vm(t),_!==0&&(p=_,i=fg(t,_))),i===1)throw l=Vc,Ta(t,0),Po(t,p),ti(t,zr()),l;if(i===6)Po(t,p);else{if(_=t.current.alternate,!(p&30)&&!tk(_)&&(i=lp(t,p),i===2&&(b=Vm(t),b!==0&&(p=b,i=fg(t,b))),i===1))throw l=Vc,Ta(t,0),Po(t,p),ti(t,zr()),l;switch(t.finishedWork=_,t.finishedLanes=p,i){case 0:case 1:throw Error(Fe(345));case 2:_a(t,Yn,qs);break;case 3:if(Po(t,p),(p&130023424)===p&&(i=py+500-zr(),10<i)){if(qd(t,0)!==0)break;if(_=t.suspendedLanes,(_&p)!==p){On(),t.pingedLanes|=t.suspendedLanes&_;break}t.timeoutHandle=Hm(_a.bind(null,t,Yn,qs),i);break}_a(t,Yn,qs);break;case 4:if(Po(t,p),(p&4194240)===p)break;for(i=t.eventTimes,_=-1;0<p;){var I=31-es(p);b=1<<I,I=i[I],I>_&&(_=I),p&=~b}if(p=_,p=zr()-p,p=(120>p?120:480>p?480:1080>p?1080:1920>p?1920:3e3>p?3e3:4320>p?4320:1960*ek(p/1960))-p,10<p){t.timeoutHandle=Hm(_a.bind(null,t,Yn,qs),p);break}_a(t,Yn,qs);break;case 5:_a(t,Yn,qs);break;default:throw Error(Fe(329))}}}return ti(t,zr()),t.callbackNode===l?tw.bind(null,t):null}function fg(t,i){var l=bc;return t.current.memoizedState.isDehydrated&&(Ta(t,i).flags|=256),t=lp(t,i),t!==2&&(i=Yn,Yn=l,i!==null&&mg(i)),t}function mg(t){Yn===null?Yn=t:Yn.push.apply(Yn,t)}function tk(t){for(var i=t;;){if(i.flags&16384){var l=i.updateQueue;if(l!==null&&(l=l.stores,l!==null))for(var p=0;p<l.length;p++){var _=l[p],b=_.getSnapshot;_=_.value;try{if(!ns(b(),_))return!1}catch{return!1}}}if(l=i.child,i.subtreeFlags&16384&&l!==null)l.return=i,i=l;else{if(i===t)break;for(;i.sibling===null;){if(i.return===null||i.return===t)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Po(t,i){for(i&=~dy,i&=~kp,t.suspendedLanes|=i,t.pingedLanes&=~i,t=t.expirationTimes;0<i;){var l=31-es(i),p=1<<l;t[l]=-1,i&=~p}}function w0(t){if(Dt&6)throw Error(Fe(327));Ol();var i=qd(t,0);if(!(i&1))return ti(t,zr()),null;var l=lp(t,i);if(t.tag!==0&&l===2){var p=Vm(t);p!==0&&(i=p,l=fg(t,p))}if(l===1)throw l=Vc,Ta(t,0),Po(t,i),ti(t,zr()),l;if(l===6)throw Error(Fe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=i,_a(t,Yn,qs),ti(t,zr()),null}function fy(t,i){var l=Dt;Dt|=1;try{return t(i)}finally{Dt=l,Dt===0&&(Zl=zr()+500,wp&&Wo())}}function za(t){Mo!==null&&Mo.tag===0&&!(Dt&6)&&Ol();var i=Dt;Dt|=1;var l=Ai.transition,p=$t;try{if(Ai.transition=null,$t=1,t)return t()}finally{$t=p,Ai.transition=l,Dt=i,!(Dt&6)&&Wo()}}function my(){ui=Al.current,sr(Al)}function Ta(t,i){t.finishedWork=null,t.finishedLanes=0;var l=t.timeoutHandle;if(l!==-1&&(t.timeoutHandle=-1,MT(l)),Dr!==null)for(l=Dr.return;l!==null;){var p=l;switch(Xg(p),p.tag){case 1:p=p.type.childContextTypes,p!=null&&Xd();break;case 3:$l(),sr(Jn),sr(kn),iy();break;case 5:ny(p);break;case 4:$l();break;case 13:sr(mr);break;case 19:sr(mr);break;case 10:Jg(p.type._context);break;case 22:case 23:my()}l=l.return}if(Yr=t,Dr=t=No(t.current,null),un=ui=i,jr=0,Vc=null,dy=kp=Pa=0,Yn=bc=null,wa!==null){for(i=0;i<wa.length;i++)if(l=wa[i],p=l.interleaved,p!==null){l.interleaved=null;var _=p.next,b=l.pending;if(b!==null){var I=b.next;b.next=_,p.next=I}l.pending=p}wa=null}return t}function rw(t,i){do{var l=Dr;try{if(Qg(),Cd.current=ip,np){for(var p=gr.memoizedState;p!==null;){var _=p.queue;_!==null&&(_.pending=null),p=p.next}np=!1}if(Ca=0,Kr=Vr=gr=null,xc=!1,Bc=0,hy.current=null,l===null||l.return===null){jr=1,Vc=i,Dr=null;break}e:{var b=t,I=l.return,u=l,B=i;if(i=un,u.flags|=32768,B!==null&&typeof B=="object"&&typeof B.then=="function"){var D=B,ne=u,re=ne.tag;if(!(ne.mode&1)&&(re===0||re===11||re===15)){var te=ne.alternate;te?(ne.updateQueue=te.updateQueue,ne.memoizedState=te.memoizedState,ne.lanes=te.lanes):(ne.updateQueue=null,ne.memoizedState=null)}var _e=l0(I);if(_e!==null){_e.flags&=-257,u0(_e,I,u,b,i),_e.mode&1&&a0(b,D,i),i=_e,B=D;var be=i.updateQueue;if(be===null){var ke=new Set;ke.add(B),i.updateQueue=ke}else be.add(B);break e}else{if(!(i&1)){a0(b,D,i),gy();break e}B=Error(Fe(426))}}else if(cr&&u.mode&1){var we=l0(I);if(we!==null){!(we.flags&65536)&&(we.flags|=256),u0(we,I,u,b,i),Kg(ql(B,u));break e}}b=B=ql(B,u),jr!==4&&(jr=2),bc===null?bc=[b]:bc.push(b),b=I;do{switch(b.tag){case 3:b.flags|=65536,i&=-i,b.lanes|=i;var K=N1(b,B,i);e0(b,K);break e;case 1:u=B;var ee=b.type,ce=b.stateNode;if(!(b.flags&128)&&(typeof ee.getDerivedStateFromError=="function"||ce!==null&&typeof ce.componentDidCatch=="function"&&(Bo===null||!Bo.has(ce)))){b.flags|=65536,i&=-i,b.lanes|=i;var ye=V1(b,u,i);e0(b,ye);break e}}b=b.return}while(b!==null)}sw(l)}catch(Pe){i=Pe,Dr===l&&l!==null&&(Dr=l=l.return);continue}break}while(1)}function nw(){var t=sp.current;return sp.current=ip,t===null?ip:t}function gy(){(jr===0||jr===3||jr===2)&&(jr=4),Yr===null||!(Pa&268435455)&&!(kp&268435455)||Po(Yr,un)}function lp(t,i){var l=Dt;Dt|=2;var p=nw();(Yr!==t||un!==i)&&(qs=null,Ta(t,i));do try{rk();break}catch(_){rw(t,_)}while(1);if(Qg(),Dt=l,sp.current=p,Dr!==null)throw Error(Fe(261));return Yr=null,un=0,jr}function rk(){for(;Dr!==null;)iw(Dr)}function nk(){for(;Dr!==null&&!CS();)iw(Dr)}function iw(t){var i=aw(t.alternate,t,ui);t.memoizedProps=t.pendingProps,i===null?sw(t):Dr=i,hy.current=null}function sw(t){var i=t;do{var l=i.alternate;if(t=i.return,i.flags&32768){if(l=KT(l,i),l!==null){l.flags&=32767,Dr=l;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{jr=6,Dr=null;return}}else if(l=XT(l,i,ui),l!==null){Dr=l;return}if(i=i.sibling,i!==null){Dr=i;return}Dr=i=t}while(i!==null);jr===0&&(jr=5)}function _a(t,i,l){var p=$t,_=Ai.transition;try{Ai.transition=null,$t=1,ik(t,i,l,p)}finally{Ai.transition=_,$t=p}return null}function ik(t,i,l,p){do Ol();while(Mo!==null);if(Dt&6)throw Error(Fe(327));l=t.finishedWork;var _=t.finishedLanes;if(l===null)return null;if(t.finishedWork=null,t.finishedLanes=0,l===t.current)throw Error(Fe(177));t.callbackNode=null,t.callbackPriority=0;var b=l.lanes|l.childLanes;if(OS(t,b),t===Yr&&(Dr=Yr=null,un=0),!(l.subtreeFlags&2064)&&!(l.flags&2064)||_d||(_d=!0,lw($d,function(){return Ol(),null})),b=(l.flags&15990)!==0,l.subtreeFlags&15990||b){b=Ai.transition,Ai.transition=null;var I=$t;$t=1;var u=Dt;Dt|=4,hy.current=null,QT(t,l),J1(l,t),TT(Gm),Zd=!!Zm,Gm=Zm=null,t.current=l,JT(l),PS(),Dt=u,$t=I,Ai.transition=b}else t.current=l;if(_d&&(_d=!1,Mo=t,ap=_),b=t.pendingLanes,b===0&&(Bo=null),AS(l.stateNode),ti(t,zr()),i!==null)for(p=t.onRecoverableError,l=0;l<i.length;l++)_=i[l],p(_.value,{componentStack:_.stack,digest:_.digest});if(op)throw op=!1,t=dg,dg=null,t;return ap&1&&t.tag!==0&&Ol(),b=t.pendingLanes,b&1?t===pg?Sc++:(Sc=0,pg=t):Sc=0,Wo(),null}function Ol(){if(Mo!==null){var t=Ox(ap),i=Ai.transition,l=$t;try{if(Ai.transition=null,$t=16>t?16:t,Mo===null)var p=!1;else{if(t=Mo,Mo=null,ap=0,Dt&6)throw Error(Fe(331));var _=Dt;for(Dt|=4,tt=t.current;tt!==null;){var b=tt,I=b.child;if(tt.flags&16){var u=b.deletions;if(u!==null){for(var B=0;B<u.length;B++){var D=u[B];for(tt=D;tt!==null;){var ne=tt;switch(ne.tag){case 0:case 11:case 15:wc(8,ne,b)}var re=ne.child;if(re!==null)re.return=ne,tt=re;else for(;tt!==null;){ne=tt;var te=ne.sibling,_e=ne.return;if(K1(ne),ne===D){tt=null;break}if(te!==null){te.return=_e,tt=te;break}tt=_e}}}var be=b.alternate;if(be!==null){var ke=be.child;if(ke!==null){be.child=null;do{var we=ke.sibling;ke.sibling=null,ke=we}while(ke!==null)}}tt=b}}if(b.subtreeFlags&2064&&I!==null)I.return=b,tt=I;else e:for(;tt!==null;){if(b=tt,b.flags&2048)switch(b.tag){case 0:case 11:case 15:wc(9,b,b.return)}var K=b.sibling;if(K!==null){K.return=b.return,tt=K;break e}tt=b.return}}var ee=t.current;for(tt=ee;tt!==null;){I=tt;var ce=I.child;if(I.subtreeFlags&2064&&ce!==null)ce.return=I,tt=ce;else e:for(I=ee;tt!==null;){if(u=tt,u.flags&2048)try{switch(u.tag){case 0:case 11:case 15:Tp(9,u)}}catch(Pe){wr(u,u.return,Pe)}if(u===I){tt=null;break e}var ye=u.sibling;if(ye!==null){ye.return=u.return,tt=ye;break e}tt=u.return}}if(Dt=_,Wo(),ws&&typeof ws.onPostCommitFiberRoot=="function")try{ws.onPostCommitFiberRoot(gp,t)}catch{}p=!0}return p}finally{$t=l,Ai.transition=i}}return!1}function b0(t,i,l){i=ql(l,i),i=N1(t,i,1),t=Fo(t,i,1),i=On(),t!==null&&(Zc(t,1,i),ti(t,i))}function wr(t,i,l){if(t.tag===3)b0(t,t,l);else for(;i!==null;){if(i.tag===3){b0(i,t,l);break}else if(i.tag===1){var p=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof p.componentDidCatch=="function"&&(Bo===null||!Bo.has(p))){t=ql(l,t),t=V1(i,t,1),i=Fo(i,t,1),t=On(),i!==null&&(Zc(i,1,t),ti(i,t));break}}i=i.return}}function sk(t,i,l){var p=t.pingCache;p!==null&&p.delete(i),i=On(),t.pingedLanes|=t.suspendedLanes&l,Yr===t&&(un&l)===l&&(jr===4||jr===3&&(un&130023424)===un&&500>zr()-py?Ta(t,0):dy|=l),ti(t,i)}function ow(t,i){i===0&&(t.mode&1?(i=ld,ld<<=1,!(ld&130023424)&&(ld=4194304)):i=1);var l=On();t=Ys(t,i),t!==null&&(Zc(t,i,l),ti(t,l))}function ok(t){var i=t.memoizedState,l=0;i!==null&&(l=i.retryLane),ow(t,l)}function ak(t,i){var l=0;switch(t.tag){case 13:var p=t.stateNode,_=t.memoizedState;_!==null&&(l=_.retryLane);break;case 19:p=t.stateNode;break;default:throw Error(Fe(314))}p!==null&&p.delete(i),ow(t,l)}var aw;aw=function(t,i,l){if(t!==null)if(t.memoizedProps!==i.pendingProps||Jn.current)Qn=!0;else{if(!(t.lanes&l)&&!(i.flags&128))return Qn=!1,HT(t,i,l);Qn=!!(t.flags&131072)}else Qn=!1,cr&&i.flags&1048576&&c1(i,Qd,i.index);switch(i.lanes=0,i.tag){case 2:var p=i.type;zd(t,i),t=i.pendingProps;var _=Vl(i,kn.current);Bl(i,l),_=oy(null,i,p,t,_,l);var b=ay();return i.flags|=1,typeof _=="object"&&_!==null&&typeof _.render=="function"&&_.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,ei(p)?(b=!0,Kd(i)):b=!1,i.memoizedState=_.state!==null&&_.state!==void 0?_.state:null,ty(i),_.updater=bp,i.stateNode=_,_._reactInternals=i,tg(i,p,t,l),i=ig(null,i,p,!0,b,l)):(i.tag=0,cr&&b&&Hg(i),Bn(null,i,_,l),i=i.child),i;case 16:p=i.elementType;e:{switch(zd(t,i),t=i.pendingProps,_=p._init,p=_(p._payload),i.type=p,_=i.tag=uk(p),t=Ki(p,t),_){case 0:i=ng(null,i,p,t,l);break e;case 1:i=d0(null,i,p,t,l);break e;case 11:i=c0(null,i,p,t,l);break e;case 14:i=h0(null,i,p,Ki(p.type,t),l);break e}throw Error(Fe(306,p,""))}return i;case 0:return p=i.type,_=i.pendingProps,_=i.elementType===p?_:Ki(p,_),ng(t,i,p,_,l);case 1:return p=i.type,_=i.pendingProps,_=i.elementType===p?_:Ki(p,_),d0(t,i,p,_,l);case 3:e:{if(q1(i),t===null)throw Error(Fe(387));p=i.pendingProps,b=i.memoizedState,_=b.element,f1(t,i),tp(i,p,null,l);var I=i.memoizedState;if(p=I.element,b.isDehydrated)if(b={element:p,isDehydrated:!1,cache:I.cache,pendingSuspenseBoundaries:I.pendingSuspenseBoundaries,transitions:I.transitions},i.updateQueue.baseState=b,i.memoizedState=b,i.flags&256){_=ql(Error(Fe(423)),i),i=p0(t,i,p,l,_);break e}else if(p!==_){_=ql(Error(Fe(424)),i),i=p0(t,i,p,l,_);break e}else for(ci=Ro(i.stateNode.containerInfo.firstChild),di=i,cr=!0,Qi=null,l=_1(i,null,p,l),i.child=l;l;)l.flags=l.flags&-3|4096,l=l.sibling;else{if(Ul(),p===_){i=Qs(t,i,l);break e}Bn(t,i,p,l)}i=i.child}return i;case 5:return v1(i),t===null&&Qm(i),p=i.type,_=i.pendingProps,b=t!==null?t.memoizedProps:null,I=_.children,Wm(p,_)?I=null:b!==null&&Wm(p,b)&&(i.flags|=32),$1(t,i),Bn(t,i,I,l),i.child;case 6:return t===null&&Qm(i),null;case 13:return Z1(t,i,l);case 4:return ry(i,i.stateNode.containerInfo),p=i.pendingProps,t===null?i.child=jl(i,null,p,l):Bn(t,i,p,l),i.child;case 11:return p=i.type,_=i.pendingProps,_=i.elementType===p?_:Ki(p,_),c0(t,i,p,_,l);case 7:return Bn(t,i,i.pendingProps,l),i.child;case 8:return Bn(t,i,i.pendingProps.children,l),i.child;case 12:return Bn(t,i,i.pendingProps.children,l),i.child;case 10:e:{if(p=i.type._context,_=i.pendingProps,b=i.memoizedProps,I=_.value,Jt(Jd,p._currentValue),p._currentValue=I,b!==null)if(ns(b.value,I)){if(b.children===_.children&&!Jn.current){i=Qs(t,i,l);break e}}else for(b=i.child,b!==null&&(b.return=i);b!==null;){var u=b.dependencies;if(u!==null){I=b.child;for(var B=u.firstContext;B!==null;){if(B.context===p){if(b.tag===1){B=Hs(-1,l&-l),B.tag=2;var D=b.updateQueue;if(D!==null){D=D.shared;var ne=D.pending;ne===null?B.next=B:(B.next=ne.next,ne.next=B),D.pending=B}}b.lanes|=l,B=b.alternate,B!==null&&(B.lanes|=l),Jm(b.return,l,i),u.lanes|=l;break}B=B.next}}else if(b.tag===10)I=b.type===i.type?null:b.child;else if(b.tag===18){if(I=b.return,I===null)throw Error(Fe(341));I.lanes|=l,u=I.alternate,u!==null&&(u.lanes|=l),Jm(I,l,i),I=b.sibling}else I=b.child;if(I!==null)I.return=b;else for(I=b;I!==null;){if(I===i){I=null;break}if(b=I.sibling,b!==null){b.return=I.return,I=b;break}I=I.return}b=I}Bn(t,i,_.children,l),i=i.child}return i;case 9:return _=i.type,p=i.pendingProps.children,Bl(i,l),_=Di(_),p=p(_),i.flags|=1,Bn(t,i,p,l),i.child;case 14:return p=i.type,_=Ki(p,i.pendingProps),_=Ki(p.type,_),h0(t,i,p,_,l);case 15:return U1(t,i,i.type,i.pendingProps,l);case 17:return p=i.type,_=i.pendingProps,_=i.elementType===p?_:Ki(p,_),zd(t,i),i.tag=1,ei(p)?(t=!0,Kd(i)):t=!1,Bl(i,l),g1(i,p,_),tg(i,p,_,l),ig(null,i,p,!0,t,l);case 19:return G1(t,i,l);case 22:return j1(t,i,l)}throw Error(Fe(156,i.tag))};function lw(t,i){return Lx(t,i)}function lk(t,i,l,p){this.tag=t,this.key=l,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=p,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Mi(t,i,l,p){return new lk(t,i,l,p)}function yy(t){return t=t.prototype,!(!t||!t.isReactComponent)}function uk(t){if(typeof t=="function")return yy(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Fg)return 11;if(t===Bg)return 14}return 2}function No(t,i){var l=t.alternate;return l===null?(l=Mi(t.tag,i,t.key,t.mode),l.elementType=t.elementType,l.type=t.type,l.stateNode=t.stateNode,l.alternate=t,t.alternate=l):(l.pendingProps=i,l.type=t.type,l.flags=0,l.subtreeFlags=0,l.deletions=null),l.flags=t.flags&14680064,l.childLanes=t.childLanes,l.lanes=t.lanes,l.child=t.child,l.memoizedProps=t.memoizedProps,l.memoizedState=t.memoizedState,l.updateQueue=t.updateQueue,i=t.dependencies,l.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},l.sibling=t.sibling,l.index=t.index,l.ref=t.ref,l}function Dd(t,i,l,p,_,b){var I=2;if(p=t,typeof t=="function")yy(t)&&(I=1);else if(typeof t=="string")I=5;else e:switch(t){case bl:return ka(l.children,_,b,i);case Rg:I=8,_|=8;break;case km:return t=Mi(12,l,i,_|2),t.elementType=km,t.lanes=b,t;case Em:return t=Mi(13,l,i,_),t.elementType=Em,t.lanes=b,t;case Im:return t=Mi(19,l,i,_),t.elementType=Im,t.lanes=b,t;case yx:return Ep(l,_,b,i);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case mx:I=10;break e;case gx:I=9;break e;case Fg:I=11;break e;case Bg:I=14;break e;case Eo:I=16,p=null;break e}throw Error(Fe(130,t==null?t:typeof t,""))}return i=Mi(I,l,i,_),i.elementType=t,i.type=p,i.lanes=b,i}function ka(t,i,l,p){return t=Mi(7,t,p,i),t.lanes=l,t}function Ep(t,i,l,p){return t=Mi(22,t,p,i),t.elementType=yx,t.lanes=l,t.stateNode={isHidden:!1},t}function mm(t,i,l){return t=Mi(6,t,null,i),t.lanes=l,t}function gm(t,i,l){return i=Mi(4,t.children!==null?t.children:[],t.key,i),i.lanes=l,i.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},i}function ck(t,i,l,p,_){this.tag=i,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Kf(0),this.expirationTimes=Kf(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Kf(0),this.identifierPrefix=p,this.onRecoverableError=_,this.mutableSourceEagerHydrationData=null}function _y(t,i,l,p,_,b,I,u,B){return t=new ck(t,i,l,u,B),i===1?(i=1,b===!0&&(i|=8)):i=0,b=Mi(3,null,null,i),t.current=b,b.stateNode=t,b.memoizedState={element:p,isDehydrated:l,cache:null,transitions:null,pendingSuspenseBoundaries:null},ty(b),t}function hk(t,i,l){var p=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wl,key:p==null?null:""+p,children:t,containerInfo:i,implementation:l}}function uw(t){if(!t)return jo;t=t._reactInternals;e:{if(Da(t)!==t||t.tag!==1)throw Error(Fe(170));var i=t;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(ei(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(Fe(171))}if(t.tag===1){var l=t.type;if(ei(l))return l1(t,l,i)}return i}function cw(t,i,l,p,_,b,I,u,B){return t=_y(l,p,!0,t,_,b,I,u,B),t.context=uw(null),l=t.current,p=On(),_=Oo(l),b=Hs(p,_),b.callback=i??null,Fo(l,b,_),t.current.lanes=_,Zc(t,_,p),ti(t,p),t}function Ip(t,i,l,p){var _=i.current,b=On(),I=Oo(_);return l=uw(l),i.context===null?i.context=l:i.pendingContext=l,i=Hs(b,I),i.payload={element:t},p=p===void 0?null:p,p!==null&&(i.callback=p),t=Fo(_,i,I),t!==null&&(ts(t,_,I,b),Id(t,_,I)),I}function up(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function S0(t,i){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var l=t.retryLane;t.retryLane=l!==0&&l<i?l:i}}function vy(t,i){S0(t,i),(t=t.alternate)&&S0(t,i)}function dk(){return null}var hw=typeof reportError=="function"?reportError:function(t){console.error(t)};function xy(t){this._internalRoot=t}Cp.prototype.render=xy.prototype.render=function(t){var i=this._internalRoot;if(i===null)throw Error(Fe(409));Ip(t,i,null,null)};Cp.prototype.unmount=xy.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var i=t.containerInfo;za(function(){Ip(null,t,null,null)}),i[Ks]=null}};function Cp(t){this._internalRoot=t}Cp.prototype.unstable_scheduleHydration=function(t){if(t){var i=Ux();t={blockedOn:null,target:t,priority:i};for(var l=0;l<Co.length&&i!==0&&i<Co[l].priority;l++);Co.splice(l,0,t),l===0&&$x(t)}};function wy(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Pp(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function T0(){}function pk(t,i,l,p,_){if(_){if(typeof p=="function"){var b=p;p=function(){var D=up(I);b.call(D)}}var I=cw(i,p,t,0,null,!1,!1,"",T0);return t._reactRootContainer=I,t[Ks]=I.current,Ac(t.nodeType===8?t.parentNode:t),za(),I}for(;_=t.lastChild;)t.removeChild(_);if(typeof p=="function"){var u=p;p=function(){var D=up(B);u.call(D)}}var B=_y(t,0,!1,null,null,!1,!1,"",T0);return t._reactRootContainer=B,t[Ks]=B.current,Ac(t.nodeType===8?t.parentNode:t),za(function(){Ip(i,B,l,p)}),B}function zp(t,i,l,p,_){var b=l._reactRootContainer;if(b){var I=b;if(typeof _=="function"){var u=_;_=function(){var B=up(I);u.call(B)}}Ip(i,I,t,_)}else I=pk(l,i,t,_,p);return up(I)}Nx=function(t){switch(t.tag){case 3:var i=t.stateNode;if(i.current.memoizedState.isDehydrated){var l=dc(i.pendingLanes);l!==0&&(Vg(i,l|1),ti(i,zr()),!(Dt&6)&&(Zl=zr()+500,Wo()))}break;case 13:za(function(){var p=Ys(t,1);if(p!==null){var _=On();ts(p,t,1,_)}}),vy(t,1)}};Ug=function(t){if(t.tag===13){var i=Ys(t,134217728);if(i!==null){var l=On();ts(i,t,134217728,l)}vy(t,134217728)}};Vx=function(t){if(t.tag===13){var i=Oo(t),l=Ys(t,i);if(l!==null){var p=On();ts(l,t,i,p)}vy(t,i)}};Ux=function(){return $t};jx=function(t,i){var l=$t;try{return $t=t,i()}finally{$t=l}};Bm=function(t,i,l){switch(i){case"input":if(zm(t,l),i=l.name,l.type==="radio"&&i!=null){for(l=t;l.parentNode;)l=l.parentNode;for(l=l.querySelectorAll("input[name="+JSON.stringify(""+i)+'][type="radio"]'),i=0;i<l.length;i++){var p=l[i];if(p!==t&&p.form===t.form){var _=xp(p);if(!_)throw Error(Fe(90));vx(p),zm(p,_)}}}break;case"textarea":wx(t,l);break;case"select":i=l.value,i!=null&&Dl(t,!!l.multiple,i,!1)}};Cx=fy;Px=za;var fk={usingClientEntryPoint:!1,Events:[Wc,El,xp,Ex,Ix,fy]},uc={findFiberByHostInstance:xa,bundleType:0,version:"18.2.0",rendererPackageName:"react-dom"},mk={bundleType:uc.bundleType,version:uc.version,rendererPackageName:uc.rendererPackageName,rendererConfig:uc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:eo.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=Ax(t),t===null?null:t.stateNode},findFiberByHostInstance:uc.findFiberByHostInstance||dk,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0-next-9e3b772b8-20220608"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vd.isDisabled&&vd.supportsFiber)try{gp=vd.inject(mk),ws=vd}catch{}}gi.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=fk;gi.createPortal=function(t,i){var l=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!wy(i))throw Error(Fe(200));return hk(t,i,null,l)};gi.createRoot=function(t,i){if(!wy(t))throw Error(Fe(299));var l=!1,p="",_=hw;return i!=null&&(i.unstable_strictMode===!0&&(l=!0),i.identifierPrefix!==void 0&&(p=i.identifierPrefix),i.onRecoverableError!==void 0&&(_=i.onRecoverableError)),i=_y(t,1,!1,null,null,l,!1,p,_),t[Ks]=i.current,Ac(t.nodeType===8?t.parentNode:t),new xy(i)};gi.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var i=t._reactInternals;if(i===void 0)throw typeof t.render=="function"?Error(Fe(188)):(t=Object.keys(t).join(","),Error(Fe(268,t)));return t=Ax(i),t=t===null?null:t.stateNode,t};gi.flushSync=function(t){return za(t)};gi.hydrate=function(t,i,l){if(!Pp(i))throw Error(Fe(200));return zp(null,t,i,!0,l)};gi.hydrateRoot=function(t,i,l){if(!wy(t))throw Error(Fe(405));var p=l!=null&&l.hydratedSources||null,_=!1,b="",I=hw;if(l!=null&&(l.unstable_strictMode===!0&&(_=!0),l.identifierPrefix!==void 0&&(b=l.identifierPrefix),l.onRecoverableError!==void 0&&(I=l.onRecoverableError)),i=cw(i,null,t,1,l??null,_,!1,b,I),t[Ks]=i.current,Ac(t),p)for(t=0;t<p.length;t++)l=p[t],_=l._getVersion,_=_(l._source),i.mutableSourceEagerHydrationData==null?i.mutableSourceEagerHydrationData=[l,_]:i.mutableSourceEagerHydrationData.push(l,_);return new Cp(i)};gi.render=function(t,i,l){if(!Pp(i))throw Error(Fe(200));return zp(null,t,i,!1,l)};gi.unmountComponentAtNode=function(t){if(!Pp(t))throw Error(Fe(40));return t._reactRootContainer?(za(function(){zp(null,null,t,!1,function(){t._reactRootContainer=null,t[Ks]=null})}),!0):!1};gi.unstable_batchedUpdates=fy;gi.unstable_renderSubtreeIntoContainer=function(t,i,l,p){if(!Pp(l))throw Error(Fe(200));if(t==null||t._reactInternals===void 0)throw Error(Fe(38));return zp(t,i,l,!1,p)};gi.version="18.2.0-next-9e3b772b8-20220608";function dw(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(dw)}catch(t){console.error(t)}}dw(),cx.exports=gi;var gk=cx.exports,k0=gk;Sm.createRoot=k0.createRoot,Sm.hydrateRoot=k0.hydrateRoot;var pw={exports:{}};(function(t,i){(function(l,p){t.exports=p()})(Z2,function(){var l,p,_;function b(u,B){if(!l)l=B;else if(!p)p=B;else{var D="var sharedChunk = {}; ("+l+")(sharedChunk); ("+p+")(sharedChunk);",ne={};l(ne),_=B(ne),typeof window<"u"&&(_.workerUrl=window.URL.createObjectURL(new Blob([D],{type:"text/javascript"})))}}b(["exports"],function(u){function B(n,e,s,a){return new(s||(s=Promise))(function(h,m){function y(k){try{S(a.next(k))}catch(C){m(C)}}function v(k){try{S(a.throw(k))}catch(C){m(C)}}function S(k){var C;k.done?h(k.value):(C=k.value,C instanceof s?C:new s(function(M){M(C)})).then(y,v)}S((a=a.apply(n,e||[])).next())})}function D(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}typeof SuppressedError=="function"&&SuppressedError;var ne=re;function re(n,e){this.x=n,this.y=e}re.prototype={clone:function(){return new re(this.x,this.y)},add:function(n){return this.clone()._add(n)},sub:function(n){return this.clone()._sub(n)},multByPoint:function(n){return this.clone()._multByPoint(n)},divByPoint:function(n){return this.clone()._divByPoint(n)},mult:function(n){return this.clone()._mult(n)},div:function(n){return this.clone()._div(n)},rotate:function(n){return this.clone()._rotate(n)},rotateAround:function(n,e){return this.clone()._rotateAround(n,e)},matMult:function(n){return this.clone()._matMult(n)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(n){return this.x===n.x&&this.y===n.y},dist:function(n){return Math.sqrt(this.distSqr(n))},distSqr:function(n){var e=n.x-this.x,s=n.y-this.y;return e*e+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(n){return Math.atan2(this.y-n.y,this.x-n.x)},angleWith:function(n){return this.angleWithSep(n.x,n.y)},angleWithSep:function(n,e){return Math.atan2(this.x*e-this.y*n,this.x*n+this.y*e)},_matMult:function(n){var e=n[2]*this.x+n[3]*this.y;return this.x=n[0]*this.x+n[1]*this.y,this.y=e,this},_add:function(n){return this.x+=n.x,this.y+=n.y,this},_sub:function(n){return this.x-=n.x,this.y-=n.y,this},_mult:function(n){return this.x*=n,this.y*=n,this},_div:function(n){return this.x/=n,this.y/=n,this},_multByPoint:function(n){return this.x*=n.x,this.y*=n.y,this},_divByPoint:function(n){return this.x/=n.x,this.y/=n.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var n=this.y;return this.y=this.x,this.x=-n,this},_rotate:function(n){var e=Math.cos(n),s=Math.sin(n),a=s*this.x+e*this.y;return this.x=e*this.x-s*this.y,this.y=a,this},_rotateAround:function(n,e){var s=Math.cos(n),a=Math.sin(n),h=e.y+a*(this.x-e.x)+s*(this.y-e.y);return this.x=e.x+s*(this.x-e.x)-a*(this.y-e.y),this.y=h,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},re.convert=function(n){return n instanceof re?n:Array.isArray(n)?new re(n[0],n[1]):n};var te=D(ne),_e=be;function be(n,e,s,a){this.cx=3*n,this.bx=3*(s-n)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*e,this.by=3*(a-e)-this.cy,this.ay=1-this.cy-this.by,this.p1x=n,this.p1y=e,this.p2x=s,this.p2y=a}be.prototype={sampleCurveX:function(n){return((this.ax*n+this.bx)*n+this.cx)*n},sampleCurveY:function(n){return((this.ay*n+this.by)*n+this.cy)*n},sampleCurveDerivativeX:function(n){return(3*this.ax*n+2*this.bx)*n+this.cx},solveCurveX:function(n,e){if(e===void 0&&(e=1e-6),n<0)return 0;if(n>1)return 1;for(var s=n,a=0;a<8;a++){var h=this.sampleCurveX(s)-n;if(Math.abs(h)<e)return s;var m=this.sampleCurveDerivativeX(s);if(Math.abs(m)<1e-6)break;s-=h/m}var y=0,v=1;for(s=n,a=0;a<20&&(h=this.sampleCurveX(s),!(Math.abs(h-n)<e));a++)n>h?y=s:v=s,s=.5*(v-y)+y;return s},solve:function(n,e){return this.sampleCurveY(this.solveCurveX(n,e))}};var ke=D(_e);let we,K;function ee(){return we==null&&(we=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")&&typeof createImageBitmap=="function"),we}function ce(){if(K==null&&(K=!1,ee())){const e=new OffscreenCanvas(5,5).getContext("2d",{willReadFrequently:!0});if(e){for(let a=0;a<5*5;a++){const h=4*a;e.fillStyle=`rgb(${h},${h+1},${h+2})`,e.fillRect(a%5,Math.floor(a/5),1,1)}const s=e.getImageData(0,0,5,5).data;for(let a=0;a<5*5*4;a++)if(a%4!=3&&s[a]!==a){K=!0;break}}}return K||!1}function ye(n,e,s,a){const h=new ke(n,e,s,a);return function(m){return h.solve(m)}}const Pe=ye(.25,.1,.25,1);function Le(n,e,s){return Math.min(s,Math.max(e,n))}function je(n,e,s){const a=s-e,h=((n-e)%a+a)%a+e;return h===e?s:h}function Ze(n,...e){for(const s of e)for(const a in s)n[a]=s[a];return n}let kt=1;function rt(n,e,s){const a={};for(const h in n)a[h]=e.call(s||this,n[h],h,n);return a}function Mr(n,e,s){const a={};for(const h in n)e.call(s||this,n[h],h,n)&&(a[h]=n[h]);return a}function Lr(n){return Array.isArray(n)?n.map(Lr):typeof n=="object"&&n?rt(n,Lr):n}const hn={};function Ar(n){hn[n]||(typeof console<"u"&&console.warn(n),hn[n]=!0)}function Qr(n,e,s){return(s.y-n.y)*(e.x-n.x)>(e.y-n.y)*(s.x-n.x)}function En(n){let e=0;for(let s,a,h=0,m=n.length,y=m-1;h<m;y=h++)s=n[h],a=n[y],e+=(a.x-s.x)*(s.y+a.y);return e}function $r(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}let He=null;function ht(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap}const mt="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";function Vt(n,e,s,a,h){return B(this,void 0,void 0,function*(){if(typeof VideoFrame>"u")throw new Error("VideoFrame not supported");const m=new VideoFrame(n,{timestamp:0});try{const y=m==null?void 0:m.format;if(!y||!y.startsWith("BGR")&&!y.startsWith("RGB"))throw new Error(`Unrecognized format ${y}`);const v=y.startsWith("BGR"),S=new Uint8ClampedArray(a*h*4);if(yield m.copyTo(S,function(k,C,M,L,O){const N=4*Math.max(-C,0),j=(Math.max(0,M)-M)*L*4+N,H=4*L,Q=Math.max(0,C),ue=Math.max(0,M);return{rect:{x:Q,y:ue,width:Math.min(k.width,C+L)-Q,height:Math.min(k.height,M+O)-ue},layout:[{offset:j,stride:H}]}}(n,e,s,a,h)),v)for(let k=0;k<S.length;k+=4){const C=S[k];S[k]=S[k+2],S[k+2]=C}return S}finally{m.close()}})}let Ft,At,or,ri;const dn={now:typeof performance<"u"&&performance&&performance.now?performance.now.bind(performance):Date.now.bind(Date),frame(n){const e=requestAnimationFrame(n);return{cancel:()=>cancelAnimationFrame(e)}},getImageData(n,e=0){return this.getImageCanvasContext(n).getImageData(-e,-e,n.width+2*e,n.height+2*e)},getImageCanvasContext(n){const e=window.document.createElement("canvas"),s=e.getContext("2d",{willReadFrequently:!0});if(!s)throw new Error("failed to create canvas 2d context");return e.width=n.width,e.height=n.height,s.drawImage(n,0,0,n.width,n.height),s},resolveURL:n=>(or||(or=document.createElement("a")),or.href=n,or.href),hardwareConcurrency:typeof navigator<"u"&&navigator.hardwareConcurrency||4,get prefersReducedMotion(){return!!matchMedia&&(ri==null&&(ri=matchMedia("(prefers-reduced-motion: reduce)")),ri.matches)}},ni={MAX_PARALLEL_IMAGE_REQUESTS:16,MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:8,MAX_TILE_CACHE_ZOOM_LEVELS:5,REGISTERED_PROTOCOLS:{},WORKER_URL:""};class is extends Error{constructor(e,s,a,h){super(`AJAXError: ${s} (${e}): ${a}`),this.status=e,this.statusText=s,this.url=a,this.body=h}}const ii=$r()?()=>self.worker&&self.worker.referrer:()=>(window.location.protocol==="blob:"?window.parent:window).location.href,Un=n=>ni.REGISTERED_PROTOCOLS[n.substring(0,n.indexOf("://"))];function Ho(n,e){const s=new AbortController,a=new Request(n.url,{method:n.method||"GET",body:n.body,credentials:n.credentials,headers:n.headers,cache:n.cache,referrer:ii(),signal:s.signal});let h=!1,m=!1;return n.type==="json"&&a.headers.set("Accept","application/json"),m||fetch(a).then(y=>y.ok?(v=>{(n.type==="arrayBuffer"||n.type==="image"?v.arrayBuffer():n.type==="json"?v.json():v.text()).then(S=>{m||(h=!0,e(null,S,v.headers.get("Cache-Control"),v.headers.get("Expires")))}).catch(S=>{m||e(new Error(S.message))})})(y):y.blob().then(v=>e(new is(y.status,y.statusText,n.url,v)))).catch(y=>{y.code!==20&&e(new Error(y.message))}),{cancel:()=>{m=!0,h||s.abort()}}}const ss=function(n,e){if(/:\/\//.test(n.url)&&!/^https?:|^file:/.test(n.url)){if($r()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,e);if(!$r())return(Un(n.url)||Ho)(n,e)}if(!(/^file:/.test(s=n.url)||/^file:/.test(ii())&&!/^\w+:/.test(s))){if(fetch&&Request&&AbortController&&Object.prototype.hasOwnProperty.call(Request.prototype,"signal"))return Ho(n,e);if($r()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",n,e,void 0,!0)}var s;return function(a,h){const m=new XMLHttpRequest;m.open(a.method||"GET",a.url,!0),a.type!=="arrayBuffer"&&a.type!=="image"||(m.responseType="arraybuffer");for(const y in a.headers)m.setRequestHeader(y,a.headers[y]);return a.type==="json"&&(m.responseType="text",m.setRequestHeader("Accept","application/json")),m.withCredentials=a.credentials==="include",m.onerror=()=>{h(new Error(m.statusText))},m.onload=()=>{if((m.status>=200&&m.status<300||m.status===0)&&m.response!==null){let y=m.response;if(a.type==="json")try{y=JSON.parse(m.response)}catch(v){return h(v)}h(null,y,m.getResponseHeader("Cache-Control"),m.getResponseHeader("Expires"))}else{const y=new Blob([m.response],{type:m.getResponseHeader("Content-Type")});h(new is(m.status,m.statusText,a.url,y))}},m.send(a.body),{cancel:()=>m.abort()}}(n,e)},Xo=function(n,e){return ss(Ze(n,{type:"arrayBuffer"}),e)};function Ri(n){if(!n||n.indexOf("://")<=0||n.indexOf("data:image/")===0||n.indexOf("blob:")===0)return!0;const e=new URL(n),s=window.location;return e.protocol===s.protocol&&e.host===s.host}function to(n,e,s){s[n]&&s[n].indexOf(e)!==-1||(s[n]=s[n]||[],s[n].push(e))}function Ss(n,e,s){if(s&&s[n]){const a=s[n].indexOf(e);a!==-1&&s[n].splice(a,1)}}class os{constructor(e,s={}){Ze(this,s),this.type=e}}class as extends os{constructor(e,s={}){super("error",Ze({error:e},s))}}class Ts{on(e,s){return this._listeners=this._listeners||{},to(e,s,this._listeners),this}off(e,s){return Ss(e,s,this._listeners),Ss(e,s,this._oneTimeListeners),this}once(e,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},to(e,s,this._oneTimeListeners),this):new Promise(a=>this.once(e,a))}fire(e,s){typeof e=="string"&&(e=new os(e,s||{}));const a=e.type;if(this.listens(a)){e.target=this;const h=this._listeners&&this._listeners[a]?this._listeners[a].slice():[];for(const v of h)v.call(this,e);const m=this._oneTimeListeners&&this._oneTimeListeners[a]?this._oneTimeListeners[a].slice():[];for(const v of m)Ss(a,v,this._oneTimeListeners),v.call(this,e);const y=this._eventedParent;y&&(Ze(e,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),y.fire(e))}else e instanceof as&&console.error(e.error);return this}listens(e){return this._listeners&&this._listeners[e]&&this._listeners[e].length>0||this._oneTimeListeners&&this._oneTimeListeners[e]&&this._oneTimeListeners[e].length>0||this._eventedParent&&this._eventedParent.listens(e)}setEventedParent(e,s){return this._eventedParent=e,this._eventedParentData=s,this}}var ve={$version:8,$root:{version:{required:!0,type:"enum",values:[8]},name:{type:"string"},metadata:{type:"*"},center:{type:"array",value:"number"},zoom:{type:"number"},bearing:{type:"number",default:0,period:360,units:"degrees"},pitch:{type:"number",default:0,units:"degrees"},light:{type:"light"},terrain:{type:"terrain"},sources:{required:!0,type:"sources"},sprite:{type:"sprite"},glyphs:{type:"string"},transition:{type:"transition"},layers:{required:!0,type:"array",value:"layer"}},sources:{"*":{type:"source"}},source:["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],source_vector:{type:{required:!0,type:"enum",values:{vector:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},attribution:{type:"string"},promoteId:{type:"promoteId"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster:{type:{required:!0,type:"enum",values:{raster:{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},scheme:{type:"enum",values:{xyz:{},tms:{}},default:"xyz"},attribution:{type:"string"},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_raster_dem:{type:{required:!0,type:"enum",values:{"raster-dem":{}}},url:{type:"string"},tiles:{type:"array",value:"string"},bounds:{type:"array",value:"number",length:4,default:[-180,-85.051129,180,85.051129]},minzoom:{type:"number",default:0},maxzoom:{type:"number",default:22},tileSize:{type:"number",default:512,units:"pixels"},attribution:{type:"string"},encoding:{type:"enum",values:{terrarium:{},mapbox:{},custom:{}},default:"mapbox"},redFactor:{type:"number",default:1},blueFactor:{type:"number",default:1},greenFactor:{type:"number",default:1},baseShift:{type:"number",default:0},volatile:{type:"boolean",default:!1},"*":{type:"*"}},source_geojson:{type:{required:!0,type:"enum",values:{geojson:{}}},data:{required:!0,type:"*"},maxzoom:{type:"number",default:18},attribution:{type:"string"},buffer:{type:"number",default:128,maximum:512,minimum:0},filter:{type:"*"},tolerance:{type:"number",default:.375},cluster:{type:"boolean",default:!1},clusterRadius:{type:"number",default:50,minimum:0},clusterMaxZoom:{type:"number"},clusterMinPoints:{type:"number"},clusterProperties:{type:"*"},lineMetrics:{type:"boolean",default:!1},generateId:{type:"boolean",default:!1},promoteId:{type:"promoteId"}},source_video:{type:{required:!0,type:"enum",values:{video:{}}},urls:{required:!0,type:"array",value:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},source_image:{type:{required:!0,type:"enum",values:{image:{}}},url:{required:!0,type:"string"},coordinates:{required:!0,type:"array",length:4,value:{type:"array",length:2,value:"number"}}},layer:{id:{type:"string",required:!0},type:{type:"enum",values:{fill:{},line:{},symbol:{},circle:{},heatmap:{},"fill-extrusion":{},raster:{},hillshade:{},background:{}},required:!0},metadata:{type:"*"},source:{type:"string"},"source-layer":{type:"string"},minzoom:{type:"number",minimum:0,maximum:24},maxzoom:{type:"number",minimum:0,maximum:24},filter:{type:"filter"},layout:{type:"layout"},paint:{type:"paint"}},layout:["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background"],layout_background:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_fill:{"fill-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_circle:{"circle-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_heatmap:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},"layout_fill-extrusion":{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_line:{"line-cap":{type:"enum",values:{butt:{},round:{},square:{}},default:"butt",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-join":{type:"enum",values:{bevel:{},round:{},miter:{}},default:"miter",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{type:"number",default:2,requires:[{"line-join":"miter"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-round-limit":{type:"number",default:1.05,requires:[{"line-join":"round"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_symbol:{"symbol-placement":{type:"enum",values:{point:{},line:{},"line-center":{}},default:"point",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-spacing":{type:"number",default:250,minimum:1,units:"pixels",requires:[{"symbol-placement":"line"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{type:"boolean",default:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{type:"number",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{type:"enum",values:{auto:{},"viewport-y":{},source:{}},default:"auto",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{type:"boolean",default:!1,requires:["icon-image",{"!":"icon-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{type:"boolean",default:!1,requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-optional":{type:"boolean",default:!1,requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-size":{type:"number",default:1,minimum:0,units:"factor of the original icon size",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{type:"enum",values:{none:{},width:{},height:{},both:{}},default:"none",requires:["icon-image","text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{type:"array",value:"number",length:4,default:[0,0,0,0],units:"pixels",requires:["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-image":{type:"resolvedImage",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{type:"padding",default:[2],units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-keep-upright":{type:"boolean",default:!1,requires:["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"icon-offset":{type:"array",value:"number",length:2,default:[0,0],requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{type:"enum",values:{map:{},viewport:{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{type:"enum",values:{map:{},viewport:{},"viewport-glyph":{},auto:{}},default:"auto",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-field":{type:"formatted",default:"",tokens:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-font":{type:"array",value:"string",default:["Open Sans Regular","Arial Unicode MS Regular"],requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-size":{type:"number",default:16,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{type:"number",default:10,minimum:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{type:"number",default:1.2,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-letter-spacing":{type:"number",default:0,units:"ems",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-justify":{type:"enum",values:{auto:{},left:{},center:{},right:{}},default:"center",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{type:"number",units:"ems",default:0,requires:["text-field"],"property-type":"data-driven",expression:{interpolated:!0,parameters:["zoom","feature"]}},"text-variable-anchor":{type:"array",value:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-variable-anchor-offset":{type:"variableAnchorOffsetCollection",requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-anchor":{type:"enum",values:{center:{},left:{},right:{},top:{},bottom:{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},default:"center",requires:["text-field",{"!":"text-variable-anchor"}],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{type:"number",default:45,units:"degrees",requires:["text-field",{"symbol-placement":["line","line-center"]}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-writing-mode":{type:"array",value:"enum",values:{horizontal:{},vertical:{}},requires:["text-field",{"symbol-placement":["point"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-rotate":{type:"number",default:0,period:360,units:"degrees",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-padding":{type:"number",default:2,minimum:0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-keep-upright":{type:"boolean",default:!0,requires:["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-transform":{type:"enum",values:{none:{},uppercase:{},lowercase:{}},default:"none",requires:["text-field"],expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-offset":{type:"array",value:"number",units:"ems",length:2,default:[0,0],requires:["text-field",{"!":"text-radial-offset"}],expression:{interpolated:!0,parameters:["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{type:"boolean",default:!1,requires:["text-field",{"!":"text-overlap"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-overlap":{type:"enum",values:{never:{},always:{},cooperative:{}},requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{type:"boolean",default:!1,requires:["text-field"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-optional":{type:"boolean",default:!1,requires:["text-field","icon-image"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_raster:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},layout_hillshade:{visibility:{type:"enum",values:{visible:{},none:{}},default:"visible","property-type":"constant"}},filter:{type:"array",value:"*"},filter_operator:{type:"enum",values:{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},in:{},"!in":{},all:{},any:{},none:{},has:{},"!has":{},within:{}}},geometry_type:{type:"enum",values:{Point:{},LineString:{},Polygon:{}}},function:{expression:{type:"expression"},stops:{type:"array",value:"function_stop"},base:{type:"number",default:1,minimum:0},property:{type:"string",default:"$zoom"},type:{type:"enum",values:{identity:{},exponential:{},interval:{},categorical:{}},default:"exponential"},colorSpace:{type:"enum",values:{rgb:{},lab:{},hcl:{}},default:"rgb"},default:{type:"*",required:!1}},function_stop:{type:"array",minimum:0,maximum:24,value:["number","color"],length:2},expression:{type:"array",value:"*",minimum:1},light:{anchor:{type:"enum",default:"viewport",values:{map:{},viewport:{}},"property-type":"data-constant",transition:!1,expression:{interpolated:!1,parameters:["zoom"]}},position:{type:"array",default:[1.15,210,30],length:3,value:"number","property-type":"data-constant",transition:!0,expression:{interpolated:!0,parameters:["zoom"]}},color:{type:"color","property-type":"data-constant",default:"#ffffff",expression:{interpolated:!0,parameters:["zoom"]},transition:!0},intensity:{type:"number","property-type":"data-constant",default:.5,minimum:0,maximum:1,expression:{interpolated:!0,parameters:["zoom"]},transition:!0}},terrain:{source:{type:"string",required:!0},exaggeration:{type:"number",minimum:0,default:1}},paint:["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background"],paint_fill:{"fill-antialias":{type:"boolean",default:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{type:"color",transition:!0,requires:[{"!":"fill-pattern"},{"fill-antialias":!0}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"fill-extrusion-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["fill-extrusion-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"fill-extrusion-height":{type:"number",default:0,minimum:0,units:"meters",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{type:"number",default:0,minimum:0,units:"meters",transition:!0,requires:["fill-extrusion-height"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{type:"boolean",default:!0,transition:!1,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_line:{"line-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"line-pattern"}],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["line-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"line-width":{type:"number",default:1,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{type:"number",default:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{type:"array",value:"number",minimum:0,transition:!0,units:"line widths",requires:[{"!":"line-pattern"}],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"line-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"cross-faded-data-driven"},"line-gradient":{type:"color",transition:!1,requires:[{"!":"line-dasharray"},{"!":"line-pattern"},{source:"geojson",has:{lineMetrics:!0}}],expression:{interpolated:!0,parameters:["line-progress"]},"property-type":"color-ramp"}},paint_circle:{"circle-radius":{type:"number",default:5,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{type:"number",default:0,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["circle-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{type:"enum",values:{map:{},viewport:{}},default:"map",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"}},paint_heatmap:{"heatmap-radius":{type:"number",default:30,minimum:1,transition:!0,units:"pixels",expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{type:"number",default:1,minimum:0,transition:!1,expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{type:"number",default:1,minimum:0,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"heatmap-color":{type:"color",default:["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"],transition:!1,expression:{interpolated:!0,parameters:["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_symbol:{"icon-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{type:"color",default:"#000000",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["icon-image"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["icon-image","icon-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"text-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{type:"color",default:"#000000",transition:!0,overridable:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{type:"color",default:"rgba(0, 0, 0, 0)",transition:!0,requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{type:"number",default:0,minimum:0,transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{type:"array",value:"number",length:2,default:[0,0],transition:!0,units:"pixels",requires:["text-field"],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{type:"enum",values:{map:{},viewport:{}},default:"map",requires:["text-field","text-translate"],expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"}},paint_raster:{"raster-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{type:"number",default:0,period:360,transition:!0,units:"degrees",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{type:"number",default:0,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-saturation":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-contrast":{type:"number",default:0,minimum:-1,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"raster-resampling":{type:"enum",values:{linear:{},nearest:{}},default:"linear",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{type:"number",default:300,minimum:0,transition:!1,units:"milliseconds",expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_hillshade:{"hillshade-illumination-direction":{type:"number",default:335,minimum:0,maximum:359,transition:!1,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{type:"enum",values:{map:{},viewport:{}},default:"viewport",expression:{interpolated:!1,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{type:"number",default:.5,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{type:"color",default:"#FFFFFF",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{type:"color",default:"#000000",transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},paint_background:{"background-color":{type:"color",default:"#000000",transition:!0,requires:[{"!":"background-pattern"}],expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"},"background-pattern":{type:"resolvedImage",transition:!0,expression:{interpolated:!1,parameters:["zoom"]},"property-type":"cross-faded"},"background-opacity":{type:"number",default:1,minimum:0,maximum:1,transition:!0,expression:{interpolated:!0,parameters:["zoom"]},"property-type":"data-constant"}},transition:{duration:{type:"number",default:300,minimum:0,units:"milliseconds"},delay:{type:"number",default:0,minimum:0,units:"milliseconds"}},"property-type":{"data-driven":{type:"property-type"},"cross-faded":{type:"property-type"},"cross-faded-data-driven":{type:"property-type"},"color-ramp":{type:"property-type"},"data-constant":{type:"property-type"},constant:{type:"property-type"}},promoteId:{"*":{type:"string"}}};const pn=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function jn(n,e){const s={};for(const a in n)a!=="ref"&&(s[a]=n[a]);return pn.forEach(a=>{a in e&&(s[a]=e[a])}),s}function Nt(n,e){if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let s=0;s<n.length;s++)if(!Nt(n[s],e[s]))return!1;return!0}if(typeof n=="object"&&n!==null&&e!==null){if(typeof e!="object"||Object.keys(n).length!==Object.keys(e).length)return!1;for(const s in n)if(!Nt(n[s],e[s]))return!1;return!0}return n===e}const Et={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight"};function _i(n,e,s){s.push({command:Et.addSource,args:[n,e[n]]})}function ro(n,e,s){e.push({command:Et.removeSource,args:[n]}),s[n]=!0}function Fi(n,e,s,a){ro(n,s,a),_i(n,e,s)}function La(n,e,s){let a;for(a in n[s])if(Object.prototype.hasOwnProperty.call(n[s],a)&&a!=="data"&&!Nt(n[s][a],e[s][a]))return!1;for(a in e[s])if(Object.prototype.hasOwnProperty.call(e[s],a)&&a!=="data"&&!Nt(n[s][a],e[s][a]))return!1;return!0}function no(n,e,s,a,h,m){let y;for(y in e=e||{},n=n||{})Object.prototype.hasOwnProperty.call(n,y)&&(Nt(n[y],e[y])||s.push({command:m,args:[a,y,e[y],h]}));for(y in e)Object.prototype.hasOwnProperty.call(e,y)&&!Object.prototype.hasOwnProperty.call(n,y)&&(Nt(n[y],e[y])||s.push({command:m,args:[a,y,e[y],h]}))}function ls(n){return n.id}function ks(n,e){return n[e.id]=e,n}class Re{constructor(e,s,a,h){this.message=(e?`${e}: `:"")+a,h&&(this.identifier=h),s!=null&&s.__line__&&(this.line=s.__line__)}}function vi(n,...e){for(const s of e)for(const a in s)n[a]=s[a];return n}class er extends Error{constructor(e,s){super(s),this.message=s,this.key=e}}class Es{constructor(e,s=[]){this.parent=e,this.bindings={};for(const[a,h]of s)this.bindings[a]=h}concat(e){return new Es(this,e)}get(e){if(this.bindings[e])return this.bindings[e];if(this.parent)return this.parent.get(e);throw new Error(`${e} not found in scope.`)}has(e){return!!this.bindings[e]||!!this.parent&&this.parent.has(e)}}const Bi={kind:"null"},Oe={kind:"number"},ft={kind:"string"},ut={kind:"boolean"},Jr={kind:"color"},xi={kind:"object"},dt={kind:"value"},Oi={kind:"collator"},Z={kind:"formatted"},A={kind:"padding"},R={kind:"resolvedImage"},V={kind:"variableAnchorOffsetCollection"};function W(n,e){return{kind:"array",itemType:n,N:e}}function X(n){if(n.kind==="array"){const e=X(n.itemType);return typeof n.N=="number"?`array<${e}, ${n.N}>`:n.itemType.kind==="value"?"array":`array<${e}>`}return n.kind}const he=[Bi,Oe,ft,ut,Jr,Z,xi,W(dt),A,R,V];function se(n,e){if(e.kind==="error")return null;if(n.kind==="array"){if(e.kind==="array"&&(e.N===0&&e.itemType.kind==="value"||!se(n.itemType,e.itemType))&&(typeof n.N!="number"||n.N===e.N))return null}else{if(n.kind===e.kind)return null;if(n.kind==="value"){for(const s of he)if(!se(s,e))return null}}return`Expected ${X(n)} but found ${X(e)} instead.`}function J(n,e){return e.some(s=>s.kind===n.kind)}function le(n,e){return e.some(s=>s==="null"?n===null:s==="array"?Array.isArray(n):s==="object"?n&&!Array.isArray(n)&&typeof n=="object":s===typeof n)}function xe(n,e){return n.kind==="array"&&e.kind==="array"?n.itemType.kind===e.itemType.kind&&typeof n.N=="number":n.kind===e.kind}const Se=.96422,Ie=.82521,nt=4/29,lt=6/29,Xe=3*lt*lt,st=lt*lt*lt,ct=Math.PI/180,Mt=180/Math.PI;function Bt(n){return(n%=360)<0&&(n+=360),n}function Tt([n,e,s,a]){let h,m;const y=qr((.2225045*(n=St(n))+.7168786*(e=St(e))+.0606169*(s=St(s)))/1);n===e&&e===s?h=m=y:(h=qr((.4360747*n+.3850649*e+.1430804*s)/Se),m=qr((.0139322*n+.0971045*e+.7141733*s)/Ie));const v=116*y-16;return[v<0?0:v,500*(h-y),200*(y-m),a]}function St(n){return n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4)}function qr(n){return n>st?Math.pow(n,1/3):n/Xe+nt}function Ut([n,e,s,a]){let h=(n+16)/116,m=isNaN(e)?h:h+e/500,y=isNaN(s)?h:h-s/200;return h=1*Rr(h),m=Se*Rr(m),y=Ie*Rr(y),[_r(3.1338561*m-1.6168667*h-.4906146*y),_r(-.9787684*m+1.9161415*h+.033454*y),_r(.0719453*m-.2289914*h+1.4052427*y),a]}function _r(n){return(n=n<=.00304?12.92*n:1.055*Math.pow(n,1/2.4)-.055)<0?0:n>1?1:n}function Rr(n){return n>lt?n*n*n:Xe*(n-nt)}function $n(n){return parseInt(n.padEnd(2,n),16)/255}function Kc(n,e){return io(e?n/100:n,0,1)}function io(n,e,s){return Math.min(Math.max(e,n),s)}function so(n){return!n.some(Number.isNaN)}const Fp={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]};class Lt{constructor(e,s,a,h=1,m=!0){this.r=e,this.g=s,this.b=a,this.a=h,m||(this.r*=h,this.g*=h,this.b*=h,h||this.overwriteGetter("rgb",[e,s,a,h]))}static parse(e){if(e instanceof Lt)return e;if(typeof e!="string")return;const s=function(a){if((a=a.toLowerCase().trim())==="transparent")return[0,0,0,0];const h=Fp[a];if(h){const[y,v,S]=h;return[y/255,v/255,S/255,1]}if(a.startsWith("#")&&/^#(?:[0-9a-f]{3,4}|[0-9a-f]{6}|[0-9a-f]{8})$/.test(a)){const y=a.length<6?1:2;let v=1;return[$n(a.slice(v,v+=y)),$n(a.slice(v,v+=y)),$n(a.slice(v,v+=y)),$n(a.slice(v,v+y)||"ff")]}if(a.startsWith("rgb")){const y=a.match(/^rgba?\(\s*([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s+|\s*(,)\s*)([\de.+-]+)(%)?(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(y){const[v,S,k,C,M,L,O,N,j,H,Q,ue]=y,ie=[C||" ",O||" ",H].join("");if(ie==="  "||ie==="  /"||ie===",,"||ie===",,,"){const de=[k,L,j].join(""),fe=de==="%%%"?100:de===""?255:0;if(fe){const Ee=[io(+S/fe,0,1),io(+M/fe,0,1),io(+N/fe,0,1),Q?Kc(+Q,ue):1];if(so(Ee))return Ee}}return}}const m=a.match(/^hsla?\(\s*([\de.+-]+)(?:deg)?(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s+|\s*(,)\s*)([\de.+-]+)%(?:\s*([,\/])\s*([\de.+-]+)(%)?)?\s*\)$/);if(m){const[y,v,S,k,C,M,L,O,N]=m,j=[S||" ",C||" ",L].join("");if(j==="  "||j==="  /"||j===",,"||j===",,,"){const H=[+v,io(+k,0,100),io(+M,0,100),O?Kc(+O,N):1];if(so(H))return function([Q,ue,ie,de]){function fe(Ee){const qe=(Ee+Q/30)%12,Ye=ue*Math.min(ie,1-ie);return ie-Ye*Math.max(-1,Math.min(qe-3,9-qe,1))}return Q=Bt(Q),ue/=100,ie/=100,[fe(0),fe(8),fe(4),de]}(H)}}}(e);return s?new Lt(...s,!1):void 0}get rgb(){const{r:e,g:s,b:a,a:h}=this,m=h||1/0;return this.overwriteGetter("rgb",[e/m,s/m,a/m,h])}get hcl(){return this.overwriteGetter("hcl",function(e){const[s,a,h,m]=Tt(e),y=Math.sqrt(a*a+h*h);return[Math.round(1e4*y)?Bt(Math.atan2(h,a)*Mt):NaN,y,s,m]}(this.rgb))}get lab(){return this.overwriteGetter("lab",Tt(this.rgb))}overwriteGetter(e,s){return Object.defineProperty(this,e,{value:s}),s}toString(){const[e,s,a,h]=this.rgb;return`rgba(${[e,s,a].map(m=>Math.round(255*m)).join(",")},${h})`}}Lt.black=new Lt(0,0,0,1),Lt.white=new Lt(1,1,1,1),Lt.transparent=new Lt(0,0,0,0),Lt.red=new Lt(1,0,0,1);class Kl{constructor(e,s,a){this.sensitivity=e?s?"variant":"case":s?"accent":"base",this.locale=a,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(e,s){return this.collator.compare(e,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Ra{constructor(e,s,a,h,m){this.text=e,this.image=s,this.scale=a,this.fontStack=h,this.textColor=m}}class Zr{constructor(e){this.sections=e}static fromString(e){return new Zr([new Ra(e,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(e=>e.text.length!==0||e.image&&e.image.name.length!==0)}static factory(e){return e instanceof Zr?e:Zr.fromString(e)}toString(){return this.sections.length===0?"":this.sections.map(e=>e.text).join("")}}class In{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof In)return e;if(typeof e=="number")return new In([e,e,e,e]);if(Array.isArray(e)&&!(e.length<1||e.length>4)){for(const s of e)if(typeof s!="number")return;switch(e.length){case 1:e=[e[0],e[0],e[0],e[0]];break;case 2:e=[e[0],e[1],e[0],e[1]];break;case 3:e=[e[0],e[1],e[2],e[1]]}return new In(e)}}toString(){return JSON.stringify(this.values)}}const Bp=new Set(["center","left","right","top","bottom","top-left","top-right","bottom-left","bottom-right"]);class qn{constructor(e){this.values=e.slice()}static parse(e){if(e instanceof qn)return e;if(Array.isArray(e)&&!(e.length<1)&&e.length%2==0){for(let s=0;s<e.length;s+=2){const a=e[s],h=e[s+1];if(typeof a!="string"||!Bp.has(a)||!Array.isArray(h)||h.length!==2||typeof h[0]!="number"||typeof h[1]!="number")return}return new qn(e)}}toString(){return JSON.stringify(this.values)}}class Fr{constructor(e){this.name=e.name,this.available=e.available}toString(){return this.name}static fromString(e){return e?new Fr({name:e,available:!1}):null}}function Fa(n,e,s,a){return typeof n=="number"&&n>=0&&n<=255&&typeof e=="number"&&e>=0&&e<=255&&typeof s=="number"&&s>=0&&s<=255?a===void 0||typeof a=="number"&&a>=0&&a<=1?null:`Invalid rgba value [${[n,e,s,a].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof a=="number"?[n,e,s,a]:[n,e,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function oo(n){if(n===null||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof Lt||n instanceof Kl||n instanceof Zr||n instanceof In||n instanceof qn||n instanceof Fr)return!0;if(Array.isArray(n)){for(const e of n)if(!oo(e))return!1;return!0}if(typeof n=="object"){for(const e in n)if(!oo(n[e]))return!1;return!0}return!1}function Xt(n){if(n===null)return Bi;if(typeof n=="string")return ft;if(typeof n=="boolean")return ut;if(typeof n=="number")return Oe;if(n instanceof Lt)return Jr;if(n instanceof Kl)return Oi;if(n instanceof Zr)return Z;if(n instanceof In)return A;if(n instanceof qn)return V;if(n instanceof Fr)return R;if(Array.isArray(n)){const e=n.length;let s;for(const a of n){const h=Xt(a);if(s){if(s===h)continue;s=dt;break}s=h}return W(s||dt,e)}return xi}function Ct(n){const e=typeof n;return n===null?"":e==="string"||e==="number"||e==="boolean"?String(n):n instanceof Lt||n instanceof Zr||n instanceof In||n instanceof qn||n instanceof Fr?n.toString():JSON.stringify(n)}class Is{constructor(e,s){this.type=e,this.value=s}static parse(e,s){if(e.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${e.length-1} instead.`);if(!oo(e[1]))return s.error("invalid value");const a=e[1];let h=Xt(a);const m=s.expectedType;return h.kind!=="array"||h.N!==0||!m||m.kind!=="array"||typeof m.N=="number"&&m.N!==0||(h=m),new Is(h,a)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}}class tr{constructor(e){this.name="ExpressionEvaluationError",this.message=e}toJSON(){return this.message}}const Ba={string:ft,number:Oe,boolean:ut,object:xi};class Zn{constructor(e,s){this.type=e,this.args=s}static parse(e,s){if(e.length<2)return s.error("Expected at least one argument.");let a,h=1;const m=e[0];if(m==="array"){let v,S;if(e.length>2){const k=e[1];if(typeof k!="string"||!(k in Ba)||k==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);v=Ba[k],h++}else v=dt;if(e.length>3){if(e[2]!==null&&(typeof e[2]!="number"||e[2]<0||e[2]!==Math.floor(e[2])))return s.error('The length argument to "array" must be a positive integer literal',2);S=e[2],h++}a=W(v,S)}else{if(!Ba[m])throw new Error(`Types doesn't contain name = ${m}`);a=Ba[m]}const y=[];for(;h<e.length;h++){const v=s.parse(e[h],h,dt);if(!v)return null;y.push(v)}return new Zn(a,y)}evaluate(e){for(let s=0;s<this.args.length;s++){const a=this.args[s].evaluate(e);if(!se(this.type,Xt(a)))return a;if(s===this.args.length-1)throw new tr(`Expected value to be of type ${X(this.type)}, but found ${X(Xt(a))} instead.`)}throw new Error}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const Yl={"to-boolean":ut,"to-color":Jr,"to-number":Oe,"to-string":ft};class us{constructor(e,s){this.type=e,this.args=s}static parse(e,s){if(e.length<2)return s.error("Expected at least one argument.");const a=e[0];if(!Yl[a])throw new Error(`Can't parse ${a} as it is not part of the known types`);if((a==="to-boolean"||a==="to-string")&&e.length!==2)return s.error("Expected one argument.");const h=Yl[a],m=[];for(let y=1;y<e.length;y++){const v=s.parse(e[y],y,dt);if(!v)return null;m.push(v)}return new us(h,m)}evaluate(e){switch(this.type.kind){case"boolean":return!!this.args[0].evaluate(e);case"color":{let s,a;for(const h of this.args){if(s=h.evaluate(e),a=null,s instanceof Lt)return s;if(typeof s=="string"){const m=e.parseColor(s);if(m)return m}else if(Array.isArray(s)&&(a=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:Fa(s[0],s[1],s[2],s[3]),!a))return new Lt(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new tr(a||`Could not parse color from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"padding":{let s;for(const a of this.args){s=a.evaluate(e);const h=In.parse(s);if(h)return h}throw new tr(`Could not parse padding from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"variableAnchorOffsetCollection":{let s;for(const a of this.args){s=a.evaluate(e);const h=qn.parse(s);if(h)return h}throw new tr(`Could not parse variableAnchorOffsetCollection from value '${typeof s=="string"?s:JSON.stringify(s)}'`)}case"number":{let s=null;for(const a of this.args){if(s=a.evaluate(e),s===null)return 0;const h=Number(s);if(!isNaN(h))return h}throw new tr(`Could not convert ${JSON.stringify(s)} to number.`)}case"formatted":return Zr.fromString(Ct(this.args[0].evaluate(e)));case"resolvedImage":return Fr.fromString(Ct(this.args[0].evaluate(e)));default:return Ct(this.args[0].evaluate(e))}}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}const Yc=["Unknown","Point","LineString","Polygon"];class Ql{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null}id(){return this.feature&&"id"in this.feature?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?Yc[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}parseColor(e){let s=this._parseColorCache[e];return s||(s=this._parseColorCache[e]=Lt.parse(e)),s}}class Oa{constructor(e,s,a=[],h,m=new Es,y=[]){this.registry=e,this.path=a,this.key=a.map(v=>`[${v}]`).join(""),this.scope=m,this.errors=y,this.expectedType=h,this._isConstant=s}parse(e,s,a,h,m={}){return s?this.concat(s,a,h)._parse(e,m):this._parse(e,m)}_parse(e,s){function a(h,m,y){return y==="assert"?new Zn(m,[h]):y==="coerce"?new us(m,[h]):h}if(e!==null&&typeof e!="string"&&typeof e!="boolean"&&typeof e!="number"||(e=["literal",e]),Array.isArray(e)){if(e.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const h=e[0];if(typeof h!="string")return this.error(`Expression name must be a string, but found ${typeof h} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const m=this.registry[h];if(m){let y=m.parse(e,this);if(!y)return null;if(this.expectedType){const v=this.expectedType,S=y.type;if(v.kind!=="string"&&v.kind!=="number"&&v.kind!=="boolean"&&v.kind!=="object"&&v.kind!=="array"||S.kind!=="value")if(v.kind!=="color"&&v.kind!=="formatted"&&v.kind!=="resolvedImage"||S.kind!=="value"&&S.kind!=="string")if(v.kind!=="padding"||S.kind!=="value"&&S.kind!=="number"&&S.kind!=="array")if(v.kind!=="variableAnchorOffsetCollection"||S.kind!=="value"&&S.kind!=="array"){if(this.checkSubtype(v,S))return null}else y=a(y,v,s.typeAnnotation||"coerce");else y=a(y,v,s.typeAnnotation||"coerce");else y=a(y,v,s.typeAnnotation||"coerce");else y=a(y,v,s.typeAnnotation||"assert")}if(!(y instanceof Is)&&y.type.kind!=="resolvedImage"&&this._isConstant(y)){const v=new Ql;try{y=new Is(y.type,y.evaluate(v))}catch(S){return this.error(S.message),null}}return y}return this.error(`Unknown expression "${h}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(e===void 0?"'undefined' value invalid. Use null instead.":typeof e=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof e} instead.`)}concat(e,s,a){const h=typeof e=="number"?this.path.concat(e):this.path,m=a?this.scope.concat(a):this.scope;return new Oa(this.registry,this._isConstant,h,s||null,m,this.errors)}error(e,...s){const a=`${this.key}${s.map(h=>`[${h}]`).join("")}`;this.errors.push(new er(a,e))}checkSubtype(e,s){const a=se(e,s);return a&&this.error(a),a}}class Na{constructor(e,s,a){this.type=Oi,this.locale=a,this.caseSensitive=e,this.diacriticSensitive=s}static parse(e,s){if(e.length!==2)return s.error("Expected one argument.");const a=e[1];if(typeof a!="object"||Array.isArray(a))return s.error("Collator options argument must be an object.");const h=s.parse(a["case-sensitive"]!==void 0&&a["case-sensitive"],1,ut);if(!h)return null;const m=s.parse(a["diacritic-sensitive"]!==void 0&&a["diacritic-sensitive"],1,ut);if(!m)return null;let y=null;return a.locale&&(y=s.parse(a.locale,1,ft),!y)?null:new Na(h,m,y)}evaluate(e){return new Kl(this.caseSensitive.evaluate(e),this.diacriticSensitive.evaluate(e),this.locale?this.locale.evaluate(e):null)}eachChild(e){e(this.caseSensitive),e(this.diacriticSensitive),this.locale&&e(this.locale)}outputDefined(){return!1}}const cs=8192;function Jl(n,e){n[0]=Math.min(n[0],e[0]),n[1]=Math.min(n[1],e[1]),n[2]=Math.max(n[2],e[0]),n[3]=Math.max(n[3],e[1])}function Ko(n,e){return!(n[0]<=e[0]||n[2]>=e[2]||n[1]<=e[1]||n[3]>=e[3])}function Qc(n,e){const s=(180+n[0])/360,a=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n[1]*Math.PI/360)))/360,h=Math.pow(2,e.z);return[Math.round(s*h*cs),Math.round(a*h*cs)]}function Op(n,e,s){const a=n[0]-e[0],h=n[1]-e[1],m=n[0]-s[0],y=n[1]-s[1];return a*y-m*h==0&&a*m<=0&&h*y<=0}function eu(n,e){let s=!1;for(let y=0,v=e.length;y<v;y++){const S=e[y];for(let k=0,C=S.length;k<C-1;k++){if(Op(n,S[k],S[k+1]))return!1;(h=S[k])[1]>(a=n)[1]!=(m=S[k+1])[1]>a[1]&&a[0]<(m[0]-h[0])*(a[1]-h[1])/(m[1]-h[1])+h[0]&&(s=!s)}}var a,h,m;return s}function tu(n,e){for(let s=0;s<e.length;s++)if(eu(n,e[s]))return!0;return!1}function Jc(n,e,s,a){const h=a[0]-s[0],m=a[1]-s[1],y=(n[0]-s[0])*m-h*(n[1]-s[1]),v=(e[0]-s[0])*m-h*(e[1]-s[1]);return y>0&&v<0||y<0&&v>0}function Np(n,e,s){for(const k of s)for(let C=0;C<k.length-1;++C)if((v=[(y=k[C+1])[0]-(m=k[C])[0],y[1]-m[1]])[0]*(S=[(h=e)[0]-(a=n)[0],h[1]-a[1]])[1]-v[1]*S[0]!=0&&Jc(a,h,m,y)&&Jc(m,y,a,h))return!0;var a,h,m,y,v,S;return!1}function eh(n,e){for(let s=0;s<n.length;++s)if(!eu(n[s],e))return!1;for(let s=0;s<n.length-1;++s)if(Np(n[s],n[s+1],e))return!1;return!0}function th(n,e){for(let s=0;s<e.length;s++)if(eh(n,e[s]))return!0;return!1}function Va(n,e,s){const a=[];for(let h=0;h<n.length;h++){const m=[];for(let y=0;y<n[h].length;y++){const v=Qc(n[h][y],s);Jl(e,v),m.push(v)}a.push(m)}return a}function rh(n,e,s){const a=[];for(let h=0;h<n.length;h++){const m=Va(n[h],e,s);a.push(m)}return a}function nh(n,e,s,a){if(n[0]<s[0]||n[0]>s[2]){const h=.5*a;let m=n[0]-s[0]>h?-a:s[0]-n[0]>h?a:0;m===0&&(m=n[0]-s[2]>h?-a:s[2]-n[0]>h?a:0),n[0]+=m}Jl(e,n)}function ru(n,e,s,a){const h=Math.pow(2,a.z)*cs,m=[a.x*cs,a.y*cs],y=[];for(const v of n)for(const S of v){const k=[S.x+m[0],S.y+m[1]];nh(k,e,s,h),y.push(k)}return y}function nu(n,e,s,a){const h=Math.pow(2,a.z)*cs,m=[a.x*cs,a.y*cs],y=[];for(const S of n){const k=[];for(const C of S){const M=[C.x+m[0],C.y+m[1]];Jl(e,M),k.push(M)}y.push(k)}if(e[2]-e[0]<=h/2){(v=e)[0]=v[1]=1/0,v[2]=v[3]=-1/0;for(const S of y)for(const k of S)nh(k,e,s,h)}var v;return y}class Cs{constructor(e,s){this.type=ut,this.geojson=e,this.geometries=s}static parse(e,s){if(e.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${e.length-1} instead.`);if(oo(e[1])){const a=e[1];if(a.type==="FeatureCollection")for(let h=0;h<a.features.length;++h){const m=a.features[h].geometry.type;if(m==="Polygon"||m==="MultiPolygon")return new Cs(a,a.features[h].geometry)}else if(a.type==="Feature"){const h=a.geometry.type;if(h==="Polygon"||h==="MultiPolygon")return new Cs(a,a.geometry)}else if(a.type==="Polygon"||a.type==="MultiPolygon")return new Cs(a,a)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(e){if(e.geometry()!=null&&e.canonicalID()!=null){if(e.geometryType()==="Point")return function(s,a){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=s.canonicalID();if(a.type==="Polygon"){const v=Va(a.coordinates,m,y),S=ru(s.geometry(),h,m,y);if(!Ko(h,m))return!1;for(const k of S)if(!eu(k,v))return!1}if(a.type==="MultiPolygon"){const v=rh(a.coordinates,m,y),S=ru(s.geometry(),h,m,y);if(!Ko(h,m))return!1;for(const k of S)if(!tu(k,v))return!1}return!0}(e,this.geometries);if(e.geometryType()==="LineString")return function(s,a){const h=[1/0,1/0,-1/0,-1/0],m=[1/0,1/0,-1/0,-1/0],y=s.canonicalID();if(a.type==="Polygon"){const v=Va(a.coordinates,m,y),S=nu(s.geometry(),h,m,y);if(!Ko(h,m))return!1;for(const k of S)if(!eh(k,v))return!1}if(a.type==="MultiPolygon"){const v=rh(a.coordinates,m,y),S=nu(s.geometry(),h,m,y);if(!Ko(h,m))return!1;for(const k of S)if(!th(k,v))return!1}return!0}(e,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}}class Ua{constructor(e,s){this.type=s.type,this.name=e,this.boundExpression=s}static parse(e,s){if(e.length!==2||typeof e[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const a=e[1];return s.scope.has(a)?new Ua(a,s.scope.get(a)):s.error(`Unknown variable "${a}". Make sure "${a}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(e){return this.boundExpression.evaluate(e)}eachChild(){}outputDefined(){return!1}}class Gn{constructor(e,s,a,h){this.name=e,this.type=s,this._evaluate=a,this.args=h}evaluate(e){return this._evaluate(e,this.args)}eachChild(e){this.args.forEach(e)}outputDefined(){return!1}static parse(e,s){const a=e[0],h=Gn.definitions[a];if(!h)return s.error(`Unknown expression "${a}". If you wanted a literal array, use ["literal", [...]].`,0);const m=Array.isArray(h)?h[0]:h.type,y=Array.isArray(h)?[[h[1],h[2]]]:h.overloads,v=y.filter(([k])=>!Array.isArray(k)||k.length===e.length-1);let S=null;for(const[k,C]of v){S=new Oa(s.registry,ja,s.path,null,s.scope);const M=[];let L=!1;for(let O=1;O<e.length;O++){const N=e[O],j=Array.isArray(k)?k[O-1]:k.type,H=S.parse(N,1+M.length,j);if(!H){L=!0;break}M.push(H)}if(!L)if(Array.isArray(k)&&k.length!==M.length)S.error(`Expected ${k.length} arguments, but found ${M.length} instead.`);else{for(let O=0;O<M.length;O++){const N=Array.isArray(k)?k[O]:k.type,j=M[O];S.concat(O+1).checkSubtype(N,j.type)}if(S.errors.length===0)return new Gn(a,m,C,M)}}if(v.length===1)s.errors.push(...S.errors);else{const k=(v.length?v:y).map(([M])=>{return L=M,Array.isArray(L)?`(${L.map(X).join(", ")})`:`(${X(L.type)}...)`;var L}).join(" | "),C=[];for(let M=1;M<e.length;M++){const L=s.parse(e[M],1+C.length);if(!L)return null;C.push(X(L.type))}s.error(`Expected arguments of type ${k}, but found (${C.join(", ")}) instead.`)}return null}static register(e,s){Gn.definitions=s;for(const a in s)e[a]=Gn}}function ja(n){if(n instanceof Ua)return ja(n.boundExpression);if(n instanceof Gn&&n.name==="error"||n instanceof Na||n instanceof Cs)return!1;const e=n instanceof us||n instanceof Zn;let s=!0;return n.eachChild(a=>{s=e?s&&ja(a):s&&a instanceof Is}),!!s&&$a(n)&&qa(n,["zoom","heatmap-density","line-progress","accumulated","is-supported-script"])}function $a(n){if(n instanceof Gn&&(n.name==="get"&&n.args.length===1||n.name==="feature-state"||n.name==="has"&&n.args.length===1||n.name==="properties"||n.name==="geometry-type"||n.name==="id"||/^filter-/.test(n.name))||n instanceof Cs)return!1;let e=!0;return n.eachChild(s=>{e&&!$a(s)&&(e=!1)}),e}function Yo(n){if(n instanceof Gn&&n.name==="feature-state")return!1;let e=!0;return n.eachChild(s=>{e&&!Yo(s)&&(e=!1)}),e}function qa(n,e){if(n instanceof Gn&&e.indexOf(n.name)>=0)return!1;let s=!0;return n.eachChild(a=>{s&&!qa(a,e)&&(s=!1)}),s}function ao(n,e){const s=n.length-1;let a,h,m=0,y=s,v=0;for(;m<=y;)if(v=Math.floor((m+y)/2),a=n[v],h=n[v+1],a<=e){if(v===s||e<h)return v;m=v+1}else{if(!(a>e))throw new tr("Input is not a number.");y=v-1}return 0}class hs{constructor(e,s,a){this.type=e,this.input=s,this.labels=[],this.outputs=[];for(const[h,m]of a)this.labels.push(h),this.outputs.push(m)}static parse(e,s){if(e.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return s.error("Expected an even number of arguments.");const a=s.parse(e[1],1,Oe);if(!a)return null;const h=[];let m=null;s.expectedType&&s.expectedType.kind!=="value"&&(m=s.expectedType);for(let y=1;y<e.length;y+=2){const v=y===1?-1/0:e[y],S=e[y+1],k=y,C=y+1;if(typeof v!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',k);if(h.length&&h[h.length-1][0]>=v)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',k);const M=s.parse(S,C,m);if(!M)return null;m=m||M.type,h.push([v,M])}return new hs(m,a,h)}evaluate(e){const s=this.labels,a=this.outputs;if(s.length===1)return a[0].evaluate(e);const h=this.input.evaluate(e);if(h<=s[0])return a[0].evaluate(e);const m=s.length;return h>=s[m-1]?a[m-1].evaluate(e):a[ao(s,h)].evaluate(e)}eachChild(e){e(this.input);for(const s of this.outputs)e(s)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function wt(n,e,s){return n+s*(e-n)}function Za(n,e,s){return n.map((a,h)=>wt(a,e[h],s))}const Cn={number:wt,color:function(n,e,s,a="rgb"){switch(a){case"rgb":{const[h,m,y,v]=Za(n.rgb,e.rgb,s);return new Lt(h,m,y,v,!1)}case"hcl":{const[h,m,y,v]=n.hcl,[S,k,C,M]=e.hcl;let L,O;if(isNaN(h)||isNaN(S))isNaN(h)?isNaN(S)?L=NaN:(L=S,y!==1&&y!==0||(O=k)):(L=h,C!==1&&C!==0||(O=m));else{let ue=S-h;S>h&&ue>180?ue-=360:S<h&&h-S>180&&(ue+=360),L=h+s*ue}const[N,j,H,Q]=function([ue,ie,de,fe]){return ue=isNaN(ue)?0:ue*ct,Ut([de,Math.cos(ue)*ie,Math.sin(ue)*ie,fe])}([L,O??wt(m,k,s),wt(y,C,s),wt(v,M,s)]);return new Lt(N,j,H,Q,!1)}case"lab":{const[h,m,y,v]=Ut(Za(n.lab,e.lab,s));return new Lt(h,m,y,v,!1)}}},array:Za,padding:function(n,e,s){return new In(Za(n.values,e.values,s))},variableAnchorOffsetCollection:function(n,e,s){const a=n.values,h=e.values;if(a.length!==h.length)throw new tr(`Cannot interpolate values of different length. from: ${n.toString()}, to: ${e.toString()}`);const m=[];for(let y=0;y<a.length;y+=2){if(a[y]!==h[y])throw new tr(`Cannot interpolate values containing mismatched anchors. from[${y}]: ${a[y]}, to[${y}]: ${h[y]}`);m.push(a[y]);const[v,S]=a[y+1],[k,C]=h[y+1];m.push([wt(v,k,s),wt(S,C,s)])}return new qn(m)}};class Pn{constructor(e,s,a,h,m){this.type=e,this.operator=s,this.interpolation=a,this.input=h,this.labels=[],this.outputs=[];for(const[y,v]of m)this.labels.push(y),this.outputs.push(v)}static interpolationFactor(e,s,a,h){let m=0;if(e.name==="exponential")m=iu(s,e.base,a,h);else if(e.name==="linear")m=iu(s,1,a,h);else if(e.name==="cubic-bezier"){const y=e.controlPoints;m=new ke(y[0],y[1],y[2],y[3]).solve(iu(s,1,a,h))}return m}static parse(e,s){let[a,h,m,...y]=e;if(!Array.isArray(h)||h.length===0)return s.error("Expected an interpolation type expression.",1);if(h[0]==="linear")h={name:"linear"};else if(h[0]==="exponential"){const k=h[1];if(typeof k!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);h={name:"exponential",base:k}}else{if(h[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(h[0])}`,1,0);{const k=h.slice(1);if(k.length!==4||k.some(C=>typeof C!="number"||C<0||C>1))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);h={name:"cubic-bezier",controlPoints:k}}}if(e.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if((e.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(m=s.parse(m,2,Oe),!m)return null;const v=[];let S=null;a==="interpolate-hcl"||a==="interpolate-lab"?S=Jr:s.expectedType&&s.expectedType.kind!=="value"&&(S=s.expectedType);for(let k=0;k<y.length;k+=2){const C=y[k],M=y[k+1],L=k+3,O=k+4;if(typeof C!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',L);if(v.length&&v[v.length-1][0]>=C)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',L);const N=s.parse(M,O,S);if(!N)return null;S=S||N.type,v.push([C,N])}return xe(S,Oe)||xe(S,Jr)||xe(S,A)||xe(S,V)||xe(S,W(Oe))?new Pn(S,a,h,m,v):s.error(`Type ${X(S)} is not interpolatable.`)}evaluate(e){const s=this.labels,a=this.outputs;if(s.length===1)return a[0].evaluate(e);const h=this.input.evaluate(e);if(h<=s[0])return a[0].evaluate(e);const m=s.length;if(h>=s[m-1])return a[m-1].evaluate(e);const y=ao(s,h),v=Pn.interpolationFactor(this.interpolation,h,s[y],s[y+1]),S=a[y].evaluate(e),k=a[y+1].evaluate(e);switch(this.operator){case"interpolate":return Cn[this.type.kind](S,k,v);case"interpolate-hcl":return Cn.color(S,k,v,"hcl");case"interpolate-lab":return Cn.color(S,k,v,"lab")}}eachChild(e){e(this.input);for(const s of this.outputs)e(s)}outputDefined(){return this.outputs.every(e=>e.outputDefined())}}function iu(n,e,s,a){const h=a-s,m=n-s;return h===0?0:e===1?m/h:(Math.pow(e,m)-1)/(Math.pow(e,h)-1)}class Ga{constructor(e,s){this.type=e,this.args=s}static parse(e,s){if(e.length<2)return s.error("Expectected at least one argument.");let a=null;const h=s.expectedType;h&&h.kind!=="value"&&(a=h);const m=[];for(const v of e.slice(1)){const S=s.parse(v,1+m.length,a,void 0,{typeAnnotation:"omit"});if(!S)return null;a=a||S.type,m.push(S)}if(!a)throw new Error("No output type");const y=h&&m.some(v=>se(h,v.type));return new Ga(y?dt:a,m)}evaluate(e){let s,a=null,h=0;for(const m of this.args)if(h++,a=m.evaluate(e),a&&a instanceof Fr&&!a.available&&(s||(s=a.name),a=null,h===this.args.length&&(a=s)),a!==null)break;return a}eachChild(e){this.args.forEach(e)}outputDefined(){return this.args.every(e=>e.outputDefined())}}class Wa{constructor(e,s){this.type=s.type,this.bindings=[].concat(e),this.result=s}evaluate(e){return this.result.evaluate(e)}eachChild(e){for(const s of this.bindings)e(s[1]);e(this.result)}static parse(e,s){if(e.length<4)return s.error(`Expected at least 3 arguments, but found ${e.length-1} instead.`);const a=[];for(let m=1;m<e.length-1;m+=2){const y=e[m];if(typeof y!="string")return s.error(`Expected string, but found ${typeof y} instead.`,m);if(/[^a-zA-Z0-9_]/.test(y))return s.error("Variable names must contain only alphanumeric characters or '_'.",m);const v=s.parse(e[m+1],m+1);if(!v)return null;a.push([y,v])}const h=s.parse(e[e.length-1],e.length-1,s.expectedType,a);return h?new Wa(a,h):null}outputDefined(){return this.result.outputDefined()}}class su{constructor(e,s,a){this.type=e,this.index=s,this.input=a}static parse(e,s){if(e.length!==3)return s.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=s.parse(e[1],1,Oe),h=s.parse(e[2],2,W(s.expectedType||dt));return a&&h?new su(h.type.itemType,a,h):null}evaluate(e){const s=this.index.evaluate(e),a=this.input.evaluate(e);if(s<0)throw new tr(`Array index out of bounds: ${s} < 0.`);if(s>=a.length)throw new tr(`Array index out of bounds: ${s} > ${a.length-1}.`);if(s!==Math.floor(s))throw new tr(`Array index must be an integer, but found ${s} instead.`);return a[s]}eachChild(e){e(this.index),e(this.input)}outputDefined(){return!1}}class ou{constructor(e,s){this.type=ut,this.needle=e,this.haystack=s}static parse(e,s){if(e.length!==3)return s.error(`Expected 2 arguments, but found ${e.length-1} instead.`);const a=s.parse(e[1],1,dt),h=s.parse(e[2],2,dt);return a&&h?J(a.type,[ut,ft,Oe,Bi,dt])?new ou(a,h):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${X(a.type)} instead`):null}evaluate(e){const s=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!a)return!1;if(!le(s,["boolean","string","number","null"]))throw new tr(`Expected first argument to be of type boolean, string, number or null, but found ${X(Xt(s))} instead.`);if(!le(a,["string","array"]))throw new tr(`Expected second argument to be of type array or string, but found ${X(Xt(a))} instead.`);return a.indexOf(s)>=0}eachChild(e){e(this.needle),e(this.haystack)}outputDefined(){return!0}}class Ha{constructor(e,s,a){this.type=Oe,this.needle=e,this.haystack=s,this.fromIndex=a}static parse(e,s){if(e.length<=2||e.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=s.parse(e[1],1,dt),h=s.parse(e[2],2,dt);if(!a||!h)return null;if(!J(a.type,[ut,ft,Oe,Bi,dt]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${X(a.type)} instead`);if(e.length===4){const m=s.parse(e[3],3,Oe);return m?new Ha(a,h,m):null}return new Ha(a,h)}evaluate(e){const s=this.needle.evaluate(e),a=this.haystack.evaluate(e);if(!le(s,["boolean","string","number","null"]))throw new tr(`Expected first argument to be of type boolean, string, number or null, but found ${X(Xt(s))} instead.`);if(!le(a,["string","array"]))throw new tr(`Expected second argument to be of type array or string, but found ${X(Xt(a))} instead.`);if(this.fromIndex){const h=this.fromIndex.evaluate(e);return a.indexOf(s,h)}return a.indexOf(s)}eachChild(e){e(this.needle),e(this.haystack),this.fromIndex&&e(this.fromIndex)}outputDefined(){return!1}}class au{constructor(e,s,a,h,m,y){this.inputType=e,this.type=s,this.input=a,this.cases=h,this.outputs=m,this.otherwise=y}static parse(e,s){if(e.length<5)return s.error(`Expected at least 4 arguments, but found only ${e.length-1}.`);if(e.length%2!=1)return s.error("Expected an even number of arguments.");let a,h;s.expectedType&&s.expectedType.kind!=="value"&&(h=s.expectedType);const m={},y=[];for(let k=2;k<e.length-1;k+=2){let C=e[k];const M=e[k+1];Array.isArray(C)||(C=[C]);const L=s.concat(k);if(C.length===0)return L.error("Expected at least one branch label.");for(const N of C){if(typeof N!="number"&&typeof N!="string")return L.error("Branch labels must be numbers or strings.");if(typeof N=="number"&&Math.abs(N)>Number.MAX_SAFE_INTEGER)return L.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof N=="number"&&Math.floor(N)!==N)return L.error("Numeric branch labels must be integer values.");if(a){if(L.checkSubtype(a,Xt(N)))return null}else a=Xt(N);if(m[String(N)]!==void 0)return L.error("Branch labels must be unique.");m[String(N)]=y.length}const O=s.parse(M,k,h);if(!O)return null;h=h||O.type,y.push(O)}const v=s.parse(e[1],1,dt);if(!v)return null;const S=s.parse(e[e.length-1],e.length-1,h);return S?v.type.kind!=="value"&&s.concat(1).checkSubtype(a,v.type)?null:new au(a,h,v,m,y,S):null}evaluate(e){const s=this.input.evaluate(e);return(Xt(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(e)}eachChild(e){e(this.input),this.outputs.forEach(e),e(this.otherwise)}outputDefined(){return this.outputs.every(e=>e.outputDefined())&&this.otherwise.outputDefined()}}class lu{constructor(e,s,a){this.type=e,this.branches=s,this.otherwise=a}static parse(e,s){if(e.length<4)return s.error(`Expected at least 3 arguments, but found only ${e.length-1}.`);if(e.length%2!=0)return s.error("Expected an odd number of arguments.");let a;s.expectedType&&s.expectedType.kind!=="value"&&(a=s.expectedType);const h=[];for(let y=1;y<e.length-1;y+=2){const v=s.parse(e[y],y,ut);if(!v)return null;const S=s.parse(e[y+1],y+1,a);if(!S)return null;h.push([v,S]),a=a||S.type}const m=s.parse(e[e.length-1],e.length-1,a);if(!m)return null;if(!a)throw new Error("Can't infer output type");return new lu(a,h,m)}evaluate(e){for(const[s,a]of this.branches)if(s.evaluate(e))return a.evaluate(e);return this.otherwise.evaluate(e)}eachChild(e){for(const[s,a]of this.branches)e(s),e(a);e(this.otherwise)}outputDefined(){return this.branches.every(([e,s])=>s.outputDefined())&&this.otherwise.outputDefined()}}class Xa{constructor(e,s,a,h){this.type=e,this.input=s,this.beginIndex=a,this.endIndex=h}static parse(e,s){if(e.length<=2||e.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${e.length-1} instead.`);const a=s.parse(e[1],1,dt),h=s.parse(e[2],2,Oe);if(!a||!h)return null;if(!J(a.type,[W(dt),ft,dt]))return s.error(`Expected first argument to be of type array or string, but found ${X(a.type)} instead`);if(e.length===4){const m=s.parse(e[3],3,Oe);return m?new Xa(a.type,a,h,m):null}return new Xa(a.type,a,h)}evaluate(e){const s=this.input.evaluate(e),a=this.beginIndex.evaluate(e);if(!le(s,["string","array"]))throw new tr(`Expected first argument to be of type array or string, but found ${X(Xt(s))} instead.`);if(this.endIndex){const h=this.endIndex.evaluate(e);return s.slice(a,h)}return s.slice(a)}eachChild(e){e(this.input),e(this.beginIndex),this.endIndex&&e(this.endIndex)}outputDefined(){return!1}}function ih(n,e){return n==="=="||n==="!="?e.kind==="boolean"||e.kind==="string"||e.kind==="number"||e.kind==="null"||e.kind==="value":e.kind==="string"||e.kind==="number"||e.kind==="value"}function sh(n,e,s,a){return a.compare(e,s)===0}function lo(n,e,s){const a=n!=="=="&&n!=="!=";return class fw{constructor(m,y,v){this.type=ut,this.lhs=m,this.rhs=y,this.collator=v,this.hasUntypedArgument=m.type.kind==="value"||y.type.kind==="value"}static parse(m,y){if(m.length!==3&&m.length!==4)return y.error("Expected two or three arguments.");const v=m[0];let S=y.parse(m[1],1,dt);if(!S)return null;if(!ih(v,S.type))return y.concat(1).error(`"${v}" comparisons are not supported for type '${X(S.type)}'.`);let k=y.parse(m[2],2,dt);if(!k)return null;if(!ih(v,k.type))return y.concat(2).error(`"${v}" comparisons are not supported for type '${X(k.type)}'.`);if(S.type.kind!==k.type.kind&&S.type.kind!=="value"&&k.type.kind!=="value")return y.error(`Cannot compare types '${X(S.type)}' and '${X(k.type)}'.`);a&&(S.type.kind==="value"&&k.type.kind!=="value"?S=new Zn(k.type,[S]):S.type.kind!=="value"&&k.type.kind==="value"&&(k=new Zn(S.type,[k])));let C=null;if(m.length===4){if(S.type.kind!=="string"&&k.type.kind!=="string"&&S.type.kind!=="value"&&k.type.kind!=="value")return y.error("Cannot use collator to compare non-string types.");if(C=y.parse(m[3],3,Oi),!C)return null}return new fw(S,k,C)}evaluate(m){const y=this.lhs.evaluate(m),v=this.rhs.evaluate(m);if(a&&this.hasUntypedArgument){const S=Xt(y),k=Xt(v);if(S.kind!==k.kind||S.kind!=="string"&&S.kind!=="number")throw new tr(`Expected arguments for "${n}" to be (string, string) or (number, number), but found (${S.kind}, ${k.kind}) instead.`)}if(this.collator&&!a&&this.hasUntypedArgument){const S=Xt(y),k=Xt(v);if(S.kind!=="string"||k.kind!=="string")return e(m,y,v)}return this.collator?s(m,y,v,this.collator.evaluate(m)):e(m,y,v)}eachChild(m){m(this.lhs),m(this.rhs),this.collator&&m(this.collator)}outputDefined(){return!0}}}const Vp=lo("==",function(n,e,s){return e===s},sh),Up=lo("!=",function(n,e,s){return e!==s},function(n,e,s,a){return!sh(0,e,s,a)}),jp=lo("<",function(n,e,s){return e<s},function(n,e,s,a){return a.compare(e,s)<0}),$p=lo(">",function(n,e,s){return e>s},function(n,e,s,a){return a.compare(e,s)>0}),qp=lo("<=",function(n,e,s){return e<=s},function(n,e,s,a){return a.compare(e,s)<=0}),Zp=lo(">=",function(n,e,s){return e>=s},function(n,e,s,a){return a.compare(e,s)>=0});class uu{constructor(e,s,a,h,m){this.type=ft,this.number=e,this.locale=s,this.currency=a,this.minFractionDigits=h,this.maxFractionDigits=m}static parse(e,s){if(e.length!==3)return s.error("Expected two arguments.");const a=s.parse(e[1],1,Oe);if(!a)return null;const h=e[2];if(typeof h!="object"||Array.isArray(h))return s.error("NumberFormat options argument must be an object.");let m=null;if(h.locale&&(m=s.parse(h.locale,1,ft),!m))return null;let y=null;if(h.currency&&(y=s.parse(h.currency,1,ft),!y))return null;let v=null;if(h["min-fraction-digits"]&&(v=s.parse(h["min-fraction-digits"],1,Oe),!v))return null;let S=null;return h["max-fraction-digits"]&&(S=s.parse(h["max-fraction-digits"],1,Oe),!S)?null:new uu(a,m,y,v,S)}evaluate(e){return new Intl.NumberFormat(this.locale?this.locale.evaluate(e):[],{style:this.currency?"currency":"decimal",currency:this.currency?this.currency.evaluate(e):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(e):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(e):void 0}).format(this.number.evaluate(e))}eachChild(e){e(this.number),this.locale&&e(this.locale),this.currency&&e(this.currency),this.minFractionDigits&&e(this.minFractionDigits),this.maxFractionDigits&&e(this.maxFractionDigits)}outputDefined(){return!1}}class Ka{constructor(e){this.type=Z,this.sections=e}static parse(e,s){if(e.length<2)return s.error("Expected at least one argument.");const a=e[1];if(!Array.isArray(a)&&typeof a=="object")return s.error("First argument must be an image or text section.");const h=[];let m=!1;for(let y=1;y<=e.length-1;++y){const v=e[y];if(m&&typeof v=="object"&&!Array.isArray(v)){m=!1;let S=null;if(v["font-scale"]&&(S=s.parse(v["font-scale"],1,Oe),!S))return null;let k=null;if(v["text-font"]&&(k=s.parse(v["text-font"],1,W(ft)),!k))return null;let C=null;if(v["text-color"]&&(C=s.parse(v["text-color"],1,Jr),!C))return null;const M=h[h.length-1];M.scale=S,M.font=k,M.textColor=C}else{const S=s.parse(e[y],1,dt);if(!S)return null;const k=S.type.kind;if(k!=="string"&&k!=="value"&&k!=="null"&&k!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");m=!0,h.push({content:S,scale:null,font:null,textColor:null})}}return new Ka(h)}evaluate(e){return new Zr(this.sections.map(s=>{const a=s.content.evaluate(e);return Xt(a)===R?new Ra("",a,null,null,null):new Ra(Ct(a),null,s.scale?s.scale.evaluate(e):null,s.font?s.font.evaluate(e).join(","):null,s.textColor?s.textColor.evaluate(e):null)}))}eachChild(e){for(const s of this.sections)e(s.content),s.scale&&e(s.scale),s.font&&e(s.font),s.textColor&&e(s.textColor)}outputDefined(){return!1}}class cu{constructor(e){this.type=R,this.input=e}static parse(e,s){if(e.length!==2)return s.error("Expected two arguments.");const a=s.parse(e[1],1,ft);return a?new cu(a):s.error("No image name provided.")}evaluate(e){const s=this.input.evaluate(e),a=Fr.fromString(s);return a&&e.availableImages&&(a.available=e.availableImages.indexOf(s)>-1),a}eachChild(e){e(this.input)}outputDefined(){return!1}}class hu{constructor(e){this.type=Oe,this.input=e}static parse(e,s){if(e.length!==2)return s.error(`Expected 1 argument, but found ${e.length-1} instead.`);const a=s.parse(e[1],1);return a?a.type.kind!=="array"&&a.type.kind!=="string"&&a.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${X(a.type)} instead.`):new hu(a):null}evaluate(e){const s=this.input.evaluate(e);if(typeof s=="string"||Array.isArray(s))return s.length;throw new tr(`Expected value to be of type string or array, but found ${X(Xt(s))} instead.`)}eachChild(e){e(this.input)}outputDefined(){return!1}}const uo={"==":Vp,"!=":Up,">":$p,"<":jp,">=":Zp,"<=":qp,array:Zn,at:su,boolean:Zn,case:lu,coalesce:Ga,collator:Na,format:Ka,image:cu,in:ou,"index-of":Ha,interpolate:Pn,"interpolate-hcl":Pn,"interpolate-lab":Pn,length:hu,let:Wa,literal:Is,match:au,number:Zn,"number-format":uu,object:Zn,slice:Xa,step:hs,string:Zn,"to-boolean":us,"to-color":us,"to-number":us,"to-string":us,var:Ua,within:Cs};function oh(n,[e,s,a,h]){e=e.evaluate(n),s=s.evaluate(n),a=a.evaluate(n);const m=h?h.evaluate(n):1,y=Fa(e,s,a,m);if(y)throw new tr(y);return new Lt(e/255,s/255,a/255,m,!1)}function ah(n,e){return n in e}function du(n,e){const s=e[n];return s===void 0?null:s}function Ps(n){return{type:n}}function lh(n){return{result:"success",value:n}}function ds(n){return{result:"error",value:n}}function co(n){return n["property-type"]==="data-driven"||n["property-type"]==="cross-faded-data-driven"}function uh(n){return!!n.expression&&n.expression.parameters.indexOf("zoom")>-1}function pu(n){return!!n.expression&&n.expression.interpolated}function Pt(n){return n instanceof Number?"number":n instanceof String?"string":n instanceof Boolean?"boolean":Array.isArray(n)?"array":n===null?"null":typeof n}function Kt(n){return typeof n=="object"&&n!==null&&!Array.isArray(n)}function Gp(n){return n}function bt(n,e){const s=e.type==="color",a=n.stops&&typeof n.stops[0][0]=="object",h=a||!(a||n.property!==void 0),m=n.type||(pu(e)?"exponential":"interval");if(s||e.type==="padding"){const C=s?Lt.parse:In.parse;(n=vi({},n)).stops&&(n.stops=n.stops.map(M=>[M[0],C(M[1])])),n.default=C(n.default?n.default:e.default)}if(n.colorSpace&&(y=n.colorSpace)!=="rgb"&&y!=="hcl"&&y!=="lab")throw new Error(`Unknown color space: "${n.colorSpace}"`);var y;let v,S,k;if(m==="exponential")v=Qo;else if(m==="interval")v=Wt;else if(m==="categorical"){v=Yt,S=Object.create(null);for(const C of n.stops)S[C[0]]=C[1];k=typeof n.stops[0][0]}else{if(m!=="identity")throw new Error(`Unknown function type "${m}"`);v=ch}if(a){const C={},M=[];for(let N=0;N<n.stops.length;N++){const j=n.stops[N],H=j[0].zoom;C[H]===void 0&&(C[H]={zoom:H,type:n.type,property:n.property,default:n.default,stops:[]},M.push(H)),C[H].stops.push([j[0].value,j[1]])}const L=[];for(const N of M)L.push([C[N].zoom,bt(C[N],e)]);const O={name:"linear"};return{kind:"composite",interpolationType:O,interpolationFactor:Pn.interpolationFactor.bind(void 0,O),zoomStops:L.map(N=>N[0]),evaluate:({zoom:N},j)=>Qo({stops:L,base:n.base},e,N).evaluate(N,j)}}if(h){const C=m==="exponential"?{name:"exponential",base:n.base!==void 0?n.base:1}:null;return{kind:"camera",interpolationType:C,interpolationFactor:Pn.interpolationFactor.bind(void 0,C),zoomStops:n.stops.map(M=>M[0]),evaluate:({zoom:M})=>v(n,e,M,S,k)}}return{kind:"source",evaluate(C,M){const L=M&&M.properties?M.properties[n.property]:void 0;return L===void 0?zs(n.default,e.default):v(n,e,L,S,k)}}}function zs(n,e,s){return n!==void 0?n:e!==void 0?e:s!==void 0?s:void 0}function Yt(n,e,s,a,h){return zs(typeof s===h?a[s]:void 0,n.default,e.default)}function Wt(n,e,s){if(Pt(s)!=="number")return zs(n.default,e.default);const a=n.stops.length;if(a===1||s<=n.stops[0][0])return n.stops[0][1];if(s>=n.stops[a-1][0])return n.stops[a-1][1];const h=ao(n.stops.map(m=>m[0]),s);return n.stops[h][1]}function Qo(n,e,s){const a=n.base!==void 0?n.base:1;if(Pt(s)!=="number")return zs(n.default,e.default);const h=n.stops.length;if(h===1||s<=n.stops[0][0])return n.stops[0][1];if(s>=n.stops[h-1][0])return n.stops[h-1][1];const m=ao(n.stops.map(C=>C[0]),s),y=function(C,M,L,O){const N=O-L,j=C-L;return N===0?0:M===1?j/N:(Math.pow(M,j)-1)/(Math.pow(M,N)-1)}(s,a,n.stops[m][0],n.stops[m+1][0]),v=n.stops[m][1],S=n.stops[m+1][1],k=Cn[e.type]||Gp;return typeof v.evaluate=="function"?{evaluate(...C){const M=v.evaluate.apply(void 0,C),L=S.evaluate.apply(void 0,C);if(M!==void 0&&L!==void 0)return k(M,L,y,n.colorSpace)}}:k(v,S,y,n.colorSpace)}function ch(n,e,s){switch(e.type){case"color":s=Lt.parse(s);break;case"formatted":s=Zr.fromString(s.toString());break;case"resolvedImage":s=Fr.fromString(s.toString());break;case"padding":s=In.parse(s);break;default:Pt(s)===e.type||e.type==="enum"&&e.values[s]||(s=void 0)}return zs(s,n.default,e.default)}Gn.register(uo,{error:[{kind:"error"},[ft],(n,[e])=>{throw new tr(e.evaluate(n))}],typeof:[ft,[dt],(n,[e])=>X(Xt(e.evaluate(n)))],"to-rgba":[W(Oe,4),[Jr],(n,[e])=>{const[s,a,h,m]=e.evaluate(n).rgb;return[255*s,255*a,255*h,m]}],rgb:[Jr,[Oe,Oe,Oe],oh],rgba:[Jr,[Oe,Oe,Oe,Oe],oh],has:{type:ut,overloads:[[[ft],(n,[e])=>ah(e.evaluate(n),n.properties())],[[ft,xi],(n,[e,s])=>ah(e.evaluate(n),s.evaluate(n))]]},get:{type:dt,overloads:[[[ft],(n,[e])=>du(e.evaluate(n),n.properties())],[[ft,xi],(n,[e,s])=>du(e.evaluate(n),s.evaluate(n))]]},"feature-state":[dt,[ft],(n,[e])=>du(e.evaluate(n),n.featureState||{})],properties:[xi,[],n=>n.properties()],"geometry-type":[ft,[],n=>n.geometryType()],id:[dt,[],n=>n.id()],zoom:[Oe,[],n=>n.globals.zoom],"heatmap-density":[Oe,[],n=>n.globals.heatmapDensity||0],"line-progress":[Oe,[],n=>n.globals.lineProgress||0],accumulated:[dt,[],n=>n.globals.accumulated===void 0?null:n.globals.accumulated],"+":[Oe,Ps(Oe),(n,e)=>{let s=0;for(const a of e)s+=a.evaluate(n);return s}],"*":[Oe,Ps(Oe),(n,e)=>{let s=1;for(const a of e)s*=a.evaluate(n);return s}],"-":{type:Oe,overloads:[[[Oe,Oe],(n,[e,s])=>e.evaluate(n)-s.evaluate(n)],[[Oe],(n,[e])=>-e.evaluate(n)]]},"/":[Oe,[Oe,Oe],(n,[e,s])=>e.evaluate(n)/s.evaluate(n)],"%":[Oe,[Oe,Oe],(n,[e,s])=>e.evaluate(n)%s.evaluate(n)],ln2:[Oe,[],()=>Math.LN2],pi:[Oe,[],()=>Math.PI],e:[Oe,[],()=>Math.E],"^":[Oe,[Oe,Oe],(n,[e,s])=>Math.pow(e.evaluate(n),s.evaluate(n))],sqrt:[Oe,[Oe],(n,[e])=>Math.sqrt(e.evaluate(n))],log10:[Oe,[Oe],(n,[e])=>Math.log(e.evaluate(n))/Math.LN10],ln:[Oe,[Oe],(n,[e])=>Math.log(e.evaluate(n))],log2:[Oe,[Oe],(n,[e])=>Math.log(e.evaluate(n))/Math.LN2],sin:[Oe,[Oe],(n,[e])=>Math.sin(e.evaluate(n))],cos:[Oe,[Oe],(n,[e])=>Math.cos(e.evaluate(n))],tan:[Oe,[Oe],(n,[e])=>Math.tan(e.evaluate(n))],asin:[Oe,[Oe],(n,[e])=>Math.asin(e.evaluate(n))],acos:[Oe,[Oe],(n,[e])=>Math.acos(e.evaluate(n))],atan:[Oe,[Oe],(n,[e])=>Math.atan(e.evaluate(n))],min:[Oe,Ps(Oe),(n,e)=>Math.min(...e.map(s=>s.evaluate(n)))],max:[Oe,Ps(Oe),(n,e)=>Math.max(...e.map(s=>s.evaluate(n)))],abs:[Oe,[Oe],(n,[e])=>Math.abs(e.evaluate(n))],round:[Oe,[Oe],(n,[e])=>{const s=e.evaluate(n);return s<0?-Math.round(-s):Math.round(s)}],floor:[Oe,[Oe],(n,[e])=>Math.floor(e.evaluate(n))],ceil:[Oe,[Oe],(n,[e])=>Math.ceil(e.evaluate(n))],"filter-==":[ut,[ft,dt],(n,[e,s])=>n.properties()[e.value]===s.value],"filter-id-==":[ut,[dt],(n,[e])=>n.id()===e.value],"filter-type-==":[ut,[ft],(n,[e])=>n.geometryType()===e.value],"filter-<":[ut,[ft,dt],(n,[e,s])=>{const a=n.properties()[e.value],h=s.value;return typeof a==typeof h&&a<h}],"filter-id-<":[ut,[dt],(n,[e])=>{const s=n.id(),a=e.value;return typeof s==typeof a&&s<a}],"filter->":[ut,[ft,dt],(n,[e,s])=>{const a=n.properties()[e.value],h=s.value;return typeof a==typeof h&&a>h}],"filter-id->":[ut,[dt],(n,[e])=>{const s=n.id(),a=e.value;return typeof s==typeof a&&s>a}],"filter-<=":[ut,[ft,dt],(n,[e,s])=>{const a=n.properties()[e.value],h=s.value;return typeof a==typeof h&&a<=h}],"filter-id-<=":[ut,[dt],(n,[e])=>{const s=n.id(),a=e.value;return typeof s==typeof a&&s<=a}],"filter->=":[ut,[ft,dt],(n,[e,s])=>{const a=n.properties()[e.value],h=s.value;return typeof a==typeof h&&a>=h}],"filter-id->=":[ut,[dt],(n,[e])=>{const s=n.id(),a=e.value;return typeof s==typeof a&&s>=a}],"filter-has":[ut,[dt],(n,[e])=>e.value in n.properties()],"filter-has-id":[ut,[],n=>n.id()!==null&&n.id()!==void 0],"filter-type-in":[ut,[W(ft)],(n,[e])=>e.value.indexOf(n.geometryType())>=0],"filter-id-in":[ut,[W(dt)],(n,[e])=>e.value.indexOf(n.id())>=0],"filter-in-small":[ut,[ft,W(dt)],(n,[e,s])=>s.value.indexOf(n.properties()[e.value])>=0],"filter-in-large":[ut,[ft,W(dt)],(n,[e,s])=>function(a,h,m,y){for(;m<=y;){const v=m+y>>1;if(h[v]===a)return!0;h[v]>a?y=v-1:m=v+1}return!1}(n.properties()[e.value],s.value,0,s.value.length-1)],all:{type:ut,overloads:[[[ut,ut],(n,[e,s])=>e.evaluate(n)&&s.evaluate(n)],[Ps(ut),(n,e)=>{for(const s of e)if(!s.evaluate(n))return!1;return!0}]]},any:{type:ut,overloads:[[[ut,ut],(n,[e,s])=>e.evaluate(n)||s.evaluate(n)],[Ps(ut),(n,e)=>{for(const s of e)if(s.evaluate(n))return!0;return!1}]]},"!":[ut,[ut],(n,[e])=>!e.evaluate(n)],"is-supported-script":[ut,[ft],(n,[e])=>{const s=n.globals&&n.globals.isSupportedScript;return!s||s(e.evaluate(n))}],upcase:[ft,[ft],(n,[e])=>e.evaluate(n).toUpperCase()],downcase:[ft,[ft],(n,[e])=>e.evaluate(n).toLowerCase()],concat:[ft,Ps(dt),(n,e)=>e.map(s=>Ct(s.evaluate(n))).join("")],"resolved-locale":[ft,[Oi],(n,[e])=>e.evaluate(n).resolvedLocale()]});class fu{constructor(e,s){var a;this.expression=e,this._warningHistory={},this._evaluator=new Ql,this._defaultValue=s?(a=s).type==="color"&&Kt(a.default)?new Lt(0,0,0,0):a.type==="color"?Lt.parse(a.default)||null:a.type==="padding"?In.parse(a.default)||null:a.type==="variableAnchorOffsetCollection"?qn.parse(a.default)||null:a.default===void 0?null:a.default:null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(e,s,a,h,m,y){return this._evaluator.globals=e,this._evaluator.feature=s,this._evaluator.featureState=a,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y,this.expression.evaluate(this._evaluator)}evaluate(e,s,a,h,m,y){this._evaluator.globals=e,this._evaluator.feature=s||null,this._evaluator.featureState=a||null,this._evaluator.canonical=h,this._evaluator.availableImages=m||null,this._evaluator.formattedSection=y||null;try{const v=this.expression.evaluate(this._evaluator);if(v==null||typeof v=="number"&&v!=v)return this._defaultValue;if(this._enumValues&&!(v in this._enumValues))throw new tr(`Expected value to be one of ${Object.keys(this._enumValues).map(S=>JSON.stringify(S)).join(", ")}, but found ${JSON.stringify(v)} instead.`);return v}catch(v){return this._warningHistory[v.message]||(this._warningHistory[v.message]=!0,typeof console<"u"&&console.warn(v.message)),this._defaultValue}}}function Ya(n){return Array.isArray(n)&&n.length>0&&typeof n[0]=="string"&&n[0]in uo}function Qa(n,e){const s=new Oa(uo,ja,[],e?function(h){const m={color:Jr,string:ft,number:Oe,enum:ft,boolean:ut,formatted:Z,padding:A,resolvedImage:R,variableAnchorOffsetCollection:V};return h.type==="array"?W(m[h.value]||dt,h.length):m[h.type]}(e):void 0),a=s.parse(n,void 0,void 0,void 0,e&&e.type==="string"?{typeAnnotation:"coerce"}:void 0);return a?lh(new fu(a,e)):ds(s.errors)}class mu{constructor(e,s){this.kind=e,this._styleExpression=s,this.isStateDependent=e!=="constant"&&!Yo(s.expression)}evaluateWithoutErrorHandling(e,s,a,h,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,s,a,h,m,y)}evaluate(e,s,a,h,m,y){return this._styleExpression.evaluate(e,s,a,h,m,y)}}class Ja{constructor(e,s,a,h){this.kind=e,this.zoomStops=a,this._styleExpression=s,this.isStateDependent=e!=="camera"&&!Yo(s.expression),this.interpolationType=h}evaluateWithoutErrorHandling(e,s,a,h,m,y){return this._styleExpression.evaluateWithoutErrorHandling(e,s,a,h,m,y)}evaluate(e,s,a,h,m,y){return this._styleExpression.evaluate(e,s,a,h,m,y)}interpolationFactor(e,s,a){return this.interpolationType?Pn.interpolationFactor(this.interpolationType,e,s,a):0}}function gu(n,e){const s=Qa(n,e);if(s.result==="error")return s;const a=s.value.expression,h=$a(a);if(!h&&!co(e))return ds([new er("","data expressions not supported")]);const m=qa(a,["zoom"]);if(!m&&!uh(e))return ds([new er("","zoom expressions not supported")]);const y=ea(a);return y||m?y instanceof er?ds([y]):y instanceof Pn&&!pu(e)?ds([new er("",'"interpolate" expressions cannot be used with this property')]):lh(y?new Ja(h?"camera":"composite",s.value,y.labels,y instanceof Pn?y.interpolation:void 0):new mu(h?"constant":"source",s.value)):ds([new er("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class Jo{constructor(e,s){this._parameters=e,this._specification=s,vi(this,bt(this._parameters,this._specification))}static deserialize(e){return new Jo(e._parameters,e._specification)}static serialize(e){return{_parameters:e._parameters,_specification:e._specification}}}function ea(n){let e=null;if(n instanceof Wa)e=ea(n.result);else if(n instanceof Ga){for(const s of n.args)if(e=ea(s),e)break}else(n instanceof hs||n instanceof Pn)&&n.input instanceof Gn&&n.input.name==="zoom"&&(e=n);return e instanceof er||n.eachChild(s=>{const a=ea(s);a instanceof er?e=a:!e&&a?e=new er("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):e&&a&&e!==a&&(e=new er("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),e}function ta(n){if(n===!0||n===!1)return!0;if(!Array.isArray(n)||n.length===0)return!1;switch(n[0]){case"has":return n.length>=2&&n[1]!=="$id"&&n[1]!=="$type";case"in":return n.length>=3&&(typeof n[1]!="string"||Array.isArray(n[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return n.length!==3||Array.isArray(n[1])||Array.isArray(n[2]);case"any":case"all":for(const e of n.slice(1))if(!ta(e)&&typeof e!="boolean")return!1;return!0;default:return!0}}const Wp={type:"boolean",default:!1,transition:!1,"property-type":"data-driven",expression:{interpolated:!1,parameters:["zoom","feature"]}};function yu(n){if(n==null)return{filter:()=>!0,needGeometry:!1};ta(n)||(n=el(n));const e=Qa(n,Wp);if(e.result==="error")throw new Error(e.value.map(s=>`${s.key}: ${s.message}`).join(", "));return{filter:(s,a,h)=>e.value.evaluate(s,a,{},h),needGeometry:hh(n)}}function Hp(n,e){return n<e?-1:n>e?1:0}function hh(n){if(!Array.isArray(n))return!1;if(n[0]==="within")return!0;for(let e=1;e<n.length;e++)if(hh(n[e]))return!0;return!1}function el(n){if(!n)return!0;const e=n[0];return n.length<=1?e!=="any":e==="=="?_u(n[1],n[2],"=="):e==="!="?ra(_u(n[1],n[2],"==")):e==="<"||e===">"||e==="<="||e===">="?_u(n[1],n[2],e):e==="any"?(s=n.slice(1),["any"].concat(s.map(el))):e==="all"?["all"].concat(n.slice(1).map(el)):e==="none"?["all"].concat(n.slice(1).map(el).map(ra)):e==="in"?dh(n[1],n.slice(2)):e==="!in"?ra(dh(n[1],n.slice(2))):e==="has"?ph(n[1]):e==="!has"?ra(ph(n[1])):e!=="within"||n;var s}function _u(n,e,s){switch(n){case"$type":return[`filter-type-${s}`,e];case"$id":return[`filter-id-${s}`,e];default:return[`filter-${s}`,n,e]}}function dh(n,e){if(e.length===0)return!1;switch(n){case"$type":return["filter-type-in",["literal",e]];case"$id":return["filter-id-in",["literal",e]];default:return e.length>200&&!e.some(s=>typeof s!=typeof e[0])?["filter-in-large",n,["literal",e.sort(Hp)]]:["filter-in-small",n,["literal",e]]}}function ph(n){switch(n){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",n]}}function ra(n){return["!",n]}function tl(n){const e=typeof n;if(e==="number"||e==="boolean"||e==="string"||n==null)return JSON.stringify(n);if(Array.isArray(n)){let h="[";for(const m of n)h+=`${tl(m)},`;return`${h}]`}const s=Object.keys(n).sort();let a="{";for(let h=0;h<s.length;h++)a+=`${JSON.stringify(s[h])}:${tl(n[s[h]])},`;return`${a}}`}function rl(n){let e="";for(const s of pn)e+=`/${tl(n[s])}`;return e}function fh(n){const e=n.value;return e?[new Re(n.key,e,"constants have been deprecated as of v8")]:[]}function rr(n){return n instanceof Number||n instanceof String||n instanceof Boolean?n.valueOf():n}function Ms(n){if(Array.isArray(n))return n.map(Ms);if(n instanceof Object&&!(n instanceof Number||n instanceof String||n instanceof Boolean)){const e={};for(const s in n)e[s]=Ms(n[s]);return e}return rr(n)}function fn(n){const e=n.key,s=n.value,a=n.valueSpec||{},h=n.objectElementValidators||{},m=n.style,y=n.styleSpec,v=n.validateSpec;let S=[];const k=Pt(s);if(k!=="object")return[new Re(e,s,`object expected, ${k} found`)];for(const C in s){const M=C.split(".")[0],L=a[M]||a["*"];let O;if(h[M])O=h[M];else if(a[M])O=v;else if(h["*"])O=h["*"];else{if(!a["*"]){S.push(new Re(e,s[C],`unknown property "${C}"`));continue}O=v}S=S.concat(O({key:(e&&`${e}.`)+C,value:s[C],valueSpec:L,style:m,styleSpec:y,object:s,objectKey:C,validateSpec:v},s))}for(const C in a)h[C]||a[C].required&&a[C].default===void 0&&s[C]===void 0&&S.push(new Re(e,s,`missing required property "${C}"`));return S}function ho(n){const e=n.value,s=n.valueSpec,a=n.style,h=n.styleSpec,m=n.key,y=n.arrayElementValidator||n.validateSpec;if(Pt(e)!=="array")return[new Re(m,e,`array expected, ${Pt(e)} found`)];if(s.length&&e.length!==s.length)return[new Re(m,e,`array length ${s.length} expected, length ${e.length} found`)];if(s["min-length"]&&e.length<s["min-length"])return[new Re(m,e,`array length at least ${s["min-length"]} expected, length ${e.length} found`)];let v={type:s.value,values:s.values};h.$version<7&&(v.function=s.function),Pt(s.value)==="object"&&(v=s.value);let S=[];for(let k=0;k<e.length;k++)S=S.concat(y({array:e,arrayIndex:k,value:e[k],valueSpec:v,validateSpec:n.validateSpec,style:a,styleSpec:h,key:`${m}[${k}]`}));return S}function na(n){const e=n.key,s=n.value,a=n.valueSpec;let h=Pt(s);return h==="number"&&s!=s&&(h="NaN"),h!=="number"?[new Re(e,s,`number expected, ${h} found`)]:"minimum"in a&&s<a.minimum?[new Re(e,s,`${s} is less than the minimum value ${a.minimum}`)]:"maximum"in a&&s>a.maximum?[new Re(e,s,`${s} is greater than the maximum value ${a.maximum}`)]:[]}function nl(n){const e=n.valueSpec,s=rr(n.value.type);let a,h,m,y={};const v=s!=="categorical"&&n.value.property===void 0,S=!v,k=Pt(n.value.stops)==="array"&&Pt(n.value.stops[0])==="array"&&Pt(n.value.stops[0][0])==="object",C=fn({key:n.key,value:n.value,valueSpec:n.styleSpec.function,validateSpec:n.validateSpec,style:n.style,styleSpec:n.styleSpec,objectElementValidators:{stops:function(O){if(s==="identity")return[new Re(O.key,O.value,'identity function may not have a "stops" property')];let N=[];const j=O.value;return N=N.concat(ho({key:O.key,value:j,valueSpec:O.valueSpec,validateSpec:O.validateSpec,style:O.style,styleSpec:O.styleSpec,arrayElementValidator:M})),Pt(j)==="array"&&j.length===0&&N.push(new Re(O.key,j,"array must have at least one stop")),N},default:function(O){return O.validateSpec({key:O.key,value:O.value,valueSpec:e,validateSpec:O.validateSpec,style:O.style,styleSpec:O.styleSpec})}}});return s==="identity"&&v&&C.push(new Re(n.key,n.value,'missing required property "property"')),s==="identity"||n.value.stops||C.push(new Re(n.key,n.value,'missing required property "stops"')),s==="exponential"&&n.valueSpec.expression&&!pu(n.valueSpec)&&C.push(new Re(n.key,n.value,"exponential functions not supported")),n.styleSpec.$version>=8&&(S&&!co(n.valueSpec)?C.push(new Re(n.key,n.value,"property functions not supported")):v&&!uh(n.valueSpec)&&C.push(new Re(n.key,n.value,"zoom functions not supported"))),s!=="categorical"&&!k||n.value.property!==void 0||C.push(new Re(n.key,n.value,'"property" property is required')),C;function M(O){let N=[];const j=O.value,H=O.key;if(Pt(j)!=="array")return[new Re(H,j,`array expected, ${Pt(j)} found`)];if(j.length!==2)return[new Re(H,j,`array length 2 expected, length ${j.length} found`)];if(k){if(Pt(j[0])!=="object")return[new Re(H,j,`object expected, ${Pt(j[0])} found`)];if(j[0].zoom===void 0)return[new Re(H,j,"object stop key must have zoom")];if(j[0].value===void 0)return[new Re(H,j,"object stop key must have value")];if(m&&m>rr(j[0].zoom))return[new Re(H,j[0].zoom,"stop zoom values must appear in ascending order")];rr(j[0].zoom)!==m&&(m=rr(j[0].zoom),h=void 0,y={}),N=N.concat(fn({key:`${H}[0]`,value:j[0],valueSpec:{zoom:{}},validateSpec:O.validateSpec,style:O.style,styleSpec:O.styleSpec,objectElementValidators:{zoom:na,value:L}}))}else N=N.concat(L({key:`${H}[0]`,value:j[0],valueSpec:{},validateSpec:O.validateSpec,style:O.style,styleSpec:O.styleSpec},j));return Ya(Ms(j[1]))?N.concat([new Re(`${H}[1]`,j[1],"expressions are not allowed in function stops.")]):N.concat(O.validateSpec({key:`${H}[1]`,value:j[1],valueSpec:e,validateSpec:O.validateSpec,style:O.style,styleSpec:O.styleSpec}))}function L(O,N){const j=Pt(O.value),H=rr(O.value),Q=O.value!==null?O.value:N;if(a){if(j!==a)return[new Re(O.key,Q,`${j} stop domain type must match previous stop domain type ${a}`)]}else a=j;if(j!=="number"&&j!=="string"&&j!=="boolean")return[new Re(O.key,Q,"stop domain value must be a number, string, or boolean")];if(j!=="number"&&s!=="categorical"){let ue=`number expected, ${j} found`;return co(e)&&s===void 0&&(ue+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new Re(O.key,Q,ue)]}return s!=="categorical"||j!=="number"||isFinite(H)&&Math.floor(H)===H?s!=="categorical"&&j==="number"&&h!==void 0&&H<h?[new Re(O.key,Q,"stop domain values must appear in ascending order")]:(h=H,s==="categorical"&&H in y?[new Re(O.key,Q,"stop domain values must be unique")]:(y[H]=!0,[])):[new Re(O.key,Q,`integer expected, found ${H}`)]}}function As(n){const e=(n.expressionContext==="property"?gu:Qa)(Ms(n.value),n.valueSpec);if(e.result==="error")return e.value.map(a=>new Re(`${n.key}${a.key}`,n.value,a.message));const s=e.value.expression||e.value._styleExpression.expression;if(n.expressionContext==="property"&&n.propertyKey==="text-font"&&!s.outputDefined())return[new Re(n.key,n.value,`Invalid data expression for "${n.propertyKey}". Output values must be contained as literals within the expression.`)];if(n.expressionContext==="property"&&n.propertyType==="layout"&&!Yo(s))return[new Re(n.key,n.value,'"feature-state" data expressions are not supported with layout properties.')];if(n.expressionContext==="filter"&&!Yo(s))return[new Re(n.key,n.value,'"feature-state" data expressions are not supported with filters.')];if(n.expressionContext&&n.expressionContext.indexOf("cluster")===0){if(!qa(s,["zoom","feature-state"]))return[new Re(n.key,n.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(n.expressionContext==="cluster-initial"&&!$a(s))return[new Re(n.key,n.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function ia(n){const e=n.key,s=n.value,a=n.valueSpec,h=[];return Array.isArray(a.values)?a.values.indexOf(rr(s))===-1&&h.push(new Re(e,s,`expected one of [${a.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(a.values).indexOf(rr(s))===-1&&h.push(new Re(e,s,`expected one of [${Object.keys(a.values).join(", ")}], ${JSON.stringify(s)} found`)),h}function po(n){return ta(Ms(n.value))?As(vi({},n,{expressionContext:"filter",valueSpec:{value:"boolean"}})):mh(n)}function mh(n){const e=n.value,s=n.key;if(Pt(e)!=="array")return[new Re(s,e,`array expected, ${Pt(e)} found`)];const a=n.styleSpec;let h,m=[];if(e.length<1)return[new Re(s,e,"filter array must have at least 1 element")];switch(m=m.concat(ia({key:`${s}[0]`,value:e[0],valueSpec:a.filter_operator,style:n.style,styleSpec:n.styleSpec})),rr(e[0])){case"<":case"<=":case">":case">=":e.length>=2&&rr(e[1])==="$type"&&m.push(new Re(s,e,`"$type" cannot be use with operator "${e[0]}"`));case"==":case"!=":e.length!==3&&m.push(new Re(s,e,`filter array for operator "${e[0]}" must have 3 elements`));case"in":case"!in":e.length>=2&&(h=Pt(e[1]),h!=="string"&&m.push(new Re(`${s}[1]`,e[1],`string expected, ${h} found`)));for(let y=2;y<e.length;y++)h=Pt(e[y]),rr(e[1])==="$type"?m=m.concat(ia({key:`${s}[${y}]`,value:e[y],valueSpec:a.geometry_type,style:n.style,styleSpec:n.styleSpec})):h!=="string"&&h!=="number"&&h!=="boolean"&&m.push(new Re(`${s}[${y}]`,e[y],`string, number, or boolean expected, ${h} found`));break;case"any":case"all":case"none":for(let y=1;y<e.length;y++)m=m.concat(mh({key:`${s}[${y}]`,value:e[y],style:n.style,styleSpec:n.styleSpec}));break;case"has":case"!has":h=Pt(e[1]),e.length!==2?m.push(new Re(s,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="string"&&m.push(new Re(`${s}[1]`,e[1],`string expected, ${h} found`));break;case"within":h=Pt(e[1]),e.length!==2?m.push(new Re(s,e,`filter array for "${e[0]}" operator must have 2 elements`)):h!=="object"&&m.push(new Re(`${s}[1]`,e[1],`object expected, ${h} found`))}return m}function gh(n,e){const s=n.key,a=n.validateSpec,h=n.style,m=n.styleSpec,y=n.value,v=n.objectKey,S=m[`${e}_${n.layerType}`];if(!S)return[];const k=v.match(/^(.*)-transition$/);if(e==="paint"&&k&&S[k[1]]&&S[k[1]].transition)return a({key:s,value:y,valueSpec:m.transition,style:h,styleSpec:m});const C=n.valueSpec||S[v];if(!C)return[new Re(s,y,`unknown property "${v}"`)];let M;if(Pt(y)==="string"&&co(C)&&!C.tokens&&(M=/^{([^}]+)}$/.exec(y)))return[new Re(s,y,`"${v}" does not support interpolation syntax
Use an identity property function instead: \`{ "type": "identity", "property": ${JSON.stringify(M[1])} }\`.`)];const L=[];return n.layerType==="symbol"&&(v==="text-field"&&h&&!h.glyphs&&L.push(new Re(s,y,'use of "text-field" requires a style "glyphs" property')),v==="text-font"&&Kt(Ms(y))&&rr(y.type)==="identity"&&L.push(new Re(s,y,'"text-font" does not support identity functions'))),L.concat(a({key:n.key,value:y,valueSpec:C,style:h,styleSpec:m,expressionContext:"property",propertyType:e,propertyKey:v}))}function yh(n){return gh(n,"paint")}function _h(n){return gh(n,"layout")}function vh(n){let e=[];const s=n.value,a=n.key,h=n.style,m=n.styleSpec;s.type||s.ref||e.push(new Re(a,s,'either "type" or "ref" is required'));let y=rr(s.type);const v=rr(s.ref);if(s.id){const S=rr(s.id);for(let k=0;k<n.arrayIndex;k++){const C=h.layers[k];rr(C.id)===S&&e.push(new Re(a,s.id,`duplicate layer id "${s.id}", previously used at line ${C.id.__line__}`))}}if("ref"in s){let S;["type","source","source-layer","filter","layout"].forEach(k=>{k in s&&e.push(new Re(a,s[k],`"${k}" is prohibited for ref layers`))}),h.layers.forEach(k=>{rr(k.id)===v&&(S=k)}),S?S.ref?e.push(new Re(a,s.ref,"ref cannot reference another ref layer")):y=rr(S.type):e.push(new Re(a,s.ref,`ref layer "${v}" not found`))}else if(y!=="background")if(s.source){const S=h.sources&&h.sources[s.source],k=S&&rr(S.type);S?k==="vector"&&y==="raster"?e.push(new Re(a,s.source,`layer "${s.id}" requires a raster source`)):k!=="raster-dem"&&y==="hillshade"?e.push(new Re(a,s.source,`layer "${s.id}" requires a raster-dem source`)):k==="raster"&&y!=="raster"?e.push(new Re(a,s.source,`layer "${s.id}" requires a vector source`)):k!=="vector"||s["source-layer"]?k==="raster-dem"&&y!=="hillshade"?e.push(new Re(a,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):y!=="line"||!s.paint||!s.paint["line-gradient"]||k==="geojson"&&S.lineMetrics||e.push(new Re(a,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):e.push(new Re(a,s,`layer "${s.id}" must specify a "source-layer"`)):e.push(new Re(a,s.source,`source "${s.source}" not found`))}else e.push(new Re(a,s,'missing required property "source"'));return e=e.concat(fn({key:a,value:s,valueSpec:m.layer,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,objectElementValidators:{"*":()=>[],type:()=>n.validateSpec({key:`${a}.type`,value:s.type,valueSpec:m.layer.type,style:n.style,styleSpec:n.styleSpec,validateSpec:n.validateSpec,object:s,objectKey:"type"}),filter:po,layout:S=>fn({layer:s,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":k=>_h(vi({layerType:y},k))}}),paint:S=>fn({layer:s,key:S.key,value:S.value,style:S.style,styleSpec:S.styleSpec,validateSpec:S.validateSpec,objectElementValidators:{"*":k=>yh(vi({layerType:y},k))}})}})),e}function wi(n){const e=n.value,s=n.key,a=Pt(e);return a!=="string"?[new Re(s,e,`string expected, ${a} found`)]:[]}const sa={promoteId:function({key:n,value:e}){if(Pt(e)==="string")return wi({key:n,value:e});{const s=[];for(const a in e)s.push(...wi({key:`${n}.${a}`,value:e[a]}));return s}}};function zn(n){const e=n.value,s=n.key,a=n.styleSpec,h=n.style,m=n.validateSpec;if(!e.type)return[new Re(s,e,'"type" is required')];const y=rr(e.type);let v;switch(y){case"vector":case"raster":return v=fn({key:s,value:e,valueSpec:a[`source_${y.replace("-","_")}`],style:n.style,styleSpec:a,objectElementValidators:sa,validateSpec:m}),v;case"raster-dem":return v=function(S){var k;const C=(k=S.sourceName)!==null&&k!==void 0?k:"",M=S.value,L=S.styleSpec,O=L.source_raster_dem,N=S.style;let j=[];const H=Pt(M);if(M===void 0)return j;if(H!=="object")return j.push(new Re("source_raster_dem",M,`object expected, ${H} found`)),j;const Q=rr(M.encoding)==="custom",ue=["redFactor","greenFactor","blueFactor","baseShift"],ie=S.value.encoding?`"${S.value.encoding}"`:"Default";for(const de in M)!Q&&ue.includes(de)?j.push(new Re(de,M[de],`In "${C}": "${de}" is only valid when "encoding" is set to "custom". ${ie} encoding found`)):O[de]?j=j.concat(S.validateSpec({key:de,value:M[de],valueSpec:O[de],validateSpec:S.validateSpec,style:N,styleSpec:L})):j.push(new Re(de,M[de],`unknown property "${de}"`));return j}({sourceName:s,value:e,style:n.style,styleSpec:a,validateSpec:m}),v;case"geojson":if(v=fn({key:s,value:e,valueSpec:a.source_geojson,style:h,styleSpec:a,validateSpec:m,objectElementValidators:sa}),e.cluster)for(const S in e.clusterProperties){const[k,C]=e.clusterProperties[S],M=typeof k=="string"?[k,["accumulated"],["get",S]]:k;v.push(...As({key:`${s}.${S}.map`,value:C,validateSpec:m,expressionContext:"cluster-map"})),v.push(...As({key:`${s}.${S}.reduce`,value:M,validateSpec:m,expressionContext:"cluster-reduce"}))}return v;case"video":return fn({key:s,value:e,valueSpec:a.source_video,style:h,validateSpec:m,styleSpec:a});case"image":return fn({key:s,value:e,valueSpec:a.source_image,style:h,validateSpec:m,styleSpec:a});case"canvas":return[new Re(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return ia({key:`${s}.type`,value:e.type,valueSpec:{values:["vector","raster","raster-dem","geojson","video","image"]},style:h,validateSpec:m,styleSpec:a})}}function oa(n){const e=n.value,s=n.styleSpec,a=s.light,h=n.style;let m=[];const y=Pt(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new Re("light",e,`object expected, ${y} found`)]),m;for(const v in e){const S=v.match(/^(.*)-transition$/);m=m.concat(S&&a[S[1]]&&a[S[1]].transition?n.validateSpec({key:v,value:e[v],valueSpec:s.transition,validateSpec:n.validateSpec,style:h,styleSpec:s}):a[v]?n.validateSpec({key:v,value:e[v],valueSpec:a[v],validateSpec:n.validateSpec,style:h,styleSpec:s}):[new Re(v,e[v],`unknown property "${v}"`)])}return m}function xh(n){const e=n.value,s=n.styleSpec,a=s.terrain,h=n.style;let m=[];const y=Pt(e);if(e===void 0)return m;if(y!=="object")return m=m.concat([new Re("terrain",e,`object expected, ${y} found`)]),m;for(const v in e)m=m.concat(a[v]?n.validateSpec({key:v,value:e[v],valueSpec:a[v],validateSpec:n.validateSpec,style:h,styleSpec:s}):[new Re(v,e[v],`unknown property "${v}"`)]);return m}function wh(n){let e=[];const s=n.value,a=n.key;if(Array.isArray(s)){const h=[],m=[];for(const y in s)s[y].id&&h.includes(s[y].id)&&e.push(new Re(a,s,`all the sprites' ids must be unique, but ${s[y].id} is duplicated`)),h.push(s[y].id),s[y].url&&m.includes(s[y].url)&&e.push(new Re(a,s,`all the sprites' URLs must be unique, but ${s[y].url} is duplicated`)),m.push(s[y].url),e=e.concat(fn({key:`${a}[${y}]`,value:s[y],valueSpec:{id:{type:"string",required:!0},url:{type:"string",required:!0}},validateSpec:n.validateSpec}));return e}return wi({key:a,value:s})}const bh={"*":()=>[],array:ho,boolean:function(n){const e=n.value,s=n.key,a=Pt(e);return a!=="boolean"?[new Re(s,e,`boolean expected, ${a} found`)]:[]},number:na,color:function(n){const e=n.key,s=n.value,a=Pt(s);return a!=="string"?[new Re(e,s,`color expected, ${a} found`)]:Lt.parse(String(s))?[]:[new Re(e,s,`color expected, "${s}" found`)]},constants:fh,enum:ia,filter:po,function:nl,layer:vh,object:fn,source:zn,light:oa,terrain:xh,string:wi,formatted:function(n){return wi(n).length===0?[]:As(n)},resolvedImage:function(n){return wi(n).length===0?[]:As(n)},padding:function(n){const e=n.key,s=n.value;if(Pt(s)==="array"){if(s.length<1||s.length>4)return[new Re(e,s,`padding requires 1 to 4 values; ${s.length} values found`)];const a={type:"number"};let h=[];for(let m=0;m<s.length;m++)h=h.concat(n.validateSpec({key:`${e}[${m}]`,value:s[m],validateSpec:n.validateSpec,valueSpec:a}));return h}return na({key:e,value:s,valueSpec:{}})},variableAnchorOffsetCollection:function(n){const e=n.key,s=n.value,a=Pt(s),h=n.styleSpec;if(a!=="array"||s.length<1||s.length%2!=0)return[new Re(e,s,"variableAnchorOffsetCollection requires a non-empty array of even length")];let m=[];for(let y=0;y<s.length;y+=2)m=m.concat(ia({key:`${e}[${y}]`,value:s[y],valueSpec:h.layout_symbol["text-anchor"]})),m=m.concat(ho({key:`${e}[${y+1}]`,value:s[y+1],valueSpec:{length:2,value:"number"},validateSpec:n.validateSpec,style:n.style,styleSpec:h}));return m},sprite:wh};function Ni(n){const e=n.value,s=n.valueSpec,a=n.styleSpec;return n.validateSpec=Ni,s.expression&&Kt(rr(e))?nl(n):s.expression&&Ya(Ms(e))?As(n):s.type&&bh[s.type]?bh[s.type](n):fn(vi({},n,{valueSpec:s.type?a[s.type]:s}))}function Sh(n){const e=n.value,s=n.key,a=wi(n);return a.length||(e.indexOf("{fontstack}")===-1&&a.push(new Re(s,e,'"glyphs" url must include a "{fontstack}" token')),e.indexOf("{range}")===-1&&a.push(new Re(s,e,'"glyphs" url must include a "{range}" token'))),a}function Wn(n,e=ve){let s=[];return s=s.concat(Ni({key:"",value:n,valueSpec:e.$root,styleSpec:e,style:n,validateSpec:Ni,objectElementValidators:{glyphs:Sh,"*":()=>[]}})),n.constants&&(s=s.concat(fh({key:"constants",value:n.constants,style:n,styleSpec:e,validateSpec:Ni}))),il(s)}function Vi(n){return function(e){return n({...e,validateSpec:Ni})}}function il(n){return[].concat(n).sort((e,s)=>e.line-s.line)}function Ui(n){return function(...e){return il(n.apply(this,e))}}Wn.source=Ui(Vi(zn)),Wn.sprite=Ui(Vi(wh)),Wn.glyphs=Ui(Vi(Sh)),Wn.light=Ui(Vi(oa)),Wn.terrain=Ui(Vi(xh)),Wn.layer=Ui(Vi(vh)),Wn.filter=Ui(Vi(po)),Wn.paintProperty=Ui(Vi(yh)),Wn.layoutProperty=Ui(Vi(_h));const ji=Wn,Xp=ji.light,vu=ji.paintProperty,Th=ji.layoutProperty;function sl(n,e){let s=!1;if(e&&e.length)for(const a of e)n.fire(new as(new Error(a.message))),s=!0;return s}class fo{constructor(e,s,a){const h=this.cells=[];if(e instanceof ArrayBuffer){this.arrayBuffer=e;const y=new Int32Array(this.arrayBuffer);e=y[0],this.d=(s=y[1])+2*(a=y[2]);for(let S=0;S<this.d*this.d;S++){const k=y[3+S],C=y[3+S+1];h.push(k===C?null:y.subarray(k,C))}const v=y[3+h.length+1];this.keys=y.subarray(y[3+h.length],v),this.bboxes=y.subarray(v),this.insert=this._insertReadonly}else{this.d=s+2*a;for(let y=0;y<this.d*this.d;y++)h.push([]);this.keys=[],this.bboxes=[]}this.n=s,this.extent=e,this.padding=a,this.scale=s/e,this.uid=0;const m=a/s*e;this.min=-m,this.max=e+m}insert(e,s,a,h,m){this._forEachCell(s,a,h,m,this._insertCell,this.uid++,void 0,void 0),this.keys.push(e),this.bboxes.push(s),this.bboxes.push(a),this.bboxes.push(h),this.bboxes.push(m)}_insertReadonly(){throw new Error("Cannot insert into a GridIndex created from an ArrayBuffer.")}_insertCell(e,s,a,h,m,y){this.cells[m].push(y)}query(e,s,a,h,m){const y=this.min,v=this.max;if(e<=y&&s<=y&&v<=a&&v<=h&&!m)return Array.prototype.slice.call(this.keys);{const S=[];return this._forEachCell(e,s,a,h,this._queryCell,S,{},m),S}}_queryCell(e,s,a,h,m,y,v,S){const k=this.cells[m];if(k!==null){const C=this.keys,M=this.bboxes;for(let L=0;L<k.length;L++){const O=k[L];if(v[O]===void 0){const N=4*O;(S?S(M[N+0],M[N+1],M[N+2],M[N+3]):e<=M[N+2]&&s<=M[N+3]&&a>=M[N+0]&&h>=M[N+1])?(v[O]=!0,y.push(C[O])):v[O]=!1}}}}_forEachCell(e,s,a,h,m,y,v,S){const k=this._convertToCellCoord(e),C=this._convertToCellCoord(s),M=this._convertToCellCoord(a),L=this._convertToCellCoord(h);for(let O=k;O<=M;O++)for(let N=C;N<=L;N++){const j=this.d*N+O;if((!S||S(this._convertFromCellCoord(O),this._convertFromCellCoord(N),this._convertFromCellCoord(O+1),this._convertFromCellCoord(N+1)))&&m.call(this,e,s,a,h,j,y,v,S))return}}_convertFromCellCoord(e){return(e-this.padding)/this.scale}_convertToCellCoord(e){return Math.max(0,Math.min(this.d-1,Math.floor(e*this.scale)+this.padding))}toArrayBuffer(){if(this.arrayBuffer)return this.arrayBuffer;const e=this.cells,s=3+this.cells.length+1+1;let a=0;for(let y=0;y<this.cells.length;y++)a+=this.cells[y].length;const h=new Int32Array(s+a+this.keys.length+this.bboxes.length);h[0]=this.extent,h[1]=this.n,h[2]=this.padding;let m=s;for(let y=0;y<e.length;y++){const v=e[y];h[3+y]=m,h.set(v,m),m+=v.length}return h[3+e.length]=m,h.set(this.keys,m),m+=this.keys.length,h[3+e.length+1]=m,h.set(this.bboxes,m),m+=this.bboxes.length,h.buffer}static serialize(e,s){const a=e.toArrayBuffer();return s&&s.push(a),{buffer:a}}static deserialize(e){return new fo(e.buffer)}}const $i={};function Ge(n,e,s={}){if($i[n])throw new Error(`${n} is already registered.`);Object.defineProperty(e,"_classRegistryKey",{value:n,writeable:!1}),$i[n]={klass:e,omit:s.omit||[],shallow:s.shallow||[]}}Ge("Object",Object),Ge("TransferableGridIndex",fo),Ge("Color",Lt),Ge("Error",Error),Ge("AJAXError",is),Ge("ResolvedImage",Fr),Ge("StylePropertyFunction",Jo),Ge("StyleExpression",fu,{omit:["_evaluator"]}),Ge("ZoomDependentExpression",Ja),Ge("ZoomConstantExpression",mu),Ge("CompoundExpression",Gn,{omit:["_evaluate"]});for(const n in uo)uo[n]._classRegistryKey||Ge(`Expression_${n}`,uo[n]);function ol(n){return n&&typeof ArrayBuffer<"u"&&(n instanceof ArrayBuffer||n.constructor&&n.constructor.name==="ArrayBuffer")}function ps(n,e){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||n instanceof Blob)return n;if(ol(n)||ht(n))return e&&e.push(n),n;if(ArrayBuffer.isView(n)){const s=n;return e&&e.push(s.buffer),s}if(n instanceof ImageData)return e&&e.push(n.data.buffer),n;if(Array.isArray(n)){const s=[];for(const a of n)s.push(ps(a,e));return s}if(typeof n=="object"){const s=n.constructor,a=s._classRegistryKey;if(!a)throw new Error("can't serialize object of unregistered class");if(!$i[a])throw new Error(`${a} is not registered.`);const h=s.serialize?s.serialize(n,e):{};if(s.serialize){if(e&&h===e[e.length-1])throw new Error("statically serialized object won't survive transfer of $name property")}else{for(const m in n){if(!n.hasOwnProperty(m)||$i[a].omit.indexOf(m)>=0)continue;const y=n[m];h[m]=$i[a].shallow.indexOf(m)>=0?y:ps(y,e)}n instanceof Error&&(h.message=n.message)}if(h.$name)throw new Error("$name property is reserved for worker serialization logic.");return a!=="Object"&&(h.$name=a),h}throw new Error("can't serialize object of type "+typeof n)}function mo(n){if(n==null||typeof n=="boolean"||typeof n=="number"||typeof n=="string"||n instanceof Boolean||n instanceof Number||n instanceof String||n instanceof Date||n instanceof RegExp||n instanceof Blob||ol(n)||ht(n)||ArrayBuffer.isView(n)||n instanceof ImageData)return n;if(Array.isArray(n))return n.map(mo);if(typeof n=="object"){const e=n.$name||"Object";if(!$i[e])throw new Error(`can't deserialize unregistered class ${e}`);const{klass:s}=$i[e];if(!s)throw new Error(`can't deserialize unregistered class ${e}`);if(s.deserialize)return s.deserialize(n);const a=Object.create(s.prototype);for(const h of Object.keys(n)){if(h==="$name")continue;const m=n[h];a[h]=$i[e].shallow.indexOf(h)>=0?m:mo(m)}return a}throw new Error("can't deserialize object of type "+typeof n)}class kh{constructor(){this.first=!0}update(e,s){const a=Math.floor(e);return this.first?(this.first=!1,this.lastIntegerZoom=a,this.lastIntegerZoomTime=0,this.lastZoom=e,this.lastFloorZoom=a,!0):(this.lastFloorZoom>a?(this.lastIntegerZoom=a+1,this.lastIntegerZoomTime=s):this.lastFloorZoom<a&&(this.lastIntegerZoom=a,this.lastIntegerZoomTime=s),e!==this.lastZoom&&(this.lastZoom=e,this.lastFloorZoom=a,!0))}}const $e={"Latin-1 Supplement":n=>n>=128&&n<=255,Arabic:n=>n>=1536&&n<=1791,"Arabic Supplement":n=>n>=1872&&n<=1919,"Arabic Extended-A":n=>n>=2208&&n<=2303,"Hangul Jamo":n=>n>=4352&&n<=4607,"Unified Canadian Aboriginal Syllabics":n=>n>=5120&&n<=5759,Khmer:n=>n>=6016&&n<=6143,"Unified Canadian Aboriginal Syllabics Extended":n=>n>=6320&&n<=6399,"General Punctuation":n=>n>=8192&&n<=8303,"Letterlike Symbols":n=>n>=8448&&n<=8527,"Number Forms":n=>n>=8528&&n<=8591,"Miscellaneous Technical":n=>n>=8960&&n<=9215,"Control Pictures":n=>n>=9216&&n<=9279,"Optical Character Recognition":n=>n>=9280&&n<=9311,"Enclosed Alphanumerics":n=>n>=9312&&n<=9471,"Geometric Shapes":n=>n>=9632&&n<=9727,"Miscellaneous Symbols":n=>n>=9728&&n<=9983,"Miscellaneous Symbols and Arrows":n=>n>=11008&&n<=11263,"CJK Radicals Supplement":n=>n>=11904&&n<=12031,"Kangxi Radicals":n=>n>=12032&&n<=12255,"Ideographic Description Characters":n=>n>=12272&&n<=12287,"CJK Symbols and Punctuation":n=>n>=12288&&n<=12351,Hiragana:n=>n>=12352&&n<=12447,Katakana:n=>n>=12448&&n<=12543,Bopomofo:n=>n>=12544&&n<=12591,"Hangul Compatibility Jamo":n=>n>=12592&&n<=12687,Kanbun:n=>n>=12688&&n<=12703,"Bopomofo Extended":n=>n>=12704&&n<=12735,"CJK Strokes":n=>n>=12736&&n<=12783,"Katakana Phonetic Extensions":n=>n>=12784&&n<=12799,"Enclosed CJK Letters and Months":n=>n>=12800&&n<=13055,"CJK Compatibility":n=>n>=13056&&n<=13311,"CJK Unified Ideographs Extension A":n=>n>=13312&&n<=19903,"Yijing Hexagram Symbols":n=>n>=19904&&n<=19967,"CJK Unified Ideographs":n=>n>=19968&&n<=40959,"Yi Syllables":n=>n>=40960&&n<=42127,"Yi Radicals":n=>n>=42128&&n<=42191,"Hangul Jamo Extended-A":n=>n>=43360&&n<=43391,"Hangul Syllables":n=>n>=44032&&n<=55215,"Hangul Jamo Extended-B":n=>n>=55216&&n<=55295,"Private Use Area":n=>n>=57344&&n<=63743,"CJK Compatibility Ideographs":n=>n>=63744&&n<=64255,"Arabic Presentation Forms-A":n=>n>=64336&&n<=65023,"Vertical Forms":n=>n>=65040&&n<=65055,"CJK Compatibility Forms":n=>n>=65072&&n<=65103,"Small Form Variants":n=>n>=65104&&n<=65135,"Arabic Presentation Forms-B":n=>n>=65136&&n<=65279,"Halfwidth and Fullwidth Forms":n=>n>=65280&&n<=65519};function xu(n){for(const e of n)if(bu(e.charCodeAt(0)))return!0;return!1}function wu(n){for(const e of n)if(!Kp(e.charCodeAt(0)))return!1;return!0}function Kp(n){return!($e.Arabic(n)||$e["Arabic Supplement"](n)||$e["Arabic Extended-A"](n)||$e["Arabic Presentation Forms-A"](n)||$e["Arabic Presentation Forms-B"](n))}function bu(n){return!(n!==746&&n!==747&&(n<4352||!($e["Bopomofo Extended"](n)||$e.Bopomofo(n)||$e["CJK Compatibility Forms"](n)&&!(n>=65097&&n<=65103)||$e["CJK Compatibility Ideographs"](n)||$e["CJK Compatibility"](n)||$e["CJK Radicals Supplement"](n)||$e["CJK Strokes"](n)||!(!$e["CJK Symbols and Punctuation"](n)||n>=12296&&n<=12305||n>=12308&&n<=12319||n===12336)||$e["CJK Unified Ideographs Extension A"](n)||$e["CJK Unified Ideographs"](n)||$e["Enclosed CJK Letters and Months"](n)||$e["Hangul Compatibility Jamo"](n)||$e["Hangul Jamo Extended-A"](n)||$e["Hangul Jamo Extended-B"](n)||$e["Hangul Jamo"](n)||$e["Hangul Syllables"](n)||$e.Hiragana(n)||$e["Ideographic Description Characters"](n)||$e.Kanbun(n)||$e["Kangxi Radicals"](n)||$e["Katakana Phonetic Extensions"](n)||$e.Katakana(n)&&n!==12540||!(!$e["Halfwidth and Fullwidth Forms"](n)||n===65288||n===65289||n===65293||n>=65306&&n<=65310||n===65339||n===65341||n===65343||n>=65371&&n<=65503||n===65507||n>=65512&&n<=65519)||!(!$e["Small Form Variants"](n)||n>=65112&&n<=65118||n>=65123&&n<=65126)||$e["Unified Canadian Aboriginal Syllabics"](n)||$e["Unified Canadian Aboriginal Syllabics Extended"](n)||$e["Vertical Forms"](n)||$e["Yijing Hexagram Symbols"](n)||$e["Yi Syllables"](n)||$e["Yi Radicals"](n))))}function Eh(n){return!(bu(n)||function(e){return!!($e["Latin-1 Supplement"](e)&&(e===167||e===169||e===174||e===177||e===188||e===189||e===190||e===215||e===247)||$e["General Punctuation"](e)&&(e===8214||e===8224||e===8225||e===8240||e===8241||e===8251||e===8252||e===8258||e===8263||e===8264||e===8265||e===8273)||$e["Letterlike Symbols"](e)||$e["Number Forms"](e)||$e["Miscellaneous Technical"](e)&&(e>=8960&&e<=8967||e>=8972&&e<=8991||e>=8996&&e<=9e3||e===9003||e>=9085&&e<=9114||e>=9150&&e<=9165||e===9167||e>=9169&&e<=9179||e>=9186&&e<=9215)||$e["Control Pictures"](e)&&e!==9251||$e["Optical Character Recognition"](e)||$e["Enclosed Alphanumerics"](e)||$e["Geometric Shapes"](e)||$e["Miscellaneous Symbols"](e)&&!(e>=9754&&e<=9759)||$e["Miscellaneous Symbols and Arrows"](e)&&(e>=11026&&e<=11055||e>=11088&&e<=11097||e>=11192&&e<=11243)||$e["CJK Symbols and Punctuation"](e)||$e.Katakana(e)||$e["Private Use Area"](e)||$e["CJK Compatibility Forms"](e)||$e["Small Form Variants"](e)||$e["Halfwidth and Fullwidth Forms"](e)||e===8734||e===8756||e===8757||e>=9984&&e<=10087||e>=10102&&e<=10131||e===65532||e===65533)}(n))}function Ih(n){return n>=1424&&n<=2303||$e["Arabic Presentation Forms-A"](n)||$e["Arabic Presentation Forms-B"](n)}function Ch(n,e){return!(!e&&Ih(n)||n>=2304&&n<=3583||n>=3840&&n<=4255||$e.Khmer(n))}function Yp(n){for(const e of n)if(Ih(e.charCodeAt(0)))return!0;return!1}const Su="deferred",Tu="loading",ku="loaded";let Eu=null,mn="unavailable",fs=null;const aa=function(n){n&&typeof n=="string"&&n.indexOf("NetworkError")>-1&&(mn="error"),Eu&&Eu(n)};function Iu(){la.fire(new os("pluginStateChange",{pluginStatus:mn,pluginURL:fs}))}const la=new Ts,Cu=function(){return mn},Ph=function(){if(mn!==Su||!fs)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");mn=Tu,Iu(),fs&&Xo({url:fs},n=>{n?aa(n):(mn=ku,Iu())})},Mn={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>mn===ku||Mn.applyArabicShaping!=null,isLoading:()=>mn===Tu,setState(n){if(!$r())throw new Error("Cannot set the state of the rtl-text-plugin when not in the web-worker context");mn=n.pluginStatus,fs=n.pluginURL},isParsed(){if(!$r())throw new Error("rtl-text-plugin is only parsed on the worker-threads");return Mn.applyArabicShaping!=null&&Mn.processBidirectionalText!=null&&Mn.processStyledBidirectionalText!=null},getPluginURL(){if(!$r())throw new Error("rtl-text-plugin url can only be queried from the worker threads");return fs}};class qt{constructor(e,s){this.zoom=e,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.zoomHistory=s.zoomHistory,this.transition=s.transition):(this.now=0,this.fadeDuration=0,this.zoomHistory=new kh,this.transition={})}isSupportedScript(e){return function(s,a){for(const h of s)if(!Ch(h.charCodeAt(0),a))return!1;return!0}(e,Mn.isLoaded())}crossFadingFactor(){return this.fadeDuration===0?1:Math.min((this.now-this.zoomHistory.lastIntegerZoomTime)/this.fadeDuration,1)}getCrossfadeParameters(){const e=this.zoom,s=e-Math.floor(e),a=this.crossFadingFactor();return e>this.zoomHistory.lastIntegerZoom?{fromScale:2,toScale:1,t:s+(1-s)*a}:{fromScale:.5,toScale:1,t:1-(1-a)*s}}}class al{constructor(e,s){this.property=e,this.value=s,this.expression=function(a,h){if(Kt(a))return new Jo(a,h);if(Ya(a)){const m=gu(a,h);if(m.result==="error")throw new Error(m.value.map(y=>`${y.key}: ${y.message}`).join(", "));return m.value}{let m=a;return h.type==="color"&&typeof a=="string"?m=Lt.parse(a):h.type!=="padding"||typeof a!="number"&&!Array.isArray(a)?h.type==="variableAnchorOffsetCollection"&&Array.isArray(a)&&(m=qn.parse(a)):m=In.parse(a),{kind:"constant",evaluate:()=>m}}}(s===void 0?e.specification.default:s,e.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(e,s,a){return this.property.possiblyEvaluate(this,e,s,a)}}class Pu{constructor(e){this.property=e,this.value=new al(e,void 0)}transitioned(e,s){return new Mh(this.property,this.value,s,Ze({},e.transition,this.transition),e.now)}untransitioned(){return new Mh(this.property,this.value,null,{},0)}}class zh{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitionablePropertyValues)}getValue(e){return Lr(this._values[e].value.value)}setValue(e,s){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Pu(this._values[e].property)),this._values[e].value=new al(this._values[e].property,s===null?void 0:Lr(s))}getTransition(e){return Lr(this._values[e].transition)}setTransition(e,s){Object.prototype.hasOwnProperty.call(this._values,e)||(this._values[e]=new Pu(this._values[e].property)),this._values[e].transition=Lr(s)||void 0}serialize(){const e={};for(const s of Object.keys(this._values)){const a=this.getValue(s);a!==void 0&&(e[s]=a);const h=this.getTransition(s);h!==void 0&&(e[`${s}-transition`]=h)}return e}transitioned(e,s){const a=new Ah(this._properties);for(const h of Object.keys(this._values))a._values[h]=this._values[h].transitioned(e,s._values[h]);return a}untransitioned(){const e=new Ah(this._properties);for(const s of Object.keys(this._values))e._values[s]=this._values[s].untransitioned();return e}}class Mh{constructor(e,s,a,h,m){this.property=e,this.value=s,this.begin=m+h.delay||0,this.end=this.begin+h.duration||0,e.specification.transition&&(h.delay||h.duration)&&(this.prior=a)}possiblyEvaluate(e,s,a){const h=e.now||0,m=this.value.possiblyEvaluate(e,s,a),y=this.prior;if(y){if(h>this.end)return this.prior=null,m;if(this.value.isDataDriven())return this.prior=null,m;if(h<this.begin)return y.possiblyEvaluate(e,s,a);{const v=(h-this.begin)/(this.end-this.begin);return this.property.interpolate(y.possiblyEvaluate(e,s,a),m,function(S){if(S<=0)return 0;if(S>=1)return 1;const k=S*S,C=k*S;return 4*(S<.5?C:3*(S-k)+C-.75)}(v))}}return m}}class Ah{constructor(e){this._properties=e,this._values=Object.create(e.defaultTransitioningPropertyValues)}possiblyEvaluate(e,s,a){const h=new ll(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(e,s,a);return h}hasTransition(){for(const e of Object.keys(this._values))if(this._values[e].prior)return!0;return!1}}class Qp{constructor(e){this._properties=e,this._values=Object.create(e.defaultPropertyValues)}hasValue(e){return this._values[e].value!==void 0}getValue(e){return Lr(this._values[e].value)}setValue(e,s){this._values[e]=new al(this._values[e].property,s===null?void 0:Lr(s))}serialize(){const e={};for(const s of Object.keys(this._values)){const a=this.getValue(s);a!==void 0&&(e[s]=a)}return e}possiblyEvaluate(e,s,a){const h=new ll(this._properties);for(const m of Object.keys(this._values))h._values[m]=this._values[m].possiblyEvaluate(e,s,a);return h}}class en{constructor(e,s,a){this.property=e,this.value=s,this.parameters=a}isConstant(){return this.value.kind==="constant"}constantOr(e){return this.value.kind==="constant"?this.value.value:e}evaluate(e,s,a,h){return this.property.evaluate(this.value,this.parameters,e,s,a,h)}}class ll{constructor(e){this._properties=e,this._values=Object.create(e.defaultPossiblyEvaluatedValues)}get(e){return this._values[e]}}class et{constructor(e){this.specification=e}possiblyEvaluate(e,s){if(e.isDataDriven())throw new Error("Value should not be data driven");return e.expression.evaluate(s)}interpolate(e,s,a){const h=Cn[this.specification.type];return h?h(e,s,a):e}}class ot{constructor(e,s){this.specification=e,this.overrides=s}possiblyEvaluate(e,s,a,h){return new en(this,e.expression.kind==="constant"||e.expression.kind==="camera"?{kind:"constant",value:e.expression.evaluate(s,null,{},a,h)}:e.expression,s)}interpolate(e,s,a){if(e.value.kind!=="constant"||s.value.kind!=="constant")return e;if(e.value.value===void 0||s.value.value===void 0)return new en(this,{kind:"constant",value:void 0},e.parameters);const h=Cn[this.specification.type];if(h){const m=h(e.value.value,s.value.value,a);return new en(this,{kind:"constant",value:m},e.parameters)}return e}evaluate(e,s,a,h,m,y){return e.kind==="constant"?e.value:e.evaluate(s,a,h,m,y)}}class ua extends ot{possiblyEvaluate(e,s,a,h){if(e.value===void 0)return new en(this,{kind:"constant",value:void 0},s);if(e.expression.kind==="constant"){const m=e.expression.evaluate(s,null,{},a,h),y=e.property.specification.type==="resolvedImage"&&typeof m!="string"?m.name:m,v=this._calculate(y,y,y,s);return new en(this,{kind:"constant",value:v},s)}if(e.expression.kind==="camera"){const m=this._calculate(e.expression.evaluate({zoom:s.zoom-1}),e.expression.evaluate({zoom:s.zoom}),e.expression.evaluate({zoom:s.zoom+1}),s);return new en(this,{kind:"constant",value:m},s)}return new en(this,e.expression,s)}evaluate(e,s,a,h,m,y){if(e.kind==="source"){const v=e.evaluate(s,a,h,m,y);return this._calculate(v,v,v,s)}return e.kind==="composite"?this._calculate(e.evaluate({zoom:Math.floor(s.zoom)-1},a,h),e.evaluate({zoom:Math.floor(s.zoom)},a,h),e.evaluate({zoom:Math.floor(s.zoom)+1},a,h),s):e.value}_calculate(e,s,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:s}:{from:a,to:s}}interpolate(e){return e}}class zu{constructor(e){this.specification=e}possiblyEvaluate(e,s,a,h){if(e.value!==void 0){if(e.expression.kind==="constant"){const m=e.expression.evaluate(s,null,{},a,h);return this._calculate(m,m,m,s)}return this._calculate(e.expression.evaluate(new qt(Math.floor(s.zoom-1),s)),e.expression.evaluate(new qt(Math.floor(s.zoom),s)),e.expression.evaluate(new qt(Math.floor(s.zoom+1),s)),s)}}_calculate(e,s,a,h){return h.zoom>h.zoomHistory.lastIntegerZoom?{from:e,to:s}:{from:a,to:s}}interpolate(e){return e}}class Mu{constructor(e){this.specification=e}possiblyEvaluate(e,s,a,h){return!!e.expression.evaluate(s,null,{},a,h)}interpolate(){return!1}}class dr{constructor(e){this.properties=e,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];for(const s in e){const a=e[s];a.specification.overridable&&this.overridableProperties.push(s);const h=this.defaultPropertyValues[s]=new al(a,void 0),m=this.defaultTransitionablePropertyValues[s]=new Pu(a);this.defaultTransitioningPropertyValues[s]=m.untransitioned(),this.defaultPossiblyEvaluatedValues[s]=h.possiblyEvaluate({})}}}Ge("DataDrivenProperty",ot),Ge("DataConstantProperty",et),Ge("CrossFadedDataDrivenProperty",ua),Ge("CrossFadedProperty",zu),Ge("ColorRampProperty",Mu);const Au="-transition";class Hn extends Ts{constructor(e,s){if(super(),this.id=e.id,this.type=e.type,this._featureFilter={filter:()=>!0,needGeometry:!1},e.type!=="custom"&&(this.metadata=e.metadata,this.minzoom=e.minzoom,this.maxzoom=e.maxzoom,e.type!=="background"&&(this.source=e.source,this.sourceLayer=e["source-layer"],this.filter=e.filter),s.layout&&(this._unevaluatedLayout=new Qp(s.layout)),s.paint)){this._transitionablePaint=new zh(s.paint);for(const a in e.paint)this.setPaintProperty(a,e.paint[a],{validate:!1});for(const a in e.layout)this.setLayoutProperty(a,e.layout[a],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new ll(s.paint)}}getCrossfadeParameters(){return this._crossfadeParameters}getLayoutProperty(e){return e==="visibility"?this.visibility:this._unevaluatedLayout.getValue(e)}setLayoutProperty(e,s,a={}){s!=null&&this._validate(Th,`layers.${this.id}.layout.${e}`,e,s,a)||(e!=="visibility"?this._unevaluatedLayout.setValue(e,s):this.visibility=s)}getPaintProperty(e){return e.endsWith(Au)?this._transitionablePaint.getTransition(e.slice(0,-11)):this._transitionablePaint.getValue(e)}setPaintProperty(e,s,a={}){if(s!=null&&this._validate(vu,`layers.${this.id}.paint.${e}`,e,s,a))return!1;if(e.endsWith(Au))return this._transitionablePaint.setTransition(e.slice(0,-11),s||void 0),!1;{const h=this._transitionablePaint._values[e],m=h.property.specification["property-type"]==="cross-faded-data-driven",y=h.value.isDataDriven(),v=h.value;this._transitionablePaint.setValue(e,s),this._handleSpecialPaintPropertyUpdate(e);const S=this._transitionablePaint._values[e].value;return S.isDataDriven()||y||m||this._handleOverridablePaintPropertyUpdate(e,v,S)}}_handleSpecialPaintPropertyUpdate(e){}_handleOverridablePaintPropertyUpdate(e,s,a){return!1}isHidden(e){return!!(this.minzoom&&e<this.minzoom)||!!(this.maxzoom&&e>=this.maxzoom)||this.visibility==="none"}updateTransitions(e){this._transitioningPaint=this._transitionablePaint.transitioned(e,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(e,s){e.getCrossfadeParameters&&(this._crossfadeParameters=e.getCrossfadeParameters()),this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(e,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(e,void 0,s)}serialize(){const e={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(e.layout=e.layout||{},e.layout.visibility=this.visibility),Mr(e,(s,a)=>!(s===void 0||a==="layout"&&!Object.keys(s).length||a==="paint"&&!Object.keys(s).length))}_validate(e,s,a,h,m={}){return(!m||m.validate!==!1)&&sl(this,e.call(ji,{key:s,layerType:this.type,objectKey:a,value:h,styleSpec:ve,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const e in this.paint._values){const s=this.paint.get(e);if(s instanceof en&&co(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}}const Dh={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Ds{constructor(e,s){this._structArray=e,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class nr{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(e,s){return e._trim(),s&&(e.isTransferred=!0,s.push(e.arrayBuffer)),{length:e.length,arrayBuffer:e.arrayBuffer}}static deserialize(e){const s=Object.create(this.prototype);return s.arrayBuffer=e.arrayBuffer,s.length=e.length,s.capacity=e.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(e){this.reserve(e),this.length=e}reserve(e){if(e>this.capacity){this.capacity=Math.max(e,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}}function Qt(n,e=1){let s=0,a=0;return{members:n.map(h=>{const m=Dh[h.type].BYTES_PER_ELEMENT,y=s=go(s,Math.max(e,m)),v=h.components||1;return a=Math.max(a,m),s+=m*v,{name:h.name,type:h.type,components:v,offset:y}}),size:go(s,Math.max(a,e)),alignment:e}}function go(n,e){return Math.ceil(n/e)*e}class ca extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s){const a=this.length;return this.resize(a+1),this.emplace(a,e,s)}emplace(e,s,a){const h=2*e;return this.int16[h+0]=s,this.int16[h+1]=a,e}}ca.prototype.bytesPerElement=4,Ge("StructArrayLayout2i4",ca);class ha extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,s,a)}emplace(e,s,a,h){const m=3*e;return this.int16[m+0]=s,this.int16[m+1]=a,this.int16[m+2]=h,e}}ha.prototype.bytesPerElement=6,Ge("StructArrayLayout3i6",ha);class Ls extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,s,a,h)}emplace(e,s,a,h,m){const y=4*e;return this.int16[y+0]=s,this.int16[y+1]=a,this.int16[y+2]=h,this.int16[y+3]=m,e}}Ls.prototype.bytesPerElement=8,Ge("StructArrayLayout4i8",Ls);class Du extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,a,h,m,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,s,a,h,m,y)}emplace(e,s,a,h,m,y,v){const S=6*e;return this.int16[S+0]=s,this.int16[S+1]=a,this.int16[S+2]=h,this.int16[S+3]=m,this.int16[S+4]=y,this.int16[S+5]=v,e}}Du.prototype.bytesPerElement=12,Ge("StructArrayLayout2i4i12",Du);class Lu extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,a,h,m,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,s,a,h,m,y)}emplace(e,s,a,h,m,y,v){const S=4*e,k=8*e;return this.int16[S+0]=s,this.int16[S+1]=a,this.uint8[k+4]=h,this.uint8[k+5]=m,this.uint8[k+6]=y,this.uint8[k+7]=v,e}}Lu.prototype.bytesPerElement=8,Ge("StructArrayLayout2i4ub8",Lu);class yo extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s){const a=this.length;return this.resize(a+1),this.emplace(a,e,s)}emplace(e,s,a){const h=2*e;return this.float32[h+0]=s,this.float32[h+1]=a,e}}yo.prototype.bytesPerElement=8,Ge("StructArrayLayout2f8",yo);class Ru extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,a,h,m,y,v,S,k,C){const M=this.length;return this.resize(M+1),this.emplace(M,e,s,a,h,m,y,v,S,k,C)}emplace(e,s,a,h,m,y,v,S,k,C,M){const L=10*e;return this.uint16[L+0]=s,this.uint16[L+1]=a,this.uint16[L+2]=h,this.uint16[L+3]=m,this.uint16[L+4]=y,this.uint16[L+5]=v,this.uint16[L+6]=S,this.uint16[L+7]=k,this.uint16[L+8]=C,this.uint16[L+9]=M,e}}Ru.prototype.bytesPerElement=20,Ge("StructArrayLayout10ui20",Ru);class Fu extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,a,h,m,y,v,S,k,C,M,L){const O=this.length;return this.resize(O+1),this.emplace(O,e,s,a,h,m,y,v,S,k,C,M,L)}emplace(e,s,a,h,m,y,v,S,k,C,M,L,O){const N=12*e;return this.int16[N+0]=s,this.int16[N+1]=a,this.int16[N+2]=h,this.int16[N+3]=m,this.uint16[N+4]=y,this.uint16[N+5]=v,this.uint16[N+6]=S,this.uint16[N+7]=k,this.int16[N+8]=C,this.int16[N+9]=M,this.int16[N+10]=L,this.int16[N+11]=O,e}}Fu.prototype.bytesPerElement=24,Ge("StructArrayLayout4i4ui4i24",Fu);class zt extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,s,a)}emplace(e,s,a,h){const m=3*e;return this.float32[m+0]=s,this.float32[m+1]=a,this.float32[m+2]=h,e}}zt.prototype.bytesPerElement=12,Ge("StructArrayLayout3f12",zt);class f extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(e){const s=this.length;return this.resize(s+1),this.emplace(s,e)}emplace(e,s){return this.uint32[1*e+0]=s,e}}f.prototype.bytesPerElement=4,Ge("StructArrayLayout1ul4",f);class r extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,a,h,m,y,v,S,k){const C=this.length;return this.resize(C+1),this.emplace(C,e,s,a,h,m,y,v,S,k)}emplace(e,s,a,h,m,y,v,S,k,C){const M=10*e,L=5*e;return this.int16[M+0]=s,this.int16[M+1]=a,this.int16[M+2]=h,this.int16[M+3]=m,this.int16[M+4]=y,this.int16[M+5]=v,this.uint32[L+3]=S,this.uint16[M+8]=k,this.uint16[M+9]=C,e}}r.prototype.bytesPerElement=20,Ge("StructArrayLayout6i1ul2ui20",r);class o extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,a,h,m,y){const v=this.length;return this.resize(v+1),this.emplace(v,e,s,a,h,m,y)}emplace(e,s,a,h,m,y,v){const S=6*e;return this.int16[S+0]=s,this.int16[S+1]=a,this.int16[S+2]=h,this.int16[S+3]=m,this.int16[S+4]=y,this.int16[S+5]=v,e}}o.prototype.bytesPerElement=12,Ge("StructArrayLayout2i2i2i12",o);class c extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(e,s,a,h,m){const y=this.length;return this.resize(y+1),this.emplace(y,e,s,a,h,m)}emplace(e,s,a,h,m,y){const v=4*e,S=8*e;return this.float32[v+0]=s,this.float32[v+1]=a,this.float32[v+2]=h,this.int16[S+6]=m,this.int16[S+7]=y,e}}c.prototype.bytesPerElement=16,Ge("StructArrayLayout2f1f2i16",c);class d extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,s,a,h)}emplace(e,s,a,h,m){const y=12*e,v=3*e;return this.uint8[y+0]=s,this.uint8[y+1]=a,this.float32[v+1]=h,this.float32[v+2]=m,e}}d.prototype.bytesPerElement=12,Ge("StructArrayLayout2ub2f12",d);class g extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,s,a)}emplace(e,s,a,h){const m=3*e;return this.uint16[m+0]=s,this.uint16[m+1]=a,this.uint16[m+2]=h,e}}g.prototype.bytesPerElement=6,Ge("StructArrayLayout3ui6",g);class x extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,a,h,m,y,v,S,k,C,M,L,O,N,j,H,Q){const ue=this.length;return this.resize(ue+1),this.emplace(ue,e,s,a,h,m,y,v,S,k,C,M,L,O,N,j,H,Q)}emplace(e,s,a,h,m,y,v,S,k,C,M,L,O,N,j,H,Q,ue){const ie=24*e,de=12*e,fe=48*e;return this.int16[ie+0]=s,this.int16[ie+1]=a,this.uint16[ie+2]=h,this.uint16[ie+3]=m,this.uint32[de+2]=y,this.uint32[de+3]=v,this.uint32[de+4]=S,this.uint16[ie+10]=k,this.uint16[ie+11]=C,this.uint16[ie+12]=M,this.float32[de+7]=L,this.float32[de+8]=O,this.uint8[fe+36]=N,this.uint8[fe+37]=j,this.uint8[fe+38]=H,this.uint32[de+10]=Q,this.int16[ie+22]=ue,e}}x.prototype.bytesPerElement=48,Ge("StructArrayLayout2i2ui3ul3ui2f3ub1ul1i48",x);class w extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,a,h,m,y,v,S,k,C,M,L,O,N,j,H,Q,ue,ie,de,fe,Ee,qe,Ye,Ue,Ve,De,We){const Be=this.length;return this.resize(Be+1),this.emplace(Be,e,s,a,h,m,y,v,S,k,C,M,L,O,N,j,H,Q,ue,ie,de,fe,Ee,qe,Ye,Ue,Ve,De,We)}emplace(e,s,a,h,m,y,v,S,k,C,M,L,O,N,j,H,Q,ue,ie,de,fe,Ee,qe,Ye,Ue,Ve,De,We,Be){const Me=32*e,it=16*e;return this.int16[Me+0]=s,this.int16[Me+1]=a,this.int16[Me+2]=h,this.int16[Me+3]=m,this.int16[Me+4]=y,this.int16[Me+5]=v,this.int16[Me+6]=S,this.int16[Me+7]=k,this.uint16[Me+8]=C,this.uint16[Me+9]=M,this.uint16[Me+10]=L,this.uint16[Me+11]=O,this.uint16[Me+12]=N,this.uint16[Me+13]=j,this.uint16[Me+14]=H,this.uint16[Me+15]=Q,this.uint16[Me+16]=ue,this.uint16[Me+17]=ie,this.uint16[Me+18]=de,this.uint16[Me+19]=fe,this.uint16[Me+20]=Ee,this.uint16[Me+21]=qe,this.uint16[Me+22]=Ye,this.uint32[it+12]=Ue,this.float32[it+13]=Ve,this.float32[it+14]=De,this.uint16[Me+30]=We,this.uint16[Me+31]=Be,e}}w.prototype.bytesPerElement=64,Ge("StructArrayLayout8i15ui1ul2f2ui64",w);class T extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e){const s=this.length;return this.resize(s+1),this.emplace(s,e)}emplace(e,s){return this.float32[1*e+0]=s,e}}T.prototype.bytesPerElement=4,Ge("StructArrayLayout1f4",T);class E extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,s,a)}emplace(e,s,a,h){const m=3*e;return this.uint16[6*e+0]=s,this.float32[m+1]=a,this.float32[m+2]=h,e}}E.prototype.bytesPerElement=12,Ge("StructArrayLayout1ui2f12",E);class P extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s,a){const h=this.length;return this.resize(h+1),this.emplace(h,e,s,a)}emplace(e,s,a,h){const m=4*e;return this.uint32[2*e+0]=s,this.uint16[m+2]=a,this.uint16[m+3]=h,e}}P.prototype.bytesPerElement=8,Ge("StructArrayLayout1ul2ui8",P);class z extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e,s){const a=this.length;return this.resize(a+1),this.emplace(a,e,s)}emplace(e,s,a){const h=2*e;return this.uint16[h+0]=s,this.uint16[h+1]=a,e}}z.prototype.bytesPerElement=4,Ge("StructArrayLayout2ui4",z);class F extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(e){const s=this.length;return this.resize(s+1),this.emplace(s,e)}emplace(e,s){return this.uint16[1*e+0]=s,e}}F.prototype.bytesPerElement=2,Ge("StructArrayLayout1ui2",F);class q extends nr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(e,s,a,h){const m=this.length;return this.resize(m+1),this.emplace(m,e,s,a,h)}emplace(e,s,a,h,m){const y=4*e;return this.float32[y+0]=s,this.float32[y+1]=a,this.float32[y+2]=h,this.float32[y+3]=m,e}}q.prototype.bytesPerElement=16,Ge("StructArrayLayout4f16",q);class $ extends Ds{get anchorPointX(){return this._structArray.int16[this._pos2+0]}get anchorPointY(){return this._structArray.int16[this._pos2+1]}get x1(){return this._structArray.int16[this._pos2+2]}get y1(){return this._structArray.int16[this._pos2+3]}get x2(){return this._structArray.int16[this._pos2+4]}get y2(){return this._structArray.int16[this._pos2+5]}get featureIndex(){return this._structArray.uint32[this._pos4+3]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+8]}get bucketIndex(){return this._structArray.uint16[this._pos2+9]}get anchorPoint(){return new te(this.anchorPointX,this.anchorPointY)}}$.prototype.size=20;class G extends r{get(e){return new $(this,e)}}Ge("CollisionBoxArray",G);class U extends Ds{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+2]}get numGlyphs(){return this._structArray.uint16[this._pos2+3]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+2]}get lineStartIndex(){return this._structArray.uint32[this._pos4+3]}get lineLength(){return this._structArray.uint32[this._pos4+4]}get segment(){return this._structArray.uint16[this._pos2+10]}get lowerSize(){return this._structArray.uint16[this._pos2+11]}get upperSize(){return this._structArray.uint16[this._pos2+12]}get lineOffsetX(){return this._structArray.float32[this._pos4+7]}get lineOffsetY(){return this._structArray.float32[this._pos4+8]}get writingMode(){return this._structArray.uint8[this._pos1+36]}get placedOrientation(){return this._structArray.uint8[this._pos1+37]}set placedOrientation(e){this._structArray.uint8[this._pos1+37]=e}get hidden(){return this._structArray.uint8[this._pos1+38]}set hidden(e){this._structArray.uint8[this._pos1+38]=e}get crossTileID(){return this._structArray.uint32[this._pos4+10]}set crossTileID(e){this._structArray.uint32[this._pos4+10]=e}get associatedIconIndex(){return this._structArray.int16[this._pos2+22]}}U.prototype.size=48;class oe extends x{get(e){return new U(this,e)}}Ge("PlacedSymbolArray",oe);class pe extends Ds{get anchorX(){return this._structArray.int16[this._pos2+0]}get anchorY(){return this._structArray.int16[this._pos2+1]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+2]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+3]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+4]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+5]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+6]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+7]}get key(){return this._structArray.uint16[this._pos2+8]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+9]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+10]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+11]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+12]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+13]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+14]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get featureIndex(){return this._structArray.uint16[this._pos2+17]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+18]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+19]}get numIconVertices(){return this._structArray.uint16[this._pos2+20]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+21]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+22]}get crossTileID(){return this._structArray.uint32[this._pos4+12]}set crossTileID(e){this._structArray.uint32[this._pos4+12]=e}get textBoxScale(){return this._structArray.float32[this._pos4+13]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+14]}get textAnchorOffsetStartIndex(){return this._structArray.uint16[this._pos2+30]}get textAnchorOffsetEndIndex(){return this._structArray.uint16[this._pos2+31]}}pe.prototype.size=64;class Y extends w{get(e){return new pe(this,e)}}Ge("SymbolInstanceArray",Y);class ae extends T{getoffsetX(e){return this.float32[1*e+0]}}Ge("GlyphOffsetArray",ae);class me extends ha{getx(e){return this.int16[3*e+0]}gety(e){return this.int16[3*e+1]}gettileUnitDistanceFromAnchor(e){return this.int16[3*e+2]}}Ge("SymbolLineVertexArray",me);class ge extends Ds{get textAnchor(){return this._structArray.uint16[this._pos2+0]}get textOffset0(){return this._structArray.float32[this._pos4+1]}get textOffset1(){return this._structArray.float32[this._pos4+2]}}ge.prototype.size=12;class Te extends E{get(e){return new ge(this,e)}}Ge("TextAnchorOffsetArray",Te);class ze extends Ds{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}}ze.prototype.size=8;class Ce extends P{get(e){return new ze(this,e)}}Ge("FeatureIndexArray",Ce);class Ae extends ca{}class Ke extends ca{}class _t extends ca{}class Ne extends Du{}class at extends Lu{}class Qe extends yo{}class Rt extends Ru{}class yt extends Fu{}class pt extends zt{}class vt extends f{}class ar extends o{}class jt extends d{}class Br extends g{}class br extends z{}const pr=Qt([{name:"a_pos",components:2,type:"Int16"}],4),{members:An}=pr;class Zt{constructor(e=[]){this.segments=e}prepareSegment(e,s,a,h){let m=this.segments[this.segments.length-1];return e>Zt.MAX_VERTEX_ARRAY_LENGTH&&Ar(`Max vertices per segment is ${Zt.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${e}`),(!m||m.vertexLength+e>Zt.MAX_VERTEX_ARRAY_LENGTH||m.sortKey!==h)&&(m={vertexOffset:s.length,primitiveOffset:a.length,vertexLength:0,primitiveLength:0},h!==void 0&&(m.sortKey=h),this.segments.push(m)),m}get(){return this.segments}destroy(){for(const e of this.segments)for(const s in e.vaos)e.vaos[s].destroy()}static simpleSegment(e,s,a,h){return new Zt([{vertexOffset:e,primitiveOffset:s,vertexLength:a,primitiveLength:h,vaos:{},sortKey:0}])}}function bi(n,e){return 256*(n=Le(Math.floor(n),0,255))+Le(Math.floor(e),0,255)}Zt.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ge("SegmentVector",Zt);const Si=Qt([{name:"a_pattern_from",components:4,type:"Uint16"},{name:"a_pattern_to",components:4,type:"Uint16"},{name:"a_pixel_ratio_from",components:1,type:"Uint16"},{name:"a_pixel_ratio_to",components:1,type:"Uint16"}]);var ms={exports:{}},Rs={exports:{}};Rs.exports=function(n,e){var s,a,h,m,y,v,S,k;for(a=n.length-(s=3&n.length),h=e,y=3432918353,v=461845907,k=0;k<a;)S=255&n.charCodeAt(k)|(255&n.charCodeAt(++k))<<8|(255&n.charCodeAt(++k))<<16|(255&n.charCodeAt(++k))<<24,++k,h=27492+(65535&(m=5*(65535&(h=(h^=S=(65535&(S=(S=(65535&S)*y+(((S>>>16)*y&65535)<<16)&4294967295)<<15|S>>>17))*v+(((S>>>16)*v&65535)<<16)&4294967295)<<13|h>>>19))+((5*(h>>>16)&65535)<<16)&4294967295))+((58964+(m>>>16)&65535)<<16);switch(S=0,s){case 3:S^=(255&n.charCodeAt(k+2))<<16;case 2:S^=(255&n.charCodeAt(k+1))<<8;case 1:h^=S=(65535&(S=(S=(65535&(S^=255&n.charCodeAt(k)))*y+(((S>>>16)*y&65535)<<16)&4294967295)<<15|S>>>17))*v+(((S>>>16)*v&65535)<<16)&4294967295}return h^=n.length,h=2246822507*(65535&(h^=h>>>16))+((2246822507*(h>>>16)&65535)<<16)&4294967295,h=3266489909*(65535&(h^=h>>>13))+((3266489909*(h>>>16)&65535)<<16)&4294967295,(h^=h>>>16)>>>0};var _o=Rs.exports,Gr={exports:{}};Gr.exports=function(n,e){for(var s,a=n.length,h=e^a,m=0;a>=4;)s=1540483477*(65535&(s=255&n.charCodeAt(m)|(255&n.charCodeAt(++m))<<8|(255&n.charCodeAt(++m))<<16|(255&n.charCodeAt(++m))<<24))+((1540483477*(s>>>16)&65535)<<16),h=1540483477*(65535&h)+((1540483477*(h>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),a-=4,++m;switch(a){case 3:h^=(255&n.charCodeAt(m+2))<<16;case 2:h^=(255&n.charCodeAt(m+1))<<8;case 1:h=1540483477*(65535&(h^=255&n.charCodeAt(m)))+((1540483477*(h>>>16)&65535)<<16)}return h=1540483477*(65535&(h^=h>>>13))+((1540483477*(h>>>16)&65535)<<16),(h^=h>>>15)>>>0};var Or=_o,tn=Gr.exports;ms.exports=Or,ms.exports.murmur3=Or,ms.exports.murmur2=tn;var Fs=D(ms.exports);class lr{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(e,s,a,h){this.ids.push(Sr(e)),this.positions.push(s,a,h)}getPositions(e){if(!this.indexed)throw new Error("Trying to get index, but feature positions are not indexed");const s=Sr(e);let a=0,h=this.ids.length-1;for(;a<h;){const y=a+h>>1;this.ids[y]>=s?h=y:a=y+1}const m=[];for(;this.ids[a]===s;)m.push({index:this.positions[3*a],start:this.positions[3*a+1],end:this.positions[3*a+2]}),a++;return m}static serialize(e,s){const a=new Float64Array(e.ids),h=new Uint32Array(e.positions);return gn(a,h,0,a.length-1),s&&s.push(a.buffer,h.buffer),{ids:a,positions:h}}static deserialize(e){const s=new lr;return s.ids=e.ids,s.positions=e.positions,s.indexed=!0,s}}function Sr(n){const e=+n;return!isNaN(e)&&e<=Number.MAX_SAFE_INTEGER?e:Fs(String(n))}function gn(n,e,s,a){for(;s<a;){const h=n[s+a>>1];let m=s-1,y=a+1;for(;;){do m++;while(n[m]<h);do y--;while(n[y]>h);if(m>=y)break;ur(n,m,y),ur(e,3*m,3*y),ur(e,3*m+1,3*y+1),ur(e,3*m+2,3*y+2)}y-s<a-y?(gn(n,e,s,y),s=y+1):(gn(n,e,y+1,a),a=y)}}function ur(n,e,s){const a=n[e];n[e]=n[s],n[s]=a}Ge("FeaturePositionMap",lr);class Bs{constructor(e,s){this.gl=e.gl,this.location=s}}class ul extends Bs{constructor(e,s){super(e,s),this.current=0}set(e){this.current!==e&&(this.current=e,this.gl.uniform1f(this.location,e))}}class Lh extends Bs{constructor(e,s){super(e,s),this.current=[0,0,0,0]}set(e){e[0]===this.current[0]&&e[1]===this.current[1]&&e[2]===this.current[2]&&e[3]===this.current[3]||(this.current=e,this.gl.uniform4f(this.location,e[0],e[1],e[2],e[3]))}}class Rh extends Bs{constructor(e,s){super(e,s),this.current=Lt.transparent}set(e){e.r===this.current.r&&e.g===this.current.g&&e.b===this.current.b&&e.a===this.current.a||(this.current=e,this.gl.uniform4f(this.location,e.r,e.g,e.b,e.a))}}const Jp=new Float32Array(16);function Bu(n){return[bi(255*n.r,255*n.g),bi(255*n.b,255*n.a)]}class Ti{constructor(e,s,a){this.value=e,this.uniformNames=s.map(h=>`u_${h}`),this.type=a}setUniform(e,s,a){e.set(a.constantOr(this.value))}getBinding(e,s,a){return this.type==="color"?new Rh(e,s):new ul(e,s)}}class Os{constructor(e,s){this.uniformNames=s.map(a=>`u_${a}`),this.patternFrom=null,this.patternTo=null,this.pixelRatioFrom=1,this.pixelRatioTo=1}setConstantPatternPositions(e,s){this.pixelRatioFrom=s.pixelRatio,this.pixelRatioTo=e.pixelRatio,this.patternFrom=s.tlbr,this.patternTo=e.tlbr}setUniform(e,s,a,h){const m=h==="u_pattern_to"?this.patternTo:h==="u_pattern_from"?this.patternFrom:h==="u_pixel_ratio_to"?this.pixelRatioTo:h==="u_pixel_ratio_from"?this.pixelRatioFrom:null;m&&e.set(m)}getBinding(e,s,a){return a.substr(0,9)==="u_pattern"?new Lh(e,s):new ul(e,s)}}class ki{constructor(e,s,a,h){this.expression=e,this.type=a,this.maxValue=0,this.paintVertexAttributes=s.map(m=>({name:`a_${m}`,type:"Float32",components:a==="color"?2:1,offset:0})),this.paintVertexArray=new h}populatePaintArray(e,s,a,h,m){const y=this.paintVertexArray.length,v=this.expression.evaluate(new qt(0),s,{},h,[],m);this.paintVertexArray.resize(e),this._setPaintValue(y,e,v)}updatePaintArray(e,s,a,h){const m=this.expression.evaluate({zoom:0},a,h);this._setPaintValue(e,s,m)}_setPaintValue(e,s,a){if(this.type==="color"){const h=Bu(a);for(let m=e;m<s;m++)this.paintVertexArray.emplace(m,h[0],h[1])}else{for(let h=e;h<s;h++)this.paintVertexArray.emplace(h,a);this.maxValue=Math.max(this.maxValue,Math.abs(a))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Xn{constructor(e,s,a,h,m,y){this.expression=e,this.uniformNames=s.map(v=>`u_${v}_t`),this.type=a,this.useIntegerZoom=h,this.zoom=m,this.maxValue=0,this.paintVertexAttributes=s.map(v=>({name:`a_${v}`,type:"Float32",components:a==="color"?4:2,offset:0})),this.paintVertexArray=new y}populatePaintArray(e,s,a,h,m){const y=this.expression.evaluate(new qt(this.zoom),s,{},h,[],m),v=this.expression.evaluate(new qt(this.zoom+1),s,{},h,[],m),S=this.paintVertexArray.length;this.paintVertexArray.resize(e),this._setPaintValue(S,e,y,v)}updatePaintArray(e,s,a,h){const m=this.expression.evaluate({zoom:this.zoom},a,h),y=this.expression.evaluate({zoom:this.zoom+1},a,h);this._setPaintValue(e,s,m,y)}_setPaintValue(e,s,a,h){if(this.type==="color"){const m=Bu(a),y=Bu(h);for(let v=e;v<s;v++)this.paintVertexArray.emplace(v,m[0],m[1],y[0],y[1])}else{for(let m=e;m<s;m++)this.paintVertexArray.emplace(m,a,h);this.maxValue=Math.max(this.maxValue,Math.abs(a),Math.abs(h))}}upload(e){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=e.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(e,s){const a=this.useIntegerZoom?Math.floor(s.zoom):s.zoom,h=Le(this.expression.interpolationFactor(a,this.zoom,this.zoom+1),0,1);e.set(h)}getBinding(e,s,a){return new ul(e,s)}}class Ei{constructor(e,s,a,h,m,y){this.expression=e,this.type=s,this.useIntegerZoom=a,this.zoom=h,this.layerId=y,this.zoomInPaintVertexArray=new m,this.zoomOutPaintVertexArray=new m}populatePaintArray(e,s,a){const h=this.zoomInPaintVertexArray.length;this.zoomInPaintVertexArray.resize(e),this.zoomOutPaintVertexArray.resize(e),this._setPaintValues(h,e,s.patterns&&s.patterns[this.layerId],a)}updatePaintArray(e,s,a,h,m){this._setPaintValues(e,s,a.patterns&&a.patterns[this.layerId],m)}_setPaintValues(e,s,a,h){if(!h||!a)return;const{min:m,mid:y,max:v}=a,S=h[m],k=h[y],C=h[v];if(S&&k&&C)for(let M=e;M<s;M++)this.zoomInPaintVertexArray.emplace(M,k.tl[0],k.tl[1],k.br[0],k.br[1],S.tl[0],S.tl[1],S.br[0],S.br[1],k.pixelRatio,S.pixelRatio),this.zoomOutPaintVertexArray.emplace(M,k.tl[0],k.tl[1],k.br[0],k.br[1],C.tl[0],C.tl[1],C.br[0],C.br[1],k.pixelRatio,C.pixelRatio)}upload(e){this.zoomInPaintVertexArray&&this.zoomInPaintVertexArray.arrayBuffer&&this.zoomOutPaintVertexArray&&this.zoomOutPaintVertexArray.arrayBuffer&&(this.zoomInPaintVertexBuffer=e.createVertexBuffer(this.zoomInPaintVertexArray,Si.members,this.expression.isStateDependent),this.zoomOutPaintVertexBuffer=e.createVertexBuffer(this.zoomOutPaintVertexArray,Si.members,this.expression.isStateDependent))}destroy(){this.zoomOutPaintVertexBuffer&&this.zoomOutPaintVertexBuffer.destroy(),this.zoomInPaintVertexBuffer&&this.zoomInPaintVertexBuffer.destroy()}}class Ou{constructor(e,s,a){this.binders={},this._buffers=[];const h=[];for(const m in e.paint._values){if(!a(m))continue;const y=e.paint.get(m);if(!(y instanceof en&&co(y.property.specification)))continue;const v=Hw(m,e.type),S=y.value,k=y.property.specification.type,C=y.property.useIntegerZoom,M=y.property.specification["property-type"],L=M==="cross-faded"||M==="cross-faded-data-driven";if(S.kind==="constant")this.binders[m]=L?new Os(S.value,v):new Ti(S.value,v,k),h.push(`/u_${m}`);else if(S.kind==="source"||L){const O=By(m,k,"source");this.binders[m]=L?new Ei(S,k,C,s,O,e.id):new ki(S,v,k,O),h.push(`/a_${m}`)}else{const O=By(m,k,"composite");this.binders[m]=new Xn(S,v,k,C,s,O),h.push(`/z_${m}`)}}this.cacheKey=h.sort().join("")}getMaxValue(e){const s=this.binders[e];return s instanceof ki||s instanceof Xn?s.maxValue:0}populatePaintArrays(e,s,a,h,m){for(const y in this.binders){const v=this.binders[y];(v instanceof ki||v instanceof Xn||v instanceof Ei)&&v.populatePaintArray(e,s,a,h,m)}}setConstantPatternPositions(e,s){for(const a in this.binders){const h=this.binders[a];h instanceof Os&&h.setConstantPatternPositions(e,s)}}updatePaintArrays(e,s,a,h,m){let y=!1;for(const v in e){const S=s.getPositions(v);for(const k of S){const C=a.feature(k.index);for(const M in this.binders){const L=this.binders[M];if((L instanceof ki||L instanceof Xn||L instanceof Ei)&&L.expression.isStateDependent===!0){const O=h.paint.get(M);L.expression=O.value,L.updatePaintArray(k.start,k.end,C,e[v],m),y=!0}}}}return y}defines(){const e=[];for(const s in this.binders){const a=this.binders[s];(a instanceof Ti||a instanceof Os)&&e.push(...a.uniformNames.map(h=>`#define HAS_UNIFORM_${h}`))}return e}getBinderAttributes(){const e=[];for(const s in this.binders){const a=this.binders[s];if(a instanceof ki||a instanceof Xn)for(let h=0;h<a.paintVertexAttributes.length;h++)e.push(a.paintVertexAttributes[h].name);else if(a instanceof Ei)for(let h=0;h<Si.members.length;h++)e.push(Si.members[h].name)}return e}getBinderUniforms(){const e=[];for(const s in this.binders){const a=this.binders[s];if(a instanceof Ti||a instanceof Os||a instanceof Xn)for(const h of a.uniformNames)e.push(h)}return e}getPaintVertexBuffers(){return this._buffers}getUniforms(e,s){const a=[];for(const h in this.binders){const m=this.binders[h];if(m instanceof Ti||m instanceof Os||m instanceof Xn){for(const y of m.uniformNames)if(s[y]){const v=m.getBinding(e,s[y],y);a.push({name:y,property:h,binding:v})}}}return a}setUniforms(e,s,a,h){for(const{name:m,property:y,binding:v}of s)this.binders[y].setUniform(v,h,a.get(y),m)}updatePaintBuffers(e){this._buffers=[];for(const s in this.binders){const a=this.binders[s];if(e&&a instanceof Ei){const h=e.fromScale===2?a.zoomInPaintVertexBuffer:a.zoomOutPaintVertexBuffer;h&&this._buffers.push(h)}else(a instanceof ki||a instanceof Xn)&&a.paintVertexBuffer&&this._buffers.push(a.paintVertexBuffer)}}upload(e){for(const s in this.binders){const a=this.binders[s];(a instanceof ki||a instanceof Xn||a instanceof Ei)&&a.upload(e)}this.updatePaintBuffers()}destroy(){for(const e in this.binders){const s=this.binders[e];(s instanceof ki||s instanceof Xn||s instanceof Ei)&&s.destroy()}}}class qi{constructor(e,s,a=()=>!0){this.programConfigurations={};for(const h of e)this.programConfigurations[h.id]=new Ou(h,s,a);this.needsUpload=!1,this._featureMap=new lr,this._bufferOffset=0}populatePaintArrays(e,s,a,h,m,y){for(const v in this.programConfigurations)this.programConfigurations[v].populatePaintArrays(e,s,h,m,y);s.id!==void 0&&this._featureMap.add(s.id,a,this._bufferOffset,e),this._bufferOffset=e,this.needsUpload=!0}updatePaintArrays(e,s,a,h){for(const m of a)this.needsUpload=this.programConfigurations[m.id].updatePaintArrays(e,this._featureMap,s,m,h)||this.needsUpload}get(e){return this.programConfigurations[e]}upload(e){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(e);this.needsUpload=!1}}destroy(){for(const e in this.programConfigurations)this.programConfigurations[e].destroy()}}function Hw(n,e){return{"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"],"fill-extrusion-pattern":["pattern_to","pattern_from","pixel_ratio_to","pixel_ratio_from"]}[n]||[n.replace(`${e}-`,"").replace(/-/g,"_")]}function By(n,e,s){const a={color:{source:yo,composite:q},number:{source:T,composite:yo}},h=function(m){return{"line-pattern":{source:Rt,composite:Rt},"fill-pattern":{source:Rt,composite:Rt},"fill-extrusion-pattern":{source:Rt,composite:Rt}}[m]}(n);return h&&h[s]||a[e][s]}Ge("ConstantBinder",Ti),Ge("CrossFadedConstantBinder",Os),Ge("SourceExpressionBinder",ki),Ge("CrossFadedCompositeBinder",Ei),Ge("CompositeExpressionBinder",Xn),Ge("ProgramConfiguration",Ou,{omit:["_buffers"]}),Ge("ProgramConfigurationSet",qi);const vr=8192,ef=Math.pow(2,14)-1,Oy=-ef-1;function da(n){const e=vr/n.extent,s=n.loadGeometry();for(let a=0;a<s.length;a++){const h=s[a];for(let m=0;m<h.length;m++){const y=h[m],v=Math.round(y.x*e),S=Math.round(y.y*e);y.x=Le(v,Oy,ef),y.y=Le(S,Oy,ef),(v<y.x||v>y.x+1||S<y.y||S>y.y+1)&&Ar("Geometry exceeds allowed extent, reduce your vector tile buffer size")}}return s}function pa(n,e){return{type:n.type,id:n.id,properties:n.properties,geometry:e?da(n):[]}}function Fh(n,e,s,a,h){n.emplaceBack(2*e+(a+1)/2,2*s+(h+1)/2)}class tf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(s=>s.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ke,this.indexArray=new Br,this.segments=new Zt,this.programConfigurations=new qi(e.layers,e.zoom),this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(e,s,a){const h=this.layers[0],m=[];let y=null,v=!1;h.type==="circle"&&(y=h.layout.get("circle-sort-key"),v=!y.isConstant());for(const{feature:S,id:k,index:C,sourceLayerIndex:M}of e){const L=this.layers[0]._featureFilter.needGeometry,O=pa(S,L);if(!this.layers[0]._featureFilter.filter(new qt(this.zoom),O,a))continue;const N=v?y.evaluate(O,{},a):void 0,j={id:k,properties:S.properties,type:S.type,sourceLayerIndex:M,index:C,geometry:L?O.geometry:da(S),patterns:{},sortKey:N};m.push(j)}v&&m.sort((S,k)=>S.sortKey-k.sortKey);for(const S of m){const{geometry:k,index:C,sourceLayerIndex:M}=S,L=e[C].feature;this.addFeature(S,k,C,a),s.featureIndex.insert(L,k,C,M,this.index)}}update(e,s,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,s,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,An),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(e,s,a,h){for(const m of s)for(const y of m){const v=y.x,S=y.y;if(v<0||v>=vr||S<0||S>=vr)continue;const k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,e.sortKey),C=k.vertexLength;Fh(this.layoutVertexArray,v,S,-1,-1),Fh(this.layoutVertexArray,v,S,1,-1),Fh(this.layoutVertexArray,v,S,1,1),Fh(this.layoutVertexArray,v,S,-1,1),this.indexArray.emplaceBack(C,C+1,C+2),this.indexArray.emplaceBack(C,C+3,C+2),k.vertexLength+=4,k.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,{},h)}}function Ny(n,e){for(let s=0;s<n.length;s++)if(cl(e,n[s]))return!0;for(let s=0;s<e.length;s++)if(cl(n,e[s]))return!0;return!!rf(n,e)}function Xw(n,e,s){return!!cl(n,e)||!!nf(e,n,s)}function Vy(n,e){if(n.length===1)return jy(e,n[0]);for(let s=0;s<e.length;s++){const a=e[s];for(let h=0;h<a.length;h++)if(cl(n,a[h]))return!0}for(let s=0;s<n.length;s++)if(jy(e,n[s]))return!0;for(let s=0;s<e.length;s++)if(rf(n,e[s]))return!0;return!1}function Kw(n,e,s){if(n.length>1){if(rf(n,e))return!0;for(let a=0;a<e.length;a++)if(nf(e[a],n,s))return!0}for(let a=0;a<n.length;a++)if(nf(n[a],e,s))return!0;return!1}function rf(n,e){if(n.length===0||e.length===0)return!1;for(let s=0;s<n.length-1;s++){const a=n[s],h=n[s+1];for(let m=0;m<e.length-1;m++)if(Yw(a,h,e[m],e[m+1]))return!0}return!1}function Yw(n,e,s,a){return Qr(n,s,a)!==Qr(e,s,a)&&Qr(n,e,s)!==Qr(n,e,a)}function nf(n,e,s){const a=s*s;if(e.length===1)return n.distSqr(e[0])<a;for(let h=1;h<e.length;h++)if(Uy(n,e[h-1],e[h])<a)return!0;return!1}function Uy(n,e,s){const a=e.distSqr(s);if(a===0)return n.distSqr(e);const h=((n.x-e.x)*(s.x-e.x)+(n.y-e.y)*(s.y-e.y))/a;return n.distSqr(h<0?e:h>1?s:s.sub(e)._mult(h)._add(e))}function jy(n,e){let s,a,h,m=!1;for(let y=0;y<n.length;y++){s=n[y];for(let v=0,S=s.length-1;v<s.length;S=v++)a=s[v],h=s[S],a.y>e.y!=h.y>e.y&&e.x<(h.x-a.x)*(e.y-a.y)/(h.y-a.y)+a.x&&(m=!m)}return m}function cl(n,e){let s=!1;for(let a=0,h=n.length-1;a<n.length;h=a++){const m=n[a],y=n[h];m.y>e.y!=y.y>e.y&&e.x<(y.x-m.x)*(e.y-m.y)/(y.y-m.y)+m.x&&(s=!s)}return s}function Qw(n,e,s){const a=s[0],h=s[2];if(n.x<a.x&&e.x<a.x||n.x>h.x&&e.x>h.x||n.y<a.y&&e.y<a.y||n.y>h.y&&e.y>h.y)return!1;const m=Qr(n,e,s[0]);return m!==Qr(n,e,s[1])||m!==Qr(n,e,s[2])||m!==Qr(n,e,s[3])}function Nu(n,e,s){const a=e.paint.get(n).value;return a.kind==="constant"?a.value:s.programConfigurations.get(e.id).getMaxValue(n)}function Bh(n){return Math.sqrt(n[0]*n[0]+n[1]*n[1])}function Oh(n,e,s,a,h){if(!e[0]&&!e[1])return n;const m=te.convert(e)._mult(h);s==="viewport"&&m._rotate(-a);const y=[];for(let v=0;v<n.length;v++)y.push(n[v].sub(m));return y}let $y,qy;Ge("CircleBucket",tf,{omit:["layers"]});var Jw={get paint(){return qy=qy||new dr({"circle-radius":new ot(ve.paint_circle["circle-radius"]),"circle-color":new ot(ve.paint_circle["circle-color"]),"circle-blur":new ot(ve.paint_circle["circle-blur"]),"circle-opacity":new ot(ve.paint_circle["circle-opacity"]),"circle-translate":new et(ve.paint_circle["circle-translate"]),"circle-translate-anchor":new et(ve.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new et(ve.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new et(ve.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new ot(ve.paint_circle["circle-stroke-width"]),"circle-stroke-color":new ot(ve.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new ot(ve.paint_circle["circle-stroke-opacity"])})},get layout(){return $y=$y||new dr({"circle-sort-key":new ot(ve.layout_circle["circle-sort-key"])})}},yn=1e-6,hl=typeof Float32Array<"u"?Float32Array:Array;function sf(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Zy(n,e,s){var a=e[0],h=e[1],m=e[2],y=e[3],v=e[4],S=e[5],k=e[6],C=e[7],M=e[8],L=e[9],O=e[10],N=e[11],j=e[12],H=e[13],Q=e[14],ue=e[15],ie=s[0],de=s[1],fe=s[2],Ee=s[3];return n[0]=ie*a+de*v+fe*M+Ee*j,n[1]=ie*h+de*S+fe*L+Ee*H,n[2]=ie*m+de*k+fe*O+Ee*Q,n[3]=ie*y+de*C+fe*N+Ee*ue,n[4]=(ie=s[4])*a+(de=s[5])*v+(fe=s[6])*M+(Ee=s[7])*j,n[5]=ie*h+de*S+fe*L+Ee*H,n[6]=ie*m+de*k+fe*O+Ee*Q,n[7]=ie*y+de*C+fe*N+Ee*ue,n[8]=(ie=s[8])*a+(de=s[9])*v+(fe=s[10])*M+(Ee=s[11])*j,n[9]=ie*h+de*S+fe*L+Ee*H,n[10]=ie*m+de*k+fe*O+Ee*Q,n[11]=ie*y+de*C+fe*N+Ee*ue,n[12]=(ie=s[12])*a+(de=s[13])*v+(fe=s[14])*M+(Ee=s[15])*j,n[13]=ie*h+de*S+fe*L+Ee*H,n[14]=ie*m+de*k+fe*O+Ee*Q,n[15]=ie*y+de*C+fe*N+Ee*ue,n}Math.hypot||(Math.hypot=function(){for(var n=0,e=arguments.length;e--;)n+=arguments[e]*arguments[e];return Math.sqrt(n)});var Vu,eb=Zy;function Nh(n,e,s){var a=e[0],h=e[1],m=e[2],y=e[3];return n[0]=s[0]*a+s[4]*h+s[8]*m+s[12]*y,n[1]=s[1]*a+s[5]*h+s[9]*m+s[13]*y,n[2]=s[2]*a+s[6]*h+s[10]*m+s[14]*y,n[3]=s[3]*a+s[7]*h+s[11]*m+s[15]*y,n}Vu=new hl(4),hl!=Float32Array&&(Vu[0]=0,Vu[1]=0,Vu[2]=0,Vu[3]=0);class tb extends Hn{constructor(e){super(e,Jw)}createBucket(e){return new tf(e)}queryRadius(e){const s=e;return Nu("circle-radius",this,s)+Nu("circle-stroke-width",this,s)+Bh(this.paint.get("circle-translate"))}queryIntersectsFeature(e,s,a,h,m,y,v,S){const k=Oh(e,this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,v),C=this.paint.get("circle-radius").evaluate(s,a)+this.paint.get("circle-stroke-width").evaluate(s,a),M=this.paint.get("circle-pitch-alignment")==="map",L=M?k:function(N,j){return N.map(H=>Gy(H,j))}(k,S),O=M?C*v:C;for(const N of h)for(const j of N){const H=M?j:Gy(j,S);let Q=O;const ue=Nh([],[j.x,j.y,0,1],S);if(this.paint.get("circle-pitch-scale")==="viewport"&&this.paint.get("circle-pitch-alignment")==="map"?Q*=ue[3]/y.cameraToCenterDistance:this.paint.get("circle-pitch-scale")==="map"&&this.paint.get("circle-pitch-alignment")==="viewport"&&(Q*=y.cameraToCenterDistance/ue[3]),Xw(L,H,Q))return!0}return!1}}function Gy(n,e){const s=Nh([],[n.x,n.y,0,1],e);return new te(s[0]/s[3],s[1]/s[3])}class Wy extends tf{}let Hy;Ge("HeatmapBucket",Wy,{omit:["layers"]});var rb={get paint(){return Hy=Hy||new dr({"heatmap-radius":new ot(ve.paint_heatmap["heatmap-radius"]),"heatmap-weight":new ot(ve.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new et(ve.paint_heatmap["heatmap-intensity"]),"heatmap-color":new Mu(ve.paint_heatmap["heatmap-color"]),"heatmap-opacity":new et(ve.paint_heatmap["heatmap-opacity"])})}};function of(n,{width:e,height:s},a,h){if(h){if(h instanceof Uint8ClampedArray)h=new Uint8Array(h.buffer);else if(h.length!==e*s*a)throw new RangeError(`mismatched image size. expected: ${h.length} but got: ${e*s*a}`)}else h=new Uint8Array(e*s*a);return n.width=e,n.height=s,n.data=h,n}function Xy(n,{width:e,height:s},a){if(e===n.width&&s===n.height)return;const h=of({},{width:e,height:s},a);af(n,h,{x:0,y:0},{x:0,y:0},{width:Math.min(n.width,e),height:Math.min(n.height,s)},a),n.width=e,n.height=s,n.data=h.data}function af(n,e,s,a,h,m){if(h.width===0||h.height===0)return e;if(h.width>n.width||h.height>n.height||s.x>n.width-h.width||s.y>n.height-h.height)throw new RangeError("out of range source coordinates for image copy");if(h.width>e.width||h.height>e.height||a.x>e.width-h.width||a.y>e.height-h.height)throw new RangeError("out of range destination coordinates for image copy");const y=n.data,v=e.data;if(y===v)throw new Error("srcData equals dstData, so image is already copied");for(let S=0;S<h.height;S++){const k=((s.y+S)*n.width+s.x)*m,C=((a.y+S)*e.width+a.x)*m;for(let M=0;M<h.width*m;M++)v[C+M]=y[k+M]}return e}class Uu{constructor(e,s){of(this,e,1,s)}resize(e){Xy(this,e,1)}clone(){return new Uu({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,s,a,h,m){af(e,s,a,h,m,1)}}class si{constructor(e,s){of(this,e,4,s)}resize(e){Xy(this,e,4)}replace(e,s){s?this.data.set(e):this.data=e instanceof Uint8ClampedArray?new Uint8Array(e.buffer):e}clone(){return new si({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(e,s,a,h,m){af(e,s,a,h,m,4)}}function Ky(n){const e={},s=n.resolution||256,a=n.clips?n.clips.length:1,h=n.image||new si({width:s,height:a});if(Math.log(s)/Math.LN2%1!=0)throw new Error(`width is not a power of 2 - ${s}`);const m=(y,v,S)=>{e[n.evaluationKey]=S;const k=n.expression.evaluate(e);h.data[y+v+0]=Math.floor(255*k.r/k.a),h.data[y+v+1]=Math.floor(255*k.g/k.a),h.data[y+v+2]=Math.floor(255*k.b/k.a),h.data[y+v+3]=Math.floor(255*k.a)};if(n.clips)for(let y=0,v=0;y<a;++y,v+=4*s)for(let S=0,k=0;S<s;S++,k+=4){const C=S/(s-1),{start:M,end:L}=n.clips[y];m(v,k,M*(1-C)+L*C)}else for(let y=0,v=0;y<s;y++,v+=4)m(0,v,y/(s-1));return h}Ge("AlphaImage",Uu),Ge("RGBAImage",si);class nb extends Hn{createBucket(e){return new Wy(e)}constructor(e){super(e,rb),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(e){e==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ky({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(){return 0}queryIntersectsFeature(){return!1}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}}let Yy;var ib={get paint(){return Yy=Yy||new dr({"hillshade-illumination-direction":new et(ve.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new et(ve.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new et(ve.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new et(ve.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new et(ve.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new et(ve.paint_hillshade["hillshade-accent-color"])})}};class sb extends Hn{constructor(e){super(e,ib)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}}const ob=Qt([{name:"a_pos",components:2,type:"Int16"}],4),{members:ab}=ob;var lf={exports:{}};function Vh(n,e,s){s=s||2;var a,h,m,y,v,S,k,C=e&&e.length,M=C?e[0]*s:n.length,L=Qy(n,0,M,s,!0),O=[];if(!L||L.next===L.prev)return O;if(C&&(L=function(j,H,Q,ue){var ie,de,fe,Ee=[];for(ie=0,de=H.length;ie<de;ie++)(fe=Qy(j,H[ie]*ue,ie<de-1?H[ie+1]*ue:j.length,ue,!1))===fe.next&&(fe.steiner=!0),Ee.push(mb(fe));for(Ee.sort(db),ie=0;ie<Ee.length;ie++)Q=pb(Ee[ie],Q);return Q}(n,e,L,s)),n.length>80*s){a=m=n[0],h=y=n[1];for(var N=s;N<M;N+=s)(v=n[N])<a&&(a=v),(S=n[N+1])<h&&(h=S),v>m&&(m=v),S>y&&(y=S);k=(k=Math.max(m-a,y-h))!==0?32767/k:0}return ju(L,O,s,a,h,k,0),O}function Qy(n,e,s,a,h){var m,y;if(h===hf(n,e,s,a)>0)for(m=e;m<s;m+=a)y=t_(m,n[m],n[m+1],y);else for(m=s-a;m>=e;m-=a)y=t_(m,n[m],n[m+1],y);return y&&Uh(y,y.next)&&(qu(y),y=y.next),y}function fa(n,e){if(!n)return n;e||(e=n);var s,a=n;do if(s=!1,a.steiner||!Uh(a,a.next)&&fr(a.prev,a,a.next)!==0)a=a.next;else{if(qu(a),(a=e=a.prev)===a.next)break;s=!0}while(s||a!==e);return e}function ju(n,e,s,a,h,m,y){if(n){!y&&m&&function(C,M,L,O){var N=C;do N.z===0&&(N.z=uf(N.x,N.y,M,L,O)),N.prevZ=N.prev,N.nextZ=N.next,N=N.next;while(N!==C);N.prevZ.nextZ=null,N.prevZ=null,function(j){var H,Q,ue,ie,de,fe,Ee,qe,Ye=1;do{for(Q=j,j=null,de=null,fe=0;Q;){for(fe++,ue=Q,Ee=0,H=0;H<Ye&&(Ee++,ue=ue.nextZ);H++);for(qe=Ye;Ee>0||qe>0&&ue;)Ee!==0&&(qe===0||!ue||Q.z<=ue.z)?(ie=Q,Q=Q.nextZ,Ee--):(ie=ue,ue=ue.nextZ,qe--),de?de.nextZ=ie:j=ie,ie.prevZ=de,de=ie;Q=ue}de.nextZ=null,Ye*=2}while(fe>1)}(N)}(n,a,h,m);for(var v,S,k=n;n.prev!==n.next;)if(v=n.prev,S=n.next,m?ub(n,a,h,m):lb(n))e.push(v.i/s|0),e.push(n.i/s|0),e.push(S.i/s|0),qu(n),n=S.next,k=S.next;else if((n=S)===k){y?y===1?ju(n=cb(fa(n),e,s),e,s,a,h,m,2):y===2&&hb(n,e,s,a,h,m):ju(fa(n),e,s,a,h,m,1);break}}}function lb(n){var e=n.prev,s=n,a=n.next;if(fr(e,s,a)>=0)return!1;for(var h=e.x,m=s.x,y=a.x,v=e.y,S=s.y,k=a.y,C=h<m?h<y?h:y:m<y?m:y,M=v<S?v<k?v:k:S<k?S:k,L=h>m?h>y?h:y:m>y?m:y,O=v>S?v>k?v:k:S>k?S:k,N=a.next;N!==e;){if(N.x>=C&&N.x<=L&&N.y>=M&&N.y<=O&&dl(h,v,m,S,y,k,N.x,N.y)&&fr(N.prev,N,N.next)>=0)return!1;N=N.next}return!0}function ub(n,e,s,a){var h=n.prev,m=n,y=n.next;if(fr(h,m,y)>=0)return!1;for(var v=h.x,S=m.x,k=y.x,C=h.y,M=m.y,L=y.y,O=v<S?v<k?v:k:S<k?S:k,N=C<M?C<L?C:L:M<L?M:L,j=v>S?v>k?v:k:S>k?S:k,H=C>M?C>L?C:L:M>L?M:L,Q=uf(O,N,e,s,a),ue=uf(j,H,e,s,a),ie=n.prevZ,de=n.nextZ;ie&&ie.z>=Q&&de&&de.z<=ue;){if(ie.x>=O&&ie.x<=j&&ie.y>=N&&ie.y<=H&&ie!==h&&ie!==y&&dl(v,C,S,M,k,L,ie.x,ie.y)&&fr(ie.prev,ie,ie.next)>=0||(ie=ie.prevZ,de.x>=O&&de.x<=j&&de.y>=N&&de.y<=H&&de!==h&&de!==y&&dl(v,C,S,M,k,L,de.x,de.y)&&fr(de.prev,de,de.next)>=0))return!1;de=de.nextZ}for(;ie&&ie.z>=Q;){if(ie.x>=O&&ie.x<=j&&ie.y>=N&&ie.y<=H&&ie!==h&&ie!==y&&dl(v,C,S,M,k,L,ie.x,ie.y)&&fr(ie.prev,ie,ie.next)>=0)return!1;ie=ie.prevZ}for(;de&&de.z<=ue;){if(de.x>=O&&de.x<=j&&de.y>=N&&de.y<=H&&de!==h&&de!==y&&dl(v,C,S,M,k,L,de.x,de.y)&&fr(de.prev,de,de.next)>=0)return!1;de=de.nextZ}return!0}function cb(n,e,s){var a=n;do{var h=a.prev,m=a.next.next;!Uh(h,m)&&Jy(h,a,a.next,m)&&$u(h,m)&&$u(m,h)&&(e.push(h.i/s|0),e.push(a.i/s|0),e.push(m.i/s|0),qu(a),qu(a.next),a=n=m),a=a.next}while(a!==n);return fa(a)}function hb(n,e,s,a,h,m){var y=n;do{for(var v=y.next.next;v!==y.prev;){if(y.i!==v.i&&gb(y,v)){var S=e_(y,v);return y=fa(y,y.next),S=fa(S,S.next),ju(y,e,s,a,h,m,0),void ju(S,e,s,a,h,m,0)}v=v.next}y=y.next}while(y!==n)}function db(n,e){return n.x-e.x}function pb(n,e){var s=function(h,m){var y,v=m,S=h.x,k=h.y,C=-1/0;do{if(k<=v.y&&k>=v.next.y&&v.next.y!==v.y){var M=v.x+(k-v.y)*(v.next.x-v.x)/(v.next.y-v.y);if(M<=S&&M>C&&(C=M,y=v.x<v.next.x?v:v.next,M===S))return y}v=v.next}while(v!==m);if(!y)return null;var L,O=y,N=y.x,j=y.y,H=1/0;v=y;do S>=v.x&&v.x>=N&&S!==v.x&&dl(k<j?S:C,k,N,j,k<j?C:S,k,v.x,v.y)&&(L=Math.abs(k-v.y)/(S-v.x),$u(v,h)&&(L<H||L===H&&(v.x>y.x||v.x===y.x&&fb(y,v)))&&(y=v,H=L)),v=v.next;while(v!==O);return y}(n,e);if(!s)return e;var a=e_(s,n);return fa(a,a.next),fa(s,s.next)}function fb(n,e){return fr(n.prev,n,e.prev)<0&&fr(e.next,n,n.next)<0}function uf(n,e,s,a,h){return(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-s)*h|0)|n<<8))|n<<4))|n<<2))|n<<1))|(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-a)*h|0)|e<<8))|e<<4))|e<<2))|e<<1))<<1}function mb(n){var e=n,s=n;do(e.x<s.x||e.x===s.x&&e.y<s.y)&&(s=e),e=e.next;while(e!==n);return s}function dl(n,e,s,a,h,m,y,v){return(h-y)*(e-v)>=(n-y)*(m-v)&&(n-y)*(a-v)>=(s-y)*(e-v)&&(s-y)*(m-v)>=(h-y)*(a-v)}function gb(n,e){return n.next.i!==e.i&&n.prev.i!==e.i&&!function(s,a){var h=s;do{if(h.i!==s.i&&h.next.i!==s.i&&h.i!==a.i&&h.next.i!==a.i&&Jy(h,h.next,s,a))return!0;h=h.next}while(h!==s);return!1}(n,e)&&($u(n,e)&&$u(e,n)&&function(s,a){var h=s,m=!1,y=(s.x+a.x)/2,v=(s.y+a.y)/2;do h.y>v!=h.next.y>v&&h.next.y!==h.y&&y<(h.next.x-h.x)*(v-h.y)/(h.next.y-h.y)+h.x&&(m=!m),h=h.next;while(h!==s);return m}(n,e)&&(fr(n.prev,n,e.prev)||fr(n,e.prev,e))||Uh(n,e)&&fr(n.prev,n,n.next)>0&&fr(e.prev,e,e.next)>0)}function fr(n,e,s){return(e.y-n.y)*(s.x-e.x)-(e.x-n.x)*(s.y-e.y)}function Uh(n,e){return n.x===e.x&&n.y===e.y}function Jy(n,e,s,a){var h=$h(fr(n,e,s)),m=$h(fr(n,e,a)),y=$h(fr(s,a,n)),v=$h(fr(s,a,e));return h!==m&&y!==v||!(h!==0||!jh(n,s,e))||!(m!==0||!jh(n,a,e))||!(y!==0||!jh(s,n,a))||!(v!==0||!jh(s,e,a))}function jh(n,e,s){return e.x<=Math.max(n.x,s.x)&&e.x>=Math.min(n.x,s.x)&&e.y<=Math.max(n.y,s.y)&&e.y>=Math.min(n.y,s.y)}function $h(n){return n>0?1:n<0?-1:0}function $u(n,e){return fr(n.prev,n,n.next)<0?fr(n,e,n.next)>=0&&fr(n,n.prev,e)>=0:fr(n,e,n.prev)<0||fr(n,n.next,e)<0}function e_(n,e){var s=new cf(n.i,n.x,n.y),a=new cf(e.i,e.x,e.y),h=n.next,m=e.prev;return n.next=e,e.prev=n,s.next=h,h.prev=s,a.next=s,s.prev=a,m.next=a,a.prev=m,a}function t_(n,e,s,a){var h=new cf(n,e,s);return a?(h.next=a.next,h.prev=a,a.next.prev=h,a.next=h):(h.prev=h,h.next=h),h}function qu(n){n.next.prev=n.prev,n.prev.next=n.next,n.prevZ&&(n.prevZ.nextZ=n.nextZ),n.nextZ&&(n.nextZ.prevZ=n.prevZ)}function cf(n,e,s){this.i=n,this.x=e,this.y=s,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function hf(n,e,s,a){for(var h=0,m=e,y=s-a;m<s;m+=a)h+=(n[y]-n[m])*(n[m+1]+n[y+1]),y=m;return h}lf.exports=Vh,lf.exports.default=Vh,Vh.deviation=function(n,e,s,a){var h=e&&e.length,m=Math.abs(hf(n,0,h?e[0]*s:n.length,s));if(h)for(var y=0,v=e.length;y<v;y++)m-=Math.abs(hf(n,e[y]*s,y<v-1?e[y+1]*s:n.length,s));var S=0;for(y=0;y<a.length;y+=3){var k=a[y]*s,C=a[y+1]*s,M=a[y+2]*s;S+=Math.abs((n[k]-n[M])*(n[C+1]-n[k+1])-(n[k]-n[C])*(n[M+1]-n[k+1]))}return m===0&&S===0?0:Math.abs((S-m)/m)},Vh.flatten=function(n){for(var e=n[0][0].length,s={vertices:[],holes:[],dimensions:e},a=0,h=0;h<n.length;h++){for(var m=0;m<n[h].length;m++)for(var y=0;y<e;y++)s.vertices.push(n[h][m][y]);h>0&&s.holes.push(a+=n[h-1].length)}return s};var r_=D(lf.exports);function yb(n,e,s,a,h){n_(n,e,s||0,a||n.length-1,h||_b)}function n_(n,e,s,a,h){for(;a>s;){if(a-s>600){var m=a-s+1,y=e-s+1,v=Math.log(m),S=.5*Math.exp(2*v/3),k=.5*Math.sqrt(v*S*(m-S)/m)*(y-m/2<0?-1:1);n_(n,e,Math.max(s,Math.floor(e-y*S/m+k)),Math.min(a,Math.floor(e+(m-y)*S/m+k)),h)}var C=n[e],M=s,L=a;for(Zu(n,s,e),h(n[a],C)>0&&Zu(n,s,a);M<L;){for(Zu(n,M,L),M++,L--;h(n[M],C)<0;)M++;for(;h(n[L],C)>0;)L--}h(n[s],C)===0?Zu(n,s,L):Zu(n,++L,a),L<=e&&(s=L+1),e<=L&&(a=L-1)}}function Zu(n,e,s){var a=n[e];n[e]=n[s],n[s]=a}function _b(n,e){return n<e?-1:n>e?1:0}function df(n,e){const s=n.length;if(s<=1)return[n];const a=[];let h,m;for(let y=0;y<s;y++){const v=En(n[y]);v!==0&&(n[y].area=Math.abs(v),m===void 0&&(m=v<0),m===v<0?(h&&a.push(h),h=[n[y]]):h.push(n[y]))}if(h&&a.push(h),e>1)for(let y=0;y<a.length;y++)a[y].length<=e||(yb(a[y],e,1,a[y].length-1,vb),a[y]=a[y].slice(0,e));return a}function vb(n,e){return e.area-n.area}function pf(n,e,s){const a=s.patternDependencies;let h=!1;for(const m of e){const y=m.paint.get(`${n}-pattern`);y.isConstant()||(h=!0);const v=y.constantOr(null);v&&(h=!0,a[v.to]=!0,a[v.from]=!0)}return h}function ff(n,e,s,a,h){const m=h.patternDependencies;for(const y of e){const v=y.paint.get(`${n}-pattern`).value;if(v.kind!=="constant"){let S=v.evaluate({zoom:a-1},s,{},h.availableImages),k=v.evaluate({zoom:a},s,{},h.availableImages),C=v.evaluate({zoom:a+1},s,{},h.availableImages);S=S&&S.name?S.name:S,k=k&&k.name?k.name:k,C=C&&C.name?C.name:C,m[S]=!0,m[k]=!0,m[C]=!0,s.patterns[y.id]={min:S,mid:k,max:C}}}return s}class mf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(s=>s.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new _t,this.indexArray=new Br,this.indexArray2=new br,this.programConfigurations=new qi(e.layers,e.zoom),this.segments=new Zt,this.segments2=new Zt,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(e,s,a){this.hasPattern=pf("fill",this.layers,s);const h=this.layers[0].layout.get("fill-sort-key"),m=!h.isConstant(),y=[];for(const{feature:v,id:S,index:k,sourceLayerIndex:C}of e){const M=this.layers[0]._featureFilter.needGeometry,L=pa(v,M);if(!this.layers[0]._featureFilter.filter(new qt(this.zoom),L,a))continue;const O=m?h.evaluate(L,{},a,s.availableImages):void 0,N={id:S,properties:v.properties,type:v.type,sourceLayerIndex:C,index:k,geometry:M?L.geometry:da(v),patterns:{},sortKey:O};y.push(N)}m&&y.sort((v,S)=>v.sortKey-S.sortKey);for(const v of y){const{geometry:S,index:k,sourceLayerIndex:C}=v;if(this.hasPattern){const M=ff("fill",this.layers,v,this.zoom,s);this.patternFeatures.push(M)}else this.addFeature(v,S,k,a,{});s.featureIndex.insert(e[k].feature,S,k,C,this.index)}}update(e,s,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,s,this.stateDependentLayers,a)}addFeatures(e,s,a){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,s,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,ab),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.indexBuffer2=e.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(e,s,a,h,m){for(const y of df(s,500)){let v=0;for(const O of y)v+=O.length;const S=this.segments.prepareSegment(v,this.layoutVertexArray,this.indexArray),k=S.vertexLength,C=[],M=[];for(const O of y){if(O.length===0)continue;O!==y[0]&&M.push(C.length/2);const N=this.segments2.prepareSegment(O.length,this.layoutVertexArray,this.indexArray2),j=N.vertexLength;this.layoutVertexArray.emplaceBack(O[0].x,O[0].y),this.indexArray2.emplaceBack(j+O.length-1,j),C.push(O[0].x),C.push(O[0].y);for(let H=1;H<O.length;H++)this.layoutVertexArray.emplaceBack(O[H].x,O[H].y),this.indexArray2.emplaceBack(j+H-1,j+H),C.push(O[H].x),C.push(O[H].y);N.vertexLength+=O.length,N.primitiveLength+=O.length}const L=r_(C,M);for(let O=0;O<L.length;O+=3)this.indexArray.emplaceBack(k+L[O],k+L[O+1],k+L[O+2]);S.vertexLength+=v,S.primitiveLength+=L.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,h)}}let i_,s_;Ge("FillBucket",mf,{omit:["layers","patternFeatures"]});var xb={get paint(){return s_=s_||new dr({"fill-antialias":new et(ve.paint_fill["fill-antialias"]),"fill-opacity":new ot(ve.paint_fill["fill-opacity"]),"fill-color":new ot(ve.paint_fill["fill-color"]),"fill-outline-color":new ot(ve.paint_fill["fill-outline-color"]),"fill-translate":new et(ve.paint_fill["fill-translate"]),"fill-translate-anchor":new et(ve.paint_fill["fill-translate-anchor"]),"fill-pattern":new ua(ve.paint_fill["fill-pattern"])})},get layout(){return i_=i_||new dr({"fill-sort-key":new ot(ve.layout_fill["fill-sort-key"])})}};class wb extends Hn{constructor(e){super(e,xb)}recalculate(e,s){super.recalculate(e,s);const a=this.paint._values["fill-outline-color"];a.value.kind==="constant"&&a.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(e){return new mf(e)}queryRadius(){return Bh(this.paint.get("fill-translate"))}queryIntersectsFeature(e,s,a,h,m,y,v){return Vy(Oh(e,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,v),h)}isTileClipped(){return!0}}const bb=Qt([{name:"a_pos",components:2,type:"Int16"},{name:"a_normal_ed",components:4,type:"Int16"}],4),Sb=Qt([{name:"a_centroid",components:2,type:"Int16"}],4),{members:Tb}=bb;var vo={},kb=ne,o_=pl;function pl(n,e,s,a,h){this.properties={},this.extent=s,this.type=0,this._pbf=n,this._geometry=-1,this._keys=a,this._values=h,n.readFields(Eb,this,e)}function Eb(n,e,s){n==1?e.id=s.readVarint():n==2?function(a,h){for(var m=a.readVarint()+a.pos;a.pos<m;){var y=h._keys[a.readVarint()],v=h._values[a.readVarint()];h.properties[y]=v}}(s,e):n==3?e.type=s.readVarint():n==4&&(e._geometry=s.pos)}function Ib(n){for(var e,s,a=0,h=0,m=n.length,y=m-1;h<m;y=h++)a+=((s=n[y]).x-(e=n[h]).x)*(e.y+s.y);return a}pl.types=["Unknown","Point","LineString","Polygon"],pl.prototype.loadGeometry=function(){var n=this._pbf;n.pos=this._geometry;for(var e,s=n.readVarint()+n.pos,a=1,h=0,m=0,y=0,v=[];n.pos<s;){if(h<=0){var S=n.readVarint();a=7&S,h=S>>3}if(h--,a===1||a===2)m+=n.readSVarint(),y+=n.readSVarint(),a===1&&(e&&v.push(e),e=[]),e.push(new kb(m,y));else{if(a!==7)throw new Error("unknown command "+a);e&&e.push(e[0].clone())}}return e&&v.push(e),v},pl.prototype.bbox=function(){var n=this._pbf;n.pos=this._geometry;for(var e=n.readVarint()+n.pos,s=1,a=0,h=0,m=0,y=1/0,v=-1/0,S=1/0,k=-1/0;n.pos<e;){if(a<=0){var C=n.readVarint();s=7&C,a=C>>3}if(a--,s===1||s===2)(h+=n.readSVarint())<y&&(y=h),h>v&&(v=h),(m+=n.readSVarint())<S&&(S=m),m>k&&(k=m);else if(s!==7)throw new Error("unknown command "+s)}return[y,S,v,k]},pl.prototype.toGeoJSON=function(n,e,s){var a,h,m=this.extent*Math.pow(2,s),y=this.extent*n,v=this.extent*e,S=this.loadGeometry(),k=pl.types[this.type];function C(O){for(var N=0;N<O.length;N++){var j=O[N];O[N]=[360*(j.x+y)/m-180,360/Math.PI*Math.atan(Math.exp((180-360*(j.y+v)/m)*Math.PI/180))-90]}}switch(this.type){case 1:var M=[];for(a=0;a<S.length;a++)M[a]=S[a][0];C(S=M);break;case 2:for(a=0;a<S.length;a++)C(S[a]);break;case 3:for(S=function(O){var N=O.length;if(N<=1)return[O];for(var j,H,Q=[],ue=0;ue<N;ue++){var ie=Ib(O[ue]);ie!==0&&(H===void 0&&(H=ie<0),H===ie<0?(j&&Q.push(j),j=[O[ue]]):j.push(O[ue]))}return j&&Q.push(j),Q}(S),a=0;a<S.length;a++)for(h=0;h<S[a].length;h++)C(S[a][h])}S.length===1?S=S[0]:k="Multi"+k;var L={type:"Feature",geometry:{type:k,coordinates:S},properties:this.properties};return"id"in this&&(L.id=this.id),L};var Cb=o_,a_=l_;function l_(n,e){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=n,this._keys=[],this._values=[],this._features=[],n.readFields(Pb,this,e),this.length=this._features.length}function Pb(n,e,s){n===15?e.version=s.readVarint():n===1?e.name=s.readString():n===5?e.extent=s.readVarint():n===2?e._features.push(s.pos):n===3?e._keys.push(s.readString()):n===4&&e._values.push(function(a){for(var h=null,m=a.readVarint()+a.pos;a.pos<m;){var y=a.readVarint()>>3;h=y===1?a.readString():y===2?a.readFloat():y===3?a.readDouble():y===4?a.readVarint64():y===5?a.readVarint():y===6?a.readSVarint():y===7?a.readBoolean():null}return h}(s))}l_.prototype.feature=function(n){if(n<0||n>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[n];var e=this._pbf.readVarint()+this._pbf.pos;return new Cb(this._pbf,e,this.extent,this._keys,this._values)};var zb=a_;function Mb(n,e,s){if(n===3){var a=new zb(s,s.readVarint()+s.pos);a.length&&(e[a.name]=a)}}vo.VectorTile=function(n,e){this.layers=n.readFields(Mb,{},e)},vo.VectorTileFeature=o_,vo.VectorTileLayer=a_;const Ab=vo.VectorTileFeature.types,gf=Math.pow(2,13);function Gu(n,e,s,a,h,m,y,v){n.emplaceBack(e,s,2*Math.floor(a*gf)+y,h*gf*2,m*gf*2,Math.round(v))}class yf{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(s=>s.id),this.index=e.index,this.hasPattern=!1,this.layoutVertexArray=new Ne,this.centroidVertexArray=new Ae,this.indexArray=new Br,this.programConfigurations=new qi(e.layers,e.zoom),this.segments=new Zt,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(e,s,a){this.features=[],this.hasPattern=pf("fill-extrusion",this.layers,s);for(const{feature:h,id:m,index:y,sourceLayerIndex:v}of e){const S=this.layers[0]._featureFilter.needGeometry,k=pa(h,S);if(!this.layers[0]._featureFilter.filter(new qt(this.zoom),k,a))continue;const C={id:m,sourceLayerIndex:v,index:y,geometry:S?k.geometry:da(h),properties:h.properties,type:h.type,patterns:{}};this.hasPattern?this.features.push(ff("fill-extrusion",this.layers,C,this.zoom,s)):this.addFeature(C,C.geometry,y,a,{}),s.featureIndex.insert(h,C.geometry,y,v,this.index,!0)}}addFeatures(e,s,a){for(const h of this.features){const{geometry:m}=h;this.addFeature(h,m,h.index,s,a)}}update(e,s,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,s,this.stateDependentLayers,a)}isEmpty(){return this.layoutVertexArray.length===0&&this.centroidVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Tb),this.centroidVertexBuffer=e.createVertexBuffer(this.centroidVertexArray,Sb.members,!0),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.centroidVertexBuffer.destroy())}addFeature(e,s,a,h,m){const y={x:0,y:0,vertexCount:0};for(const v of df(s,500)){let S=0;for(const N of v)S+=N.length;let k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray);for(const N of v){if(N.length===0||Lb(N))continue;let j=0;for(let H=0;H<N.length;H++){const Q=N[H];if(H>=1){const ue=N[H-1];if(!Db(Q,ue)){k.vertexLength+4>Zt.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray));const ie=Q.sub(ue)._perp()._unit(),de=ue.dist(Q);j+de>32768&&(j=0),Gu(this.layoutVertexArray,Q.x,Q.y,ie.x,ie.y,0,0,j),Gu(this.layoutVertexArray,Q.x,Q.y,ie.x,ie.y,0,1,j),y.x+=2*Q.x,y.y+=2*Q.y,y.vertexCount+=2,j+=de,Gu(this.layoutVertexArray,ue.x,ue.y,ie.x,ie.y,0,0,j),Gu(this.layoutVertexArray,ue.x,ue.y,ie.x,ie.y,0,1,j),y.x+=2*ue.x,y.y+=2*ue.y,y.vertexCount+=2;const fe=k.vertexLength;this.indexArray.emplaceBack(fe,fe+2,fe+1),this.indexArray.emplaceBack(fe+1,fe+2,fe+3),k.vertexLength+=4,k.primitiveLength+=2}}}}if(k.vertexLength+S>Zt.MAX_VERTEX_ARRAY_LENGTH&&(k=this.segments.prepareSegment(S,this.layoutVertexArray,this.indexArray)),Ab[e.type]!=="Polygon")continue;const C=[],M=[],L=k.vertexLength;for(const N of v)if(N.length!==0){N!==v[0]&&M.push(C.length/2);for(let j=0;j<N.length;j++){const H=N[j];Gu(this.layoutVertexArray,H.x,H.y,0,0,1,1,0),y.x+=H.x,y.y+=H.y,y.vertexCount+=1,C.push(H.x),C.push(H.y)}}const O=r_(C,M);for(let N=0;N<O.length;N+=3)this.indexArray.emplaceBack(L+O[N],L+O[N+2],L+O[N+1]);k.primitiveLength+=O.length/3,k.vertexLength+=S}for(let v=0;v<y.vertexCount;v++)this.centroidVertexArray.emplaceBack(Math.floor(y.x/y.vertexCount),Math.floor(y.y/y.vertexCount));this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,h)}}function Db(n,e){return n.x===e.x&&(n.x<0||n.x>vr)||n.y===e.y&&(n.y<0||n.y>vr)}function Lb(n){return n.every(e=>e.x<0)||n.every(e=>e.x>vr)||n.every(e=>e.y<0)||n.every(e=>e.y>vr)}let u_;Ge("FillExtrusionBucket",yf,{omit:["layers","features"]});var Rb={get paint(){return u_=u_||new dr({"fill-extrusion-opacity":new et(ve["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new ot(ve["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new et(ve["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new et(ve["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new ua(ve["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new ot(ve["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new ot(ve["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new et(ve["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"])})}};class Fb extends Hn{constructor(e){super(e,Rb)}createBucket(e){return new yf(e)}queryRadius(){return Bh(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}queryIntersectsFeature(e,s,a,h,m,y,v,S){const k=Oh(e,this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,v),C=this.paint.get("fill-extrusion-height").evaluate(s,a),M=this.paint.get("fill-extrusion-base").evaluate(s,a),L=function(N,j,H,Q){const ue=[];for(const ie of N){const de=[ie.x,ie.y,0,1];Nh(de,de,j),ue.push(new te(de[0]/de[3],de[1]/de[3]))}return ue}(k,S),O=function(N,j,H,Q){const ue=[],ie=[],de=Q[8]*j,fe=Q[9]*j,Ee=Q[10]*j,qe=Q[11]*j,Ye=Q[8]*H,Ue=Q[9]*H,Ve=Q[10]*H,De=Q[11]*H;for(const We of N){const Be=[],Me=[];for(const it of We){const Je=it.x,gt=it.y,Gt=Q[0]*Je+Q[4]*gt+Q[12],Ht=Q[1]*Je+Q[5]*gt+Q[13],kr=Q[2]*Je+Q[6]*gt+Q[14],Kn=Q[3]*Je+Q[7]*gt+Q[15],_n=kr+Ee,xr=Kn+qe,Nr=Gt+Ye,Hr=Ht+Ue,vn=kr+Ve,xn=Kn+De,Er=new te((Gt+de)/xr,(Ht+fe)/xr);Er.z=_n/xr,Be.push(Er);const Ir=new te(Nr/xn,Hr/xn);Ir.z=vn/xn,Me.push(Ir)}ue.push(Be),ie.push(Me)}return[ue,ie]}(h,M,C,S);return function(N,j,H){let Q=1/0;Vy(H,j)&&(Q=c_(H,j[0]));for(let ue=0;ue<j.length;ue++){const ie=j[ue],de=N[ue];for(let fe=0;fe<ie.length-1;fe++){const Ee=ie[fe],qe=[Ee,ie[fe+1],de[fe+1],de[fe],Ee];Ny(H,qe)&&(Q=Math.min(Q,c_(H,qe)))}}return Q!==1/0&&Q}(O[0],O[1],L)}}function Wu(n,e){return n.x*e.x+n.y*e.y}function c_(n,e){if(n.length===1){let s=0;const a=e[s++];let h;for(;!h||a.equals(h);)if(h=e[s++],!h)return 1/0;for(;s<e.length;s++){const m=e[s],y=n[0],v=h.sub(a),S=m.sub(a),k=y.sub(a),C=Wu(v,v),M=Wu(v,S),L=Wu(S,S),O=Wu(k,v),N=Wu(k,S),j=C*L-M*M,H=(L*O-M*N)/j,Q=(C*N-M*O)/j,ue=a.z*(1-H-Q)+h.z*H+m.z*Q;if(isFinite(ue))return ue}return 1/0}{let s=1/0;for(const a of e)s=Math.min(s,a.z);return s}}const Bb=Qt([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"}],4),{members:Ob}=Bb,Nb=Qt([{name:"a_uv_x",components:1,type:"Float32"},{name:"a_split_index",components:1,type:"Float32"}]),{members:Vb}=Nb,Ub=vo.VectorTileFeature.types,jb=Math.cos(Math.PI/180*37.5),h_=Math.pow(2,14)/.5;class _f{constructor(e){this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(s=>s.id),this.index=e.index,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(s=>{this.gradients[s.id]={}}),this.layoutVertexArray=new at,this.layoutVertexArray2=new Qe,this.indexArray=new Br,this.programConfigurations=new qi(e.layers,e.zoom),this.segments=new Zt,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter(s=>s.isStateDependent()).map(s=>s.id)}populate(e,s,a){this.hasPattern=pf("line",this.layers,s);const h=this.layers[0].layout.get("line-sort-key"),m=!h.isConstant(),y=[];for(const{feature:v,id:S,index:k,sourceLayerIndex:C}of e){const M=this.layers[0]._featureFilter.needGeometry,L=pa(v,M);if(!this.layers[0]._featureFilter.filter(new qt(this.zoom),L,a))continue;const O=m?h.evaluate(L,{},a):void 0,N={id:S,properties:v.properties,type:v.type,sourceLayerIndex:C,index:k,geometry:M?L.geometry:da(v),patterns:{},sortKey:O};y.push(N)}m&&y.sort((v,S)=>v.sortKey-S.sortKey);for(const v of y){const{geometry:S,index:k,sourceLayerIndex:C}=v;if(this.hasPattern){const M=ff("line",this.layers,v,this.zoom,s);this.patternFeatures.push(M)}else this.addFeature(v,S,k,a,{});s.featureIndex.insert(e[k].feature,S,k,C,this.index)}}update(e,s,a){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(e,s,this.stateDependentLayers,a)}addFeatures(e,s,a){for(const h of this.patternFeatures)this.addFeature(h,h.geometry,h.index,s,a)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(e){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=e.createVertexBuffer(this.layoutVertexArray2,Vb)),this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Ob),this.indexBuffer=e.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(e),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(e){if(e.properties&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_start")&&Object.prototype.hasOwnProperty.call(e.properties,"mapbox_clip_end"))return{start:+e.properties.mapbox_clip_start,end:+e.properties.mapbox_clip_end}}addFeature(e,s,a,h,m){const y=this.layers[0].layout,v=y.get("line-join").evaluate(e,{}),S=y.get("line-cap"),k=y.get("line-miter-limit"),C=y.get("line-round-limit");this.lineClips=this.lineFeatureClips(e);for(const M of s)this.addLine(M,e,v,S,k,C);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,e,a,m,h)}addLine(e,s,a,h,m,y){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let Q=0;Q<e.length-1;Q++)this.totalDistance+=e[Q].dist(e[Q+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const v=Ub[s.type]==="Polygon";let S=e.length;for(;S>=2&&e[S-1].equals(e[S-2]);)S--;let k=0;for(;k<S-1&&e[k].equals(e[k+1]);)k++;if(S<(v?3:2))return;a==="bevel"&&(m=1.05);const C=this.overscaling<=16?15*vr/(512*this.overscaling):0,M=this.segments.prepareSegment(10*S,this.layoutVertexArray,this.indexArray);let L,O,N,j,H;this.e1=this.e2=-1,v&&(L=e[S-2],H=e[k].sub(L)._unit()._perp());for(let Q=k;Q<S;Q++){if(N=Q===S-1?v?e[k+1]:void 0:e[Q+1],N&&e[Q].equals(N))continue;H&&(j=H),L&&(O=L),L=e[Q],H=N?N.sub(L)._unit()._perp():j,j=j||H;let ue=j.add(H);ue.x===0&&ue.y===0||ue._unit();const ie=j.x*H.x+j.y*H.y,de=ue.x*H.x+ue.y*H.y,fe=de!==0?1/de:1/0,Ee=2*Math.sqrt(2-2*de),qe=de<jb&&O&&N,Ye=j.x*H.y-j.y*H.x>0;if(qe&&Q>k){const De=L.dist(O);if(De>2*C){const We=L.sub(L.sub(O)._mult(C/De)._round());this.updateDistance(O,We),this.addCurrentVertex(We,j,0,0,M),O=We}}const Ue=O&&N;let Ve=Ue?a:v?"butt":h;if(Ue&&Ve==="round"&&(fe<y?Ve="miter":fe<=2&&(Ve="fakeround")),Ve==="miter"&&fe>m&&(Ve="bevel"),Ve==="bevel"&&(fe>2&&(Ve="flipbevel"),fe<m&&(Ve="miter")),O&&this.updateDistance(O,L),Ve==="miter")ue._mult(fe),this.addCurrentVertex(L,ue,0,0,M);else if(Ve==="flipbevel"){if(fe>100)ue=H.mult(-1);else{const De=fe*j.add(H).mag()/j.sub(H).mag();ue._perp()._mult(De*(Ye?-1:1))}this.addCurrentVertex(L,ue,0,0,M),this.addCurrentVertex(L,ue.mult(-1),0,0,M)}else if(Ve==="bevel"||Ve==="fakeround"){const De=-Math.sqrt(fe*fe-1),We=Ye?De:0,Be=Ye?0:De;if(O&&this.addCurrentVertex(L,j,We,Be,M),Ve==="fakeround"){const Me=Math.round(180*Ee/Math.PI/20);for(let it=1;it<Me;it++){let Je=it/Me;if(Je!==.5){const Gt=Je-.5;Je+=Je*Gt*(Je-1)*((1.0904+ie*(ie*(3.55645-1.43519*ie)-3.2452))*Gt*Gt+(.848013+ie*(.215638*ie-1.06021)))}const gt=H.sub(j)._mult(Je)._add(j)._unit()._mult(Ye?-1:1);this.addHalfVertex(L,gt.x,gt.y,!1,Ye,0,M)}}N&&this.addCurrentVertex(L,H,-We,-Be,M)}else if(Ve==="butt")this.addCurrentVertex(L,ue,0,0,M);else if(Ve==="square"){const De=O?1:-1;this.addCurrentVertex(L,ue,De,De,M)}else Ve==="round"&&(O&&(this.addCurrentVertex(L,j,0,0,M),this.addCurrentVertex(L,j,1,1,M,!0)),N&&(this.addCurrentVertex(L,H,-1,-1,M,!0),this.addCurrentVertex(L,H,0,0,M)));if(qe&&Q<S-1){const De=L.dist(N);if(De>2*C){const We=L.add(N.sub(L)._mult(C/De)._round());this.updateDistance(L,We),this.addCurrentVertex(We,H,0,0,M),L=We}}}}addCurrentVertex(e,s,a,h,m,y=!1){const v=s.y*h-s.x,S=-s.y-s.x*h;this.addHalfVertex(e,s.x+s.y*a,s.y-s.x*a,y,!1,a,m),this.addHalfVertex(e,v,S,y,!0,-h,m),this.distance>h_/2&&this.totalDistance===0&&(this.distance=0,this.updateScaledDistance(),this.addCurrentVertex(e,s,a,h,m,y))}addHalfVertex({x:e,y:s},a,h,m,y,v,S){const k=.5*(this.lineClips?this.scaledDistance*(h_-1):this.scaledDistance);this.layoutVertexArray.emplaceBack((e<<1)+(m?1:0),(s<<1)+(y?1:0),Math.round(63*a)+128,Math.round(63*h)+128,1+(v===0?0:v<0?-1:1)|(63&k)<<2,k>>6),this.lineClips&&this.layoutVertexArray2.emplaceBack((this.scaledDistance-this.lineClips.start)/(this.lineClips.end-this.lineClips.start),this.lineClipsArray.length);const C=S.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,C),S.primitiveLength++),y?this.e2=C:this.e1=C}updateScaledDistance(){this.scaledDistance=this.lineClips?this.lineClips.start+(this.lineClips.end-this.lineClips.start)*this.distance/this.totalDistance:this.distance}updateDistance(e,s){this.distance+=e.dist(s),this.updateScaledDistance()}}let d_,p_;Ge("LineBucket",_f,{omit:["layers","patternFeatures"]});var f_={get paint(){return p_=p_||new dr({"line-opacity":new ot(ve.paint_line["line-opacity"]),"line-color":new ot(ve.paint_line["line-color"]),"line-translate":new et(ve.paint_line["line-translate"]),"line-translate-anchor":new et(ve.paint_line["line-translate-anchor"]),"line-width":new ot(ve.paint_line["line-width"]),"line-gap-width":new ot(ve.paint_line["line-gap-width"]),"line-offset":new ot(ve.paint_line["line-offset"]),"line-blur":new ot(ve.paint_line["line-blur"]),"line-dasharray":new zu(ve.paint_line["line-dasharray"]),"line-pattern":new ua(ve.paint_line["line-pattern"]),"line-gradient":new Mu(ve.paint_line["line-gradient"])})},get layout(){return d_=d_||new dr({"line-cap":new et(ve.layout_line["line-cap"]),"line-join":new ot(ve.layout_line["line-join"]),"line-miter-limit":new et(ve.layout_line["line-miter-limit"]),"line-round-limit":new et(ve.layout_line["line-round-limit"]),"line-sort-key":new ot(ve.layout_line["line-sort-key"])})}};class $b extends ot{possiblyEvaluate(e,s){return s=new qt(Math.floor(s.zoom),{now:s.now,fadeDuration:s.fadeDuration,zoomHistory:s.zoomHistory,transition:s.transition}),super.possiblyEvaluate(e,s)}evaluate(e,s,a,h){return s=Ze({},s,{zoom:Math.floor(s.zoom)}),super.evaluate(e,s,a,h)}}let qh;class qb extends Hn{constructor(e){super(e,f_),this.gradientVersion=0,qh||(qh=new $b(f_.paint.properties["line-width"].specification),qh.useIntegerZoom=!0)}_handleSpecialPaintPropertyUpdate(e){if(e==="line-gradient"){const s=this.gradientExpression();this.stepInterpolant=!!function(a){return a._styleExpression!==void 0}(s)&&s._styleExpression.expression instanceof hs,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}recalculate(e,s){super.recalculate(e,s),this.paint._values["line-floorwidth"]=qh.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,e)}createBucket(e){return new _f(e)}queryRadius(e){const s=e,a=m_(Nu("line-width",this,s),Nu("line-gap-width",this,s)),h=Nu("line-offset",this,s);return a/2+Math.abs(h)+Bh(this.paint.get("line-translate"))}queryIntersectsFeature(e,s,a,h,m,y,v){const S=Oh(e,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,v),k=v/2*m_(this.paint.get("line-width").evaluate(s,a),this.paint.get("line-gap-width").evaluate(s,a)),C=this.paint.get("line-offset").evaluate(s,a);return C&&(h=function(M,L){const O=[];for(let N=0;N<M.length;N++){const j=M[N],H=[];for(let Q=0;Q<j.length;Q++){const ue=j[Q-1],ie=j[Q],de=j[Q+1],fe=Q===0?new te(0,0):ie.sub(ue)._unit()._perp(),Ee=Q===j.length-1?new te(0,0):de.sub(ie)._unit()._perp(),qe=fe._add(Ee)._unit(),Ye=qe.x*Ee.x+qe.y*Ee.y;Ye!==0&&qe._mult(1/Ye),H.push(qe._mult(L)._add(ie))}O.push(H)}return O}(h,C*v)),function(M,L,O){for(let N=0;N<L.length;N++){const j=L[N];if(M.length>=3){for(let H=0;H<j.length;H++)if(cl(M,j[H]))return!0}if(Kw(M,j,O))return!0}return!1}(S,h,k)}isTileClipped(){return!0}}function m_(n,e){return e>0?e+2*n:n}const Zb=Qt([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_data",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),Gb=Qt([{name:"a_projected_pos",components:3,type:"Float32"}],4);Qt([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const Wb=Qt([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]);Qt([{type:"Int16",name:"anchorPointX"},{type:"Int16",name:"anchorPointY"},{type:"Int16",name:"x1"},{type:"Int16",name:"y1"},{type:"Int16",name:"x2"},{type:"Int16",name:"y2"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const g_=Qt([{name:"a_pos",components:2,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),Hb=Qt([{name:"a_pos",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);function Xb(n,e,s){return n.sections.forEach(a=>{a.text=function(h,m,y){const v=m.layout.get("text-transform").evaluate(y,{});return v==="uppercase"?h=h.toLocaleUpperCase():v==="lowercase"&&(h=h.toLocaleLowerCase()),Mn.applyArabicShaping&&(h=Mn.applyArabicShaping(h)),h}(a.text,e,s)}),n}Qt([{name:"triangle",components:3,type:"Uint16"}]),Qt([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"}]),Qt([{type:"Int16",name:"anchorX"},{type:"Int16",name:"anchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",name:"textBoxScale"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Uint16",name:"textAnchorOffsetStartIndex"},{type:"Uint16",name:"textAnchorOffsetEndIndex"}]),Qt([{type:"Float32",name:"offsetX"}]),Qt([{type:"Int16",name:"x"},{type:"Int16",name:"y"},{type:"Int16",name:"tileUnitDistanceFromAnchor"}]),Qt([{type:"Uint16",name:"textAnchor"},{type:"Float32",components:2,name:"textOffset"}]);const Hu={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};var Tr=24,y_=Ot,__=function(n,e,s,a,h){var m,y,v=8*h-a-1,S=(1<<v)-1,k=S>>1,C=-7,M=s?h-1:0,L=s?-1:1,O=n[e+M];for(M+=L,m=O&(1<<-C)-1,O>>=-C,C+=v;C>0;m=256*m+n[e+M],M+=L,C-=8);for(y=m&(1<<-C)-1,m>>=-C,C+=a;C>0;y=256*y+n[e+M],M+=L,C-=8);if(m===0)m=1-k;else{if(m===S)return y?NaN:1/0*(O?-1:1);y+=Math.pow(2,a),m-=k}return(O?-1:1)*y*Math.pow(2,m-a)},v_=function(n,e,s,a,h,m){var y,v,S,k=8*m-h-1,C=(1<<k)-1,M=C>>1,L=h===23?Math.pow(2,-24)-Math.pow(2,-77):0,O=a?0:m-1,N=a?1:-1,j=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(v=isNaN(e)?1:0,y=C):(y=Math.floor(Math.log(e)/Math.LN2),e*(S=Math.pow(2,-y))<1&&(y--,S*=2),(e+=y+M>=1?L/S:L*Math.pow(2,1-M))*S>=2&&(y++,S/=2),y+M>=C?(v=0,y=C):y+M>=1?(v=(e*S-1)*Math.pow(2,h),y+=M):(v=e*Math.pow(2,M-1)*Math.pow(2,h),y=0));h>=8;n[s+O]=255&v,O+=N,v/=256,h-=8);for(y=y<<h|v,k+=h;k>0;n[s+O]=255&y,O+=N,y/=256,k-=8);n[s+O-N]|=128*j};function Ot(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}Ot.Varint=0,Ot.Fixed64=1,Ot.Bytes=2,Ot.Fixed32=5;var vf=4294967296,x_=1/vf,w_=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Ns(n){return n.type===Ot.Bytes?n.readVarint()+n.pos:n.pos+1}function fl(n,e,s){return s?4294967296*e+(n>>>0):4294967296*(e>>>0)+(n>>>0)}function b_(n,e,s){var a=e<=16383?1:e<=2097151?2:e<=268435455?3:Math.floor(Math.log(e)/(7*Math.LN2));s.realloc(a);for(var h=s.pos-1;h>=n;h--)s.buf[h+a]=s.buf[h]}function Kb(n,e){for(var s=0;s<n.length;s++)e.writeVarint(n[s])}function Yb(n,e){for(var s=0;s<n.length;s++)e.writeSVarint(n[s])}function Qb(n,e){for(var s=0;s<n.length;s++)e.writeFloat(n[s])}function Jb(n,e){for(var s=0;s<n.length;s++)e.writeDouble(n[s])}function e2(n,e){for(var s=0;s<n.length;s++)e.writeBoolean(n[s])}function t2(n,e){for(var s=0;s<n.length;s++)e.writeFixed32(n[s])}function r2(n,e){for(var s=0;s<n.length;s++)e.writeSFixed32(n[s])}function n2(n,e){for(var s=0;s<n.length;s++)e.writeFixed64(n[s])}function i2(n,e){for(var s=0;s<n.length;s++)e.writeSFixed64(n[s])}function Zh(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+16777216*n[e+3]}function ml(n,e,s){n[s]=e,n[s+1]=e>>>8,n[s+2]=e>>>16,n[s+3]=e>>>24}function S_(n,e){return(n[e]|n[e+1]<<8|n[e+2]<<16)+(n[e+3]<<24)}Ot.prototype={destroy:function(){this.buf=null},readFields:function(n,e,s){for(s=s||this.length;this.pos<s;){var a=this.readVarint(),h=a>>3,m=this.pos;this.type=7&a,n(h,e,this),this.pos===m&&this.skip(a)}return e},readMessage:function(n,e){return this.readFields(n,e,this.readVarint()+this.pos)},readFixed32:function(){var n=Zh(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=S_(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=Zh(this.buf,this.pos)+Zh(this.buf,this.pos+4)*vf;return this.pos+=8,n},readSFixed64:function(){var n=Zh(this.buf,this.pos)+S_(this.buf,this.pos+4)*vf;return this.pos+=8,n},readFloat:function(){var n=__(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=__(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var e,s,a=this.buf;return e=127&(s=a[this.pos++]),s<128?e:(e|=(127&(s=a[this.pos++]))<<7,s<128?e:(e|=(127&(s=a[this.pos++]))<<14,s<128?e:(e|=(127&(s=a[this.pos++]))<<21,s<128?e:function(h,m,y){var v,S,k=y.buf;if(v=(112&(S=k[y.pos++]))>>4,S<128||(v|=(127&(S=k[y.pos++]))<<3,S<128)||(v|=(127&(S=k[y.pos++]))<<10,S<128)||(v|=(127&(S=k[y.pos++]))<<17,S<128)||(v|=(127&(S=k[y.pos++]))<<24,S<128)||(v|=(1&(S=k[y.pos++]))<<31,S<128))return fl(h,v,m);throw new Error("Expected varint not more than 10 bytes")}(e|=(15&(s=a[this.pos]))<<28,n,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2==1?(n+1)/-2:n/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var n=this.readVarint()+this.pos,e=this.pos;return this.pos=n,n-e>=12&&w_?function(s,a,h){return w_.decode(s.subarray(a,h))}(this.buf,e,n):function(s,a,h){for(var m="",y=a;y<h;){var v,S,k,C=s[y],M=null,L=C>239?4:C>223?3:C>191?2:1;if(y+L>h)break;L===1?C<128&&(M=C):L===2?(192&(v=s[y+1]))==128&&(M=(31&C)<<6|63&v)<=127&&(M=null):L===3?(S=s[y+2],(192&(v=s[y+1]))==128&&(192&S)==128&&((M=(15&C)<<12|(63&v)<<6|63&S)<=2047||M>=55296&&M<=57343)&&(M=null)):L===4&&(S=s[y+2],k=s[y+3],(192&(v=s[y+1]))==128&&(192&S)==128&&(192&k)==128&&((M=(15&C)<<18|(63&v)<<12|(63&S)<<6|63&k)<=65535||M>=1114112)&&(M=null)),M===null?(M=65533,L=1):M>65535&&(M-=65536,m+=String.fromCharCode(M>>>10&1023|55296),M=56320|1023&M),m+=String.fromCharCode(M),y+=L}return m}(this.buf,e,n)},readBytes:function(){var n=this.readVarint()+this.pos,e=this.buf.subarray(this.pos,n);return this.pos=n,e},readPackedVarint:function(n,e){if(this.type!==Ot.Bytes)return n.push(this.readVarint(e));var s=Ns(this);for(n=n||[];this.pos<s;)n.push(this.readVarint(e));return n},readPackedSVarint:function(n){if(this.type!==Ot.Bytes)return n.push(this.readSVarint());var e=Ns(this);for(n=n||[];this.pos<e;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==Ot.Bytes)return n.push(this.readBoolean());var e=Ns(this);for(n=n||[];this.pos<e;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==Ot.Bytes)return n.push(this.readFloat());var e=Ns(this);for(n=n||[];this.pos<e;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==Ot.Bytes)return n.push(this.readDouble());var e=Ns(this);for(n=n||[];this.pos<e;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==Ot.Bytes)return n.push(this.readFixed32());var e=Ns(this);for(n=n||[];this.pos<e;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==Ot.Bytes)return n.push(this.readSFixed32());var e=Ns(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==Ot.Bytes)return n.push(this.readFixed64());var e=Ns(this);for(n=n||[];this.pos<e;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==Ot.Bytes)return n.push(this.readSFixed64());var e=Ns(this);for(n=n||[];this.pos<e;)n.push(this.readSFixed64());return n},skip:function(n){var e=7&n;if(e===Ot.Varint)for(;this.buf[this.pos++]>127;);else if(e===Ot.Bytes)this.pos=this.readVarint()+this.pos;else if(e===Ot.Fixed32)this.pos+=4;else{if(e!==Ot.Fixed64)throw new Error("Unimplemented type: "+e);this.pos+=8}},writeTag:function(n,e){this.writeVarint(n<<3|e)},realloc:function(n){for(var e=this.length||16;e<this.pos+n;)e*=2;if(e!==this.length){var s=new Uint8Array(e);s.set(this.buf),this.buf=s,this.length=e}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),ml(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),ml(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),ml(this.buf,-1&n,this.pos),ml(this.buf,Math.floor(n*x_),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),ml(this.buf,-1&n,this.pos),ml(this.buf,Math.floor(n*x_),this.pos+4),this.pos+=8},writeVarint:function(n){(n=+n||0)>268435455||n<0?function(e,s){var a,h;if(e>=0?(a=e%4294967296|0,h=e/4294967296|0):(h=~(-e/4294967296),4294967295^(a=~(-e%4294967296))?a=a+1|0:(a=0,h=h+1|0)),e>=18446744073709552e3||e<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),function(m,y,v){v.buf[v.pos++]=127&m|128,m>>>=7,v.buf[v.pos++]=127&m|128,m>>>=7,v.buf[v.pos++]=127&m|128,m>>>=7,v.buf[v.pos++]=127&m|128,v.buf[v.pos]=127&(m>>>=7)}(a,0,s),function(m,y){var v=(7&m)<<4;y.buf[y.pos++]|=v|((m>>>=3)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m|((m>>>=7)?128:0),m&&(y.buf[y.pos++]=127&m)))))}(h,s)}(n,this):(this.realloc(4),this.buf[this.pos++]=127&n|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=127&(n>>>=7)|(n>127?128:0),n<=127||(this.buf[this.pos++]=n>>>7&127))))},writeSVarint:function(n){this.writeVarint(n<0?2*-n-1:2*n)},writeBoolean:function(n){this.writeVarint(!!n)},writeString:function(n){n=String(n),this.realloc(4*n.length),this.pos++;var e=this.pos;this.pos=function(a,h,m){for(var y,v,S=0;S<h.length;S++){if((y=h.charCodeAt(S))>55295&&y<57344){if(!v){y>56319||S+1===h.length?(a[m++]=239,a[m++]=191,a[m++]=189):v=y;continue}if(y<56320){a[m++]=239,a[m++]=191,a[m++]=189,v=y;continue}y=v-55296<<10|y-56320|65536,v=null}else v&&(a[m++]=239,a[m++]=191,a[m++]=189,v=null);y<128?a[m++]=y:(y<2048?a[m++]=y>>6|192:(y<65536?a[m++]=y>>12|224:(a[m++]=y>>18|240,a[m++]=y>>12&63|128),a[m++]=y>>6&63|128),a[m++]=63&y|128)}return m}(this.buf,n,this.pos);var s=this.pos-e;s>=128&&b_(e,s,this),this.pos=e-1,this.writeVarint(s),this.pos+=s},writeFloat:function(n){this.realloc(4),v_(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),v_(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var e=n.length;this.writeVarint(e),this.realloc(e);for(var s=0;s<e;s++)this.buf[this.pos++]=n[s]},writeRawMessage:function(n,e){this.pos++;var s=this.pos;n(e,this);var a=this.pos-s;a>=128&&b_(s,a,this),this.pos=s-1,this.writeVarint(a),this.pos+=a},writeMessage:function(n,e,s){this.writeTag(n,Ot.Bytes),this.writeRawMessage(e,s)},writePackedVarint:function(n,e){e.length&&this.writeMessage(n,Kb,e)},writePackedSVarint:function(n,e){e.length&&this.writeMessage(n,Yb,e)},writePackedBoolean:function(n,e){e.length&&this.writeMessage(n,e2,e)},writePackedFloat:function(n,e){e.length&&this.writeMessage(n,Qb,e)},writePackedDouble:function(n,e){e.length&&this.writeMessage(n,Jb,e)},writePackedFixed32:function(n,e){e.length&&this.writeMessage(n,t2,e)},writePackedSFixed32:function(n,e){e.length&&this.writeMessage(n,r2,e)},writePackedFixed64:function(n,e){e.length&&this.writeMessage(n,n2,e)},writePackedSFixed64:function(n,e){e.length&&this.writeMessage(n,i2,e)},writeBytesField:function(n,e){this.writeTag(n,Ot.Bytes),this.writeBytes(e)},writeFixed32Field:function(n,e){this.writeTag(n,Ot.Fixed32),this.writeFixed32(e)},writeSFixed32Field:function(n,e){this.writeTag(n,Ot.Fixed32),this.writeSFixed32(e)},writeFixed64Field:function(n,e){this.writeTag(n,Ot.Fixed64),this.writeFixed64(e)},writeSFixed64Field:function(n,e){this.writeTag(n,Ot.Fixed64),this.writeSFixed64(e)},writeVarintField:function(n,e){this.writeTag(n,Ot.Varint),this.writeVarint(e)},writeSVarintField:function(n,e){this.writeTag(n,Ot.Varint),this.writeSVarint(e)},writeStringField:function(n,e){this.writeTag(n,Ot.Bytes),this.writeString(e)},writeFloatField:function(n,e){this.writeTag(n,Ot.Fixed32),this.writeFloat(e)},writeDoubleField:function(n,e){this.writeTag(n,Ot.Fixed64),this.writeDouble(e)},writeBooleanField:function(n,e){this.writeVarintField(n,!!e)}};var xf=D(y_);const wf=3;function s2(n,e,s){n===1&&s.readMessage(o2,e)}function o2(n,e,s){if(n===3){const{id:a,bitmap:h,width:m,height:y,left:v,top:S,advance:k}=s.readMessage(a2,{});e.push({id:a,bitmap:new Uu({width:m+2*wf,height:y+2*wf},h),metrics:{width:m,height:y,left:v,top:S,advance:k}})}}function a2(n,e,s){n===1?e.id=s.readVarint():n===2?e.bitmap=s.readBytes():n===3?e.width=s.readVarint():n===4?e.height=s.readVarint():n===5?e.left=s.readSVarint():n===6?e.top=s.readSVarint():n===7&&(e.advance=s.readVarint())}const T_=wf;function k_(n){let e=0,s=0;for(const y of n)e+=y.w*y.h,s=Math.max(s,y.w);n.sort((y,v)=>v.h-y.h);const a=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(e/.95)),s),h:1/0}];let h=0,m=0;for(const y of n)for(let v=a.length-1;v>=0;v--){const S=a[v];if(!(y.w>S.w||y.h>S.h)){if(y.x=S.x,y.y=S.y,m=Math.max(m,y.y+y.h),h=Math.max(h,y.x+y.w),y.w===S.w&&y.h===S.h){const k=a.pop();v<a.length&&(a[v]=k)}else y.h===S.h?(S.x+=y.w,S.w-=y.w):y.w===S.w?(S.y+=y.h,S.h-=y.h):(a.push({x:S.x+y.w,y:S.y,w:S.w-y.w,h:y.h}),S.y+=y.h,S.h-=y.h);break}}return{w:h,h:m,fill:e/(h*m)||0}}const Dn=1;class bf{constructor(e,{pixelRatio:s,version:a,stretchX:h,stretchY:m,content:y}){this.paddedRect=e,this.pixelRatio=s,this.stretchX=h,this.stretchY=m,this.content=y,this.version=a}get tl(){return[this.paddedRect.x+Dn,this.paddedRect.y+Dn]}get br(){return[this.paddedRect.x+this.paddedRect.w-Dn,this.paddedRect.y+this.paddedRect.h-Dn]}get tlbr(){return this.tl.concat(this.br)}get displaySize(){return[(this.paddedRect.w-2*Dn)/this.pixelRatio,(this.paddedRect.h-2*Dn)/this.pixelRatio]}}class E_{constructor(e,s){const a={},h={};this.haveRenderCallbacks=[];const m=[];this.addImages(e,a,m),this.addImages(s,h,m);const{w:y,h:v}=k_(m),S=new si({width:y||1,height:v||1});for(const k in e){const C=e[k],M=a[k].paddedRect;si.copy(C.data,S,{x:0,y:0},{x:M.x+Dn,y:M.y+Dn},C.data)}for(const k in s){const C=s[k],M=h[k].paddedRect,L=M.x+Dn,O=M.y+Dn,N=C.data.width,j=C.data.height;si.copy(C.data,S,{x:0,y:0},{x:L,y:O},C.data),si.copy(C.data,S,{x:0,y:j-1},{x:L,y:O-1},{width:N,height:1}),si.copy(C.data,S,{x:0,y:0},{x:L,y:O+j},{width:N,height:1}),si.copy(C.data,S,{x:N-1,y:0},{x:L-1,y:O},{width:1,height:j}),si.copy(C.data,S,{x:0,y:0},{x:L+N,y:O},{width:1,height:j})}this.image=S,this.iconPositions=a,this.patternPositions=h}addImages(e,s,a){for(const h in e){const m=e[h],y={x:0,y:0,w:m.data.width+2*Dn,h:m.data.height+2*Dn};a.push(y),s[h]=new bf(y,m),m.hasRenderCallback&&this.haveRenderCallbacks.push(h)}}patchUpdatedImages(e,s){e.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const a in e.updatedImages)this.patchUpdatedImage(this.iconPositions[a],e.getImage(a),s),this.patchUpdatedImage(this.patternPositions[a],e.getImage(a),s)}patchUpdatedImage(e,s,a){if(!e||!s||e.version===s.version)return;e.version=s.version;const[h,m]=e.tl;a.update(s.data,void 0,{x:h,y:m})}}var xo;Ge("ImagePosition",bf),Ge("ImageAtlas",E_),u.ai=void 0,(xo=u.ai||(u.ai={}))[xo.none=0]="none",xo[xo.horizontal=1]="horizontal",xo[xo.vertical=2]="vertical",xo[xo.horizontalOnly=3]="horizontalOnly";const Xu=-17;class Ku{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(e,s){const a=new Ku;return a.scale=e||1,a.fontStack=s,a}static forImage(e){const s=new Ku;return s.imageName=e,s}}class gl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(e,s){const a=new gl;for(let h=0;h<e.sections.length;h++){const m=e.sections[h];m.image?a.addImageSection(m):a.addTextSection(m,s)}return a}length(){return this.text.length}getSection(e){return this.sections[this.sectionIndex[e]]}getSectionIndex(e){return this.sectionIndex[e]}getCharCode(e){return this.text.charCodeAt(e)}verticalizePunctuation(){this.text=function(e){let s="";for(let a=0;a<e.length;a++){const h=e.charCodeAt(a+1)||null,m=e.charCodeAt(a-1)||null;s+=h&&Eh(h)&&!Hu[e[a+1]]||m&&Eh(m)&&!Hu[e[a-1]]||!Hu[e[a]]?e[a]:Hu[e[a]]}return s}(this.text)}trim(){let e=0;for(let a=0;a<this.text.length&&Wh[this.text.charCodeAt(a)];a++)e++;let s=this.text.length;for(let a=this.text.length-1;a>=0&&a>=e&&Wh[this.text.charCodeAt(a)];a--)s--;this.text=this.text.substring(e,s),this.sectionIndex=this.sectionIndex.slice(e,s)}substring(e,s){const a=new gl;return a.text=this.text.substring(e,s),a.sectionIndex=this.sectionIndex.slice(e,s),a.sections=this.sections,a}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((e,s)=>Math.max(e,this.sections[s].scale),0)}addTextSection(e,s){this.text+=e.text,this.sections.push(Ku.forText(e.scale,e.fontStack||s));const a=this.sections.length-1;for(let h=0;h<e.text.length;++h)this.sectionIndex.push(a)}addImageSection(e){const s=e.image?e.image.name:"";if(s.length===0)return void Ar("Can't add FormattedSection with an empty image.");const a=this.getNextImageSectionCharCode();a?(this.text+=String.fromCharCode(a),this.sections.push(Ku.forImage(s)),this.sectionIndex.push(this.sections.length-1)):Ar("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function Gh(n,e,s,a,h,m,y,v,S,k,C,M,L,O,N,j){const H=gl.fromFeature(n,h);let Q;M===u.ai.vertical&&H.verticalizePunctuation();const{processBidirectionalText:ue,processStyledBidirectionalText:ie}=Mn;if(ue&&H.sections.length===1){Q=[];const Ee=ue(H.toString(),Sf(H,k,m,e,a,O,N));for(const qe of Ee){const Ye=new gl;Ye.text=qe,Ye.sections=H.sections;for(let Ue=0;Ue<qe.length;Ue++)Ye.sectionIndex.push(0);Q.push(Ye)}}else if(ie){Q=[];const Ee=ie(H.text,H.sectionIndex,Sf(H,k,m,e,a,O,N));for(const qe of Ee){const Ye=new gl;Ye.text=qe[0],Ye.sectionIndex=qe[1],Ye.sections=H.sections,Q.push(Ye)}}else Q=function(Ee,qe){const Ye=[],Ue=Ee.text;let Ve=0;for(const De of qe)Ye.push(Ee.substring(Ve,De)),Ve=De;return Ve<Ue.length&&Ye.push(Ee.substring(Ve,Ue.length)),Ye}(H,Sf(H,k,m,e,a,O,N));const de=[],fe={positionedLines:de,text:H.toString(),top:C[1],bottom:C[1],left:C[0],right:C[0],writingMode:M,iconsInText:!1,verticalizable:!1};return function(Ee,qe,Ye,Ue,Ve,De,We,Be,Me,it,Je,gt){let Gt=0,Ht=Xu,kr=0,Kn=0;const _n=Be==="right"?1:Be==="left"?0:.5;let xr=0;for(const Er of Ve){Er.trim();const Ir=Er.getMaxScale(),rn=(Ir-1)*Tr,wn={positionedGlyphs:[],lineOffset:0};Ee.positionedLines[xr]=wn;const nn=wn.positionedGlyphs;let Ln=0;if(!Er.length()){Ht+=De,++xr;continue}for(let Cr=0;Cr<Er.length();Cr++){const xt=Er.getSection(Cr),sn=Er.getSectionIndex(Cr),Xr=Er.getCharCode(Cr);let Pr=0,Ii=null,Zi=null,Gi=null,Vs=Tr;const Ci=!(Me===u.ai.horizontal||!Je&&!bu(Xr)||Je&&(Wh[Xr]||(Nr=Xr,$e.Arabic(Nr)||$e["Arabic Supplement"](Nr)||$e["Arabic Extended-A"](Nr)||$e["Arabic Presentation Forms-A"](Nr)||$e["Arabic Presentation Forms-B"](Nr))));if(xt.imageName){const ai=Ue[xt.imageName];if(!ai)continue;Gi=xt.imageName,Ee.iconsInText=Ee.iconsInText||!0,Zi=ai.paddedRect;const Fn=ai.displaySize;xt.scale=xt.scale*Tr/gt,Ii={width:Fn[0],height:Fn[1],left:Dn,top:-T_,advance:Ci?Fn[1]:Fn[0]},Pr=rn+(Tr-Fn[1]*xt.scale),Vs=Ii.advance;const Us=Ci?Fn[0]*xt.scale-Tr*Ir:Fn[1]*xt.scale-Tr*Ir;Us>0&&Us>Ln&&(Ln=Us)}else{const ai=Ye[xt.fontStack],Fn=ai&&ai[Xr];if(Fn&&Fn.rect)Zi=Fn.rect,Ii=Fn.metrics;else{const Us=qe[xt.fontStack],tc=Us&&Us[Xr];if(!tc)continue;Ii=tc.metrics}Pr=(Ir-xt.scale)*Tr}Ci?(Ee.verticalizable=!0,nn.push({glyph:Xr,imageName:Gi,x:Gt,y:Ht+Pr,vertical:Ci,scale:xt.scale,fontStack:xt.fontStack,sectionIndex:sn,metrics:Ii,rect:Zi}),Gt+=Vs*xt.scale+it):(nn.push({glyph:Xr,imageName:Gi,x:Gt,y:Ht+Pr,vertical:Ci,scale:xt.scale,fontStack:xt.fontStack,sectionIndex:sn,metrics:Ii,rect:Zi}),Gt+=Ii.advance*xt.scale+it)}nn.length!==0&&(kr=Math.max(Gt-it,kr),c2(nn,0,nn.length-1,_n,Ln)),Gt=0;const Rn=De*Ir+Ln;wn.lineOffset=Math.max(Ln,rn),Ht+=Rn,Kn=Math.max(Rn,Kn),++xr}var Nr;const Hr=Ht-Xu,{horizontalAlign:vn,verticalAlign:xn}=Tf(We);(function(Er,Ir,rn,wn,nn,Ln,Rn,Cr,xt){const sn=(Ir-rn)*nn;let Xr=0;Xr=Ln!==Rn?-Cr*wn-Xu:(-wn*xt+.5)*Rn;for(const Pr of Er)for(const Ii of Pr.positionedGlyphs)Ii.x+=sn,Ii.y+=Xr})(Ee.positionedLines,_n,vn,xn,kr,Kn,De,Hr,Ve.length),Ee.top+=-xn*Hr,Ee.bottom=Ee.top+Hr,Ee.left+=-vn*kr,Ee.right=Ee.left+kr}(fe,e,s,a,Q,y,v,S,M,k,L,j),!function(Ee){for(const qe of Ee)if(qe.positionedGlyphs.length!==0)return!1;return!0}(de)&&fe}const Wh={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},l2={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function I_(n,e,s,a,h,m){if(e.imageName){const y=a[e.imageName];return y?y.displaySize[0]*e.scale*Tr/m+h:0}{const y=s[e.fontStack],v=y&&y[n];return v?v.metrics.advance*e.scale+h:0}}function C_(n,e,s,a){const h=Math.pow(n-e,2);return a?n<e?h/2:2*h:h+Math.abs(s)*s}function u2(n,e,s){let a=0;return n===10&&(a-=1e4),s&&(a+=150),n!==40&&n!==65288||(a+=50),e!==41&&e!==65289||(a+=50),a}function P_(n,e,s,a,h,m){let y=null,v=C_(e,s,h,m);for(const S of a){const k=C_(e-S.x,s,h,m)+S.badness;k<=v&&(y=S,v=k)}return{index:n,x:e,priorBreak:y,badness:v}}function z_(n){return n?z_(n.priorBreak).concat(n.index):[]}function Sf(n,e,s,a,h,m,y){if(m!=="point")return[];if(!n)return[];const v=[],S=function(L,O,N,j,H,Q){let ue=0;for(let ie=0;ie<L.length();ie++){const de=L.getSection(ie);ue+=I_(L.getCharCode(ie),de,j,H,O,Q)}return ue/Math.max(1,Math.ceil(ue/N))}(n,e,s,a,h,y),k=n.text.indexOf("")>=0;let C=0;for(let L=0;L<n.length();L++){const O=n.getSection(L),N=n.getCharCode(L);if(Wh[N]||(C+=I_(N,O,a,h,e,y)),L<n.length()-1){const j=!((M=N)<11904||!($e["Bopomofo Extended"](M)||$e.Bopomofo(M)||$e["CJK Compatibility Forms"](M)||$e["CJK Compatibility Ideographs"](M)||$e["CJK Compatibility"](M)||$e["CJK Radicals Supplement"](M)||$e["CJK Strokes"](M)||$e["CJK Symbols and Punctuation"](M)||$e["CJK Unified Ideographs Extension A"](M)||$e["CJK Unified Ideographs"](M)||$e["Enclosed CJK Letters and Months"](M)||$e["Halfwidth and Fullwidth Forms"](M)||$e.Hiragana(M)||$e["Ideographic Description Characters"](M)||$e["Kangxi Radicals"](M)||$e["Katakana Phonetic Extensions"](M)||$e.Katakana(M)||$e["Vertical Forms"](M)||$e["Yi Radicals"](M)||$e["Yi Syllables"](M)));(l2[N]||j||O.imageName)&&v.push(P_(L+1,C,S,v,u2(N,n.getCharCode(L+1),j&&k),!1))}}var M;return z_(P_(n.length(),C,S,v,0,!0))}function Tf(n){let e=.5,s=.5;switch(n){case"right":case"top-right":case"bottom-right":e=1;break;case"left":case"top-left":case"bottom-left":e=0}switch(n){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:e,verticalAlign:s}}function c2(n,e,s,a,h){if(!a&&!h)return;const m=n[s],y=(n[s].x+m.metrics.advance*m.scale)*a;for(let v=e;v<=s;v++)n[v].x-=y,n[v].y+=h}function h2(n,e,s){const{horizontalAlign:a,verticalAlign:h}=Tf(s),m=e[0]-n.displaySize[0]*a,y=e[1]-n.displaySize[1]*h;return{image:n,top:y,bottom:y+n.displaySize[1],left:m,right:m+n.displaySize[0]}}function M_(n,e,s,a,h,m){const y=n.image;let v;if(y.content){const H=y.content,Q=y.pixelRatio||1;v=[H[0]/Q,H[1]/Q,y.displaySize[0]-H[2]/Q,y.displaySize[1]-H[3]/Q]}const S=e.left*m,k=e.right*m;let C,M,L,O;s==="width"||s==="both"?(O=h[0]+S-a[3],M=h[0]+k+a[1]):(O=h[0]+(S+k-y.displaySize[0])/2,M=O+y.displaySize[0]);const N=e.top*m,j=e.bottom*m;return s==="height"||s==="both"?(C=h[1]+N-a[0],L=h[1]+j+a[2]):(C=h[1]+(N+j-y.displaySize[1])/2,L=C+y.displaySize[1]),{image:y,top:C,right:M,bottom:L,left:O,collisionPadding:v}}const Yu=255,gs=128,wo=Yu*gs;function A_(n,e){const{expression:s}=e;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new qt(n+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:a,interpolationType:h}=s;let m=0;for(;m<a.length&&a[m]<=n;)m++;m=Math.max(0,m-1);let y=m;for(;y<a.length&&a[y]<n+1;)y++;y=Math.min(a.length-1,y);const v=a[m],S=a[y];return s.kind==="composite"?{kind:"composite",minZoom:v,maxZoom:S,interpolationType:h}:{kind:"camera",minZoom:v,maxZoom:S,minSize:s.evaluate(new qt(v)),maxSize:s.evaluate(new qt(S)),interpolationType:h}}}function kf(n,e,s){let a="never";const h=n.get(e);return h?a=h:n.get(s)&&(a="always"),a}const d2=vo.VectorTileFeature.types,p2=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Hh(n,e,s,a,h,m,y,v,S,k,C,M,L){const O=v?Math.min(wo,Math.round(v[0])):0,N=v?Math.min(wo,Math.round(v[1])):0;n.emplaceBack(e,s,Math.round(32*a),Math.round(32*h),m,y,(O<<1)+(S?1:0),N,16*k,16*C,256*M,256*L)}function Ef(n,e,s){n.emplaceBack(e.x,e.y,s),n.emplaceBack(e.x,e.y,s),n.emplaceBack(e.x,e.y,s),n.emplaceBack(e.x,e.y,s)}function f2(n){for(const e of n.sections)if(Yp(e.text))return!0;return!1}class If{constructor(e){this.layoutVertexArray=new yt,this.indexArray=new Br,this.programConfigurations=e,this.segments=new Zt,this.dynamicLayoutVertexArray=new pt,this.opacityVertexArray=new vt,this.hasVisibleVertices=!1,this.placedSymbolArray=new oe}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(e,s,a,h){this.isEmpty()||(a&&(this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,Zb.members),this.indexBuffer=e.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=e.createVertexBuffer(this.dynamicLayoutVertexArray,Gb.members,!0),this.opacityVertexBuffer=e.createVertexBuffer(this.opacityVertexArray,p2,!0),this.opacityVertexBuffer.itemSize=1),(a||h)&&this.programConfigurations.upload(e))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy())}}Ge("SymbolBuffers",If);class Cf{constructor(e,s,a){this.layoutVertexArray=new e,this.layoutAttributes=s,this.indexArray=new a,this.segments=new Zt,this.collisionVertexArray=new jt}upload(e){this.layoutVertexBuffer=e.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=e.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=e.createVertexBuffer(this.collisionVertexArray,Wb.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy())}}Ge("CollisionBuffers",Cf);class yl{constructor(e){this.collisionBoxArray=e.collisionBoxArray,this.zoom=e.zoom,this.overscaling=e.overscaling,this.layers=e.layers,this.layerIds=this.layers.map(y=>y.id),this.index=e.index,this.pixelRatio=e.pixelRatio,this.sourceLayerIndex=e.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=sf([]),this.placementViewportMatrix=sf([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=A_(this.zoom,s["text-size"]),this.iconSizeData=A_(this.zoom,s["icon-size"]);const a=this.layers[0].layout,h=a.get("symbol-sort-key"),m=a.get("symbol-z-order");this.canOverlap=kf(a,"text-overlap","text-allow-overlap")!=="never"||kf(a,"icon-overlap","icon-allow-overlap")!=="never"||a.get("text-ignore-placement")||a.get("icon-ignore-placement"),this.sortFeaturesByKey=m!=="viewport-y"&&!h.isConstant(),this.sortFeaturesByY=(m==="viewport-y"||m==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,a.get("symbol-placement")==="point"&&(this.writingModes=a.get("text-writing-mode").map(y=>u.ai[y])),this.stateDependentLayerIds=this.layers.filter(y=>y.isStateDependent()).map(y=>y.id),this.sourceID=e.sourceID}createArrays(){this.text=new If(new qi(this.layers,this.zoom,e=>/^text/.test(e))),this.icon=new If(new qi(this.layers,this.zoom,e=>/^icon/.test(e))),this.glyphOffsetArray=new ae,this.lineVertexArray=new me,this.symbolInstances=new Y,this.textAnchorOffsets=new Te}calculateGlyphDependencies(e,s,a,h,m){for(let y=0;y<e.length;y++)if(s[e.charCodeAt(y)]=!0,(a||h)&&m){const v=Hu[e.charAt(y)];v&&(s[v.charCodeAt(0)]=!0)}}populate(e,s,a){const h=this.layers[0],m=h.layout,y=m.get("text-font"),v=m.get("text-field"),S=m.get("icon-image"),k=(v.value.kind!=="constant"||v.value.value instanceof Zr&&!v.value.value.isEmpty()||v.value.value.toString().length>0)&&(y.value.kind!=="constant"||y.value.value.length>0),C=S.value.kind!=="constant"||!!S.value.value||Object.keys(S.parameters).length>0,M=m.get("symbol-sort-key");if(this.features=[],!k&&!C)return;const L=s.iconDependencies,O=s.glyphDependencies,N=s.availableImages,j=new qt(this.zoom);for(const{feature:H,id:Q,index:ue,sourceLayerIndex:ie}of e){const de=h._featureFilter.needGeometry,fe=pa(H,de);if(!h._featureFilter.filter(j,fe,a))continue;let Ee,qe;if(de||(fe.geometry=da(H)),k){const Ue=h.getValueAndResolveTokens("text-field",fe,a,N),Ve=Zr.factory(Ue);f2(Ve)&&(this.hasRTLText=!0),(!this.hasRTLText||Cu()==="unavailable"||this.hasRTLText&&Mn.isParsed())&&(Ee=Xb(Ve,h,fe))}if(C){const Ue=h.getValueAndResolveTokens("icon-image",fe,a,N);qe=Ue instanceof Fr?Ue:Fr.fromString(Ue)}if(!Ee&&!qe)continue;const Ye=this.sortFeaturesByKey?M.evaluate(fe,{},a):void 0;if(this.features.push({id:Q,text:Ee,icon:qe,index:ue,sourceLayerIndex:ie,geometry:fe.geometry,properties:H.properties,type:d2[H.type],sortKey:Ye}),qe&&(L[qe.name]=!0),Ee){const Ue=y.evaluate(fe,{},a).join(","),Ve=m.get("text-rotation-alignment")!=="viewport"&&m.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(u.ai.vertical)>=0;for(const De of Ee.sections)if(De.image)L[De.image.name]=!0;else{const We=xu(Ee.toString()),Be=De.fontStack||Ue,Me=O[Be]=O[Be]||{};this.calculateGlyphDependencies(De.text,Me,Ve,this.allowVerticalPlacement,We)}}}m.get("symbol-placement")==="line"&&(this.features=function(H){const Q={},ue={},ie=[];let de=0;function fe(Ue){ie.push(H[Ue]),de++}function Ee(Ue,Ve,De){const We=ue[Ue];return delete ue[Ue],ue[Ve]=We,ie[We].geometry[0].pop(),ie[We].geometry[0]=ie[We].geometry[0].concat(De[0]),We}function qe(Ue,Ve,De){const We=Q[Ve];return delete Q[Ve],Q[Ue]=We,ie[We].geometry[0].shift(),ie[We].geometry[0]=De[0].concat(ie[We].geometry[0]),We}function Ye(Ue,Ve,De){const We=De?Ve[0][Ve[0].length-1]:Ve[0][0];return`${Ue}:${We.x}:${We.y}`}for(let Ue=0;Ue<H.length;Ue++){const Ve=H[Ue],De=Ve.geometry,We=Ve.text?Ve.text.toString():null;if(!We){fe(Ue);continue}const Be=Ye(We,De),Me=Ye(We,De,!0);if(Be in ue&&Me in Q&&ue[Be]!==Q[Me]){const it=qe(Be,Me,De),Je=Ee(Be,Me,ie[it].geometry);delete Q[Be],delete ue[Me],ue[Ye(We,ie[Je].geometry,!0)]=Je,ie[it].geometry=null}else Be in ue?Ee(Be,Me,De):Me in Q?qe(Be,Me,De):(fe(Ue),Q[Be]=de-1,ue[Me]=de-1)}return ie.filter(Ue=>Ue.geometry)}(this.features)),this.sortFeaturesByKey&&this.features.sort((H,Q)=>H.sortKey-Q.sortKey)}update(e,s,a){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(e,s,this.layers,a),this.icon.programConfigurations.updatePaintArrays(e,s,this.layers,a))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(e){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(e),this.iconCollisionBox.upload(e)),this.text.upload(e,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(e,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(e,s){const a=this.lineVertexArray.length;if(e.segment!==void 0){let h=e.dist(s[e.segment+1]),m=e.dist(s[e.segment]);const y={};for(let v=e.segment+1;v<s.length;v++)y[v]={x:s[v].x,y:s[v].y,tileUnitDistanceFromAnchor:h},v<s.length-1&&(h+=s[v+1].dist(s[v]));for(let v=e.segment||0;v>=0;v--)y[v]={x:s[v].x,y:s[v].y,tileUnitDistanceFromAnchor:m},v>0&&(m+=s[v-1].dist(s[v]));for(let v=0;v<s.length;v++){const S=y[v];this.lineVertexArray.emplaceBack(S.x,S.y,S.tileUnitDistanceFromAnchor)}}return{lineStartIndex:a,lineLength:this.lineVertexArray.length-a}}addSymbols(e,s,a,h,m,y,v,S,k,C,M,L){const O=e.indexArray,N=e.layoutVertexArray,j=e.segments.prepareSegment(4*s.length,N,O,this.canOverlap?y.sortKey:void 0),H=this.glyphOffsetArray.length,Q=j.vertexLength,ue=this.allowVerticalPlacement&&v===u.ai.vertical?Math.PI/2:0,ie=y.text&&y.text.sections;for(let de=0;de<s.length;de++){const{tl:fe,tr:Ee,bl:qe,br:Ye,tex:Ue,pixelOffsetTL:Ve,pixelOffsetBR:De,minFontScaleX:We,minFontScaleY:Be,glyphOffset:Me,isSDF:it,sectionIndex:Je}=s[de],gt=j.vertexLength,Gt=Me[1];Hh(N,S.x,S.y,fe.x,Gt+fe.y,Ue.x,Ue.y,a,it,Ve.x,Ve.y,We,Be),Hh(N,S.x,S.y,Ee.x,Gt+Ee.y,Ue.x+Ue.w,Ue.y,a,it,De.x,Ve.y,We,Be),Hh(N,S.x,S.y,qe.x,Gt+qe.y,Ue.x,Ue.y+Ue.h,a,it,Ve.x,De.y,We,Be),Hh(N,S.x,S.y,Ye.x,Gt+Ye.y,Ue.x+Ue.w,Ue.y+Ue.h,a,it,De.x,De.y,We,Be),Ef(e.dynamicLayoutVertexArray,S,ue),O.emplaceBack(gt,gt+1,gt+2),O.emplaceBack(gt+1,gt+2,gt+3),j.vertexLength+=4,j.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Me[0]),de!==s.length-1&&Je===s[de+1].sectionIndex||e.programConfigurations.populatePaintArrays(N.length,y,y.index,{},L,ie&&ie[Je])}e.placedSymbolArray.emplaceBack(S.x,S.y,H,this.glyphOffsetArray.length-H,Q,k,C,S.segment,a?a[0]:0,a?a[1]:0,h[0],h[1],v,0,!1,0,M)}_addCollisionDebugVertex(e,s,a,h,m,y){return s.emplaceBack(0,0),e.emplaceBack(a.x,a.y,h,m,Math.round(y.x),Math.round(y.y))}addCollisionDebugVertices(e,s,a,h,m,y,v){const S=m.segments.prepareSegment(4,m.layoutVertexArray,m.indexArray),k=S.vertexLength,C=m.layoutVertexArray,M=m.collisionVertexArray,L=v.anchorX,O=v.anchorY;this._addCollisionDebugVertex(C,M,y,L,O,new te(e,s)),this._addCollisionDebugVertex(C,M,y,L,O,new te(a,s)),this._addCollisionDebugVertex(C,M,y,L,O,new te(a,h)),this._addCollisionDebugVertex(C,M,y,L,O,new te(e,h)),S.vertexLength+=4;const N=m.indexArray;N.emplaceBack(k,k+1),N.emplaceBack(k+1,k+2),N.emplaceBack(k+2,k+3),N.emplaceBack(k+3,k),S.primitiveLength+=4}addDebugCollisionBoxes(e,s,a,h){for(let m=e;m<s;m++){const y=this.collisionBoxArray.get(m);this.addCollisionDebugVertices(y.x1,y.y1,y.x2,y.y2,h?this.textCollisionBox:this.iconCollisionBox,y.anchorPoint,a)}}generateCollisionDebugBuffers(){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Cf(ar,g_.members,br),this.iconCollisionBox=new Cf(ar,g_.members,br);for(let e=0;e<this.symbolInstances.length;e++){const s=this.symbolInstances.get(e);this.addDebugCollisionBoxes(s.textBoxStartIndex,s.textBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.verticalTextBoxStartIndex,s.verticalTextBoxEndIndex,s,!0),this.addDebugCollisionBoxes(s.iconBoxStartIndex,s.iconBoxEndIndex,s,!1),this.addDebugCollisionBoxes(s.verticalIconBoxStartIndex,s.verticalIconBoxEndIndex,s,!1)}}_deserializeCollisionBoxesForSymbol(e,s,a,h,m,y,v,S,k){const C={};for(let M=s;M<a;M++){const L=e.get(M);C.textBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},C.textFeatureIndex=L.featureIndex;break}for(let M=h;M<m;M++){const L=e.get(M);C.verticalTextBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},C.verticalTextFeatureIndex=L.featureIndex;break}for(let M=y;M<v;M++){const L=e.get(M);C.iconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},C.iconFeatureIndex=L.featureIndex;break}for(let M=S;M<k;M++){const L=e.get(M);C.verticalIconBox={x1:L.x1,y1:L.y1,x2:L.x2,y2:L.y2,anchorPointX:L.anchorPointX,anchorPointY:L.anchorPointY},C.verticalIconFeatureIndex=L.featureIndex;break}return C}deserializeCollisionBoxes(e){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const a=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(e,a.textBoxStartIndex,a.textBoxEndIndex,a.verticalTextBoxStartIndex,a.verticalTextBoxEndIndex,a.iconBoxStartIndex,a.iconBoxEndIndex,a.verticalIconBoxStartIndex,a.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(e,s){const a=e.placedSymbolArray.get(s),h=a.vertexStartIndex+4*a.numGlyphs;for(let m=a.vertexStartIndex;m<h;m+=4)e.indexArray.emplaceBack(m,m+1,m+2),e.indexArray.emplaceBack(m+1,m+2,m+3)}getSortedSymbolIndexes(e){if(this.sortedAngle===e&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(e),a=Math.cos(e),h=[],m=[],y=[];for(let v=0;v<this.symbolInstances.length;++v){y.push(v);const S=this.symbolInstances.get(v);h.push(0|Math.round(s*S.anchorX+a*S.anchorY)),m.push(S.featureIndex)}return y.sort((v,S)=>h[v]-h[S]||m[S]-m[v]),y}addToSortKeyRanges(e,s){const a=this.sortKeyRanges[this.sortKeyRanges.length-1];a&&a.sortKey===s?a.symbolInstanceEnd=e+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:e,symbolInstanceEnd:e+1})}sortFeatures(e){if(this.sortFeaturesByY&&this.sortedAngle!==e&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(e),this.sortedAngle=e,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const a=this.symbolInstances.get(s);this.featureSortOrder.push(a.featureIndex),[a.rightJustifiedTextSymbolIndex,a.centerJustifiedTextSymbolIndex,a.leftJustifiedTextSymbolIndex].forEach((h,m,y)=>{h>=0&&y.indexOf(h)===m&&this.addIndicesForPlacedSymbol(this.text,h)}),a.verticalPlacedTextSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.text,a.verticalPlacedTextSymbolIndex),a.placedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.placedIconSymbolIndex),a.verticalPlacedIconSymbolIndex>=0&&this.addIndicesForPlacedSymbol(this.icon,a.verticalPlacedIconSymbolIndex)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let D_,L_;Ge("SymbolBucket",yl,{omit:["layers","collisionBoxArray","features","compareText"]}),yl.MAX_GLYPHS=65535,yl.addDynamicAttributes=Ef;var Pf={get paint(){return L_=L_||new dr({"icon-opacity":new ot(ve.paint_symbol["icon-opacity"]),"icon-color":new ot(ve.paint_symbol["icon-color"]),"icon-halo-color":new ot(ve.paint_symbol["icon-halo-color"]),"icon-halo-width":new ot(ve.paint_symbol["icon-halo-width"]),"icon-halo-blur":new ot(ve.paint_symbol["icon-halo-blur"]),"icon-translate":new et(ve.paint_symbol["icon-translate"]),"icon-translate-anchor":new et(ve.paint_symbol["icon-translate-anchor"]),"text-opacity":new ot(ve.paint_symbol["text-opacity"]),"text-color":new ot(ve.paint_symbol["text-color"],{runtimeType:Jr,getOverride:n=>n.textColor,hasOverride:n=>!!n.textColor}),"text-halo-color":new ot(ve.paint_symbol["text-halo-color"]),"text-halo-width":new ot(ve.paint_symbol["text-halo-width"]),"text-halo-blur":new ot(ve.paint_symbol["text-halo-blur"]),"text-translate":new et(ve.paint_symbol["text-translate"]),"text-translate-anchor":new et(ve.paint_symbol["text-translate-anchor"])})},get layout(){return D_=D_||new dr({"symbol-placement":new et(ve.layout_symbol["symbol-placement"]),"symbol-spacing":new et(ve.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new et(ve.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new ot(ve.layout_symbol["symbol-sort-key"]),"symbol-z-order":new et(ve.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new et(ve.layout_symbol["icon-allow-overlap"]),"icon-overlap":new et(ve.layout_symbol["icon-overlap"]),"icon-ignore-placement":new et(ve.layout_symbol["icon-ignore-placement"]),"icon-optional":new et(ve.layout_symbol["icon-optional"]),"icon-rotation-alignment":new et(ve.layout_symbol["icon-rotation-alignment"]),"icon-size":new ot(ve.layout_symbol["icon-size"]),"icon-text-fit":new et(ve.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new et(ve.layout_symbol["icon-text-fit-padding"]),"icon-image":new ot(ve.layout_symbol["icon-image"]),"icon-rotate":new ot(ve.layout_symbol["icon-rotate"]),"icon-padding":new ot(ve.layout_symbol["icon-padding"]),"icon-keep-upright":new et(ve.layout_symbol["icon-keep-upright"]),"icon-offset":new ot(ve.layout_symbol["icon-offset"]),"icon-anchor":new ot(ve.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new et(ve.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new et(ve.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new et(ve.layout_symbol["text-rotation-alignment"]),"text-field":new ot(ve.layout_symbol["text-field"]),"text-font":new ot(ve.layout_symbol["text-font"]),"text-size":new ot(ve.layout_symbol["text-size"]),"text-max-width":new ot(ve.layout_symbol["text-max-width"]),"text-line-height":new et(ve.layout_symbol["text-line-height"]),"text-letter-spacing":new ot(ve.layout_symbol["text-letter-spacing"]),"text-justify":new ot(ve.layout_symbol["text-justify"]),"text-radial-offset":new ot(ve.layout_symbol["text-radial-offset"]),"text-variable-anchor":new et(ve.layout_symbol["text-variable-anchor"]),"text-variable-anchor-offset":new ot(ve.layout_symbol["text-variable-anchor-offset"]),"text-anchor":new ot(ve.layout_symbol["text-anchor"]),"text-max-angle":new et(ve.layout_symbol["text-max-angle"]),"text-writing-mode":new et(ve.layout_symbol["text-writing-mode"]),"text-rotate":new ot(ve.layout_symbol["text-rotate"]),"text-padding":new et(ve.layout_symbol["text-padding"]),"text-keep-upright":new et(ve.layout_symbol["text-keep-upright"]),"text-transform":new ot(ve.layout_symbol["text-transform"]),"text-offset":new ot(ve.layout_symbol["text-offset"]),"text-allow-overlap":new et(ve.layout_symbol["text-allow-overlap"]),"text-overlap":new et(ve.layout_symbol["text-overlap"]),"text-ignore-placement":new et(ve.layout_symbol["text-ignore-placement"]),"text-optional":new et(ve.layout_symbol["text-optional"])})}};class R_{constructor(e){if(e.property.overrides===void 0)throw new Error("overrides must be provided to instantiate FormatSectionOverride class");this.type=e.property.overrides?e.property.overrides.runtimeType:Bi,this.defaultValue=e}evaluate(e){if(e.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(e.formattedSection))return s.getOverride(e.formattedSection)}return e.feature&&e.featureState?this.defaultValue.evaluate(e.feature,e.featureState):this.defaultValue.property.specification.default}eachChild(e){this.defaultValue.isConstant()||e(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ge("FormatSectionOverride",R_,{omit:["defaultValue"]});class Xh extends Hn{constructor(e){super(e,Pf)}recalculate(e,s){if(super.recalculate(e,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")==="map"?"map":"viewport"),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment")),this.layout.get("symbol-placement")==="point"){const a=this.layout.get("text-writing-mode");if(a){const h=[];for(const m of a)h.indexOf(m)<0&&h.push(m);this.layout._values["text-writing-mode"]=h}else this.layout._values["text-writing-mode"]=["horizontal"]}this._setPaintOverrides()}getValueAndResolveTokens(e,s,a,h){const m=this.layout.get(e).evaluate(s,{},a,h),y=this._unevaluatedLayout._values[e];return y.isDataDriven()||Ya(y.value)||!m?m:function(v,S){return S.replace(/{([^{}]+)}/g,(k,C)=>v&&C in v?String(v[C]):"")}(s.properties,m)}createBucket(e){return new yl(e)}queryRadius(){return 0}queryIntersectsFeature(){throw new Error("Should take a different path in FeatureIndex")}_setPaintOverrides(){for(const e of Pf.paint.overridableProperties){if(!Xh.hasPaintOverride(this.layout,e))continue;const s=this.paint.get(e),a=new R_(s),h=new fu(a,s.property.specification);let m=null;m=s.value.kind==="constant"||s.value.kind==="source"?new mu("source",h):new Ja("composite",h,s.value.zoomStops),this.paint._values[e]=new en(s.property,m,s.parameters)}}_handleOverridablePaintPropertyUpdate(e,s,a){return!(!this.layout||s.isDataDriven()||a.isDataDriven())&&Xh.hasPaintOverride(this.layout,e)}static hasPaintOverride(e,s){const a=e.get("text-field"),h=Pf.paint.properties[s];let m=!1;const y=v=>{for(const S of v)if(h.overrides&&h.overrides.hasOverride(S))return void(m=!0)};if(a.value.kind==="constant"&&a.value.value instanceof Zr)y(a.value.value.sections);else if(a.value.kind==="source"){const v=k=>{m||(k instanceof Is&&Xt(k.value)===Z?y(k.value.sections):k instanceof Ka?y(k.sections):k.eachChild(v))},S=a.value;S._styleExpression&&v(S._styleExpression.expression)}return m}}let F_;var m2={get paint(){return F_=F_||new dr({"background-color":new et(ve.paint_background["background-color"]),"background-pattern":new zu(ve.paint_background["background-pattern"]),"background-opacity":new et(ve.paint_background["background-opacity"])})}};class g2 extends Hn{constructor(e){super(e,m2)}}let B_;var y2={get paint(){return B_=B_||new dr({"raster-opacity":new et(ve.paint_raster["raster-opacity"]),"raster-hue-rotate":new et(ve.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new et(ve.paint_raster["raster-brightness-min"]),"raster-brightness-max":new et(ve.paint_raster["raster-brightness-max"]),"raster-saturation":new et(ve.paint_raster["raster-saturation"]),"raster-contrast":new et(ve.paint_raster["raster-contrast"]),"raster-resampling":new et(ve.paint_raster["raster-resampling"]),"raster-fade-duration":new et(ve.paint_raster["raster-fade-duration"])})}};class _2 extends Hn{constructor(e){super(e,y2)}}class v2 extends Hn{constructor(e){super(e,{}),this.onAdd=s=>{this.implementation.onAdd&&this.implementation.onAdd(s,s.painter.context.gl)},this.onRemove=s=>{this.implementation.onRemove&&this.implementation.onRemove(s,s.painter.context.gl)},this.implementation=e}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){throw new Error("Custom layers cannot be serialized")}}class x2{constructor(e){this._callback=e,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){delete this._channel,this._callback=()=>{}}}const zf=63710088e-1;class bo{constructor(e,s){if(isNaN(e)||isNaN(s))throw new Error(`Invalid LngLat object: (${e}, ${s})`);if(this.lng=+e,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new bo(je(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(e){const s=Math.PI/180,a=this.lat*s,h=e.lat*s,m=Math.sin(a)*Math.sin(h)+Math.cos(a)*Math.cos(h)*Math.cos((e.lng-this.lng)*s);return zf*Math.acos(Math.min(m,1))}static convert(e){if(e instanceof bo)return e;if(Array.isArray(e)&&(e.length===2||e.length===3))return new bo(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null)return new bo(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}const O_=2*Math.PI*zf;function N_(n){return O_*Math.cos(n*Math.PI/180)}function V_(n){return(180+n)/360}function U_(n){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+n*Math.PI/360)))/360}function j_(n,e){return n/N_(e)}function $_(n){return 360*n-180}function Mf(n){return 360/Math.PI*Math.atan(Math.exp((180-360*n)*Math.PI/180))-90}class Kh{constructor(e,s,a=0){this.x=+e,this.y=+s,this.z=+a}static fromLngLat(e,s=0){const a=bo.convert(e);return new Kh(V_(a.lng),U_(a.lat),j_(s,a.lat))}toLngLat(){return new bo($_(this.x),Mf(this.y))}toAltitude(){return this.z*N_(Mf(this.y))}meterInMercatorCoordinateUnits(){return 1/O_*(e=Mf(this.y),1/Math.cos(e*Math.PI/180));var e}}function q_(n,e,s){var a=2*Math.PI*6378137/256/Math.pow(2,s);return[n*a-2*Math.PI*6378137/2,e*a-2*Math.PI*6378137/2]}class Af{constructor(e,s,a){if(e<0||e>25||a<0||a>=Math.pow(2,e)||s<0||s>=Math.pow(2,e))throw new Error(`x=${s}, y=${a}, z=${e} outside of bounds. 0<=x<${Math.pow(2,e)}, 0<=y<${Math.pow(2,e)} 0<=z<=25 `);this.z=e,this.x=s,this.y=a,this.key=Qu(0,e,e,s,a)}equals(e){return this.z===e.z&&this.x===e.x&&this.y===e.y}url(e,s,a){const h=(y=this.y,v=this.z,S=q_(256*(m=this.x),256*(y=Math.pow(2,v)-y-1),v),k=q_(256*(m+1),256*(y+1),v),S[0]+","+S[1]+","+k[0]+","+k[1]);var m,y,v,S,k;const C=function(M,L,O){let N,j="";for(let H=M;H>0;H--)N=1<<H-1,j+=(L&N?1:0)+(O&N?2:0);return j}(this.z,this.x,this.y);return e[(this.x+this.y)%e.length].replace(/{prefix}/g,(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(a==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace(/{ratio}/g,s>1?"@2x":"").replace(/{quadkey}/g,C).replace(/{bbox-epsg-3857}/g,h)}isChildOf(e){const s=this.z-e.z;return s>0&&e.x===this.x>>s&&e.y===this.y>>s}getTilePoint(e){const s=Math.pow(2,this.z);return new te((e.x*s-this.x)*vr,(e.y*s-this.y)*vr)}toString(){return`${this.z}/${this.x}/${this.y}`}}class Z_{constructor(e,s){this.wrap=e,this.canonical=s,this.key=Qu(e,s.z,s.z,s.x,s.y)}}class oi{constructor(e,s,a,h,m){if(e<a)throw new Error(`overscaledZ should be >= z; overscaledZ = ${e}; z = ${a}`);this.overscaledZ=e,this.wrap=s,this.canonical=new Af(a,+h,+m),this.key=Qu(s,e,a,h,m)}clone(){return new oi(this.overscaledZ,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)}equals(e){return this.overscaledZ===e.overscaledZ&&this.wrap===e.wrap&&this.canonical.equals(e.canonical)}scaledTo(e){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const s=this.canonical.z-e;return e>this.canonical.z?new oi(e,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new oi(e,this.wrap,e,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(e,s){if(e>this.overscaledZ)throw new Error(`targetZ > this.overscaledZ; targetZ = ${e}; overscaledZ = ${this.overscaledZ}`);const a=this.canonical.z-e;return e>this.canonical.z?Qu(this.wrap*+s,e,this.canonical.z,this.canonical.x,this.canonical.y):Qu(this.wrap*+s,e,e,this.canonical.x>>a,this.canonical.y>>a)}isChildOf(e){if(e.wrap!==this.wrap)return!1;const s=this.canonical.z-e.canonical.z;return e.overscaledZ===0||e.overscaledZ<this.overscaledZ&&e.canonical.x===this.canonical.x>>s&&e.canonical.y===this.canonical.y>>s}children(e){if(this.overscaledZ>=e)return[new oi(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,a=2*this.canonical.x,h=2*this.canonical.y;return[new oi(s,this.wrap,s,a,h),new oi(s,this.wrap,s,a+1,h),new oi(s,this.wrap,s,a,h+1),new oi(s,this.wrap,s,a+1,h+1)]}isLessThan(e){return this.wrap<e.wrap||!(this.wrap>e.wrap)&&(this.overscaledZ<e.overscaledZ||!(this.overscaledZ>e.overscaledZ)&&(this.canonical.x<e.canonical.x||!(this.canonical.x>e.canonical.x)&&this.canonical.y<e.canonical.y))}wrapped(){return new oi(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(e){return new oi(this.overscaledZ,e,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new Z_(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}getTilePoint(e){return this.canonical.getTilePoint(new Kh(e.x-this.wrap,e.y))}}function Qu(n,e,s,a,h){(n*=2)<0&&(n=-1*n-1);const m=1<<s;return(m*m*n+m*h+a).toString(36)+s.toString(36)+e.toString(36)}Ge("CanonicalTileID",Af),Ge("OverscaledTileID",oi,{omit:["posMatrix"]});class G_{constructor(e,s,a,h=1,m=1,y=1,v=0){if(this.uid=e,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(a&&!["mapbox","terrarium","custom"].includes(a))return void Ar(`"${a}" is not a valid encoding type. Valid types include "mapbox", "terrarium" and "custom".`);this.stride=s.height;const S=this.dim=s.height-2;switch(this.data=new Uint32Array(s.data.buffer),a){case"terrarium":this.redFactor=256,this.greenFactor=1,this.blueFactor=1/256,this.baseShift=32768;break;case"custom":this.redFactor=h,this.greenFactor=m,this.blueFactor=y,this.baseShift=v;break;default:this.redFactor=6553.6,this.greenFactor=25.6,this.blueFactor=.1,this.baseShift=1e4}for(let k=0;k<S;k++)this.data[this._idx(-1,k)]=this.data[this._idx(0,k)],this.data[this._idx(S,k)]=this.data[this._idx(S-1,k)],this.data[this._idx(k,-1)]=this.data[this._idx(k,0)],this.data[this._idx(k,S)]=this.data[this._idx(k,S-1)];this.data[this._idx(-1,-1)]=this.data[this._idx(0,0)],this.data[this._idx(S,-1)]=this.data[this._idx(S-1,0)],this.data[this._idx(-1,S)]=this.data[this._idx(0,S-1)],this.data[this._idx(S,S)]=this.data[this._idx(S-1,S-1)],this.min=Number.MAX_SAFE_INTEGER,this.max=Number.MIN_SAFE_INTEGER;for(let k=0;k<S;k++)for(let C=0;C<S;C++){const M=this.get(k,C);M>this.max&&(this.max=M),M<this.min&&(this.min=M)}}get(e,s){const a=new Uint8Array(this.data.buffer),h=4*this._idx(e,s);return this.unpack(a[h],a[h+1],a[h+2])}getUnpackVector(){return[this.redFactor,this.greenFactor,this.blueFactor,this.baseShift]}_idx(e,s){if(e<-1||e>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(e+1)}unpack(e,s,a){return e*this.redFactor+s*this.greenFactor+a*this.blueFactor-this.baseShift}getPixels(){return new si({width:this.stride,height:this.stride},new Uint8Array(this.data.buffer))}backfillBorder(e,s,a){if(this.dim!==e.dim)throw new Error("dem dimension mismatch");let h=s*this.dim,m=s*this.dim+this.dim,y=a*this.dim,v=a*this.dim+this.dim;switch(s){case-1:h=m-1;break;case 1:m=h+1}switch(a){case-1:y=v-1;break;case 1:v=y+1}const S=-s*this.dim,k=-a*this.dim;for(let C=y;C<v;C++)for(let M=h;M<m;M++)this.data[this._idx(M,C)]=e.data[this._idx(M+S,C+k)]}}Ge("DEMData",G_);class W_{constructor(e){this._stringToNumber={},this._numberToString=[];for(let s=0;s<e.length;s++){const a=e[s];this._stringToNumber[a]=s,this._numberToString[s]=a}}encode(e){return this._stringToNumber[e]}decode(e){if(e>=this._numberToString.length)throw new Error(`Out of bounds. Index requested n=${e} can't be >= this._numberToString.length ${this._numberToString.length}`);return this._numberToString[e]}}class H_{constructor(e,s,a,h,m){this.type="Feature",this._vectorTileFeature=e,e._z=s,e._x=a,e._y=h,this.properties=e.properties,this.id=m}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._vectorTileFeature._x,this._vectorTileFeature._y,this._vectorTileFeature._z).geometry),this._geometry}set geometry(e){this._geometry=e}toJSON(){const e={geometry:this.geometry};for(const s in this)s!=="_geometry"&&s!=="_vectorTileFeature"&&(e[s]=this[s]);return e}}class X_{constructor(e,s){this.tileID=e,this.x=e.canonical.x,this.y=e.canonical.y,this.z=e.canonical.z,this.grid=new fo(vr,16,0),this.grid3D=new fo(vr,16,0),this.featureIndexArray=new Ce,this.promoteId=s}insert(e,s,a,h,m,y){const v=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(a,h,m);const S=y?this.grid3D:this.grid;for(let k=0;k<s.length;k++){const C=s[k],M=[1/0,1/0,-1/0,-1/0];for(let L=0;L<C.length;L++){const O=C[L];M[0]=Math.min(M[0],O.x),M[1]=Math.min(M[1],O.y),M[2]=Math.max(M[2],O.x),M[3]=Math.max(M[3],O.y)}M[0]<vr&&M[1]<vr&&M[2]>=0&&M[3]>=0&&S.insert(v,M[0],M[1],M[2],M[3])}}loadVTLayers(){return this.vtLayers||(this.vtLayers=new vo.VectorTile(new xf(this.rawTileData)).layers,this.sourceLayerCoder=new W_(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"])),this.vtLayers}query(e,s,a,h){this.loadVTLayers();const m=e.params||{},y=vr/e.tileSize/e.scale,v=yu(m.filter),S=e.queryGeometry,k=e.queryPadding*y,C=Y_(S),M=this.grid.query(C.minX-k,C.minY-k,C.maxX+k,C.maxY+k),L=Y_(e.cameraQueryGeometry),O=this.grid3D.query(L.minX-k,L.minY-k,L.maxX+k,L.maxY+k,(H,Q,ue,ie)=>function(de,fe,Ee,qe,Ye){for(const Ve of de)if(fe<=Ve.x&&Ee<=Ve.y&&qe>=Ve.x&&Ye>=Ve.y)return!0;const Ue=[new te(fe,Ee),new te(fe,Ye),new te(qe,Ye),new te(qe,Ee)];if(de.length>2){for(const Ve of Ue)if(cl(de,Ve))return!0}for(let Ve=0;Ve<de.length-1;Ve++)if(Qw(de[Ve],de[Ve+1],Ue))return!0;return!1}(e.cameraQueryGeometry,H-k,Q-k,ue+k,ie+k));for(const H of O)M.push(H);M.sort(w2);const N={};let j;for(let H=0;H<M.length;H++){const Q=M[H];if(Q===j)continue;j=Q;const ue=this.featureIndexArray.get(Q);let ie=null;this.loadMatchingFeature(N,ue.bucketIndex,ue.sourceLayerIndex,ue.featureIndex,v,m.layers,m.availableImages,s,a,h,(de,fe,Ee)=>(ie||(ie=da(de)),fe.queryIntersectsFeature(S,de,Ee,ie,this.z,e.transform,y,e.pixelPosMatrix)))}return N}loadMatchingFeature(e,s,a,h,m,y,v,S,k,C,M){const L=this.bucketLayerIDs[s];if(y&&!function(H,Q){for(let ue=0;ue<H.length;ue++)if(Q.indexOf(H[ue])>=0)return!0;return!1}(y,L))return;const O=this.sourceLayerCoder.decode(a),N=this.vtLayers[O].feature(h);if(m.needGeometry){const H=pa(N,!0);if(!m.filter(new qt(this.tileID.overscaledZ),H,this.tileID.canonical))return}else if(!m.filter(new qt(this.tileID.overscaledZ),N))return;const j=this.getId(N,O);for(let H=0;H<L.length;H++){const Q=L[H];if(y&&y.indexOf(Q)<0)continue;const ue=S[Q];if(!ue)continue;let ie={};j&&C&&(ie=C.getState(ue.sourceLayer||"_geojsonTileLayer",j));const de=Ze({},k[Q]);de.paint=K_(de.paint,ue.paint,N,ie,v),de.layout=K_(de.layout,ue.layout,N,ie,v);const fe=!M||M(N,ue,ie);if(!fe)continue;const Ee=new H_(N,this.z,this.x,this.y,j);Ee.layer=de;let qe=e[Q];qe===void 0&&(qe=e[Q]=[]),qe.push({featureIndex:h,feature:Ee,intersectionZ:fe})}}lookupSymbolFeatures(e,s,a,h,m,y,v,S){const k={};this.loadVTLayers();const C=yu(m);for(const M of e)this.loadMatchingFeature(k,a,h,M,C,y,v,S,s);return k}hasLayer(e){for(const s of this.bucketLayerIDs)for(const a of s)if(e===a)return!0;return!1}getId(e,s){let a=e.id;return this.promoteId&&(a=e.properties[typeof this.promoteId=="string"?this.promoteId:this.promoteId[s]],typeof a=="boolean"&&(a=Number(a))),a}}function K_(n,e,s,a,h){return rt(n,(m,y)=>{const v=e instanceof ll?e.get(y):null;return v&&v.evaluate?v.evaluate(s,a,h):v})}function Y_(n){let e=1/0,s=1/0,a=-1/0,h=-1/0;for(const m of n)e=Math.min(e,m.x),s=Math.min(s,m.y),a=Math.max(a,m.x),h=Math.max(h,m.y);return{minX:e,minY:s,maxX:a,maxY:h}}function w2(n,e){return e-n}function Q_(n,e,s,a,h){const m=[];for(let y=0;y<n.length;y++){const v=n[y];let S;for(let k=0;k<v.length-1;k++){let C=v[k],M=v[k+1];C.x<e&&M.x<e||(C.x<e?C=new te(e,C.y+(e-C.x)/(M.x-C.x)*(M.y-C.y))._round():M.x<e&&(M=new te(e,C.y+(e-C.x)/(M.x-C.x)*(M.y-C.y))._round()),C.y<s&&M.y<s||(C.y<s?C=new te(C.x+(s-C.y)/(M.y-C.y)*(M.x-C.x),s)._round():M.y<s&&(M=new te(C.x+(s-C.y)/(M.y-C.y)*(M.x-C.x),s)._round()),C.x>=a&&M.x>=a||(C.x>=a?C=new te(a,C.y+(a-C.x)/(M.x-C.x)*(M.y-C.y))._round():M.x>=a&&(M=new te(a,C.y+(a-C.x)/(M.x-C.x)*(M.y-C.y))._round()),C.y>=h&&M.y>=h||(C.y>=h?C=new te(C.x+(h-C.y)/(M.y-C.y)*(M.x-C.x),h)._round():M.y>=h&&(M=new te(C.x+(h-C.y)/(M.y-C.y)*(M.x-C.x),h)._round()),S&&C.equals(S[S.length-1])||(S=[C],m.push(S)),S.push(M)))))}}return m}Ge("FeatureIndex",X_,{omit:["rawTileData","sourceLayerCoder"]});class So extends te{constructor(e,s,a,h){super(e,s),this.angle=a,h!==void 0&&(this.segment=h)}clone(){return new So(this.x,this.y,this.angle,this.segment)}}function J_(n,e,s,a,h){if(e.segment===void 0||s===0)return!0;let m=e,y=e.segment+1,v=0;for(;v>-s/2;){if(y--,y<0)return!1;v-=n[y].dist(m),m=n[y]}v+=n[y].dist(n[y+1]),y++;const S=[];let k=0;for(;v<s/2;){const C=n[y],M=n[y+1];if(!M)return!1;let L=n[y-1].angleTo(C)-C.angleTo(M);for(L=Math.abs((L+3*Math.PI)%(2*Math.PI)-Math.PI),S.push({distance:v,angleDelta:L}),k+=L;v-S[0].distance>a;)k-=S.shift().angleDelta;if(k>h)return!1;y++,v+=C.dist(M)}return!0}function ev(n){let e=0;for(let s=0;s<n.length-1;s++)e+=n[s].dist(n[s+1]);return e}function tv(n,e,s){return n?.6*e*s:0}function rv(n,e){return Math.max(n?n.right-n.left:0,e?e.right-e.left:0)}function b2(n,e,s,a,h,m){const y=tv(s,h,m),v=rv(s,a)*m;let S=0;const k=ev(n)/2;for(let C=0;C<n.length-1;C++){const M=n[C],L=n[C+1],O=M.dist(L);if(S+O>k){const N=(k-S)/O,j=Cn.number(M.x,L.x,N),H=Cn.number(M.y,L.y,N),Q=new So(j,H,L.angleTo(M),C);return Q._round(),!y||J_(n,Q,v,y,e)?Q:void 0}S+=O}}function S2(n,e,s,a,h,m,y,v,S){const k=tv(a,m,y),C=rv(a,h),M=C*y,L=n[0].x===0||n[0].x===S||n[0].y===0||n[0].y===S;return e-M<e/4&&(e=M+e/4),nv(n,L?e/2*v%e:(C/2+2*m)*y*v%e,e,k,s,M,L,!1,S)}function nv(n,e,s,a,h,m,y,v,S){const k=m/2,C=ev(n);let M=0,L=e-s,O=[];for(let N=0;N<n.length-1;N++){const j=n[N],H=n[N+1],Q=j.dist(H),ue=H.angleTo(j);for(;L+s<M+Q;){L+=s;const ie=(L-M)/Q,de=Cn.number(j.x,H.x,ie),fe=Cn.number(j.y,H.y,ie);if(de>=0&&de<S&&fe>=0&&fe<S&&L-k>=0&&L+k<=C){const Ee=new So(de,fe,ue,N);Ee._round(),a&&!J_(n,Ee,m,a,h)||O.push(Ee)}}M+=Q}return v||O.length||y||(O=nv(n,M/2,s,a,h,m,y,!0,S)),O}Ge("Anchor",So);const _l=Dn;function iv(n,e,s,a){const h=[],m=n.image,y=m.pixelRatio,v=m.paddedRect.w-2*_l,S=m.paddedRect.h-2*_l,k=n.right-n.left,C=n.bottom-n.top,M=m.stretchX||[[0,v]],L=m.stretchY||[[0,S]],O=(De,We)=>De+We[1]-We[0],N=M.reduce(O,0),j=L.reduce(O,0),H=v-N,Q=S-j;let ue=0,ie=N,de=0,fe=j,Ee=0,qe=H,Ye=0,Ue=Q;if(m.content&&a){const De=m.content;ue=Yh(M,0,De[0]),de=Yh(L,0,De[1]),ie=Yh(M,De[0],De[2]),fe=Yh(L,De[1],De[3]),Ee=De[0]-ue,Ye=De[1]-de,qe=De[2]-De[0]-ie,Ue=De[3]-De[1]-fe}const Ve=(De,We,Be,Me)=>{const it=Qh(De.stretch-ue,ie,k,n.left),Je=Jh(De.fixed-Ee,qe,De.stretch,N),gt=Qh(We.stretch-de,fe,C,n.top),Gt=Jh(We.fixed-Ye,Ue,We.stretch,j),Ht=Qh(Be.stretch-ue,ie,k,n.left),kr=Jh(Be.fixed-Ee,qe,Be.stretch,N),Kn=Qh(Me.stretch-de,fe,C,n.top),_n=Jh(Me.fixed-Ye,Ue,Me.stretch,j),xr=new te(it,gt),Nr=new te(Ht,gt),Hr=new te(Ht,Kn),vn=new te(it,Kn),xn=new te(Je/y,Gt/y),Er=new te(kr/y,_n/y),Ir=e*Math.PI/180;if(Ir){const nn=Math.sin(Ir),Ln=Math.cos(Ir),Rn=[Ln,-nn,nn,Ln];xr._matMult(Rn),Nr._matMult(Rn),vn._matMult(Rn),Hr._matMult(Rn)}const rn=De.stretch+De.fixed,wn=We.stretch+We.fixed;return{tl:xr,tr:Nr,bl:vn,br:Hr,tex:{x:m.paddedRect.x+_l+rn,y:m.paddedRect.y+_l+wn,w:Be.stretch+Be.fixed-rn,h:Me.stretch+Me.fixed-wn},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:xn,pixelOffsetBR:Er,minFontScaleX:qe/y/k,minFontScaleY:Ue/y/C,isSDF:s}};if(a&&(m.stretchX||m.stretchY)){const De=sv(M,H,N),We=sv(L,Q,j);for(let Be=0;Be<De.length-1;Be++){const Me=De[Be],it=De[Be+1];for(let Je=0;Je<We.length-1;Je++)h.push(Ve(Me,We[Je],it,We[Je+1]))}}else h.push(Ve({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:v+1},{fixed:0,stretch:S+1}));return h}function Yh(n,e,s){let a=0;for(const h of n)a+=Math.max(e,Math.min(s,h[1]))-Math.max(e,Math.min(s,h[0]));return a}function sv(n,e,s){const a=[{fixed:-_l,stretch:0}];for(const[h,m]of n){const y=a[a.length-1];a.push({fixed:h-y.stretch,stretch:y.stretch}),a.push({fixed:h-y.stretch,stretch:y.stretch+(m-h)})}return a.push({fixed:e+_l,stretch:s}),a}function Qh(n,e,s,a){return n/e*s+a}function Jh(n,e,s,a){return n-e*s/a}class ed{constructor(e,s,a,h,m,y,v,S,k,C){if(this.boxStartIndex=e.length,k){let M=y.top,L=y.bottom;const O=y.collisionPadding;O&&(M-=O[1],L+=O[3]);let N=L-M;N>0&&(N=Math.max(10,N),this.circleDiameter=N)}else{let M=y.top*v-S[0],L=y.bottom*v+S[2],O=y.left*v-S[3],N=y.right*v+S[1];const j=y.collisionPadding;if(j&&(O-=j[0]*v,M-=j[1]*v,N+=j[2]*v,L+=j[3]*v),C){const H=new te(O,M),Q=new te(N,M),ue=new te(O,L),ie=new te(N,L),de=C*Math.PI/180;H._rotate(de),Q._rotate(de),ue._rotate(de),ie._rotate(de),O=Math.min(H.x,Q.x,ue.x,ie.x),N=Math.max(H.x,Q.x,ue.x,ie.x),M=Math.min(H.y,Q.y,ue.y,ie.y),L=Math.max(H.y,Q.y,ue.y,ie.y)}e.emplaceBack(s.x,s.y,O,M,N,L,a,h,m)}this.boxEndIndex=e.length}}class T2{constructor(e=[],s=k2){if(this.data=e,this.length=this.data.length,this.compare=s,this.length>0)for(let a=(this.length>>1)-1;a>=0;a--)this._down(a)}push(e){this.data.push(e),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const e=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),e}peek(){return this.data[0]}_up(e){const{data:s,compare:a}=this,h=s[e];for(;e>0;){const m=e-1>>1,y=s[m];if(a(h,y)>=0)break;s[e]=y,e=m}s[e]=h}_down(e){const{data:s,compare:a}=this,h=this.length>>1,m=s[e];for(;e<h;){let y=1+(e<<1),v=s[y];const S=y+1;if(S<this.length&&a(s[S],v)<0&&(y=S,v=s[S]),a(v,m)>=0)break;s[e]=v,e=y}s[e]=m}}function k2(n,e){return n<e?-1:n>e?1:0}function E2(n,e=1,s=!1){let a=1/0,h=1/0,m=-1/0,y=-1/0;const v=n[0];for(let O=0;O<v.length;O++){const N=v[O];(!O||N.x<a)&&(a=N.x),(!O||N.y<h)&&(h=N.y),(!O||N.x>m)&&(m=N.x),(!O||N.y>y)&&(y=N.y)}const S=Math.min(m-a,y-h);let k=S/2;const C=new T2([],I2);if(S===0)return new te(a,h);for(let O=a;O<m;O+=S)for(let N=h;N<y;N+=S)C.push(new vl(O+k,N+k,k,n));let M=function(O){let N=0,j=0,H=0;const Q=O[0];for(let ue=0,ie=Q.length,de=ie-1;ue<ie;de=ue++){const fe=Q[ue],Ee=Q[de],qe=fe.x*Ee.y-Ee.x*fe.y;j+=(fe.x+Ee.x)*qe,H+=(fe.y+Ee.y)*qe,N+=3*qe}return new vl(j/N,H/N,0,O)}(n),L=C.length;for(;C.length;){const O=C.pop();(O.d>M.d||!M.d)&&(M=O,s&&console.log("found best %d after %d probes",Math.round(1e4*O.d)/1e4,L)),O.max-M.d<=e||(k=O.h/2,C.push(new vl(O.p.x-k,O.p.y-k,k,n)),C.push(new vl(O.p.x+k,O.p.y-k,k,n)),C.push(new vl(O.p.x-k,O.p.y+k,k,n)),C.push(new vl(O.p.x+k,O.p.y+k,k,n)),L+=4)}return s&&(console.log(`num probes: ${L}`),console.log(`best distance: ${M.d}`)),M.p}function I2(n,e){return e.max-n.max}function vl(n,e,s,a){this.p=new te(n,e),this.h=s,this.d=function(h,m){let y=!1,v=1/0;for(let S=0;S<m.length;S++){const k=m[S];for(let C=0,M=k.length,L=M-1;C<M;L=C++){const O=k[C],N=k[L];O.y>h.y!=N.y>h.y&&h.x<(N.x-O.x)*(h.y-O.y)/(N.y-O.y)+O.x&&(y=!y),v=Math.min(v,Uy(h,O,N))}}return(y?1:-1)*Math.sqrt(v)}(this.p,a),this.max=this.d+this.h*Math.SQRT2}var Wr;u.aq=void 0,(Wr=u.aq||(u.aq={}))[Wr.center=1]="center",Wr[Wr.left=2]="left",Wr[Wr.right=3]="right",Wr[Wr.top=4]="top",Wr[Wr.bottom=5]="bottom",Wr[Wr["top-left"]=6]="top-left",Wr[Wr["top-right"]=7]="top-right",Wr[Wr["bottom-left"]=8]="bottom-left",Wr[Wr["bottom-right"]=9]="bottom-right";const To=7,Df=Number.POSITIVE_INFINITY;function ov(n,e){return e[1]!==Df?function(s,a,h){let m=0,y=0;switch(a=Math.abs(a),h=Math.abs(h),s){case"top-right":case"top-left":case"top":y=h-To;break;case"bottom-right":case"bottom-left":case"bottom":y=-h+To}switch(s){case"top-right":case"bottom-right":case"right":m=-a;break;case"top-left":case"bottom-left":case"left":m=a}return[m,y]}(n,e[0],e[1]):function(s,a){let h=0,m=0;a<0&&(a=0);const y=a/Math.SQRT2;switch(s){case"top-right":case"top-left":m=y-To;break;case"bottom-right":case"bottom-left":m=-y+To;break;case"bottom":m=-a+To;break;case"top":m=a-To}switch(s){case"top-right":case"bottom-right":h=-y;break;case"top-left":case"bottom-left":h=y;break;case"left":h=a;break;case"right":h=-a}return[h,m]}(n,e[0])}function av(n,e,s){var a;const h=n.layout,m=(a=h.get("text-variable-anchor-offset"))===null||a===void 0?void 0:a.evaluate(e,{},s);if(m){const v=m.values,S=[];for(let k=0;k<v.length;k+=2){const C=S[k]=v[k],M=v[k+1].map(L=>L*Tr);C.startsWith("top")?M[1]-=To:C.startsWith("bottom")&&(M[1]+=To),S[k+1]=M}return new qn(S)}const y=h.get("text-variable-anchor");if(y){let v;v=n._unevaluatedLayout.getValue("text-radial-offset")!==void 0?[h.get("text-radial-offset").evaluate(e,{},s)*Tr,Df]:h.get("text-offset").evaluate(e,{},s).map(k=>k*Tr);const S=[];for(const k of y)S.push(k,ov(k,v));return new qn(S)}return null}function Lf(n){switch(n){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function C2(n,e,s,a,h,m,y,v,S,k,C){let M=m.textMaxSize.evaluate(e,{});M===void 0&&(M=y);const L=n.layers[0].layout,O=L.get("icon-offset").evaluate(e,{},C),N=uv(s.horizontal),j=y/24,H=n.tilePixelRatio*j,Q=n.tilePixelRatio*M/24,ue=n.tilePixelRatio*v,ie=n.tilePixelRatio*L.get("symbol-spacing"),de=L.get("text-padding")*n.tilePixelRatio,fe=function(Me,it,Je,gt=1){const Gt=Me.get("icon-padding").evaluate(it,{},Je),Ht=Gt&&Gt.values;return[Ht[0]*gt,Ht[1]*gt,Ht[2]*gt,Ht[3]*gt]}(L,e,C,n.tilePixelRatio),Ee=L.get("text-max-angle")/180*Math.PI,qe=L.get("text-rotation-alignment")!=="viewport"&&L.get("symbol-placement")!=="point",Ye=L.get("icon-rotation-alignment")==="map"&&L.get("symbol-placement")!=="point",Ue=L.get("symbol-placement"),Ve=ie/2,De=L.get("icon-text-fit");let We;a&&De!=="none"&&(n.allowVerticalPlacement&&s.vertical&&(We=M_(a,s.vertical,De,L.get("icon-text-fit-padding"),O,j)),N&&(a=M_(a,N,De,L.get("icon-text-fit-padding"),O,j)));const Be=(Me,it)=>{it.x<0||it.x>=vr||it.y<0||it.y>=vr||function(Je,gt,Gt,Ht,kr,Kn,_n,xr,Nr,Hr,vn,xn,Er,Ir,rn,wn,nn,Ln,Rn,Cr,xt,sn,Xr,Pr,Ii){const Zi=Je.addToLineVertexArray(gt,Gt);let Gi,Vs,Ci,ai,Fn=0,Us=0,tc=0,pv=0,jf=-1,$f=-1;const js={};let fv=Fs("");if(Je.allowVerticalPlacement&&Ht.vertical){const on=xr.layout.get("text-rotate").evaluate(xt,{},Pr)+90;Ci=new ed(Nr,gt,Hr,vn,xn,Ht.vertical,Er,Ir,rn,on),_n&&(ai=new ed(Nr,gt,Hr,vn,xn,_n,nn,Ln,rn,on))}if(kr){const on=xr.layout.get("icon-rotate").evaluate(xt,{}),li=xr.layout.get("icon-text-fit")!=="none",ma=iv(kr,on,Xr,li),Hi=_n?iv(_n,on,Xr,li):void 0;Vs=new ed(Nr,gt,Hr,vn,xn,kr,nn,Ln,!1,on),Fn=4*ma.length;const ga=Je.iconSizeData;let ys=null;ga.kind==="source"?(ys=[gs*xr.layout.get("icon-size").evaluate(xt,{})],ys[0]>wo&&Ar(`${Je.layerIds[0]}: Value for "icon-size" is >= ${Yu}. Reduce your "icon-size".`)):ga.kind==="composite"&&(ys=[gs*sn.compositeIconSizes[0].evaluate(xt,{},Pr),gs*sn.compositeIconSizes[1].evaluate(xt,{},Pr)],(ys[0]>wo||ys[1]>wo)&&Ar(`${Je.layerIds[0]}: Value for "icon-size" is >= ${Yu}. Reduce your "icon-size".`)),Je.addSymbols(Je.icon,ma,ys,Cr,Rn,xt,u.ai.none,gt,Zi.lineStartIndex,Zi.lineLength,-1,Pr),jf=Je.icon.placedSymbolArray.length-1,Hi&&(Us=4*Hi.length,Je.addSymbols(Je.icon,Hi,ys,Cr,Rn,xt,u.ai.vertical,gt,Zi.lineStartIndex,Zi.lineLength,-1,Pr),$f=Je.icon.placedSymbolArray.length-1)}const mv=Object.keys(Ht.horizontal);for(const on of mv){const li=Ht.horizontal[on];if(!Gi){fv=Fs(li.text);const Hi=xr.layout.get("text-rotate").evaluate(xt,{},Pr);Gi=new ed(Nr,gt,Hr,vn,xn,li,Er,Ir,rn,Hi)}const ma=li.positionedLines.length===1;if(tc+=lv(Je,gt,li,Kn,xr,rn,xt,wn,Zi,Ht.vertical?u.ai.horizontal:u.ai.horizontalOnly,ma?mv:[on],js,jf,sn,Pr),ma)break}Ht.vertical&&(pv+=lv(Je,gt,Ht.vertical,Kn,xr,rn,xt,wn,Zi,u.ai.vertical,["vertical"],js,$f,sn,Pr));const M2=Gi?Gi.boxStartIndex:Je.collisionBoxArray.length,A2=Gi?Gi.boxEndIndex:Je.collisionBoxArray.length,D2=Ci?Ci.boxStartIndex:Je.collisionBoxArray.length,L2=Ci?Ci.boxEndIndex:Je.collisionBoxArray.length,R2=Vs?Vs.boxStartIndex:Je.collisionBoxArray.length,F2=Vs?Vs.boxEndIndex:Je.collisionBoxArray.length,B2=ai?ai.boxStartIndex:Je.collisionBoxArray.length,O2=ai?ai.boxEndIndex:Je.collisionBoxArray.length;let Wi=-1;const rd=(on,li)=>on&&on.circleDiameter?Math.max(on.circleDiameter,li):li;Wi=rd(Gi,Wi),Wi=rd(Ci,Wi),Wi=rd(Vs,Wi),Wi=rd(ai,Wi);const gv=Wi>-1?1:0;gv&&(Wi*=Ii/Tr),Je.glyphOffsetArray.length>=yl.MAX_GLYPHS&&Ar("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),xt.sortKey!==void 0&&Je.addToSortKeyRanges(Je.symbolInstances.length,xt.sortKey);const N2=av(xr,xt,Pr),[V2,U2]=function(on,li){const ma=on.length,Hi=li==null?void 0:li.values;if((Hi==null?void 0:Hi.length)>0)for(let ga=0;ga<Hi.length;ga+=2){const ys=Hi[ga+1];on.emplaceBack(u.aq[Hi[ga]],ys[0],ys[1])}return[ma,on.length]}(Je.textAnchorOffsets,N2);Je.symbolInstances.emplaceBack(gt.x,gt.y,js.right>=0?js.right:-1,js.center>=0?js.center:-1,js.left>=0?js.left:-1,js.vertical||-1,jf,$f,fv,M2,A2,D2,L2,R2,F2,B2,O2,Hr,tc,pv,Fn,Us,gv,0,Er,Wi,V2,U2)}(n,it,Me,s,a,h,We,n.layers[0],n.collisionBoxArray,e.index,e.sourceLayerIndex,n.index,H,[de,de,de,de],qe,S,ue,fe,Ye,O,e,m,k,C,y)};if(Ue==="line")for(const Me of Q_(e.geometry,0,0,vr,vr)){const it=S2(Me,ie,Ee,s.vertical||N,a,24,Q,n.overscaling,vr);for(const Je of it)N&&P2(n,N.text,Ve,Je)||Be(Me,Je)}else if(Ue==="line-center"){for(const Me of e.geometry)if(Me.length>1){const it=b2(Me,Ee,s.vertical||N,a,24,Q);it&&Be(Me,it)}}else if(e.type==="Polygon")for(const Me of df(e.geometry,0)){const it=E2(Me,16);Be(Me[0],new So(it.x,it.y,0))}else if(e.type==="LineString")for(const Me of e.geometry)Be(Me,new So(Me[0].x,Me[0].y,0));else if(e.type==="Point")for(const Me of e.geometry)for(const it of Me)Be([it],new So(it.x,it.y,0))}function lv(n,e,s,a,h,m,y,v,S,k,C,M,L,O,N){const j=function(ue,ie,de,fe,Ee,qe,Ye,Ue){const Ve=fe.layout.get("text-rotate").evaluate(qe,{})*Math.PI/180,De=[];for(const We of ie.positionedLines)for(const Be of We.positionedGlyphs){if(!Be.rect)continue;const Me=Be.rect||{};let it=T_+1,Je=!0,gt=1,Gt=0;const Ht=(Ee||Ue)&&Be.vertical,kr=Be.metrics.advance*Be.scale/2;if(Ue&&ie.verticalizable&&(Gt=We.lineOffset/2-(Be.imageName?-(Tr-Be.metrics.width*Be.scale)/2:(Be.scale-1)*Tr)),Be.imageName){const Cr=Ye[Be.imageName];Je=Cr.sdf,gt=Cr.pixelRatio,it=Dn/gt}const Kn=Ee?[Be.x+kr,Be.y]:[0,0];let _n=Ee?[0,0]:[Be.x+kr+de[0],Be.y+de[1]-Gt],xr=[0,0];Ht&&(xr=_n,_n=[0,0]);const Nr=Be.metrics.isDoubleResolution?2:1,Hr=(Be.metrics.left-it)*Be.scale-kr+_n[0],vn=(-Be.metrics.top-it)*Be.scale+_n[1],xn=Hr+Me.w/Nr*Be.scale/gt,Er=vn+Me.h/Nr*Be.scale/gt,Ir=new te(Hr,vn),rn=new te(xn,vn),wn=new te(Hr,Er),nn=new te(xn,Er);if(Ht){const Cr=new te(-kr,kr-Xu),xt=-Math.PI/2,sn=Tr/2-kr,Xr=new te(5-Xu-sn,-(Be.imageName?sn:0)),Pr=new te(...xr);Ir._rotateAround(xt,Cr)._add(Xr)._add(Pr),rn._rotateAround(xt,Cr)._add(Xr)._add(Pr),wn._rotateAround(xt,Cr)._add(Xr)._add(Pr),nn._rotateAround(xt,Cr)._add(Xr)._add(Pr)}if(Ve){const Cr=Math.sin(Ve),xt=Math.cos(Ve),sn=[xt,-Cr,Cr,xt];Ir._matMult(sn),rn._matMult(sn),wn._matMult(sn),nn._matMult(sn)}const Ln=new te(0,0),Rn=new te(0,0);De.push({tl:Ir,tr:rn,bl:wn,br:nn,tex:Me,writingMode:ie.writingMode,glyphOffset:Kn,sectionIndex:Be.sectionIndex,isSDF:Je,pixelOffsetTL:Ln,pixelOffsetBR:Rn,minFontScaleX:0,minFontScaleY:0})}return De}(0,s,v,h,m,y,a,n.allowVerticalPlacement),H=n.textSizeData;let Q=null;H.kind==="source"?(Q=[gs*h.layout.get("text-size").evaluate(y,{})],Q[0]>wo&&Ar(`${n.layerIds[0]}: Value for "text-size" is >= ${Yu}. Reduce your "text-size".`)):H.kind==="composite"&&(Q=[gs*O.compositeTextSizes[0].evaluate(y,{},N),gs*O.compositeTextSizes[1].evaluate(y,{},N)],(Q[0]>wo||Q[1]>wo)&&Ar(`${n.layerIds[0]}: Value for "text-size" is >= ${Yu}. Reduce your "text-size".`)),n.addSymbols(n.text,j,Q,v,m,y,k,e,S.lineStartIndex,S.lineLength,L,N);for(const ue of C)M[ue]=n.text.placedSymbolArray.length-1;return 4*j.length}function uv(n){for(const e in n)return n[e];return null}function P2(n,e,s,a){const h=n.compareText;if(e in h){const m=h[e];for(let y=m.length-1;y>=0;y--)if(a.dist(m[y])<s)return!0}else h[e]=[];return h[e].push(a),!1}const cv=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Rf{static from(e){if(!(e instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,a]=new Uint8Array(e,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const h=a>>4;if(h!==1)throw new Error(`Got v${h} data when expected v1.`);const m=cv[15&a];if(!m)throw new Error("Unrecognized array type.");const[y]=new Uint16Array(e,2,1),[v]=new Uint32Array(e,4,1);return new Rf(v,y,m,e)}constructor(e,s=64,a=Float64Array,h){if(isNaN(e)||e<0)throw new Error(`Unpexpected numItems value: ${e}.`);this.numItems=+e,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=a,this.IndexArrayType=e<65536?Uint16Array:Uint32Array;const m=cv.indexOf(this.ArrayType),y=2*e*this.ArrayType.BYTES_PER_ELEMENT,v=e*this.IndexArrayType.BYTES_PER_ELEMENT,S=(8-v%8)%8;if(m<0)throw new Error(`Unexpected typed array class: ${a}.`);h&&h instanceof ArrayBuffer?(this.data=h,this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+S,2*e),this._pos=2*e,this._finished=!0):(this.data=new ArrayBuffer(8+y+v+S),this.ids=new this.IndexArrayType(this.data,8,e),this.coords=new this.ArrayType(this.data,8+v+S,2*e),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+m]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=e)}add(e,s){const a=this._pos>>1;return this.ids[a]=a,this.coords[this._pos++]=e,this.coords[this._pos++]=s,a}finish(){const e=this._pos>>1;if(e!==this.numItems)throw new Error(`Added ${e} items when expected ${this.numItems}.`);return Ff(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(e,s,a,h){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:m,coords:y,nodeSize:v}=this,S=[0,m.length-1,0],k=[];for(;S.length;){const C=S.pop()||0,M=S.pop()||0,L=S.pop()||0;if(M-L<=v){for(let H=L;H<=M;H++){const Q=y[2*H],ue=y[2*H+1];Q>=e&&Q<=a&&ue>=s&&ue<=h&&k.push(m[H])}continue}const O=L+M>>1,N=y[2*O],j=y[2*O+1];N>=e&&N<=a&&j>=s&&j<=h&&k.push(m[O]),(C===0?e<=N:s<=j)&&(S.push(L),S.push(O-1),S.push(1-C)),(C===0?a>=N:h>=j)&&(S.push(O+1),S.push(M),S.push(1-C))}return k}within(e,s,a){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:h,coords:m,nodeSize:y}=this,v=[0,h.length-1,0],S=[],k=a*a;for(;v.length;){const C=v.pop()||0,M=v.pop()||0,L=v.pop()||0;if(M-L<=y){for(let H=L;H<=M;H++)dv(m[2*H],m[2*H+1],e,s)<=k&&S.push(h[H]);continue}const O=L+M>>1,N=m[2*O],j=m[2*O+1];dv(N,j,e,s)<=k&&S.push(h[O]),(C===0?e-a<=N:s-a<=j)&&(v.push(L),v.push(O-1),v.push(1-C)),(C===0?e+a>=N:s+a>=j)&&(v.push(O+1),v.push(M),v.push(1-C))}return S}}function Ff(n,e,s,a,h,m){if(h-a<=s)return;const y=a+h>>1;hv(n,e,y,a,h,m),Ff(n,e,s,a,y-1,1-m),Ff(n,e,s,y+1,h,1-m)}function hv(n,e,s,a,h,m){for(;h>a;){if(h-a>600){const k=h-a+1,C=s-a+1,M=Math.log(k),L=.5*Math.exp(2*M/3),O=.5*Math.sqrt(M*L*(k-L)/k)*(C-k/2<0?-1:1);hv(n,e,s,Math.max(a,Math.floor(s-C*L/k+O)),Math.min(h,Math.floor(s+(k-C)*L/k+O)),m)}const y=e[2*s+m];let v=a,S=h;for(Ju(n,e,a,s),e[2*h+m]>y&&Ju(n,e,a,h);v<S;){for(Ju(n,e,v,S),v++,S--;e[2*v+m]<y;)v++;for(;e[2*S+m]>y;)S--}e[2*a+m]===y?Ju(n,e,a,S):(S++,Ju(n,e,S,h)),S<=s&&(a=S+1),s<=S&&(h=S-1)}}function Ju(n,e,s,a){Bf(n,s,a),Bf(e,2*s,2*a),Bf(e,2*s+1,2*a+1)}function Bf(n,e,s){const a=n[e];n[e]=n[s],n[s]=a}function dv(n,e,s,a){const h=n-s,m=e-a;return h*h+m*m}var Of;u.bh=void 0,(Of=u.bh||(u.bh={})).create="create",Of.load="load",Of.fullLoad="fullLoad";let td=null,ec=[];const Nf=1e3/60,Vf="loadTime",Uf="fullLoadTime",z2={mark(n){performance.mark(n)},frame(n){const e=n;td!=null&&ec.push(e-td),td=e},clearMetrics(){td=null,ec=[],performance.clearMeasures(Vf),performance.clearMeasures(Uf);for(const n in u.bh)performance.clearMarks(u.bh[n])},getPerformanceMetrics(){performance.measure(Vf,u.bh.create,u.bh.load),performance.measure(Uf,u.bh.create,u.bh.fullLoad);const n=performance.getEntriesByName(Vf)[0].duration,e=performance.getEntriesByName(Uf)[0].duration,s=ec.length,a=1/(ec.reduce((m,y)=>m+y,0)/s/1e3),h=ec.filter(m=>m>Nf).reduce((m,y)=>m+(y-Nf)/Nf,0);return{loadTime:n,fullLoadTime:e,fps:a,percentDroppedFrames:h/(s+h)*100,totalFrames:s}}};u.$=function(n,e,s){var a,h,m,y,v,S,k,C,M,L,O,N,j=s[0],H=s[1],Q=s[2];return e===n?(n[12]=e[0]*j+e[4]*H+e[8]*Q+e[12],n[13]=e[1]*j+e[5]*H+e[9]*Q+e[13],n[14]=e[2]*j+e[6]*H+e[10]*Q+e[14],n[15]=e[3]*j+e[7]*H+e[11]*Q+e[15]):(h=e[1],m=e[2],y=e[3],v=e[4],S=e[5],k=e[6],C=e[7],M=e[8],L=e[9],O=e[10],N=e[11],n[0]=a=e[0],n[1]=h,n[2]=m,n[3]=y,n[4]=v,n[5]=S,n[6]=k,n[7]=C,n[8]=M,n[9]=L,n[10]=O,n[11]=N,n[12]=a*j+v*H+M*Q+e[12],n[13]=h*j+S*H+L*Q+e[13],n[14]=m*j+k*H+O*Q+e[14],n[15]=y*j+C*H+N*Q+e[15]),n},u.A=hl,u.B=Cn,u.C=class{constructor(n,e,s){this.receive=a=>{const h=a.data,m=h.id;if(m&&(!h.targetMapId||this.mapId===h.targetMapId))if(h.type==="<cancel>"){delete this.tasks[m];const y=this.cancelCallbacks[m];delete this.cancelCallbacks[m],y&&y()}else $r()||h.mustQueue?(this.tasks[m]=h,this.taskQueue.push(m),this.invoker.trigger()):this.processTask(m,h)},this.process=()=>{if(!this.taskQueue.length)return;const a=this.taskQueue.shift(),h=this.tasks[a];delete this.tasks[a],this.taskQueue.length&&this.invoker.trigger(),h&&this.processTask(a,h)},this.target=n,this.parent=e,this.mapId=s,this.callbacks={},this.tasks={},this.taskQueue=[],this.cancelCallbacks={},this.invoker=new x2(this.process),this.target.addEventListener("message",this.receive,!1),this.globalScope=$r()?n:window}send(n,e,s,a,h=!1){const m=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(this.callbacks[m]=s);const y=[],v={id:m,type:n,hasCallback:!!s,targetMapId:a,mustQueue:h,sourceMapId:this.mapId,data:ps(e,y)};return this.target.postMessage(v,{transfer:y}),{cancel:()=>{s&&delete this.callbacks[m],this.target.postMessage({id:m,type:"<cancel>",targetMapId:a,sourceMapId:this.mapId})}}}processTask(n,e){if(e.type==="<response>"){const s=this.callbacks[n];delete this.callbacks[n],s&&(e.error?s(mo(e.error)):s(null,mo(e.data)))}else{let s=!1;const a=[],h=e.hasCallback?(v,S)=>{s=!0,delete this.cancelCallbacks[n];const k={id:n,type:"<response>",sourceMapId:this.mapId,error:v?ps(v):null,data:ps(S,a)};this.target.postMessage(k,{transfer:a})}:v=>{s=!0};let m=null;const y=mo(e.data);if(this.parent[e.type])m=this.parent[e.type](e.sourceMapId,y,h);else if("getWorkerSource"in this.parent){const v=e.type.split(".");m=this.parent.getWorkerSource(e.sourceMapId,v[0],y.source)[v[1]](y,h)}else h(new Error(`Could not find function ${e.type}`));!s&&m&&m.cancel&&(this.cancelCallbacks[n]=m.cancel)}}remove(){this.invoker.remove(),this.target.removeEventListener("message",this.receive,!1)}},u.D=et,u.E=Ts,u.F=function(n,e){const s={};for(let a=0;a<e.length;a++){const h=e[a];h in n&&(s[h]=n[h])}return s},u.G=V_,u.H=U_,u.I=bf,u.J=ee,u.K=ce,u.L=bo,u.M=Vt,u.N=vr,u.O=oi,u.P=te,u.Q=Qt,u.R=si,u.S=Zt,u.T=zh,u.U=Kh,u.V=class extends Ls{},u.W=Af,u.X=function(n,e){const s=window.document.createElement("video");s.muted=!0,s.onloadstart=function(){e(null,s)};for(let a=0;a<n.length;a++){const h=window.document.createElement("source");Ri(n[a])||(s.crossOrigin="Anonymous"),h.src=n[a],s.appendChild(h)}return{cancel:()=>{}}},u.Y=Re,u.Z=function(){var n=new hl(16);return hl!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n},u._=B,u.a=ht,u.a$=class extends F{},u.a0=function(n,e,s){var a=s[0],h=s[1],m=s[2];return n[0]=e[0]*a,n[1]=e[1]*a,n[2]=e[2]*a,n[3]=e[3]*a,n[4]=e[4]*h,n[5]=e[5]*h,n[6]=e[6]*h,n[7]=e[7]*h,n[8]=e[8]*m,n[9]=e[9]*m,n[10]=e[10]*m,n[11]=e[11]*m,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},u.a1=Zy,u.a2=function(){return kt++},u.a3=G,u.a4=yl,u.a5=function(){Mn.isLoading()||Mn.isLoaded()||Cu()!=="deferred"||Ph()},u.a6=yu,u.a7=pa,u.a8=qt,u.a9=H_,u.aA=aa,u.aB=function(n){n=n.slice();const e=Object.create(null);for(let s=0;s<n.length;s++)e[n[s].id]=n[s];for(let s=0;s<n.length;s++)"ref"in n[s]&&(n[s]=jn(n[s],e[n[s].ref]));return n},u.aC=function(n){if(n.type==="custom")return new v2(n);switch(n.type){case"background":return new g2(n);case"circle":return new tb(n);case"fill":return new wb(n);case"fill-extrusion":return new Fb(n);case"heatmap":return new nb(n);case"hillshade":return new sb(n);case"line":return new qb(n);case"raster":return new _2(n);case"symbol":return new Xh(n)}},u.aD=Lr,u.aE=function(n,e){if(!n)return[{command:Et.setStyle,args:[e]}];let s=[];try{if(!Nt(n.version,e.version))return[{command:Et.setStyle,args:[e]}];Nt(n.center,e.center)||s.push({command:Et.setCenter,args:[e.center]}),Nt(n.zoom,e.zoom)||s.push({command:Et.setZoom,args:[e.zoom]}),Nt(n.bearing,e.bearing)||s.push({command:Et.setBearing,args:[e.bearing]}),Nt(n.pitch,e.pitch)||s.push({command:Et.setPitch,args:[e.pitch]}),Nt(n.sprite,e.sprite)||s.push({command:Et.setSprite,args:[e.sprite]}),Nt(n.glyphs,e.glyphs)||s.push({command:Et.setGlyphs,args:[e.glyphs]}),Nt(n.transition,e.transition)||s.push({command:Et.setTransition,args:[e.transition]}),Nt(n.light,e.light)||s.push({command:Et.setLight,args:[e.light]});const a={},h=[];(function(y,v,S,k){let C;for(C in v=v||{},y=y||{})Object.prototype.hasOwnProperty.call(y,C)&&(Object.prototype.hasOwnProperty.call(v,C)||ro(C,S,k));for(C in v)Object.prototype.hasOwnProperty.call(v,C)&&(Object.prototype.hasOwnProperty.call(y,C)?Nt(y[C],v[C])||(y[C].type==="geojson"&&v[C].type==="geojson"&&La(y,v,C)?S.push({command:Et.setGeoJSONSourceData,args:[C,v[C].data]}):Fi(C,v,S,k)):_i(C,v,S))})(n.sources,e.sources,h,a);const m=[];n.layers&&n.layers.forEach(y=>{a[y.source]?s.push({command:Et.removeLayer,args:[y.id]}):m.push(y)}),s=s.concat(h),function(y,v,S){v=v||[];const k=(y=y||[]).map(ls),C=v.map(ls),M=y.reduce(ks,{}),L=v.reduce(ks,{}),O=k.slice(),N=Object.create(null);let j,H,Q,ue,ie,de,fe;for(j=0,H=0;j<k.length;j++)Q=k[j],Object.prototype.hasOwnProperty.call(L,Q)?H++:(S.push({command:Et.removeLayer,args:[Q]}),O.splice(O.indexOf(Q,H),1));for(j=0,H=0;j<C.length;j++)Q=C[C.length-1-j],O[O.length-1-j]!==Q&&(Object.prototype.hasOwnProperty.call(M,Q)?(S.push({command:Et.removeLayer,args:[Q]}),O.splice(O.lastIndexOf(Q,O.length-H),1)):H++,de=O[O.length-j],S.push({command:Et.addLayer,args:[L[Q],de]}),O.splice(O.length-j,0,Q),N[Q]=!0);for(j=0;j<C.length;j++)if(Q=C[j],ue=M[Q],ie=L[Q],!N[Q]&&!Nt(ue,ie))if(Nt(ue.source,ie.source)&&Nt(ue["source-layer"],ie["source-layer"])&&Nt(ue.type,ie.type)){for(fe in no(ue.layout,ie.layout,S,Q,null,Et.setLayoutProperty),no(ue.paint,ie.paint,S,Q,null,Et.setPaintProperty),Nt(ue.filter,ie.filter)||S.push({command:Et.setFilter,args:[Q,ie.filter]}),Nt(ue.minzoom,ie.minzoom)&&Nt(ue.maxzoom,ie.maxzoom)||S.push({command:Et.setLayerZoomRange,args:[Q,ie.minzoom,ie.maxzoom]}),ue)Object.prototype.hasOwnProperty.call(ue,fe)&&fe!=="layout"&&fe!=="paint"&&fe!=="filter"&&fe!=="metadata"&&fe!=="minzoom"&&fe!=="maxzoom"&&(fe.indexOf("paint.")===0?no(ue[fe],ie[fe],S,Q,fe.slice(6),Et.setPaintProperty):Nt(ue[fe],ie[fe])||S.push({command:Et.setLayerProperty,args:[Q,fe,ie[fe]]}));for(fe in ie)Object.prototype.hasOwnProperty.call(ie,fe)&&!Object.prototype.hasOwnProperty.call(ue,fe)&&fe!=="layout"&&fe!=="paint"&&fe!=="filter"&&fe!=="metadata"&&fe!=="minzoom"&&fe!=="maxzoom"&&(fe.indexOf("paint.")===0?no(ue[fe],ie[fe],S,Q,fe.slice(6),Et.setPaintProperty):Nt(ue[fe],ie[fe])||S.push({command:Et.setLayerProperty,args:[Q,fe,ie[fe]]}))}else S.push({command:Et.removeLayer,args:[Q]}),de=O[O.lastIndexOf(Q)+1],S.push({command:Et.addLayer,args:[ie,de]})}(m,e.layers,s)}catch(a){console.warn("Unable to compute style diff:",a),s=[{command:Et.setStyle,args:[e]}]}return s},u.aF=function(n){const e=[],s=n.id;return s===void 0&&e.push({message:`layers.${s}: missing required property "id"`}),n.render===void 0&&e.push({message:`layers.${s}: missing required method "render"`}),n.renderingMode&&n.renderingMode!=="2d"&&n.renderingMode!=="3d"&&e.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),e},u.aG=function n(e,s){if(Array.isArray(e)){if(!Array.isArray(s)||e.length!==s.length)return!1;for(let a=0;a<e.length;a++)if(!n(e[a],s[a]))return!1;return!0}if(typeof e=="object"&&e!==null&&s!==null){if(typeof s!="object"||Object.keys(e).length!==Object.keys(s).length)return!1;for(const a in e)if(!n(e[a],s[a]))return!1;return!0}return e===s},u.aH=rt,u.aI=Mr,u.aJ=la,u.aK=function(n){return n({pluginStatus:mn,pluginURL:fs}),la.on("pluginStateChange",n),n},u.aL=class extends Bs{constructor(n,e){super(n,e),this.current=0}set(n){this.current!==n&&(this.current=n,this.gl.uniform1i(this.location,n))}},u.aM=ul,u.aN=class extends Bs{constructor(n,e){super(n,e),this.current=Jp}set(n){if(n[12]!==this.current[12]||n[0]!==this.current[0])return this.current=n,void this.gl.uniformMatrix4fv(this.location,!1,n);for(let e=1;e<16;e++)if(n[e]!==this.current[e]){this.current=n,this.gl.uniformMatrix4fv(this.location,!1,n);break}}},u.aO=Lh,u.aP=class extends Bs{constructor(n,e){super(n,e),this.current=[0,0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]&&n[2]===this.current[2]||(this.current=n,this.gl.uniform3f(this.location,n[0],n[1],n[2]))}},u.aQ=class extends Bs{constructor(n,e){super(n,e),this.current=[0,0]}set(n){n[0]===this.current[0]&&n[1]===this.current[1]||(this.current=n,this.gl.uniform2f(this.location,n[0],n[1]))}},u.aR=Rh,u.aS=function(n,e,s,a,h,m,y){var v=1/(e-s),S=1/(a-h),k=1/(m-y);return n[0]=-2*v,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*S,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*k,n[11]=0,n[12]=(e+s)*v,n[13]=(h+a)*S,n[14]=(y+m)*k,n[15]=1,n},u.aT=Lt,u.aU=eb,u.aV=class extends c{},u.aW=Hb,u.aX=class extends g{},u.aY=function(n){return n<=1?1:Math.pow(2,Math.ceil(Math.log(n)/Math.LN2))},u.aZ=Ky,u.a_=Ae,u.aa=function(n){const e={};if(n.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(s,a,h,m)=>{const y=h||m;return e[a]=!y||y.toLowerCase(),""}),e["max-age"]){const s=parseInt(e["max-age"],10);isNaN(s)?delete e["max-age"]:e["max-age"]=s}return e},u.ab=function(n,e){const s=[];for(const a in n)a in e||s.push(a);return s},u.ac=function(n){if(He==null){const e=n.navigator?n.navigator.userAgent:null;He=!!n.safari||!(!e||!(/\b(iPad|iPhone|iPod)\b/.test(e)||e.match("Safari")&&!e.match("Chrome")))}return He},u.ad=Le,u.ae=function(n,e,s){var a=Math.sin(s),h=Math.cos(s),m=e[0],y=e[1],v=e[2],S=e[3],k=e[4],C=e[5],M=e[6],L=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=m*h+k*a,n[1]=y*h+C*a,n[2]=v*h+M*a,n[3]=S*h+L*a,n[4]=k*h-m*a,n[5]=C*h-y*a,n[6]=M*h-v*a,n[7]=L*h-S*a,n},u.af=function(n){var e=new hl(16);return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],e},u.ag=Nh,u.ah=function(n,e){let s=0,a=0;if(n.kind==="constant")a=n.layoutSize;else if(n.kind!=="source"){const{interpolationType:h,minZoom:m,maxZoom:y}=n,v=h?Le(Pn.interpolationFactor(h,e,m,y),0,1):0;n.kind==="camera"?a=Cn.number(n.minSize,n.maxSize,v):s=v}return{uSizeT:s,uSize:a}},u.aj=function(n,{uSize:e,uSizeT:s},{lowerSize:a,upperSize:h}){return n.kind==="source"?a/gs:n.kind==="composite"?Cn.number(a/gs,h/gs,s):e},u.ak=Ef,u.al=function(n,e,s,a){const h=e.y-n.y,m=e.x-n.x,y=a.y-s.y,v=a.x-s.x,S=y*m-v*h;if(S===0)return null;const k=(v*(n.y-s.y)-y*(n.x-s.x))/S;return new te(n.x+k*m,n.y+k*h)},u.am=Q_,u.an=Ny,u.ao=sf,u.ap=Tr,u.ar=kf,u.as=function(n,e){var s=e[0],a=e[1],h=e[2],m=e[3],y=e[4],v=e[5],S=e[6],k=e[7],C=e[8],M=e[9],L=e[10],O=e[11],N=e[12],j=e[13],H=e[14],Q=e[15],ue=s*v-a*y,ie=s*S-h*y,de=s*k-m*y,fe=a*S-h*v,Ee=a*k-m*v,qe=h*k-m*S,Ye=C*j-M*N,Ue=C*H-L*N,Ve=C*Q-O*N,De=M*H-L*j,We=M*Q-O*j,Be=L*Q-O*H,Me=ue*Be-ie*We+de*De+fe*Ve-Ee*Ue+qe*Ye;return Me?(n[0]=(v*Be-S*We+k*De)*(Me=1/Me),n[1]=(h*We-a*Be-m*De)*Me,n[2]=(j*qe-H*Ee+Q*fe)*Me,n[3]=(L*Ee-M*qe-O*fe)*Me,n[4]=(S*Ve-y*Be-k*Ue)*Me,n[5]=(s*Be-h*Ve+m*Ue)*Me,n[6]=(H*de-N*qe-Q*ie)*Me,n[7]=(C*qe-L*de+O*ie)*Me,n[8]=(y*We-v*Ve+k*Ye)*Me,n[9]=(a*Ve-s*We-m*Ye)*Me,n[10]=(N*Ee-j*de+Q*ue)*Me,n[11]=(M*de-C*Ee-O*ue)*Me,n[12]=(v*Ue-y*De-S*Ye)*Me,n[13]=(s*De-a*Ue+h*Ye)*Me,n[14]=(j*ie-N*fe-H*ue)*Me,n[15]=(C*fe-M*ie+L*ue)*Me,n):null},u.at=Lf,u.au=Tf,u.av=Rf,u.aw=function(){const n={},e=ve.$version;for(const s in ve.$root){const a=ve.$root[s];if(a.required){let h=null;h=s==="version"?e:a.type==="array"?[]:{},h!=null&&(n[s]=h)}}return n},u.ax=Et,u.ay=kh,u.az=ii,u.b=function(n,e){const s=new Blob([new Uint8Array(n)],{type:"image/png"});createImageBitmap(s).then(a=>{e(null,a)}).catch(a=>{e(new Error(`Could not load image because of ${a.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})},u.b0=Br,u.b1=function(n,e){var s=n[0],a=n[1],h=n[2],m=n[3],y=n[4],v=n[5],S=n[6],k=n[7],C=n[8],M=n[9],L=n[10],O=n[11],N=n[12],j=n[13],H=n[14],Q=n[15],ue=e[0],ie=e[1],de=e[2],fe=e[3],Ee=e[4],qe=e[5],Ye=e[6],Ue=e[7],Ve=e[8],De=e[9],We=e[10],Be=e[11],Me=e[12],it=e[13],Je=e[14],gt=e[15];return Math.abs(s-ue)<=yn*Math.max(1,Math.abs(s),Math.abs(ue))&&Math.abs(a-ie)<=yn*Math.max(1,Math.abs(a),Math.abs(ie))&&Math.abs(h-de)<=yn*Math.max(1,Math.abs(h),Math.abs(de))&&Math.abs(m-fe)<=yn*Math.max(1,Math.abs(m),Math.abs(fe))&&Math.abs(y-Ee)<=yn*Math.max(1,Math.abs(y),Math.abs(Ee))&&Math.abs(v-qe)<=yn*Math.max(1,Math.abs(v),Math.abs(qe))&&Math.abs(S-Ye)<=yn*Math.max(1,Math.abs(S),Math.abs(Ye))&&Math.abs(k-Ue)<=yn*Math.max(1,Math.abs(k),Math.abs(Ue))&&Math.abs(C-Ve)<=yn*Math.max(1,Math.abs(C),Math.abs(Ve))&&Math.abs(M-De)<=yn*Math.max(1,Math.abs(M),Math.abs(De))&&Math.abs(L-We)<=yn*Math.max(1,Math.abs(L),Math.abs(We))&&Math.abs(O-Be)<=yn*Math.max(1,Math.abs(O),Math.abs(Be))&&Math.abs(N-Me)<=yn*Math.max(1,Math.abs(N),Math.abs(Me))&&Math.abs(j-it)<=yn*Math.max(1,Math.abs(j),Math.abs(it))&&Math.abs(H-Je)<=yn*Math.max(1,Math.abs(H),Math.abs(Je))&&Math.abs(Q-gt)<=yn*Math.max(1,Math.abs(Q),Math.abs(gt))},u.b2=function(n,e){return n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n},u.b3=function(n,e,s){return n[0]=e[0]*s[0],n[1]=e[1]*s[1],n[2]=e[2]*s[2],n[3]=e[3]*s[3],n},u.b4=function(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]+n[3]*e[3]},u.b5=je,u.b6=Z_,u.b7=j_,u.b8=function(n,e,s,a,h){var m,y=1/Math.tan(e/2);return n[0]=y/s,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=y,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,h!=null&&h!==1/0?(n[10]=(h+a)*(m=1/(a-h)),n[14]=2*h*a*m):(n[10]=-1,n[14]=-2*a),n},u.b9=function(n,e,s){var a=Math.sin(s),h=Math.cos(s),m=e[4],y=e[5],v=e[6],S=e[7],k=e[8],C=e[9],M=e[10],L=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=m*h+k*a,n[5]=y*h+C*a,n[6]=v*h+M*a,n[7]=S*h+L*a,n[8]=k*h-m*a,n[9]=C*h-y*a,n[10]=M*h-v*a,n[11]=L*h-S*a,n},u.bA=ne,u.bB=y_,u.bC=Qa,u.bD=Mn,u.ba=ye,u.bb=Pe,u.bc=function(n,e){return n[0]=e[0],n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=e[1],n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=e[2],n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n},u.bd=class extends ha{},u.be=zf,u.bf=$_,u.bg=z2,u.bi=is,u.bj=function(n,e,s=!1){if(mn===Su||mn===Tu||mn===ku)throw new Error("setRTLTextPlugin cannot be called multiple times.");fs=dn.resolveURL(n),mn=Su,Eu=e,Iu(),s||Ph()},u.bk=Cu,u.bl=function(n,e){const s={};for(let h=0;h<n.length;h++){const m=e&&e[n[h].id]||rl(n[h]);e&&(e[n[h].id]=m);let y=s[m];y||(y=s[m]=[]),y.push(n[h])}const a=[];for(const h in s)a.push(s[h]);return a},u.bm=Ge,u.bn=W_,u.bo=X_,u.bp=E_,u.bq=function(n){n.bucket.createArrays(),n.bucket.tilePixelRatio=vr/(512*n.bucket.overscaling),n.bucket.compareText={},n.bucket.iconsNeedLinear=!1;const e=n.bucket.layers[0],s=e.layout,a=e._unevaluatedLayout._values,h={layoutIconSize:a["icon-size"].possiblyEvaluate(new qt(n.bucket.zoom+1),n.canonical),layoutTextSize:a["text-size"].possiblyEvaluate(new qt(n.bucket.zoom+1),n.canonical),textMaxSize:a["text-size"].possiblyEvaluate(new qt(18))};if(n.bucket.textSizeData.kind==="composite"){const{minZoom:k,maxZoom:C}=n.bucket.textSizeData;h.compositeTextSizes=[a["text-size"].possiblyEvaluate(new qt(k),n.canonical),a["text-size"].possiblyEvaluate(new qt(C),n.canonical)]}if(n.bucket.iconSizeData.kind==="composite"){const{minZoom:k,maxZoom:C}=n.bucket.iconSizeData;h.compositeIconSizes=[a["icon-size"].possiblyEvaluate(new qt(k),n.canonical),a["icon-size"].possiblyEvaluate(new qt(C),n.canonical)]}const m=s.get("text-line-height")*Tr,y=s.get("text-rotation-alignment")!=="viewport"&&s.get("symbol-placement")!=="point",v=s.get("text-keep-upright"),S=s.get("text-size");for(const k of n.bucket.features){const C=s.get("text-font").evaluate(k,{},n.canonical).join(","),M=S.evaluate(k,{},n.canonical),L=h.layoutTextSize.evaluate(k,{},n.canonical),O=h.layoutIconSize.evaluate(k,{},n.canonical),N={horizontal:{},vertical:void 0},j=k.text;let H,Q=[0,0];if(j){const de=j.toString(),fe=s.get("text-letter-spacing").evaluate(k,{},n.canonical)*Tr,Ee=wu(de)?fe:0,qe=s.get("text-anchor").evaluate(k,{},n.canonical),Ye=av(e,k,n.canonical);if(!Ye){const Be=s.get("text-radial-offset").evaluate(k,{},n.canonical);Q=Be?ov(qe,[Be*Tr,Df]):s.get("text-offset").evaluate(k,{},n.canonical).map(Me=>Me*Tr)}let Ue=y?"center":s.get("text-justify").evaluate(k,{},n.canonical);const Ve=s.get("symbol-placement"),De=Ve==="point"?s.get("text-max-width").evaluate(k,{},n.canonical)*Tr:0,We=()=>{n.bucket.allowVerticalPlacement&&xu(de)&&(N.vertical=Gh(j,n.glyphMap,n.glyphPositions,n.imagePositions,C,De,m,qe,"left",Ee,Q,u.ai.vertical,!0,Ve,L,M))};if(!y&&Ye){const Be=new Set;if(Ue==="auto")for(let it=0;it<Ye.values.length;it+=2)Be.add(Lf(Ye.values[it]));else Be.add(Ue);let Me=!1;for(const it of Be)if(!N.horizontal[it])if(Me)N.horizontal[it]=N.horizontal[0];else{const Je=Gh(j,n.glyphMap,n.glyphPositions,n.imagePositions,C,De,m,"center",it,Ee,Q,u.ai.horizontal,!1,Ve,L,M);Je&&(N.horizontal[it]=Je,Me=Je.positionedLines.length===1)}We()}else{Ue==="auto"&&(Ue=Lf(qe));const Be=Gh(j,n.glyphMap,n.glyphPositions,n.imagePositions,C,De,m,qe,Ue,Ee,Q,u.ai.horizontal,!1,Ve,L,M);Be&&(N.horizontal[Ue]=Be),We(),xu(de)&&y&&v&&(N.vertical=Gh(j,n.glyphMap,n.glyphPositions,n.imagePositions,C,De,m,qe,Ue,Ee,Q,u.ai.vertical,!1,Ve,L,M))}}let ue=!1;if(k.icon&&k.icon.name){const de=n.imageMap[k.icon.name];de&&(H=h2(n.imagePositions[k.icon.name],s.get("icon-offset").evaluate(k,{},n.canonical),s.get("icon-anchor").evaluate(k,{},n.canonical)),ue=!!de.sdf,n.bucket.sdfIcons===void 0?n.bucket.sdfIcons=ue:n.bucket.sdfIcons!==ue&&Ar("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(de.pixelRatio!==n.bucket.pixelRatio||s.get("icon-rotate").constantOr(1)!==0)&&(n.bucket.iconsNeedLinear=!0))}const ie=uv(N.horizontal)||N.vertical;n.bucket.iconsInText=!!ie&&ie.iconsInText,(ie||H)&&C2(n.bucket,k,N,H,n.imageMap,h,L,O,Q,ue,n.canonical)}n.showCollisionBoxes&&n.bucket.generateCollisionDebugBuffers()},u.br=_f,u.bs=mf,u.bt=yf,u.bu=class{constructor(n){this._marks={start:[n.url,"start"].join("#"),end:[n.url,"end"].join("#"),measure:n.url.toString()},performance.mark(this._marks.start)}finish(){performance.mark(this._marks.end);let n=performance.getEntriesByName(this._marks.measure);return n.length===0&&(performance.measure(this._marks.measure,this._marks.start,this._marks.end),n=performance.getEntriesByName(this._marks.measure),performance.clearMarks(this._marks.start),performance.clearMarks(this._marks.end),performance.clearMeasures(this._marks.measure)),n}},u.bv=xf,u.bw=vo,u.bx=function(n,e,s,a,h){return B(this,void 0,void 0,function*(){if(ce())try{return yield Vt(n,e,s,a,h)}catch{}return function(m,y,v,S,k){const C=m.width,M=m.height;Ft&&At||(Ft=new OffscreenCanvas(C,M),At=Ft.getContext("2d",{willReadFrequently:!0})),Ft.width=C,Ft.height=M,At.drawImage(m,0,0,C,M);const L=At.getImageData(y,v,S,k);return At.clearRect(0,0,C,M),L.data}(n,e,s,a,h)})},u.by=G_,u.bz=D,u.c=ni,u.d=function(n,e){const s=new Image;s.onload=()=>{e(null,s),URL.revokeObjectURL(s.src),s.onload=null,window.requestAnimationFrame(()=>{s.src=mt})},s.onerror=()=>e(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const a=new Blob([new Uint8Array(n)],{type:"image/png"});s.src=n.byteLength?URL.createObjectURL(a):mt},u.e=Ze,u.f=function(n,e){return ss(Ze(n,{type:"json"}),e)},u.g=Un,u.h=dn,u.i=$r,u.j=as,u.k=os,u.l=Xo,u.m=ss,u.n=function(n){return new xf(n).readFields(s2,[])},u.o=function(n,e,s){if(!n.length)return s(null,[]);let a=n.length;const h=new Array(n.length);let m=null;n.forEach((y,v)=>{e(y,(S,k)=>{S&&(m=S),h[v]=k,--a==0&&s(m,h)})})},u.p=k_,u.q=Uu,u.r=dr,u.s=Ri,u.t=Xp,u.u=$e,u.v=ve,u.w=Ar,u.x=sl,u.y=ji,u.z=function([n,e,s]){return e+=90,e*=Math.PI/180,s*=Math.PI/180,{x:n*Math.cos(e)*Math.sin(s),y:n*Math.sin(e)*Math.sin(s),z:n*Math.cos(s)}}}),b(["./shared"],function(u){class B{constructor(A){this.keyCache={},A&&this.replace(A)}replace(A){this._layerConfigs={},this._layers={},this.update(A,[])}update(A,R){for(const W of A){this._layerConfigs[W.id]=W;const X=this._layers[W.id]=u.aC(W);X._featureFilter=u.a6(X.filter),this.keyCache[W.id]&&delete this.keyCache[W.id]}for(const W of R)delete this.keyCache[W],delete this._layerConfigs[W],delete this._layers[W];this.familiesBySource={};const V=u.bl(Object.values(this._layerConfigs),this.keyCache);for(const W of V){const X=W.map(Se=>this._layers[Se.id]),he=X[0];if(he.visibility==="none")continue;const se=he.source||"";let J=this.familiesBySource[se];J||(J=this.familiesBySource[se]={});const le=he.sourceLayer||"_geojsonTileLayer";let xe=J[le];xe||(xe=J[le]=[]),xe.push(X)}}}class D{constructor(A){const R={},V=[];for(const se in A){const J=A[se],le=R[se]={};for(const xe in J){const Se=J[+xe];if(!Se||Se.bitmap.width===0||Se.bitmap.height===0)continue;const Ie={x:0,y:0,w:Se.bitmap.width+2,h:Se.bitmap.height+2};V.push(Ie),le[xe]={rect:Ie,metrics:Se.metrics}}}const{w:W,h:X}=u.p(V),he=new u.q({width:W||1,height:X||1});for(const se in A){const J=A[se];for(const le in J){const xe=J[+le];if(!xe||xe.bitmap.width===0||xe.bitmap.height===0)continue;const Se=R[se][le].rect;u.q.copy(xe.bitmap,he,{x:0,y:0},{x:Se.x+1,y:Se.y+1},xe.bitmap)}}this.image=he,this.positions=R}}u.bm("GlyphAtlas",D);class ne{constructor(A){this.tileID=new u.O(A.tileID.overscaledZ,A.tileID.wrap,A.tileID.canonical.z,A.tileID.canonical.x,A.tileID.canonical.y),this.uid=A.uid,this.zoom=A.zoom,this.pixelRatio=A.pixelRatio,this.tileSize=A.tileSize,this.source=A.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=A.showCollisionBoxes,this.collectResourceTiming=!!A.collectResourceTiming,this.returnDependencies=!!A.returnDependencies,this.promoteId=A.promoteId,this.inFlightDependencies=[],this.dependencySentinel=-1}parse(A,R,V,W,X){this.status="parsing",this.data=A,this.collisionBoxArray=new u.a3;const he=new u.bn(Object.keys(A.layers).sort()),se=new u.bo(this.tileID,this.promoteId);se.bucketLayerIDs=[];const J={},le={featureIndex:se,iconDependencies:{},patternDependencies:{},glyphDependencies:{},availableImages:V},xe=R.familiesBySource[this.source];for(const Tt in xe){const St=A.layers[Tt];if(!St)continue;St.version===1&&u.w(`Vector tile source "${this.source}" layer "${Tt}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const qr=he.encode(Tt),Ut=[];for(let _r=0;_r<St.length;_r++){const Rr=St.feature(_r),$n=se.getId(Rr,Tt);Ut.push({feature:Rr,id:$n,index:_r,sourceLayerIndex:qr})}for(const _r of xe[Tt]){const Rr=_r[0];Rr.source!==this.source&&u.w(`layer.source = ${Rr.source} does not equal this.source = ${this.source}`),Rr.minzoom&&this.zoom<Math.floor(Rr.minzoom)||Rr.maxzoom&&this.zoom>=Rr.maxzoom||Rr.visibility!=="none"&&(re(_r,this.zoom,V),(J[Rr.id]=Rr.createBucket({index:se.bucketLayerIDs.length,layers:_r,zoom:this.zoom,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:qr,sourceID:this.source})).populate(Ut,le,this.tileID.canonical),se.bucketLayerIDs.push(_r.map($n=>$n.id)))}}let Se,Ie,nt,lt;const Xe=u.aH(le.glyphDependencies,Tt=>Object.keys(Tt).map(Number));this.inFlightDependencies.forEach(Tt=>Tt==null?void 0:Tt.cancel()),this.inFlightDependencies=[];const st=++this.dependencySentinel;Object.keys(Xe).length?this.inFlightDependencies.push(W.send("getGlyphs",{uid:this.uid,stacks:Xe,source:this.source,tileID:this.tileID,type:"glyphs"},(Tt,St)=>{st===this.dependencySentinel&&(Se||(Se=Tt,Ie=St,Bt.call(this)))})):Ie={};const ct=Object.keys(le.iconDependencies);ct.length?this.inFlightDependencies.push(W.send("getImages",{icons:ct,source:this.source,tileID:this.tileID,type:"icons"},(Tt,St)=>{st===this.dependencySentinel&&(Se||(Se=Tt,nt=St,Bt.call(this)))})):nt={};const Mt=Object.keys(le.patternDependencies);function Bt(){if(Se)return X(Se);if(Ie&&nt&&lt){const Tt=new D(Ie),St=new u.bp(nt,lt);for(const qr in J){const Ut=J[qr];Ut instanceof u.a4?(re(Ut.layers,this.zoom,V),u.bq({bucket:Ut,glyphMap:Ie,glyphPositions:Tt.positions,imageMap:nt,imagePositions:St.iconPositions,showCollisionBoxes:this.showCollisionBoxes,canonical:this.tileID.canonical})):Ut.hasPattern&&(Ut instanceof u.br||Ut instanceof u.bs||Ut instanceof u.bt)&&(re(Ut.layers,this.zoom,V),Ut.addFeatures(le,this.tileID.canonical,St.patternPositions))}this.status="done",X(null,{buckets:Object.values(J).filter(qr=>!qr.isEmpty()),featureIndex:se,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Tt.image,imageAtlas:St,glyphMap:this.returnDependencies?Ie:null,iconMap:this.returnDependencies?nt:null,glyphPositions:this.returnDependencies?Tt.positions:null})}}Mt.length?this.inFlightDependencies.push(W.send("getImages",{icons:Mt,source:this.source,tileID:this.tileID,type:"patterns"},(Tt,St)=>{st===this.dependencySentinel&&(Se||(Se=Tt,lt=St,Bt.call(this)))})):lt={},Bt.call(this)}}function re(Z,A,R){const V=new u.a8(A);for(const W of Z)W.recalculate(V,R)}function te(Z,A){const R=u.l(Z.request,(V,W,X,he)=>{if(V)A(V);else if(W)try{const se=new u.bw.VectorTile(new u.bv(W));A(null,{vectorTile:se,rawData:W,cacheControl:X,expires:he})}catch(se){const J=new Uint8Array(W);let le=`Unable to parse the tile at ${Z.request.url}, `;le+=J[0]===31&&J[1]===139?"please make sure the data is not gzipped and that you have configured the relevant header in the server":`got error: ${se.messge}`,A(new Error(le))}});return()=>{R.cancel(),A()}}class _e{constructor(A,R,V,W){this.actor=A,this.layerIndex=R,this.availableImages=V,this.loadVectorData=W||te,this.fetching={},this.loading={},this.loaded={}}loadTile(A,R){const V=A.uid;this.loading||(this.loading={});const W=!!(A&&A.request&&A.request.collectResourceTiming)&&new u.bu(A.request),X=this.loading[V]=new ne(A);X.abort=this.loadVectorData(A,(he,se)=>{if(delete this.loading[V],he||!se)return X.status="done",this.loaded[V]=X,R(he);const J=se.rawData,le={};se.expires&&(le.expires=se.expires),se.cacheControl&&(le.cacheControl=se.cacheControl);const xe={};if(W){const Se=W.finish();Se&&(xe.resourceTiming=JSON.parse(JSON.stringify(Se)))}X.vectorTile=se.vectorTile,X.parse(se.vectorTile,this.layerIndex,this.availableImages,this.actor,(Se,Ie)=>{if(delete this.fetching[V],Se||!Ie)return R(Se);R(null,u.e({rawTileData:J.slice(0)},Ie,le,xe))}),this.loaded=this.loaded||{},this.loaded[V]=X,this.fetching[V]={rawTileData:J,cacheControl:le,resourceTiming:xe}})}reloadTile(A,R){const V=this.loaded,W=A.uid;if(V&&V[W]){const X=V[W];X.showCollisionBoxes=A.showCollisionBoxes,X.status==="parsing"?X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor,(he,se)=>{if(he||!se)return R(he,se);let J;if(this.fetching[W]){const{rawTileData:le,cacheControl:xe,resourceTiming:Se}=this.fetching[W];delete this.fetching[W],J=u.e({rawTileData:le.slice(0)},se,xe,Se)}else J=se;R(null,J)}):X.status==="done"&&(X.vectorTile?X.parse(X.vectorTile,this.layerIndex,this.availableImages,this.actor,R):R())}}abortTile(A,R){const V=this.loading,W=A.uid;V&&V[W]&&V[W].abort&&(V[W].abort(),delete V[W]),R()}removeTile(A,R){const V=this.loaded,W=A.uid;V&&V[W]&&delete V[W],R()}}class be{constructor(){this.loaded={}}loadTile(A,R){return u._(this,void 0,void 0,function*(){const{uid:V,encoding:W,rawImageData:X,redFactor:he,greenFactor:se,blueFactor:J,baseShift:le}=A,xe=X.width+2,Se=X.height+2,Ie=u.a(X)?new u.R({width:xe,height:Se},yield u.bx(X,-1,-1,xe,Se)):X,nt=new u.by(V,Ie,W,he,se,J,le);this.loaded=this.loaded||{},this.loaded[V]=nt,R(null,nt)})}removeTile(A){const R=this.loaded,V=A.uid;R&&R[V]&&delete R[V]}}function ke(Z,A){if(Z.length!==0){we(Z[0],A);for(var R=1;R<Z.length;R++)we(Z[R],!A)}}function we(Z,A){for(var R=0,V=0,W=0,X=Z.length,he=X-1;W<X;he=W++){var se=(Z[W][0]-Z[he][0])*(Z[he][1]+Z[W][1]),J=R+se;V+=Math.abs(R)>=Math.abs(se)?R-J+se:se-J+R,R=J}R+V>=0!=!!A&&Z.reverse()}var K=u.bz(function Z(A,R){var V,W=A&&A.type;if(W==="FeatureCollection")for(V=0;V<A.features.length;V++)Z(A.features[V],R);else if(W==="GeometryCollection")for(V=0;V<A.geometries.length;V++)Z(A.geometries[V],R);else if(W==="Feature")Z(A.geometry,R);else if(W==="Polygon")ke(A.coordinates,R);else if(W==="MultiPolygon")for(V=0;V<A.coordinates.length;V++)ke(A.coordinates[V],R);return A});const ee=u.bw.VectorTileFeature.prototype.toGeoJSON;var ce={exports:{}},ye=u.bA,Pe=u.bw.VectorTileFeature,Le=je;function je(Z,A){this.options=A||{},this.features=Z,this.length=Z.length}function Ze(Z,A){this.id=typeof Z.id=="number"?Z.id:void 0,this.type=Z.type,this.rawGeometry=Z.type===1?[Z.geometry]:Z.geometry,this.properties=Z.tags,this.extent=A||4096}je.prototype.feature=function(Z){return new Ze(this.features[Z],this.options.extent)},Ze.prototype.loadGeometry=function(){var Z=this.rawGeometry;this.geometry=[];for(var A=0;A<Z.length;A++){for(var R=Z[A],V=[],W=0;W<R.length;W++)V.push(new ye(R[W][0],R[W][1]));this.geometry.push(V)}return this.geometry},Ze.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Z=this.geometry,A=1/0,R=-1/0,V=1/0,W=-1/0,X=0;X<Z.length;X++)for(var he=Z[X],se=0;se<he.length;se++){var J=he[se];A=Math.min(A,J.x),R=Math.max(R,J.x),V=Math.min(V,J.y),W=Math.max(W,J.y)}return[A,V,R,W]},Ze.prototype.toGeoJSON=Pe.prototype.toGeoJSON;var kt=u.bB,rt=Le;function Mr(Z){var A=new kt;return function(R,V){for(var W in R.layers)V.writeMessage(3,Lr,R.layers[W])}(Z,A),A.finish()}function Lr(Z,A){var R;A.writeVarintField(15,Z.version||1),A.writeStringField(1,Z.name||""),A.writeVarintField(5,Z.extent||4096);var V={keys:[],values:[],keycache:{},valuecache:{}};for(R=0;R<Z.length;R++)V.feature=Z.feature(R),A.writeMessage(2,hn,V);var W=V.keys;for(R=0;R<W.length;R++)A.writeStringField(3,W[R]);var X=V.values;for(R=0;R<X.length;R++)A.writeMessage(4,He,X[R])}function hn(Z,A){var R=Z.feature;R.id!==void 0&&A.writeVarintField(1,R.id),A.writeMessage(2,Ar,Z),A.writeVarintField(3,R.type),A.writeMessage(4,$r,R)}function Ar(Z,A){var R=Z.feature,V=Z.keys,W=Z.values,X=Z.keycache,he=Z.valuecache;for(var se in R.properties){var J=R.properties[se],le=X[se];if(J!==null){le===void 0&&(V.push(se),X[se]=le=V.length-1),A.writeVarint(le);var xe=typeof J;xe!=="string"&&xe!=="boolean"&&xe!=="number"&&(J=JSON.stringify(J));var Se=xe+":"+J,Ie=he[Se];Ie===void 0&&(W.push(J),he[Se]=Ie=W.length-1),A.writeVarint(Ie)}}}function Qr(Z,A){return(A<<3)+(7&Z)}function En(Z){return Z<<1^Z>>31}function $r(Z,A){for(var R=Z.loadGeometry(),V=Z.type,W=0,X=0,he=R.length,se=0;se<he;se++){var J=R[se],le=1;V===1&&(le=J.length),A.writeVarint(Qr(1,le));for(var xe=V===3?J.length-1:J.length,Se=0;Se<xe;Se++){Se===1&&V!==1&&A.writeVarint(Qr(2,xe-1));var Ie=J[Se].x-W,nt=J[Se].y-X;A.writeVarint(En(Ie)),A.writeVarint(En(nt)),W+=Ie,X+=nt}V===3&&A.writeVarint(Qr(7,1))}}function He(Z,A){var R=typeof Z;R==="string"?A.writeStringField(1,Z):R==="boolean"?A.writeBooleanField(7,Z):R==="number"&&(Z%1!=0?A.writeDoubleField(3,Z):Z<0?A.writeSVarintField(6,Z):A.writeVarintField(5,Z))}ce.exports=Mr,ce.exports.fromVectorTileJs=Mr,ce.exports.fromGeojsonVt=function(Z,A){A=A||{};var R={};for(var V in Z)R[V]=new rt(Z[V].features,A),R[V].name=V,R[V].version=A.version,R[V].extent=A.extent;return Mr({layers:R})},ce.exports.GeoJSONWrapper=rt;var ht=u.bz(ce.exports);const mt={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Z=>Z},Vt=Math.fround||(Ft=new Float32Array(1),Z=>(Ft[0]=+Z,Ft[0]));var Ft;const At=3,or=5,ri=6;class dn{constructor(A){this.options=Object.assign(Object.create(mt),A),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(A){const{log:R,minZoom:V,maxZoom:W}=this.options;R&&console.time("total time");const X=`prepare ${A.length} points`;R&&console.time(X),this.points=A;const he=[];for(let J=0;J<A.length;J++){const le=A[J];if(!le.geometry)continue;const[xe,Se]=le.geometry.coordinates,Ie=Vt(ii(xe)),nt=Vt(Un(Se));he.push(Ie,nt,1/0,J,-1,1),this.options.reduce&&he.push(0)}let se=this.trees[W+1]=this._createTree(he);R&&console.timeEnd(X);for(let J=W;J>=V;J--){const le=+Date.now();se=this.trees[J]=this._createTree(this._cluster(se,J)),R&&console.log("z%d: %d clusters in %dms",J,se.numItems,+Date.now()-le)}return R&&console.timeEnd("total time"),this}getClusters(A,R){let V=((A[0]+180)%360+360)%360-180;const W=Math.max(-90,Math.min(90,A[1]));let X=A[2]===180?180:((A[2]+180)%360+360)%360-180;const he=Math.max(-90,Math.min(90,A[3]));if(A[2]-A[0]>=360)V=-180,X=180;else if(V>X){const Se=this.getClusters([V,W,180,he],R),Ie=this.getClusters([-180,W,X,he],R);return Se.concat(Ie)}const se=this.trees[this._limitZoom(R)],J=se.range(ii(V),Un(he),ii(X),Un(W)),le=se.data,xe=[];for(const Se of J){const Ie=this.stride*Se;xe.push(le[Ie+or]>1?ni(le,Ie,this.clusterProps):this.points[le[Ie+At]])}return xe}getChildren(A){const R=this._getOriginId(A),V=this._getOriginZoom(A),W="No cluster with the specified id.",X=this.trees[V];if(!X)throw new Error(W);const he=X.data;if(R*this.stride>=he.length)throw new Error(W);const se=this.options.radius/(this.options.extent*Math.pow(2,V-1)),J=X.within(he[R*this.stride],he[R*this.stride+1],se),le=[];for(const xe of J){const Se=xe*this.stride;he[Se+4]===A&&le.push(he[Se+or]>1?ni(he,Se,this.clusterProps):this.points[he[Se+At]])}if(le.length===0)throw new Error(W);return le}getLeaves(A,R,V){const W=[];return this._appendLeaves(W,A,R=R||10,V=V||0,0),W}getTile(A,R,V){const W=this.trees[this._limitZoom(A)],X=Math.pow(2,A),{extent:he,radius:se}=this.options,J=se/he,le=(V-J)/X,xe=(V+1+J)/X,Se={features:[]};return this._addTileFeatures(W.range((R-J)/X,le,(R+1+J)/X,xe),W.data,R,V,X,Se),R===0&&this._addTileFeatures(W.range(1-J/X,le,1,xe),W.data,X,V,X,Se),R===X-1&&this._addTileFeatures(W.range(0,le,J/X,xe),W.data,-1,V,X,Se),Se.features.length?Se:null}getClusterExpansionZoom(A){let R=this._getOriginZoom(A)-1;for(;R<=this.options.maxZoom;){const V=this.getChildren(A);if(R++,V.length!==1)break;A=V[0].properties.cluster_id}return R}_appendLeaves(A,R,V,W,X){const he=this.getChildren(R);for(const se of he){const J=se.properties;if(J&&J.cluster?X+J.point_count<=W?X+=J.point_count:X=this._appendLeaves(A,J.cluster_id,V,W,X):X<W?X++:A.push(se),A.length===V)break}return X}_createTree(A){const R=new u.av(A.length/this.stride|0,this.options.nodeSize,Float32Array);for(let V=0;V<A.length;V+=this.stride)R.add(A[V],A[V+1]);return R.finish(),R.data=A,R}_addTileFeatures(A,R,V,W,X,he){for(const se of A){const J=se*this.stride,le=R[J+or]>1;let xe,Se,Ie;if(le)xe=is(R,J,this.clusterProps),Se=R[J],Ie=R[J+1];else{const Xe=this.points[R[J+At]];xe=Xe.properties;const[st,ct]=Xe.geometry.coordinates;Se=ii(st),Ie=Un(ct)}const nt={type:1,geometry:[[Math.round(this.options.extent*(Se*X-V)),Math.round(this.options.extent*(Ie*X-W))]],tags:xe};let lt;lt=le||this.options.generateId?R[J+At]:this.points[R[J+At]].id,lt!==void 0&&(nt.id=lt),he.features.push(nt)}}_limitZoom(A){return Math.max(this.options.minZoom,Math.min(Math.floor(+A),this.options.maxZoom+1))}_cluster(A,R){const{radius:V,extent:W,reduce:X,minPoints:he}=this.options,se=V/(W*Math.pow(2,R)),J=A.data,le=[],xe=this.stride;for(let Se=0;Se<J.length;Se+=xe){if(J[Se+2]<=R)continue;J[Se+2]=R;const Ie=J[Se],nt=J[Se+1],lt=A.within(J[Se],J[Se+1],se),Xe=J[Se+or];let st=Xe;for(const ct of lt){const Mt=ct*xe;J[Mt+2]>R&&(st+=J[Mt+or])}if(st>Xe&&st>=he){let ct,Mt=Ie*Xe,Bt=nt*Xe,Tt=-1;const St=((Se/xe|0)<<5)+(R+1)+this.points.length;for(const qr of lt){const Ut=qr*xe;if(J[Ut+2]<=R)continue;J[Ut+2]=R;const _r=J[Ut+or];Mt+=J[Ut]*_r,Bt+=J[Ut+1]*_r,J[Ut+4]=St,X&&(ct||(ct=this._map(J,Se,!0),Tt=this.clusterProps.length,this.clusterProps.push(ct)),X(ct,this._map(J,Ut)))}J[Se+4]=St,le.push(Mt/st,Bt/st,1/0,St,-1,st),X&&le.push(Tt)}else{for(let ct=0;ct<xe;ct++)le.push(J[Se+ct]);if(st>1)for(const ct of lt){const Mt=ct*xe;if(!(J[Mt+2]<=R)){J[Mt+2]=R;for(let Bt=0;Bt<xe;Bt++)le.push(J[Mt+Bt])}}}}return le}_getOriginId(A){return A-this.points.length>>5}_getOriginZoom(A){return(A-this.points.length)%32}_map(A,R,V){if(A[R+or]>1){const he=this.clusterProps[A[R+ri]];return V?Object.assign({},he):he}const W=this.points[A[R+At]].properties,X=this.options.map(W);return V&&X===W?Object.assign({},X):X}}function ni(Z,A,R){return{type:"Feature",id:Z[A+At],properties:is(Z,A,R),geometry:{type:"Point",coordinates:[(V=Z[A],360*(V-.5)),Ho(Z[A+1])]}};var V}function is(Z,A,R){const V=Z[A+or],W=V>=1e4?`${Math.round(V/1e3)}k`:V>=1e3?Math.round(V/100)/10+"k":V,X=Z[A+ri],he=X===-1?{}:Object.assign({},R[X]);return Object.assign(he,{cluster:!0,cluster_id:Z[A+At],point_count:V,point_count_abbreviated:W})}function ii(Z){return Z/360+.5}function Un(Z){const A=Math.sin(Z*Math.PI/180),R=.5-.25*Math.log((1+A)/(1-A))/Math.PI;return R<0?0:R>1?1:R}function Ho(Z){const A=(180-360*Z)*Math.PI/180;return 360*Math.atan(Math.exp(A))/Math.PI-90}function ss(Z,A,R,V){for(var W,X=V,he=R-A>>1,se=R-A,J=Z[A],le=Z[A+1],xe=Z[R],Se=Z[R+1],Ie=A+3;Ie<R;Ie+=3){var nt=Xo(Z[Ie],Z[Ie+1],J,le,xe,Se);if(nt>X)W=Ie,X=nt;else if(nt===X){var lt=Math.abs(Ie-he);lt<se&&(W=Ie,se=lt)}}X>V&&(W-A>3&&ss(Z,A,W,V),Z[W+2]=X,R-W>3&&ss(Z,W,R,V))}function Xo(Z,A,R,V,W,X){var he=W-R,se=X-V;if(he!==0||se!==0){var J=((Z-R)*he+(A-V)*se)/(he*he+se*se);J>1?(R=W,V=X):J>0&&(R+=he*J,V+=se*J)}return(he=Z-R)*he+(se=A-V)*se}function Ri(Z,A,R,V){var W={id:Z===void 0?null:Z,type:A,geometry:R,tags:V,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return function(X){var he=X.geometry,se=X.type;if(se==="Point"||se==="MultiPoint"||se==="LineString")to(X,he);else if(se==="Polygon"||se==="MultiLineString")for(var J=0;J<he.length;J++)to(X,he[J]);else if(se==="MultiPolygon")for(J=0;J<he.length;J++)for(var le=0;le<he[J].length;le++)to(X,he[J][le])}(W),W}function to(Z,A){for(var R=0;R<A.length;R+=3)Z.minX=Math.min(Z.minX,A[R]),Z.minY=Math.min(Z.minY,A[R+1]),Z.maxX=Math.max(Z.maxX,A[R]),Z.maxY=Math.max(Z.maxY,A[R+1])}function Ss(Z,A,R,V){if(A.geometry){var W=A.geometry.coordinates,X=A.geometry.type,he=Math.pow(R.tolerance/((1<<R.maxZoom)*R.extent),2),se=[],J=A.id;if(R.promoteId?J=A.properties[R.promoteId]:R.generateId&&(J=V||0),X==="Point")os(W,se);else if(X==="MultiPoint")for(var le=0;le<W.length;le++)os(W[le],se);else if(X==="LineString")as(W,se,he,!1);else if(X==="MultiLineString"){if(R.lineMetrics){for(le=0;le<W.length;le++)as(W[le],se=[],he,!1),Z.push(Ri(J,"LineString",se,A.properties));return}Ts(W,se,he,!1)}else if(X==="Polygon")Ts(W,se,he,!0);else{if(X!=="MultiPolygon"){if(X==="GeometryCollection"){for(le=0;le<A.geometry.geometries.length;le++)Ss(Z,{id:J,geometry:A.geometry.geometries[le],properties:A.properties},R,V);return}throw new Error("Input data is not a valid GeoJSON object.")}for(le=0;le<W.length;le++){var xe=[];Ts(W[le],xe,he,!0),se.push(xe)}}Z.push(Ri(J,X,se,A.properties))}}function os(Z,A){A.push(ve(Z[0])),A.push(pn(Z[1])),A.push(0)}function as(Z,A,R,V){for(var W,X,he=0,se=0;se<Z.length;se++){var J=ve(Z[se][0]),le=pn(Z[se][1]);A.push(J),A.push(le),A.push(0),se>0&&(he+=V?(W*le-J*X)/2:Math.sqrt(Math.pow(J-W,2)+Math.pow(le-X,2))),W=J,X=le}var xe=A.length-3;A[2]=1,ss(A,0,xe,R),A[xe+2]=1,A.size=Math.abs(he),A.start=0,A.end=A.size}function Ts(Z,A,R,V){for(var W=0;W<Z.length;W++){var X=[];as(Z[W],X,R,V),A.push(X)}}function ve(Z){return Z/360+.5}function pn(Z){var A=Math.sin(Z*Math.PI/180),R=.5-.25*Math.log((1+A)/(1-A))/Math.PI;return R<0?0:R>1?1:R}function jn(Z,A,R,V,W,X,he,se){if(V/=A,X>=(R/=A)&&he<V)return Z;if(he<R||X>=V)return null;for(var J=[],le=0;le<Z.length;le++){var xe=Z[le],Se=xe.geometry,Ie=xe.type,nt=W===0?xe.minX:xe.minY,lt=W===0?xe.maxX:xe.maxY;if(nt>=R&&lt<V)J.push(xe);else if(!(lt<R||nt>=V)){var Xe=[];if(Ie==="Point"||Ie==="MultiPoint")Nt(Se,Xe,R,V,W);else if(Ie==="LineString")Et(Se,Xe,R,V,W,!1,se.lineMetrics);else if(Ie==="MultiLineString")ro(Se,Xe,R,V,W,!1);else if(Ie==="Polygon")ro(Se,Xe,R,V,W,!0);else if(Ie==="MultiPolygon")for(var st=0;st<Se.length;st++){var ct=[];ro(Se[st],ct,R,V,W,!0),ct.length&&Xe.push(ct)}if(Xe.length){if(se.lineMetrics&&Ie==="LineString"){for(st=0;st<Xe.length;st++)J.push(Ri(xe.id,Ie,Xe[st],xe.tags));continue}Ie!=="LineString"&&Ie!=="MultiLineString"||(Xe.length===1?(Ie="LineString",Xe=Xe[0]):Ie="MultiLineString"),Ie!=="Point"&&Ie!=="MultiPoint"||(Ie=Xe.length===3?"Point":"MultiPoint"),J.push(Ri(xe.id,Ie,Xe,xe.tags))}}}return J.length?J:null}function Nt(Z,A,R,V,W){for(var X=0;X<Z.length;X+=3){var he=Z[X+W];he>=R&&he<=V&&(A.push(Z[X]),A.push(Z[X+1]),A.push(Z[X+2]))}}function Et(Z,A,R,V,W,X,he){for(var se,J,le=_i(Z),xe=W===0?La:no,Se=Z.start,Ie=0;Ie<Z.length-3;Ie+=3){var nt=Z[Ie],lt=Z[Ie+1],Xe=Z[Ie+2],st=Z[Ie+3],ct=Z[Ie+4],Mt=W===0?nt:lt,Bt=W===0?st:ct,Tt=!1;he&&(se=Math.sqrt(Math.pow(nt-st,2)+Math.pow(lt-ct,2))),Mt<R?Bt>R&&(J=xe(le,nt,lt,st,ct,R),he&&(le.start=Se+se*J)):Mt>V?Bt<V&&(J=xe(le,nt,lt,st,ct,V),he&&(le.start=Se+se*J)):Fi(le,nt,lt,Xe),Bt<R&&Mt>=R&&(J=xe(le,nt,lt,st,ct,R),Tt=!0),Bt>V&&Mt<=V&&(J=xe(le,nt,lt,st,ct,V),Tt=!0),!X&&Tt&&(he&&(le.end=Se+se*J),A.push(le),le=_i(Z)),he&&(Se+=se)}var St=Z.length-3;nt=Z[St],lt=Z[St+1],Xe=Z[St+2],(Mt=W===0?nt:lt)>=R&&Mt<=V&&Fi(le,nt,lt,Xe),St=le.length-3,X&&St>=3&&(le[St]!==le[0]||le[St+1]!==le[1])&&Fi(le,le[0],le[1],le[2]),le.length&&A.push(le)}function _i(Z){var A=[];return A.size=Z.size,A.start=Z.start,A.end=Z.end,A}function ro(Z,A,R,V,W,X){for(var he=0;he<Z.length;he++)Et(Z[he],A,R,V,W,X,!1)}function Fi(Z,A,R,V){Z.push(A),Z.push(R),Z.push(V)}function La(Z,A,R,V,W,X){var he=(X-A)/(V-A);return Z.push(X),Z.push(R+(W-R)*he),Z.push(1),he}function no(Z,A,R,V,W,X){var he=(X-R)/(W-R);return Z.push(A+(V-A)*he),Z.push(X),Z.push(1),he}function ls(Z,A){for(var R=[],V=0;V<Z.length;V++){var W,X=Z[V],he=X.type;if(he==="Point"||he==="MultiPoint"||he==="LineString")W=ks(X.geometry,A);else if(he==="MultiLineString"||he==="Polygon"){W=[];for(var se=0;se<X.geometry.length;se++)W.push(ks(X.geometry[se],A))}else if(he==="MultiPolygon")for(W=[],se=0;se<X.geometry.length;se++){for(var J=[],le=0;le<X.geometry[se].length;le++)J.push(ks(X.geometry[se][le],A));W.push(J)}R.push(Ri(X.id,he,W,X.tags))}return R}function ks(Z,A){var R=[];R.size=Z.size,Z.start!==void 0&&(R.start=Z.start,R.end=Z.end);for(var V=0;V<Z.length;V+=3)R.push(Z[V]+A,Z[V+1],Z[V+2]);return R}function Re(Z,A){if(Z.transformed)return Z;var R,V,W,X=1<<Z.z,he=Z.x,se=Z.y;for(R=0;R<Z.features.length;R++){var J=Z.features[R],le=J.geometry,xe=J.type;if(J.geometry=[],xe===1)for(V=0;V<le.length;V+=2)J.geometry.push(vi(le[V],le[V+1],A,X,he,se));else for(V=0;V<le.length;V++){var Se=[];for(W=0;W<le[V].length;W+=2)Se.push(vi(le[V][W],le[V][W+1],A,X,he,se));J.geometry.push(Se)}}return Z.transformed=!0,Z}function vi(Z,A,R,V,W,X){return[Math.round(R*(Z*V-W)),Math.round(R*(A*V-X))]}function er(Z,A,R,V,W){for(var X=A===W.maxZoom?0:W.tolerance/((1<<A)*W.extent),he={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:R,y:V,z:A,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},se=0;se<Z.length;se++){he.numFeatures++,Es(he,Z[se],X,W);var J=Z[se].minX,le=Z[se].minY,xe=Z[se].maxX,Se=Z[se].maxY;J<he.minX&&(he.minX=J),le<he.minY&&(he.minY=le),xe>he.maxX&&(he.maxX=xe),Se>he.maxY&&(he.maxY=Se)}return he}function Es(Z,A,R,V){var W=A.geometry,X=A.type,he=[];if(X==="Point"||X==="MultiPoint")for(var se=0;se<W.length;se+=3)he.push(W[se]),he.push(W[se+1]),Z.numPoints++,Z.numSimplified++;else if(X==="LineString")Bi(he,W,Z,R,!1,!1);else if(X==="MultiLineString"||X==="Polygon")for(se=0;se<W.length;se++)Bi(he,W[se],Z,R,X==="Polygon",se===0);else if(X==="MultiPolygon")for(var J=0;J<W.length;J++){var le=W[J];for(se=0;se<le.length;se++)Bi(he,le[se],Z,R,!0,se===0)}if(he.length){var xe=A.tags||null;if(X==="LineString"&&V.lineMetrics){for(var Se in xe={},A.tags)xe[Se]=A.tags[Se];xe.mapbox_clip_start=W.start/W.size,xe.mapbox_clip_end=W.end/W.size}var Ie={geometry:he,type:X==="Polygon"||X==="MultiPolygon"?3:X==="LineString"||X==="MultiLineString"?2:1,tags:xe};A.id!==null&&(Ie.id=A.id),Z.features.push(Ie)}}function Bi(Z,A,R,V,W,X){var he=V*V;if(V>0&&A.size<(W?he:V))R.numPoints+=A.length/3;else{for(var se=[],J=0;J<A.length;J+=3)(V===0||A[J+2]>he)&&(R.numSimplified++,se.push(A[J]),se.push(A[J+1])),R.numPoints++;W&&function(le,xe){for(var Se=0,Ie=0,nt=le.length,lt=nt-2;Ie<nt;lt=Ie,Ie+=2)Se+=(le[Ie]-le[lt])*(le[Ie+1]+le[lt+1]);if(Se>0===xe)for(Ie=0,nt=le.length;Ie<nt/2;Ie+=2){var Xe=le[Ie],st=le[Ie+1];le[Ie]=le[nt-2-Ie],le[Ie+1]=le[nt-1-Ie],le[nt-2-Ie]=Xe,le[nt-1-Ie]=st}}(se,X),Z.push(se)}}function Oe(Z,A){var R=(A=this.options=function(W,X){for(var he in X)W[he]=X[he];return W}(Object.create(this.options),A)).debug;if(R&&console.time("preprocess data"),A.maxZoom<0||A.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(A.promoteId&&A.generateId)throw new Error("promoteId and generateId cannot be used together.");var V=function(W,X){var he=[];if(W.type==="FeatureCollection")for(var se=0;se<W.features.length;se++)Ss(he,W.features[se],X,se);else Ss(he,W.type==="Feature"?W:{geometry:W},X);return he}(Z,A);this.tiles={},this.tileCoords=[],R&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",A.indexMaxZoom,A.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),V=function(W,X){var he=X.buffer/X.extent,se=W,J=jn(W,1,-1-he,he,0,-1,2,X),le=jn(W,1,1-he,2+he,0,-1,2,X);return(J||le)&&(se=jn(W,1,-he,1+he,0,-1,2,X)||[],J&&(se=ls(J,1).concat(se)),le&&(se=se.concat(ls(le,-1)))),se}(V,A),V.length&&this.splitTile(V,0,0,0),R&&(V.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ft(Z,A,R){return 32*((1<<Z)*R+A)+Z}function ut(Z,A){return A?Z.properties[A]:Z.id}function Jr(Z,A){if(Z==null)return!0;if(Z.type==="Feature")return ut(Z,A)!=null;if(Z.type==="FeatureCollection"){const R=new Set;for(const V of Z.features){const W=ut(V,A);if(W==null||R.has(W))return!1;R.add(W)}return!0}return!1}function xi(Z,A){const R=new Map;if(Z!=null)if(Z.type==="Feature")R.set(ut(Z,A),Z);else for(const V of Z.features)R.set(ut(V,A),V);return R}Oe.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},Oe.prototype.splitTile=function(Z,A,R,V,W,X,he){for(var se=[Z,A,R,V],J=this.options,le=J.debug;se.length;){V=se.pop(),R=se.pop(),A=se.pop(),Z=se.pop();var xe=1<<A,Se=ft(A,R,V),Ie=this.tiles[Se];if(!Ie&&(le>1&&console.time("creation"),Ie=this.tiles[Se]=er(Z,A,R,V,J),this.tileCoords.push({z:A,x:R,y:V}),le)){le>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",A,R,V,Ie.numFeatures,Ie.numPoints,Ie.numSimplified),console.timeEnd("creation"));var nt="z"+A;this.stats[nt]=(this.stats[nt]||0)+1,this.total++}if(Ie.source=Z,W){if(A===J.maxZoom||A===W)continue;var lt=1<<W-A;if(R!==Math.floor(X/lt)||V!==Math.floor(he/lt))continue}else if(A===J.indexMaxZoom||Ie.numPoints<=J.indexMaxPoints)continue;if(Ie.source=null,Z.length!==0){le>1&&console.time("clipping");var Xe,st,ct,Mt,Bt,Tt,St=.5*J.buffer/J.extent,qr=.5-St,Ut=.5+St,_r=1+St;Xe=st=ct=Mt=null,Bt=jn(Z,xe,R-St,R+Ut,0,Ie.minX,Ie.maxX,J),Tt=jn(Z,xe,R+qr,R+_r,0,Ie.minX,Ie.maxX,J),Z=null,Bt&&(Xe=jn(Bt,xe,V-St,V+Ut,1,Ie.minY,Ie.maxY,J),st=jn(Bt,xe,V+qr,V+_r,1,Ie.minY,Ie.maxY,J),Bt=null),Tt&&(ct=jn(Tt,xe,V-St,V+Ut,1,Ie.minY,Ie.maxY,J),Mt=jn(Tt,xe,V+qr,V+_r,1,Ie.minY,Ie.maxY,J),Tt=null),le>1&&console.timeEnd("clipping"),se.push(Xe||[],A+1,2*R,2*V),se.push(st||[],A+1,2*R,2*V+1),se.push(ct||[],A+1,2*R+1,2*V),se.push(Mt||[],A+1,2*R+1,2*V+1)}}},Oe.prototype.getTile=function(Z,A,R){var V=this.options,W=V.extent,X=V.debug;if(Z<0||Z>24)return null;var he=1<<Z,se=ft(Z,A=(A%he+he)%he,R);if(this.tiles[se])return Re(this.tiles[se],W);X>1&&console.log("drilling down to z%d-%d-%d",Z,A,R);for(var J,le=Z,xe=A,Se=R;!J&&le>0;)le--,xe=Math.floor(xe/2),Se=Math.floor(Se/2),J=this.tiles[ft(le,xe,Se)];return J&&J.source?(X>1&&console.log("found parent tile z%d-%d-%d",le,xe,Se),X>1&&console.time("drilling down"),this.splitTile(J.source,le,xe,Se,Z,A,R),X>1&&console.timeEnd("drilling down"),this.tiles[se]?Re(this.tiles[se],W):null):null};class dt extends _e{constructor(A,R,V,W){super(A,R,V),this._dataUpdateable=new Map,this.loadGeoJSON=(X,he)=>{const{promoteId:se}=X;if(X.request)return u.f(X.request,(J,le,xe,Se)=>{this._dataUpdateable=Jr(le,se)?xi(le,se):void 0,he(J,le,xe,Se)});if(typeof X.data=="string")try{const J=JSON.parse(X.data);this._dataUpdateable=Jr(J,se)?xi(J,se):void 0,he(null,J)}catch{he(new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`))}else X.dataDiff?this._dataUpdateable?(function(J,le,xe){var Se,Ie,nt,lt;if(le.removeAll&&J.clear(),le.remove)for(const Xe of le.remove)J.delete(Xe);if(le.add)for(const Xe of le.add){const st=ut(Xe,xe);st!=null&&J.set(st,Xe)}if(le.update)for(const Xe of le.update){let st=J.get(Xe.id);if(st==null)continue;const ct=!Xe.removeAllProperties&&(((Se=Xe.removeProperties)===null||Se===void 0?void 0:Se.length)>0||((Ie=Xe.addOrUpdateProperties)===null||Ie===void 0?void 0:Ie.length)>0);if((Xe.newGeometry||Xe.removeAllProperties||ct)&&(st=Object.assign({},st),J.set(Xe.id,st),ct&&(st.properties=Object.assign({},st.properties))),Xe.newGeometry&&(st.geometry=Xe.newGeometry),Xe.removeAllProperties)st.properties={};else if(((nt=Xe.removeProperties)===null||nt===void 0?void 0:nt.length)>0)for(const Mt of Xe.removeProperties)Object.prototype.hasOwnProperty.call(st.properties,Mt)&&delete st.properties[Mt];if(((lt=Xe.addOrUpdateProperties)===null||lt===void 0?void 0:lt.length)>0)for(const{key:Mt,value:Bt}of Xe.addOrUpdateProperties)st.properties[Mt]=Bt}}(this._dataUpdateable,X.dataDiff,se),he(null,{type:"FeatureCollection",features:Array.from(this._dataUpdateable.values())})):he(new Error(`Cannot update existing geojson data in ${X.source}`)):he(new Error(`Input data given to '${X.source}' is not a valid GeoJSON object.`));return{cancel:()=>{}}},this.loadVectorData=this.loadGeoJSONTile,W&&(this.loadGeoJSON=W)}loadGeoJSONTile(A,R){const V=A.tileID.canonical;if(!this._geoJSONIndex)return R(null,null);const W=this._geoJSONIndex.getTile(V.z,V.x,V.y);if(!W)return R(null,null);const X=new class{constructor(se){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=u.N,this.length=se.length,this._features=se}feature(se){return new class{constructor(J){this._feature=J,this.extent=u.N,this.type=J.type,this.properties=J.tags,"id"in J&&!isNaN(J.id)&&(this.id=parseInt(J.id,10))}loadGeometry(){if(this._feature.type===1){const J=[];for(const le of this._feature.geometry)J.push([new u.P(le[0],le[1])]);return J}{const J=[];for(const le of this._feature.geometry){const xe=[];for(const Se of le)xe.push(new u.P(Se[0],Se[1]));J.push(xe)}return J}}toGeoJSON(J,le,xe){return ee.call(this,J,le,xe)}}(this._features[se])}}(W.features);let he=ht(X);he.byteOffset===0&&he.byteLength===he.buffer.byteLength||(he=new Uint8Array(he)),R(null,{vectorTile:X,rawData:he.buffer})}loadData(A,R){var V;(V=this._pendingRequest)===null||V===void 0||V.cancel(),this._pendingCallback&&this._pendingCallback(null,{abandoned:!0});const W=!!(A&&A.request&&A.request.collectResourceTiming)&&new u.bu(A.request);this._pendingCallback=R,this._pendingRequest=this.loadGeoJSON(A,(X,he)=>{if(delete this._pendingCallback,delete this._pendingRequest,X||!he)return R(X);if(typeof he!="object")return R(new Error(`Input data given to '${A.source}' is not a valid GeoJSON object.`));{K(he,!0);try{if(A.filter){const J=u.bC(A.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(J.result==="error")throw new Error(J.value.map(xe=>`${xe.key}: ${xe.message}`).join(", "));he={type:"FeatureCollection",features:he.features.filter(xe=>J.value.evaluate({zoom:0},xe))}}this._geoJSONIndex=A.cluster?new dn(function({superclusterOptions:J,clusterProperties:le}){if(!le||!J)return J;const xe={},Se={},Ie={accumulated:null,zoom:0},nt={properties:null},lt=Object.keys(le);for(const Xe of lt){const[st,ct]=le[Xe],Mt=u.bC(ct),Bt=u.bC(typeof st=="string"?[st,["accumulated"],["get",Xe]]:st);xe[Xe]=Mt.value,Se[Xe]=Bt.value}return J.map=Xe=>{nt.properties=Xe;const st={};for(const ct of lt)st[ct]=xe[ct].evaluate(Ie,nt);return st},J.reduce=(Xe,st)=>{nt.properties=st;for(const ct of lt)Ie.accumulated=Xe[ct],Xe[ct]=Se[ct].evaluate(Ie,nt)},J}(A)).load(he.features):function(J,le){return new Oe(J,le)}(he,A.geojsonVtOptions)}catch(J){return R(J)}this.loaded={};const se={};if(W){const J=W.finish();J&&(se.resourceTiming={},se.resourceTiming[A.source]=JSON.parse(JSON.stringify(J)))}R(null,se)}})}reloadTile(A,R){const V=this.loaded;return V&&V[A.uid]?super.reloadTile(A,R):this.loadTile(A,R)}removeSource(A,R){this._pendingCallback&&this._pendingCallback(null,{abandoned:!0}),R()}getClusterExpansionZoom(A,R){try{R(null,this._geoJSONIndex.getClusterExpansionZoom(A.clusterId))}catch(V){R(V)}}getClusterChildren(A,R){try{R(null,this._geoJSONIndex.getChildren(A.clusterId))}catch(V){R(V)}}getClusterLeaves(A,R){try{R(null,this._geoJSONIndex.getLeaves(A.clusterId,A.limit,A.offset))}catch(V){R(V)}}}class Oi{constructor(A){this.self=A,this.actor=new u.C(A,this),this.layerIndexes={},this.availableImages={},this.workerSourceTypes={vector:_e,geojson:dt},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(R,V)=>{if(this.workerSourceTypes[R])throw new Error(`Worker source with name "${R}" already registered.`);this.workerSourceTypes[R]=V},this.self.registerRTLTextPlugin=R=>{if(u.bD.isParsed())throw new Error("RTL text plugin already registered.");u.bD.applyArabicShaping=R.applyArabicShaping,u.bD.processBidirectionalText=R.processBidirectionalText,u.bD.processStyledBidirectionalText=R.processStyledBidirectionalText}}setReferrer(A,R){this.referrer=R}setImages(A,R,V){this.availableImages[A]=R;for(const W in this.workerSources[A]){const X=this.workerSources[A][W];for(const he in X)X[he].availableImages=R}V()}setLayers(A,R,V){this.getLayerIndex(A).replace(R),V()}updateLayers(A,R,V){this.getLayerIndex(A).update(R.layers,R.removedIds),V()}loadTile(A,R,V){this.getWorkerSource(A,R.type,R.source).loadTile(R,V)}loadDEMTile(A,R,V){this.getDEMWorkerSource(A,R.source).loadTile(R,V)}reloadTile(A,R,V){this.getWorkerSource(A,R.type,R.source).reloadTile(R,V)}abortTile(A,R,V){this.getWorkerSource(A,R.type,R.source).abortTile(R,V)}removeTile(A,R,V){this.getWorkerSource(A,R.type,R.source).removeTile(R,V)}removeDEMTile(A,R){this.getDEMWorkerSource(A,R.source).removeTile(R)}removeSource(A,R,V){if(!this.workerSources[A]||!this.workerSources[A][R.type]||!this.workerSources[A][R.type][R.source])return;const W=this.workerSources[A][R.type][R.source];delete this.workerSources[A][R.type][R.source],W.removeSource!==void 0?W.removeSource(R,V):V()}loadWorkerSource(A,R,V){try{this.self.importScripts(R.url),V()}catch(W){V(W.toString())}}syncRTLPluginState(A,R,V){try{u.bD.setState(R);const W=u.bD.getPluginURL();if(u.bD.isLoaded()&&!u.bD.isParsed()&&W!=null){this.self.importScripts(W);const X=u.bD.isParsed();V(X?void 0:new Error(`RTL Text Plugin failed to import scripts from ${W}`),X)}}catch(W){V(W.toString())}}getAvailableImages(A){let R=this.availableImages[A];return R||(R=[]),R}getLayerIndex(A){let R=this.layerIndexes[A];return R||(R=this.layerIndexes[A]=new B),R}getWorkerSource(A,R,V){return this.workerSources[A]||(this.workerSources[A]={}),this.workerSources[A][R]||(this.workerSources[A][R]={}),this.workerSources[A][R][V]||(this.workerSources[A][R][V]=new this.workerSourceTypes[R]({send:(W,X,he)=>{this.actor.send(W,X,he,A)}},this.getLayerIndex(A),this.getAvailableImages(A))),this.workerSources[A][R][V]}getDEMWorkerSource(A,R){return this.demWorkerSources[A]||(this.demWorkerSources[A]={}),this.demWorkerSources[A][R]||(this.demWorkerSources[A][R]=new be),this.demWorkerSources[A][R]}}return u.i()&&(self.worker=new Oi(self)),Oi}),b(["./shared"],function(u){var B="3.6.2";class D{static testProp(r){if(!D.docStyle)return r[0];for(let o=0;o<r.length;o++)if(r[o]in D.docStyle)return r[o];return r[0]}static create(r,o,c){const d=window.document.createElement(r);return o!==void 0&&(d.className=o),c&&c.appendChild(d),d}static createNS(r,o){return window.document.createElementNS(r,o)}static disableDrag(){D.docStyle&&D.selectProp&&(D.userSelect=D.docStyle[D.selectProp],D.docStyle[D.selectProp]="none")}static enableDrag(){D.docStyle&&D.selectProp&&(D.docStyle[D.selectProp]=D.userSelect)}static setTransform(r,o){r.style[D.transformProp]=o}static addEventListener(r,o,c,d={}){r.addEventListener(o,c,"passive"in d?d:d.capture)}static removeEventListener(r,o,c,d={}){r.removeEventListener(o,c,"passive"in d?d:d.capture)}static suppressClickInternal(r){r.preventDefault(),r.stopPropagation(),window.removeEventListener("click",D.suppressClickInternal,!0)}static suppressClick(){window.addEventListener("click",D.suppressClickInternal,!0),window.setTimeout(()=>{window.removeEventListener("click",D.suppressClickInternal,!0)},0)}static mousePos(r,o){const c=r.getBoundingClientRect();return new u.P(o.clientX-c.left-r.clientLeft,o.clientY-c.top-r.clientTop)}static touchPos(r,o){const c=r.getBoundingClientRect(),d=[];for(let g=0;g<o.length;g++)d.push(new u.P(o[g].clientX-c.left-r.clientLeft,o[g].clientY-c.top-r.clientTop));return d}static mouseButton(r){return r.button}static remove(r){r.parentNode&&r.parentNode.removeChild(r)}}D.docStyle=typeof window<"u"&&window.document&&window.document.documentElement.style,D.selectProp=D.testProp(["userSelect","MozUserSelect","WebkitUserSelect","msUserSelect"]),D.transformProp=D.testProp(["transform","WebkitTransform"]);const ne={supported:!1,testSupport:function(f){!_e&&te&&(be?ke(f):re=f)}};let re,te,_e=!1,be=!1;function ke(f){const r=f.createTexture();f.bindTexture(f.TEXTURE_2D,r);try{if(f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,te),f.isContextLost())return;ne.supported=!0}catch{}f.deleteTexture(r),_e=!0}var we,K;typeof document<"u"&&(te=document.createElement("img"),te.onload=function(){re&&ke(re),re=null,be=!0},te.onerror=function(){_e=!0,re=null},te.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA="),function(f){let r,o,c,d;f.resetRequestQueue=()=>{r=[],o=0,c=0,d={}},f.addThrottleControl=E=>{const P=c++;return d[P]=E,P},f.removeThrottleControl=E=>{delete d[E],w()},f.getImage=(E,P,z=!0)=>{ne.supported&&(E.headers||(E.headers={}),E.headers.accept="image/webp,*/*");const F={requestParameters:E,supportImageRefresh:z,callback:P,cancelled:!1,completed:!1,cancel:()=>{F.completed||F.cancelled||(F.cancelled=!0,F.innerRequest&&(F.innerRequest.cancel(),o--),w())}};return r.push(F),w(),F};const g=E=>{const{requestParameters:P,supportImageRefresh:z,callback:F}=E;return u.e(P,{type:"image"}),(z!==!1||u.i()||u.g(P.url)||P.headers&&!Object.keys(P.headers).reduce((q,$)=>q&&$==="accept",!0)?u.m:T)(P,(q,$,G,U)=>{x(E,F,q,$,G,U)})},x=(E,P,z,F,q,$)=>{z?P(z):F instanceof HTMLImageElement||u.a(F)?P(null,F):F&&((G,U)=>{typeof createImageBitmap=="function"?u.b(G,U):u.d(G,U)})(F,(G,U)=>{G!=null?P(G):U!=null&&P(null,U,{cacheControl:q,expires:$})}),E.cancelled||(E.completed=!0,o--,w())},w=()=>{const E=(()=>{const P=Object.keys(d);let z=!1;if(P.length>0){for(const F of P)if(z=d[F](),z)break}return z})()?u.c.MAX_PARALLEL_IMAGE_REQUESTS_PER_FRAME:u.c.MAX_PARALLEL_IMAGE_REQUESTS;for(let P=o;P<E&&r.length>0;P++){const z=r.shift();if(z.cancelled){P--;continue}const F=g(z);o++,z.innerRequest=F}},T=(E,P)=>{const z=new Image,F=E.url;let q=!1;const $=E.credentials;return $&&$==="include"?z.crossOrigin="use-credentials":($&&$==="same-origin"||!u.s(F))&&(z.crossOrigin="anonymous"),z.fetchPriority="high",z.onload=()=>{P(null,z),z.onerror=z.onload=null},z.onerror=()=>{q||P(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.")),z.onerror=z.onload=null},z.src=F,{cancel:()=>{q=!0,z.src=""}}}}(we||(we={})),we.resetRequestQueue(),function(f){f.Glyphs="Glyphs",f.Image="Image",f.Source="Source",f.SpriteImage="SpriteImage",f.SpriteJSON="SpriteJSON",f.Style="Style",f.Tile="Tile",f.Unknown="Unknown"}(K||(K={}));class ee{constructor(r){this._transformRequestFn=r}transformRequest(r,o){return this._transformRequestFn&&this._transformRequestFn(r,o)||{url:r}}normalizeSpriteURL(r,o,c){const d=function(g){const x=g.match(ce);if(!x)throw new Error(`Unable to parse URL "${g}"`);return{protocol:x[1],authority:x[2],path:x[3]||"/",params:x[4]?x[4].split("&"):[]}}(r);return d.path+=`${o}${c}`,function(g){const x=g.params.length?`?${g.params.join("&")}`:"";return`${g.protocol}://${g.authority}${g.path}${x}`}(d)}setTransformRequest(r){this._transformRequestFn=r}}const ce=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function ye(f){var r=new u.A(3);return r[0]=f[0],r[1]=f[1],r[2]=f[2],r}var Pe,Le=function(f,r,o){return f[0]=r[0]-o[0],f[1]=r[1]-o[1],f[2]=r[2]-o[2],f};Pe=new u.A(3),u.A!=Float32Array&&(Pe[0]=0,Pe[1]=0,Pe[2]=0);var je=function(f){var r=f[0],o=f[1];return r*r+o*o};function Ze(f){const r=[];if(typeof f=="string")r.push({id:"default",url:f});else if(f&&f.length>0){const o=[];for(const{id:c,url:d}of f){const g=`${c}${d}`;o.indexOf(g)===-1&&(o.push(g),r.push({id:c,url:d}))}}return r}function kt(f,r,o,c,d){if(c)return void f(c);if(d!==Object.values(r).length||d!==Object.values(o).length)return;const g={};for(const x in r){g[x]={};const w=u.h.getImageCanvasContext(o[x]),T=r[x];for(const E in T){const{width:P,height:z,x:F,y:q,sdf:$,pixelRatio:G,stretchX:U,stretchY:oe,content:pe}=T[E];g[x][E]={data:null,pixelRatio:G,sdf:$,stretchX:U,stretchY:oe,content:pe,spriteData:{width:P,height:z,x:F,y:q,context:w}}}}f(null,g)}(function(){var f=new u.A(2);u.A!=Float32Array&&(f[0]=0,f[1]=0)})();class rt{constructor(r,o,c,d){this.context=r,this.format=c,this.texture=r.gl.createTexture(),this.update(o,d)}update(r,o,c){const{width:d,height:g}=r,x=!(this.size&&this.size[0]===d&&this.size[1]===g||c),{context:w}=this,{gl:T}=w;if(this.useMipmap=!!(o&&o.useMipmap),T.bindTexture(T.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===T.RGBA&&(!o||o.premultiply!==!1)),x)this.size=[d,g],r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||u.a(r)?T.texImage2D(T.TEXTURE_2D,0,this.format,this.format,T.UNSIGNED_BYTE,r):T.texImage2D(T.TEXTURE_2D,0,this.format,d,g,0,this.format,T.UNSIGNED_BYTE,r.data);else{const{x:E,y:P}=c||{x:0,y:0};r instanceof HTMLImageElement||r instanceof HTMLCanvasElement||r instanceof HTMLVideoElement||r instanceof ImageData||u.a(r)?T.texSubImage2D(T.TEXTURE_2D,0,E,P,T.RGBA,T.UNSIGNED_BYTE,r):T.texSubImage2D(T.TEXTURE_2D,0,E,P,d,g,T.RGBA,T.UNSIGNED_BYTE,r.data)}this.useMipmap&&this.isSizePowerOfTwo()&&T.generateMipmap(T.TEXTURE_2D)}bind(r,o,c){const{context:d}=this,{gl:g}=d;g.bindTexture(g.TEXTURE_2D,this.texture),c!==g.LINEAR_MIPMAP_NEAREST||this.isSizePowerOfTwo()||(c=g.LINEAR),r!==this.filter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,r),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,c||r),this.filter=r),o!==this.wrap&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,o),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,o),this.wrap=o)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:r}=this.context;r.deleteTexture(this.texture),this.texture=null}}function Mr(f){const{userImage:r}=f;return!!(r&&r.render&&r.render())&&(f.data.replace(new Uint8Array(r.data.buffer)),!0)}class Lr extends u.E{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new u.R({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(r){if(this.loaded!==r&&(this.loaded=r,r)){for(const{ids:o,callback:c}of this.requestors)this._notify(o,c);this.requestors=[]}}getImage(r){const o=this.images[r];if(o&&!o.data&&o.spriteData){const c=o.spriteData;o.data=new u.R({width:c.width,height:c.height},c.context.getImageData(c.x,c.y,c.width,c.height).data),o.spriteData=null}return o}addImage(r,o){if(this.images[r])throw new Error(`Image id ${r} already exist, use updateImage instead`);this._validate(r,o)&&(this.images[r]=o)}_validate(r,o){let c=!0;const d=o.data||o.spriteData;return this._validateStretch(o.stretchX,d&&d.width)||(this.fire(new u.j(new Error(`Image "${r}" has invalid "stretchX" value`))),c=!1),this._validateStretch(o.stretchY,d&&d.height)||(this.fire(new u.j(new Error(`Image "${r}" has invalid "stretchY" value`))),c=!1),this._validateContent(o.content,o)||(this.fire(new u.j(new Error(`Image "${r}" has invalid "content" value`))),c=!1),c}_validateStretch(r,o){if(!r)return!0;let c=0;for(const d of r){if(d[0]<c||d[1]<d[0]||o<d[1])return!1;c=d[1]}return!0}_validateContent(r,o){if(!r)return!0;if(r.length!==4)return!1;const c=o.spriteData,d=c&&c.width||o.data.width,g=c&&c.height||o.data.height;return!(r[0]<0||d<r[0]||r[1]<0||g<r[1]||r[2]<0||d<r[2]||r[3]<0||g<r[3]||r[2]<r[0]||r[3]<r[1])}updateImage(r,o,c=!0){const d=this.getImage(r);if(c&&(d.data.width!==o.data.width||d.data.height!==o.data.height))throw new Error(`size mismatch between old image (${d.data.width}x${d.data.height}) and new image (${o.data.width}x${o.data.height}).`);o.version=d.version+1,this.images[r]=o,this.updatedImages[r]=!0}removeImage(r){const o=this.images[r];delete this.images[r],delete this.patterns[r],o.userImage&&o.userImage.onRemove&&o.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(r,o){let c=!0;if(!this.isLoaded())for(const d of r)this.images[d]||(c=!1);this.isLoaded()||c?this._notify(r,o):this.requestors.push({ids:r,callback:o})}_notify(r,o){const c={};for(const d of r){let g=this.getImage(d);g||(this.fire(new u.k("styleimagemissing",{id:d})),g=this.getImage(d)),g?c[d]={data:g.data.clone(),pixelRatio:g.pixelRatio,sdf:g.sdf,version:g.version,stretchX:g.stretchX,stretchY:g.stretchY,content:g.content,hasRenderCallback:!!(g.userImage&&g.userImage.render)}:u.w(`Image "${d}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}o(null,c)}getPixelSize(){const{width:r,height:o}=this.atlasImage;return{width:r,height:o}}getPattern(r){const o=this.patterns[r],c=this.getImage(r);if(!c)return null;if(o&&o.position.version===c.version)return o.position;if(o)o.position.version=c.version;else{const d={w:c.data.width+2,h:c.data.height+2,x:0,y:0},g=new u.I(d,c);this.patterns[r]={bin:d,position:g}}return this._updatePatternAtlas(),this.patterns[r].position}bind(r){const o=r.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new rt(r,this.atlasImage,o.RGBA),this.atlasTexture.bind(o.LINEAR,o.CLAMP_TO_EDGE)}_updatePatternAtlas(){const r=[];for(const g in this.patterns)r.push(this.patterns[g].bin);const{w:o,h:c}=u.p(r),d=this.atlasImage;d.resize({width:o||1,height:c||1});for(const g in this.patterns){const{bin:x}=this.patterns[g],w=x.x+1,T=x.y+1,E=this.getImage(g).data,P=E.width,z=E.height;u.R.copy(E,d,{x:0,y:0},{x:w,y:T},{width:P,height:z}),u.R.copy(E,d,{x:0,y:z-1},{x:w,y:T-1},{width:P,height:1}),u.R.copy(E,d,{x:0,y:0},{x:w,y:T+z},{width:P,height:1}),u.R.copy(E,d,{x:P-1,y:0},{x:w-1,y:T},{width:1,height:z}),u.R.copy(E,d,{x:0,y:0},{x:w+P,y:T},{width:1,height:z})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(r){for(const o of r){if(this.callbackDispatchedThisFrame[o])continue;this.callbackDispatchedThisFrame[o]=!0;const c=this.getImage(o);c||u.w(`Image with ID: "${o}" was not found`),Mr(c)&&this.updateImage(o,c)}}}const hn=1e20;function Ar(f,r,o,c,d,g,x,w,T){for(let E=r;E<r+c;E++)Qr(f,o*g+E,g,d,x,w,T);for(let E=o;E<o+d;E++)Qr(f,E*g+r,1,c,x,w,T)}function Qr(f,r,o,c,d,g,x){g[0]=0,x[0]=-hn,x[1]=hn,d[0]=f[r];for(let w=1,T=0,E=0;w<c;w++){d[w]=f[r+w*o];const P=w*w;do{const z=g[T];E=(d[w]-d[z]+P-z*z)/(w-z)/2}while(E<=x[T]&&--T>-1);T++,g[T]=w,x[T]=E,x[T+1]=hn}for(let w=0,T=0;w<c;w++){for(;x[T+1]<w;)T++;const E=g[T],P=w-E;f[r+w*o]=d[E]+P*P}}class En{constructor(r,o){this.requestManager=r,this.localIdeographFontFamily=o,this.entries={}}setURL(r){this.url=r}getGlyphs(r,o){const c=[];for(const d in r)for(const g of r[d])c.push({stack:d,id:g});u.o(c,({stack:d,id:g},x)=>{let w=this.entries[d];w||(w=this.entries[d]={glyphs:{},requests:{},ranges:{}});let T=w.glyphs[g];if(T!==void 0)return void x(null,{stack:d,id:g,glyph:T});if(T=this._tinySDF(w,d,g),T)return w.glyphs[g]=T,void x(null,{stack:d,id:g,glyph:T});const E=Math.floor(g/256);if(256*E>65535)return void x(new Error("glyphs > 65535 not supported"));if(w.ranges[E])return void x(null,{stack:d,id:g,glyph:T});if(!this.url)return void x(new Error("glyphsUrl is not set"));let P=w.requests[E];P||(P=w.requests[E]=[],En.loadGlyphRange(d,E,this.url,this.requestManager,(z,F)=>{if(F){for(const q in F)this._doesCharSupportLocalGlyph(+q)||(w.glyphs[+q]=F[+q]);w.ranges[E]=!0}for(const q of P)q(z,F);delete w.requests[E]})),P.push((z,F)=>{z?x(z):F&&x(null,{stack:d,id:g,glyph:F[g]||null})})},(d,g)=>{if(d)o(d);else if(g){const x={};for(const{stack:w,id:T,glyph:E}of g)(x[w]||(x[w]={}))[T]=E&&{id:E.id,bitmap:E.bitmap.clone(),metrics:E.metrics};o(null,x)}})}_doesCharSupportLocalGlyph(r){return!!this.localIdeographFontFamily&&(u.u["CJK Unified Ideographs"](r)||u.u["Hangul Syllables"](r)||u.u.Hiragana(r)||u.u.Katakana(r))}_tinySDF(r,o,c){const d=this.localIdeographFontFamily;if(!d||!this._doesCharSupportLocalGlyph(c))return;let g=r.tinySDF;if(!g){let w="400";/bold/i.test(o)?w="900":/medium/i.test(o)?w="500":/light/i.test(o)&&(w="200"),g=r.tinySDF=new En.TinySDF({fontSize:48,buffer:6,radius:16,cutoff:.25,fontFamily:d,fontWeight:w})}const x=g.draw(String.fromCharCode(c));return{id:c,bitmap:new u.q({width:x.width||60,height:x.height||60},x.data),metrics:{width:x.glyphWidth/2||24,height:x.glyphHeight/2||24,left:x.glyphLeft/2+.5||0,top:x.glyphTop/2-27.5||-8,advance:x.glyphAdvance/2||24,isDoubleResolution:!0}}}}En.loadGlyphRange=function(f,r,o,c,d){const g=256*r,x=g+255,w=c.transformRequest(o.replace("{fontstack}",f).replace("{range}",`${g}-${x}`),K.Glyphs);u.l(w,(T,E)=>{if(T)d(T);else if(E){const P={};for(const z of u.n(E))P[z.id]=z;d(null,P)}})},En.TinySDF=class{constructor({fontSize:f=24,buffer:r=3,radius:o=8,cutoff:c=.25,fontFamily:d="sans-serif",fontWeight:g="normal",fontStyle:x="normal"}={}){this.buffer=r,this.cutoff=c,this.radius=o;const w=this.size=f+4*r,T=this._createCanvas(w),E=this.ctx=T.getContext("2d",{willReadFrequently:!0});E.font=`${x} ${g} ${f}px ${d}`,E.textBaseline="alphabetic",E.textAlign="left",E.fillStyle="black",this.gridOuter=new Float64Array(w*w),this.gridInner=new Float64Array(w*w),this.f=new Float64Array(w),this.z=new Float64Array(w+1),this.v=new Uint16Array(w)}_createCanvas(f){const r=document.createElement("canvas");return r.width=r.height=f,r}draw(f){const{width:r,actualBoundingBoxAscent:o,actualBoundingBoxDescent:c,actualBoundingBoxLeft:d,actualBoundingBoxRight:g}=this.ctx.measureText(f),x=Math.ceil(o),w=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(g-d))),T=Math.min(this.size-this.buffer,x+Math.ceil(c)),E=w+2*this.buffer,P=T+2*this.buffer,z=Math.max(E*P,0),F=new Uint8ClampedArray(z),q={data:F,width:E,height:P,glyphWidth:w,glyphHeight:T,glyphTop:x,glyphLeft:0,glyphAdvance:r};if(w===0||T===0)return q;const{ctx:$,buffer:G,gridInner:U,gridOuter:oe}=this;$.clearRect(G,G,w,T),$.fillText(f,G,G+x);const pe=$.getImageData(G,G,w,T);oe.fill(hn,0,z),U.fill(0,0,z);for(let Y=0;Y<T;Y++)for(let ae=0;ae<w;ae++){const me=pe.data[4*(Y*w+ae)+3]/255;if(me===0)continue;const ge=(Y+G)*E+ae+G;if(me===1)oe[ge]=0,U[ge]=hn;else{const Te=.5-me;oe[ge]=Te>0?Te*Te:0,U[ge]=Te<0?Te*Te:0}}Ar(oe,0,0,E,P,E,this.f,this.v,this.z),Ar(U,G,G,w,T,E,this.f,this.v,this.z);for(let Y=0;Y<z;Y++){const ae=Math.sqrt(oe[Y])-Math.sqrt(U[Y]);F[Y]=Math.round(255-255*(ae/this.radius+this.cutoff))}return q}};class $r{constructor(){this.specification=u.v.light.position}possiblyEvaluate(r,o){return u.z(r.expression.evaluate(o))}interpolate(r,o,c){return{x:u.B.number(r.x,o.x,c),y:u.B.number(r.y,o.y,c),z:u.B.number(r.z,o.z,c)}}}let He;class ht extends u.E{constructor(r){super(),He=He||new u.r({anchor:new u.D(u.v.light.anchor),position:new $r,color:new u.D(u.v.light.color),intensity:new u.D(u.v.light.intensity)}),this._transitionable=new u.T(He),this.setLight(r),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(r,o={}){if(!this._validate(u.t,r,o))for(const c in r){const d=r[c];c.endsWith("-transition")?this._transitionable.setTransition(c.slice(0,-11),d):this._transitionable.setValue(c,d)}}updateTransitions(r){this._transitioning=this._transitionable.transitioned(r,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(r){this.properties=this._transitioning.possiblyEvaluate(r)}_validate(r,o,c){return(!c||c.validate!==!1)&&u.x(this,r.call(u.y,u.e({value:o,style:{glyphs:!0,sprite:!0},styleSpec:u.v})))}}class mt{constructor(r,o){this.width=r,this.height=o,this.nextRow=0,this.data=new Uint8Array(this.width*this.height),this.dashEntry={}}getDash(r,o){const c=r.join(",")+String(o);return this.dashEntry[c]||(this.dashEntry[c]=this.addDash(r,o)),this.dashEntry[c]}getDashRanges(r,o,c){const d=[];let g=r.length%2==1?-r[r.length-1]*c:0,x=r[0]*c,w=!0;d.push({left:g,right:x,isDash:w,zeroLength:r[0]===0});let T=r[0];for(let E=1;E<r.length;E++){w=!w;const P=r[E];g=T*c,T+=P,x=T*c,d.push({left:g,right:x,isDash:w,zeroLength:P===0})}return d}addRoundDash(r,o,c){const d=o/2;for(let g=-c;g<=c;g++){const x=this.width*(this.nextRow+c+g);let w=0,T=r[w];for(let E=0;E<this.width;E++){E/T.right>1&&(T=r[++w]);const P=Math.abs(E-T.left),z=Math.abs(E-T.right),F=Math.min(P,z);let q;const $=g/c*(d+1);if(T.isDash){const G=d-Math.abs($);q=Math.sqrt(F*F+G*G)}else q=d-Math.sqrt(F*F+$*$);this.data[x+E]=Math.max(0,Math.min(255,q+128))}}}addRegularDash(r){for(let w=r.length-1;w>=0;--w){const T=r[w],E=r[w+1];T.zeroLength?r.splice(w,1):E&&E.isDash===T.isDash&&(E.left=T.left,r.splice(w,1))}const o=r[0],c=r[r.length-1];o.isDash===c.isDash&&(o.left=c.left-this.width,c.right=o.right+this.width);const d=this.width*this.nextRow;let g=0,x=r[g];for(let w=0;w<this.width;w++){w/x.right>1&&(x=r[++g]);const T=Math.abs(w-x.left),E=Math.abs(w-x.right),P=Math.min(T,E);this.data[d+w]=Math.max(0,Math.min(255,(x.isDash?P:-P)+128))}}addDash(r,o){const c=o?7:0,d=2*c+1;if(this.nextRow+d>this.height)return u.w("LineAtlas out of space"),null;let g=0;for(let w=0;w<r.length;w++)g+=r[w];if(g!==0){const w=this.width/g,T=this.getDashRanges(r,this.width,w);o?this.addRoundDash(T,w,c):this.addRegularDash(T)}const x={y:(this.nextRow+c+.5)/this.height,height:2*c/this.height,width:g};return this.nextRow+=d,this.dirty=!0,x}bind(r){const o=r.gl;this.texture?(o.bindTexture(o.TEXTURE_2D,this.texture),this.dirty&&(this.dirty=!1,o.texSubImage2D(o.TEXTURE_2D,0,0,0,this.width,this.height,o.ALPHA,o.UNSIGNED_BYTE,this.data))):(this.texture=o.createTexture(),o.bindTexture(o.TEXTURE_2D,this.texture),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.LINEAR),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.LINEAR),o.texImage2D(o.TEXTURE_2D,0,o.ALPHA,this.width,this.height,0,o.ALPHA,o.UNSIGNED_BYTE,this.data))}}class Vt{constructor(r,o,c){this.workerPool=r,this.actors=[],this.currentActor=0,this.id=c;const d=this.workerPool.acquire(c);for(let g=0;g<d.length;g++){const x=new u.C(d[g],o,c);x.name=`Worker ${g}`,this.actors.push(x)}if(!this.actors.length)throw new Error("No actors found")}broadcast(r,o,c){u.o(this.actors,(d,g)=>{d.send(r,o,g)},c=c||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(r=!0){this.actors.forEach(o=>{o.remove()}),this.actors=[],r&&this.workerPool.release(this.id)}}function Ft(f,r,o){const c=function(d,g){if(d)return o(d);if(g){const x=u.F(u.e(g,f),["tiles","minzoom","maxzoom","attribution","bounds","scheme","tileSize","encoding"]);g.vector_layers&&(x.vectorLayers=g.vector_layers,x.vectorLayerIds=x.vectorLayers.map(w=>w.id)),o(null,x)}};return f.url?u.f(r.transformRequest(f.url,K.Source),c):u.h.frame(()=>c(null,f))}class At{constructor(r,o){r&&(o?this.setSouthWest(r).setNorthEast(o):Array.isArray(r)&&(r.length===4?this.setSouthWest([r[0],r[1]]).setNorthEast([r[2],r[3]]):this.setSouthWest(r[0]).setNorthEast(r[1])))}setNorthEast(r){return this._ne=r instanceof u.L?new u.L(r.lng,r.lat):u.L.convert(r),this}setSouthWest(r){return this._sw=r instanceof u.L?new u.L(r.lng,r.lat):u.L.convert(r),this}extend(r){const o=this._sw,c=this._ne;let d,g;if(r instanceof u.L)d=r,g=r;else{if(!(r instanceof At))return Array.isArray(r)?r.length===4||r.every(Array.isArray)?this.extend(At.convert(r)):this.extend(u.L.convert(r)):r&&("lng"in r||"lon"in r)&&"lat"in r?this.extend(u.L.convert(r)):this;if(d=r._sw,g=r._ne,!d||!g)return this}return o||c?(o.lng=Math.min(d.lng,o.lng),o.lat=Math.min(d.lat,o.lat),c.lng=Math.max(g.lng,c.lng),c.lat=Math.max(g.lat,c.lat)):(this._sw=new u.L(d.lng,d.lat),this._ne=new u.L(g.lng,g.lat)),this}getCenter(){return new u.L((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new u.L(this.getWest(),this.getNorth())}getSouthEast(){return new u.L(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(r){const{lng:o,lat:c}=u.L.convert(r);let d=this._sw.lng<=o&&o<=this._ne.lng;return this._sw.lng>this._ne.lng&&(d=this._sw.lng>=o&&o>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&d}static convert(r){return r instanceof At?r:r&&new At(r)}static fromLngLat(r,o=0){const c=360*o/40075017,d=c/Math.cos(Math.PI/180*r.lat);return new At(new u.L(r.lng-d,r.lat-c),new u.L(r.lng+d,r.lat+c))}}class or{constructor(r,o,c){this.bounds=At.convert(this.validateBounds(r)),this.minzoom=o||0,this.maxzoom=c||24}validateBounds(r){return Array.isArray(r)&&r.length===4?[Math.max(-180,r[0]),Math.max(-90,r[1]),Math.min(180,r[2]),Math.min(90,r[3])]:[-180,-90,180,90]}contains(r){const o=Math.pow(2,r.z),c=Math.floor(u.G(this.bounds.getWest())*o),d=Math.floor(u.H(this.bounds.getNorth())*o),g=Math.ceil(u.G(this.bounds.getEast())*o),x=Math.ceil(u.H(this.bounds.getSouth())*o);return r.x>=c&&r.x<g&&r.y>=d&&r.y<x}}class ri extends u.E{constructor(r,o,c,d){if(super(),this.load=()=>{this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Ft(this._options,this.map._requestManager,(g,x)=>{this._tileJSONRequest=null,this._loaded=!0,this.map.style.sourceCaches[this.id].clearTiles(),g?this.fire(new u.j(g)):x&&(u.e(this,x),x.bounds&&(this.tileBounds=new or(x.bounds,this.minzoom,this.maxzoom)),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})))})},this.serialize=()=>u.e({},this._options),this.id=r,this.dispatcher=c,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,u.e(this,u.F(o,["url","scheme","tileSize","promoteId"])),this._options=u.e({type:"vector"},o),this._collectResourceTiming=o.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(d)}loaded(){return this._loaded}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}onAdd(r){this.map=r,this.load()}setSourceProperty(r){this._tileJSONRequest&&this._tileJSONRequest.cancel(),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}setUrl(r){return this.setSourceProperty(()=>{this.url=r,this._options.url=r}),this}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}loadTile(r,o){const c=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d={request:this.map._requestManager.transformRequest(c,K.Tile),uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,tileSize:this.tileSize*r.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};function g(x,w){return delete r.request,r.aborted?o(null):x&&x.status!==404?o(x):(w&&w.resourceTiming&&(r.resourceTiming=w.resourceTiming),this.map._refreshExpiredTiles&&w&&r.setExpiryData(w),r.loadVectorData(w,this.map.painter),o(null),void(r.reloadCallback&&(this.loadTile(r,r.reloadCallback),r.reloadCallback=null)))}d.request.collectResourceTiming=this._collectResourceTiming,r.actor&&r.state!=="expired"?r.state==="loading"?r.reloadCallback=o:r.request=r.actor.send("reloadTile",d,g.bind(this)):(r.actor=this.dispatcher.getActor(),r.request=r.actor.send("loadTile",d,g.bind(this)))}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.actor&&r.actor.send("abortTile",{uid:r.uid,type:this.type,source:this.id},void 0)}unloadTile(r){r.unloadVectorData(),r.actor&&r.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id},void 0)}hasTransition(){return!1}}class dn extends u.E{constructor(r,o,c,d){super(),this.id=r,this.dispatcher=c,this.setEventedParent(d),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=u.e({type:"raster"},o),u.e(this,u.F(o,["url","scheme","tileSize"]))}load(){this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this._tileJSONRequest=Ft(this._options,this.map._requestManager,(r,o)=>{this._tileJSONRequest=null,this._loaded=!0,r?this.fire(new u.j(r)):o&&(u.e(this,o),o.bounds&&(this.tileBounds=new or(o.bounds,this.minzoom,this.maxzoom)),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})))})}loaded(){return this._loaded}onAdd(r){this.map=r,this.load()}onRemove(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}setSourceProperty(r){this._tileJSONRequest&&this._tileJSONRequest.cancel(),r(),this.load()}setTiles(r){return this.setSourceProperty(()=>{this._options.tiles=r}),this}serialize(){return u.e({},this._options)}hasTile(r){return!this.tileBounds||this.tileBounds.contains(r.canonical)}loadTile(r,o){const c=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme);r.request=we.getImage(this.map._requestManager.transformRequest(c,K.Tile),(d,g,x)=>{if(delete r.request,r.aborted)r.state="unloaded",o(null);else if(d)r.state="errored",o(d);else if(g){this.map._refreshExpiredTiles&&x&&r.setExpiryData(x);const w=this.map.painter.context,T=w.gl;r.texture=this.map.painter.getTileTexture(g.width),r.texture?r.texture.update(g,{useMipmap:!0}):(r.texture=new rt(w,g,T.RGBA,{useMipmap:!0}),r.texture.bind(T.LINEAR,T.CLAMP_TO_EDGE,T.LINEAR_MIPMAP_NEAREST),w.extTextureFilterAnisotropic&&T.texParameterf(T.TEXTURE_2D,w.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,w.extTextureFilterAnisotropicMax)),r.state="loaded",o(null)}},this.map._refreshExpiredTiles)}abortTile(r,o){r.request&&(r.request.cancel(),delete r.request),o()}unloadTile(r,o){r.texture&&this.map.painter.saveTileTexture(r.texture),o()}hasTransition(){return!1}}class ni extends dn{constructor(r,o,c,d){super(r,o,c,d),this.type="raster-dem",this.maxzoom=22,this._options=u.e({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox",this.redFactor=o.redFactor,this.greenFactor=o.greenFactor,this.blueFactor=o.blueFactor,this.baseShift=o.baseShift}loadTile(r,o){const c=r.tileID.canonical.url(this.tiles,this.map.getPixelRatio(),this.scheme),d=this.map._requestManager.transformRequest(c,K.Tile);function g(x,w){x&&(r.state="errored",o(x)),w&&(r.dem=w,r.needsHillshadePrepare=!0,r.needsTerrainPrepare=!0,r.state="loaded",o(null))}r.neighboringTiles=this._getNeighboringTiles(r.tileID),r.request=we.getImage(d,(x,w,T)=>u._(this,void 0,void 0,function*(){if(delete r.request,r.aborted)r.state="unloaded",o(null);else if(x)r.state="errored",o(x);else if(w){this.map._refreshExpiredTiles&&r.setExpiryData(T);const E=u.a(w)&&u.J()?w:yield function(z){return u._(this,void 0,void 0,function*(){if(typeof VideoFrame<"u"&&u.K()){const F=z.width+2,q=z.height+2;try{return new u.R({width:F,height:q},yield u.M(z,-1,-1,F,q))}catch{}}return u.h.getImageData(z,1)})}(w),P={uid:r.uid,coord:r.tileID,source:this.id,rawImageData:E,encoding:this.encoding,redFactor:this.redFactor,greenFactor:this.greenFactor,blueFactor:this.blueFactor,baseShift:this.baseShift};r.actor&&r.state!=="expired"||(r.actor=this.dispatcher.getActor(),r.actor.send("loadDEMTile",P,g))}}),this.map._refreshExpiredTiles)}_getNeighboringTiles(r){const o=r.canonical,c=Math.pow(2,o.z),d=(o.x-1+c)%c,g=o.x===0?r.wrap-1:r.wrap,x=(o.x+1+c)%c,w=o.x+1===c?r.wrap+1:r.wrap,T={};return T[new u.O(r.overscaledZ,g,o.z,d,o.y).key]={backfilled:!1},T[new u.O(r.overscaledZ,w,o.z,x,o.y).key]={backfilled:!1},o.y>0&&(T[new u.O(r.overscaledZ,g,o.z,d,o.y-1).key]={backfilled:!1},T[new u.O(r.overscaledZ,r.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},T[new u.O(r.overscaledZ,w,o.z,x,o.y-1).key]={backfilled:!1}),o.y+1<c&&(T[new u.O(r.overscaledZ,g,o.z,d,o.y+1).key]={backfilled:!1},T[new u.O(r.overscaledZ,r.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},T[new u.O(r.overscaledZ,w,o.z,x,o.y+1).key]={backfilled:!1}),T}unloadTile(r){r.demTexture&&this.map.painter.saveTileTexture(r.demTexture),r.fbo&&(r.fbo.destroy(),delete r.fbo),r.dem&&delete r.dem,delete r.neighboringTiles,r.state="unloaded",r.actor&&r.actor.send("removeDEMTile",{uid:r.uid,source:this.id})}}class is extends u.E{constructor(r,o,c,d){super(),this.load=()=>{this._updateWorkerData()},this.serialize=()=>u.e({},this._options,{type:this.type,data:this._data}),this.id=r,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._removed=!1,this._pendingLoads=0,this.actor=c.getActor(),this.setEventedParent(d),this._data=o.data,this._options=u.e({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const g=u.N/this.tileSize;this.workerOptions=u.e({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*g,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*g,extent:u.N,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:u.N,radius:(o.clusterRadius||50)*g,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions),typeof this.promoteId=="string"&&(this.workerOptions.promoteId=this.promoteId)}onAdd(r){this.map=r,this.load()}setData(r){return this._data=r,this._updateWorkerData(),this}updateData(r){return this._updateWorkerData(r),this}setClusterOptions(r){return this.workerOptions.cluster=r.cluster,r&&(r.clusterRadius!==void 0&&(this.workerOptions.superclusterOptions.radius=r.clusterRadius),r.clusterMaxZoom!==void 0&&(this.workerOptions.superclusterOptions.maxZoom=r.clusterMaxZoom)),this._updateWorkerData(),this}getClusterExpansionZoom(r,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:r,source:this.id},o),this}getClusterChildren(r,o){return this.actor.send("geojson.getClusterChildren",{clusterId:r,source:this.id},o),this}getClusterLeaves(r,o,c,d){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:r,limit:o,offset:c},d),this}_updateWorkerData(r){const o=u.e({},this.workerOptions);r?o.dataDiff=r:typeof this._data=="string"?(o.request=this.map._requestManager.transformRequest(u.h.resolveURL(this._data),K.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(this._data),this._pendingLoads++,this.fire(new u.k("dataloading",{dataType:"source"})),this.actor.send(`${this.type}.loadData`,o,(c,d)=>{if(this._pendingLoads--,this._removed||d&&d.abandoned)return void this.fire(new u.k("dataabort",{dataType:"source"}));let g=null;if(d&&d.resourceTiming&&d.resourceTiming[this.id]&&(g=d.resourceTiming[this.id].slice(0)),c)return void this.fire(new u.j(c));const x={dataType:"source"};this._collectResourceTiming&&g&&g.length>0&&u.e(x,{resourceTiming:g}),this.fire(new u.k("data",Object.assign(Object.assign({},x),{sourceDataType:"metadata"}))),this.fire(new u.k("data",Object.assign(Object.assign({},x),{sourceDataType:"content"})))})}loaded(){return this._pendingLoads===0}loadTile(r,o){const c=r.actor?"reloadTile":"loadTile";r.actor=this.actor;const d={type:this.type,uid:r.uid,tileID:r.tileID,zoom:r.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:this.map.getPixelRatio(),showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId};r.request=this.actor.send(c,d,(g,x)=>(delete r.request,r.unloadVectorData(),r.aborted?o(null):g?o(g):(r.loadVectorData(x,this.map.painter,c==="reloadTile"),o(null))))}abortTile(r){r.request&&(r.request.cancel(),delete r.request),r.aborted=!0}unloadTile(r){r.unloadVectorData(),this.actor.send("removeTile",{uid:r.uid,type:this.type,source:this.id})}onRemove(){this._removed=!0,this.actor.send("removeSource",{type:this.type,source:this.id})}hasTransition(){return!1}}var ii=u.Q([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);class Un extends u.E{constructor(r,o,c,d){super(),this.load=(g,x)=>{this._loaded=!1,this.fire(new u.k("dataloading",{dataType:"source"})),this.url=this.options.url,this._request=we.getImage(this.map._requestManager.transformRequest(this.url,K.Image),(w,T)=>{this._request=null,this._loaded=!0,w?this.fire(new u.j(w)):T&&(this.image=T,g&&(this.coordinates=g),x&&x(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||!this.image)return;const g=this.map.painter.context,x=g.gl;this.boundsBuffer||(this.boundsBuffer=g.createVertexBuffer(this._boundsArray,ii.members)),this.boundsSegments||(this.boundsSegments=u.S.simpleSegment(0,0,4,2)),this.texture||(this.texture=new rt(g,this.image,x.RGBA),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE));let w=!1;for(const T in this.tiles){const E=this.tiles[T];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,w=!0)}w&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"image",url:this.options.url,coordinates:this.coordinates}),this.id=r,this.dispatcher=c,this.coordinates=o.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(d),this.options=o}loaded(){return this._loaded}updateImage(r){return r.url?(this._request&&(this._request.cancel(),this._request=null),this.options.url=r.url,this.load(r.coordinates,()=>{this.texture=null}),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new u.k("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(r){this.map=r,this.load()}onRemove(){this._request&&(this._request.cancel(),this._request=null)}setCoordinates(r){this.coordinates=r;const o=r.map(u.U.fromLngLat);this.tileID=function(d){let g=1/0,x=1/0,w=-1/0,T=-1/0;for(const F of d)g=Math.min(g,F.x),x=Math.min(x,F.y),w=Math.max(w,F.x),T=Math.max(T,F.y);const E=Math.max(w-g,T-x),P=Math.max(0,Math.floor(-Math.log(E)/Math.LN2)),z=Math.pow(2,P);return new u.W(P,Math.floor((g+w)/2*z),Math.floor((x+T)/2*z))}(o),this.minzoom=this.maxzoom=this.tileID.z;const c=o.map(d=>this.tileID.getTilePoint(d)._round());return this._boundsArray=new u.V,this._boundsArray.emplaceBack(c[0].x,c[0].y,0,0),this._boundsArray.emplaceBack(c[1].x,c[1].y,u.N,0),this._boundsArray.emplaceBack(c[3].x,c[3].y,0,u.N),this._boundsArray.emplaceBack(c[2].x,c[2].y,u.N,u.N),this.boundsBuffer&&(this.boundsBuffer.destroy(),delete this.boundsBuffer),this.fire(new u.k("data",{dataType:"source",sourceDataType:"content"})),this}loadTile(r,o){this.tileID&&this.tileID.equals(r.tileID.canonical)?(this.tiles[String(r.tileID.wrap)]=r,r.buckets={},o(null)):(r.state="errored",o(null))}hasTransition(){return!1}}class Ho extends Un{constructor(r,o,c,d){super(r,o,c,d),this.load=()=>{this._loaded=!1;const g=this.options;this.urls=[];for(const x of g.urls)this.urls.push(this.map._requestManager.transformRequest(x,K.Source).url);u.X(this.urls,(x,w)=>{this._loaded=!0,x?this.fire(new u.j(x)):w&&(this.video=w,this.video.loop=!0,this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})},this.prepare=()=>{if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const g=this.map.painter.context,x=g.gl;this.boundsBuffer||(this.boundsBuffer=g.createVertexBuffer(this._boundsArray,ii.members)),this.boundsSegments||(this.boundsSegments=u.S.simpleSegment(0,0,4,2)),this.texture?this.video.paused||(this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE),x.texSubImage2D(x.TEXTURE_2D,0,0,0,x.RGBA,x.UNSIGNED_BYTE,this.video)):(this.texture=new rt(g,this.video,x.RGBA),this.texture.bind(x.LINEAR,x.CLAMP_TO_EDGE));let w=!1;for(const T in this.tiles){const E=this.tiles[T];E.state!=="loaded"&&(E.state="loaded",E.texture=this.texture,w=!0)}w&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"video",urls:this.urls,coordinates:this.coordinates}),this.roundZoom=!0,this.type="video",this.options=o}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(r){if(this.video){const o=this.video.seekable;r<o.start(0)||r>o.end(0)?this.fire(new u.j(new u.Y(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=r}}getVideo(){return this.video}onAdd(r){this.map||(this.map=r,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}hasTransition(){return this.video&&!this.video.paused}}class ss extends Un{constructor(r,o,c,d){super(r,o,c,d),this.load=()=>{this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new u.j(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())},this.prepare=()=>{let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const x=this.map.painter.context,w=x.gl;this.boundsBuffer||(this.boundsBuffer=x.createVertexBuffer(this._boundsArray,ii.members)),this.boundsSegments||(this.boundsSegments=u.S.simpleSegment(0,0,4,2)),this.texture?(g||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new rt(x,this.canvas,w.RGBA,{premultiply:!0});let T=!1;for(const E in this.tiles){const P=this.tiles[E];P.state!=="loaded"&&(P.state="loaded",P.texture=this.texture,T=!0)}T&&this.fire(new u.k("data",{dataType:"source",sourceDataType:"idle",sourceId:this.id}))},this.serialize=()=>({type:"canvas",coordinates:this.coordinates}),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(g=>!Array.isArray(g)||g.length!==2||g.some(x=>typeof x!="number"))||this.fire(new u.j(new u.Y(`sources.${r}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new u.j(new u.Y(`sources.${r}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new u.j(new u.Y(`sources.${r}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new u.j(new u.Y(`sources.${r}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new u.j(new u.Y(`sources.${r}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}getCanvas(){return this.canvas}onAdd(r){this.map=r,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const r of[this.canvas.width,this.canvas.height])if(isNaN(r)||r<=0)return!0;return!1}}const Xo={},Ri=f=>{switch(f){case"geojson":return is;case"image":return Un;case"raster":return dn;case"raster-dem":return ni;case"vector":return ri;case"video":return Ho;case"canvas":return ss}return Xo[f]};function to(f,r){const o=u.Z();return u.$(o,o,[1,1,0]),u.a0(o,o,[.5*f.width,.5*f.height,1]),u.a1(o,o,f.calculatePosMatrix(r.toUnwrapped()))}function Ss(f,r,o,c,d,g){const x=function(z,F,q){if(z)for(const $ of z){const G=F[$];if(G&&G.source===q&&G.type==="fill-extrusion")return!0}else for(const $ in F){const G=F[$];if(G.source===q&&G.type==="fill-extrusion")return!0}return!1}(d&&d.layers,r,f.id),w=g.maxPitchScaleFactor(),T=f.tilesIn(c,w,x);T.sort(os);const E=[];for(const z of T)E.push({wrappedTileID:z.tileID.wrapped().key,queryResults:z.tile.queryRenderedFeatures(r,o,f._state,z.queryGeometry,z.cameraQueryGeometry,z.scale,d,g,w,to(f.transform,z.tileID))});const P=function(z){const F={},q={};for(const $ of z){const G=$.queryResults,U=$.wrappedTileID,oe=q[U]=q[U]||{};for(const pe in G){const Y=G[pe],ae=oe[pe]=oe[pe]||{},me=F[pe]=F[pe]||[];for(const ge of Y)ae[ge.featureIndex]||(ae[ge.featureIndex]=!0,me.push(ge))}}return F}(E);for(const z in P)P[z].forEach(F=>{const q=F.feature,$=f.getFeatureState(q.layer["source-layer"],q.id);q.source=q.layer.source,q.layer["source-layer"]&&(q.sourceLayer=q.layer["source-layer"]),q.state=$});return P}function os(f,r){const o=f.tileID,c=r.tileID;return o.overscaledZ-c.overscaledZ||o.canonical.y-c.canonical.y||o.wrap-c.wrap||o.canonical.x-c.canonical.x}class as{constructor(r,o){this.timeAdded=0,this.fadeEndTime=0,this.tileID=r,this.uid=u.a2(),this.uses=0,this.tileSize=o,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.rtt=[],this.rttCoords={},this.expiredRequestCount=0,this.state="loading"}registerFadeDuration(r){const o=r+this.timeAdded;o<this.fadeEndTime||(this.fadeEndTime=o)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}clearTextures(r){this.demTexture&&r.saveTileTexture(this.demTexture),this.demTexture=null}loadVectorData(r,o,c){if(this.hasData()&&this.unloadVectorData(),this.state="loaded",r){r.featureIndex&&(this.latestFeatureIndex=r.featureIndex,r.rawTileData?(this.latestRawTileData=r.rawTileData,this.latestFeatureIndex.rawTileData=r.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=r.collisionBoxArray,this.buckets=function(d,g){const x={};if(!g)return x;for(const w of d){const T=w.layerIds.map(E=>g.getLayer(E)).filter(Boolean);if(T.length!==0){w.layers=T,w.stateDependentLayerIds&&(w.stateDependentLayers=w.stateDependentLayerIds.map(E=>T.filter(P=>P.id===E)[0]));for(const E of T)x[E.id]=w}}return x}(r.buckets,o.style),this.hasSymbolBuckets=!1;for(const d in this.buckets){const g=this.buckets[d];if(g instanceof u.a4){if(this.hasSymbolBuckets=!0,!c)break;g.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const d in this.buckets){const g=this.buckets[d];if(g instanceof u.a4&&g.hasRTLText){this.hasRTLText=!0,u.a5();break}}this.queryPadding=0;for(const d in this.buckets){const g=this.buckets[d];this.queryPadding=Math.max(this.queryPadding,o.style.getLayer(d).queryRadius(g))}r.imageAtlas&&(this.imageAtlas=r.imageAtlas),r.glyphAtlasImage&&(this.glyphAtlasImage=r.glyphAtlasImage)}else this.collisionBoxArray=new u.a3}unloadVectorData(){for(const r in this.buckets)this.buckets[r].destroy();this.buckets={},this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.imageAtlas&&(this.imageAtlas=null),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.latestFeatureIndex=null,this.state="unloaded"}getBucket(r){return this.buckets[r.id]}upload(r){for(const c in this.buckets){const d=this.buckets[c];d.uploadPending()&&d.upload(r)}const o=r.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new rt(r,this.imageAtlas.image,o.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new rt(r,this.glyphAtlasImage,o.ALPHA),this.glyphAtlasImage=null)}prepare(r){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(r,this.imageAtlasTexture)}queryRenderedFeatures(r,o,c,d,g,x,w,T,E,P){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({queryGeometry:d,cameraQueryGeometry:g,scale:x,tileSize:this.tileSize,pixelPosMatrix:P,transform:T,params:w,queryPadding:this.queryPadding*E},r,o,c):{}}querySourceFeatures(r,o){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const d=c.loadVTLayers(),g=o&&o.sourceLayer?o.sourceLayer:"",x=d._geojsonTileLayer||d[g];if(!x)return;const w=u.a6(o&&o.filter),{z:T,x:E,y:P}=this.tileID.canonical,z={z:T,x:E,y:P};for(let F=0;F<x.length;F++){const q=x.feature(F);if(w.needGeometry){const U=u.a7(q,!0);if(!w.filter(new u.a8(this.tileID.overscaledZ),U,this.tileID.canonical))continue}else if(!w.filter(new u.a8(this.tileID.overscaledZ),q))continue;const $=c.getId(q,g),G=new u.a9(q,T,E,P,$);G.tile=z,r.push(G)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(r){const o=this.expirationTime;if(r.cacheControl){const c=u.aa(r.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else r.expires&&(this.expirationTime=new Date(r.expires).getTime());if(this.expirationTime){const c=Date.now();let d=!1;if(this.expirationTime>c)d=!1;else if(o)if(this.expirationTime<o)d=!0;else{const g=this.expirationTime-o;g?this.expirationTime=c+Math.max(g,3e4):d=!0}else d=!0;d?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(r,o){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(r).length===0)return;const c=this.latestFeatureIndex.loadVTLayers();for(const d in this.buckets){if(!o.style.hasLayer(d))continue;const g=this.buckets[d],x=g.layers[0].sourceLayer||"_geojsonTileLayer",w=c[x],T=r[x];if(!w||!T||Object.keys(T).length===0)continue;g.update(T,w,this.imageAtlas&&this.imageAtlas.patternPositions||{});const E=o&&o.style&&o.style.getLayer(d);E&&(this.queryPadding=Math.max(this.queryPadding,E.queryRadius(g)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<u.h.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(r){this.symbolFadeHoldUntil=u.h.now()+r}setDependencies(r,o){const c={};for(const d of o)c[d]=!0;this.dependencies[r]=c}hasDependency(r,o){for(const c of r){const d=this.dependencies[c];if(d){for(const g of o)if(d[g])return!0}}return!1}}class Ts{constructor(r,o){this.max=r,this.onRemove=o,this.reset()}reset(){for(const r in this.data)for(const o of this.data[r])o.timeout&&clearTimeout(o.timeout),this.onRemove(o.value);return this.data={},this.order=[],this}add(r,o,c){const d=r.wrapped().key;this.data[d]===void 0&&(this.data[d]=[]);const g={value:o,timeout:void 0};if(c!==void 0&&(g.timeout=setTimeout(()=>{this.remove(r,g)},c)),this.data[d].push(g),this.order.push(d),this.order.length>this.max){const x=this._getAndRemoveByKey(this.order[0]);x&&this.onRemove(x)}return this}has(r){return r.wrapped().key in this.data}getAndRemove(r){return this.has(r)?this._getAndRemoveByKey(r.wrapped().key):null}_getAndRemoveByKey(r){const o=this.data[r].shift();return o.timeout&&clearTimeout(o.timeout),this.data[r].length===0&&delete this.data[r],this.order.splice(this.order.indexOf(r),1),o.value}getByKey(r){const o=this.data[r];return o?o[0].value:null}get(r){return this.has(r)?this.data[r.wrapped().key][0].value:null}remove(r,o){if(!this.has(r))return this;const c=r.wrapped().key,d=o===void 0?0:this.data[c].indexOf(o),g=this.data[c][d];return this.data[c].splice(d,1),g.timeout&&clearTimeout(g.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(g.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(r){for(this.max=r;this.order.length>this.max;){const o=this._getAndRemoveByKey(this.order[0]);o&&this.onRemove(o)}return this}filter(r){const o=[];for(const c in this.data)for(const d of this.data[c])r(d.value)||o.push(d);for(const c of o)this.remove(c.value.tileID,c)}}class ve{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(r,o,c){const d=String(o);if(this.stateChanges[r]=this.stateChanges[r]||{},this.stateChanges[r][d]=this.stateChanges[r][d]||{},u.e(this.stateChanges[r][d],c),this.deletedStates[r]===null){this.deletedStates[r]={};for(const g in this.state[r])g!==d&&(this.deletedStates[r][g]=null)}else if(this.deletedStates[r]&&this.deletedStates[r][d]===null){this.deletedStates[r][d]={};for(const g in this.state[r][d])c[g]||(this.deletedStates[r][d][g]=null)}else for(const g in c)this.deletedStates[r]&&this.deletedStates[r][d]&&this.deletedStates[r][d][g]===null&&delete this.deletedStates[r][d][g]}removeFeatureState(r,o,c){if(this.deletedStates[r]===null)return;const d=String(o);if(this.deletedStates[r]=this.deletedStates[r]||{},c&&o!==void 0)this.deletedStates[r][d]!==null&&(this.deletedStates[r][d]=this.deletedStates[r][d]||{},this.deletedStates[r][d][c]=null);else if(o!==void 0)if(this.stateChanges[r]&&this.stateChanges[r][d])for(c in this.deletedStates[r][d]={},this.stateChanges[r][d])this.deletedStates[r][d][c]=null;else this.deletedStates[r][d]=null;else this.deletedStates[r]=null}getState(r,o){const c=String(o),d=u.e({},(this.state[r]||{})[c],(this.stateChanges[r]||{})[c]);if(this.deletedStates[r]===null)return{};if(this.deletedStates[r]){const g=this.deletedStates[r][o];if(g===null)return{};for(const x in g)delete d[x]}return d}initializeTileState(r,o){r.setFeatureState(this.state,o)}coalesceChanges(r,o){const c={};for(const d in this.stateChanges){this.state[d]=this.state[d]||{};const g={};for(const x in this.stateChanges[d])this.state[d][x]||(this.state[d][x]={}),u.e(this.state[d][x],this.stateChanges[d][x]),g[x]=this.state[d][x];c[d]=g}for(const d in this.deletedStates){this.state[d]=this.state[d]||{};const g={};if(this.deletedStates[d]===null)for(const x in this.state[d])g[x]={},this.state[d][x]={};else for(const x in this.deletedStates[d]){if(this.deletedStates[d][x]===null)this.state[d][x]={};else for(const w of Object.keys(this.deletedStates[d][x]))delete this.state[d][x][w];g[x]=this.state[d][x]}c[d]=c[d]||{},u.e(c[d],g)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const d in r)r[d].setFeatureState(c,o)}}class pn extends u.E{constructor(r,o,c){super(),this.id=r,this.dispatcher=c,this.on("data",d=>{d.dataType==="source"&&d.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&d.dataType==="source"&&d.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform,this.terrain),this._didEmitContent=!0)}),this.on("dataloading",()=>{this._sourceErrored=!1}),this.on("error",()=>{this._sourceErrored=this._source.loaded()}),this._source=((d,g,x,w)=>{const T=new(Ri(g.type))(d,g,x,w);if(T.id!==d)throw new Error(`Expected Source id to be ${d} instead of ${T.id}`);return T})(r,o,c,this),this._tiles={},this._cache=new Ts(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._maxTileCacheSize=null,this._maxTileCacheZoomLevels=null,this._loadedParentTiles={},this._coveredTiles={},this._state=new ve,this._didEmitContent=!1,this._updated=!1}onAdd(r){this.map=r,this._maxTileCacheSize=r?r._maxTileCacheSize:null,this._maxTileCacheZoomLevels=r?r._maxTileCacheZoomLevels:null,this._source&&this._source.onAdd&&this._source.onAdd(r)}onRemove(r){this.clearTiles(),this._source&&this._source.onRemove&&this._source.onRemove(r)}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;if(!(this.used===void 0&&this.usedForTerrain===void 0||this.used||this.usedForTerrain))return!0;if(!this._updated)return!1;for(const r in this._tiles){const o=this._tiles[r];if(o.state!=="loaded"&&o.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const r=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,r&&this.reload(),this.transform&&this.update(this.transform,this.terrain)}_loadTile(r,o){return this._source.loadTile(r,o)}_unloadTile(r){if(this._source.unloadTile)return this._source.unloadTile(r,()=>{})}_abortTile(r){this._source.abortTile&&this._source.abortTile(r,()=>{}),this._source.fire(new u.k("dataabort",{tile:r,coord:r.tileID,dataType:"source"}))}serialize(){return this._source.serialize()}prepare(r){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const o in this._tiles){const c=this._tiles[o];c.upload(r),c.prepare(this.map.style.imageManager)}}getIds(){return Object.values(this._tiles).map(r=>r.tileID).sort(jn).map(r=>r.key)}getRenderableIds(r){const o=[];for(const c in this._tiles)this._isIdRenderable(c,r)&&o.push(this._tiles[c]);return r?o.sort((c,d)=>{const g=c.tileID,x=d.tileID,w=new u.P(g.canonical.x,g.canonical.y)._rotate(this.transform.angle),T=new u.P(x.canonical.x,x.canonical.y)._rotate(this.transform.angle);return g.overscaledZ-x.overscaledZ||T.y-w.y||T.x-w.x}).map(c=>c.tileID.key):o.map(c=>c.tileID).sort(jn).map(c=>c.key)}hasRenderableParent(r){const o=this.findLoadedParent(r,0);return!!o&&this._isIdRenderable(o.tileID.key)}_isIdRenderable(r,o){return this._tiles[r]&&this._tiles[r].hasData()&&!this._coveredTiles[r]&&(o||!this._tiles[r].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const r in this._tiles)this._tiles[r].state!=="errored"&&this._reloadTile(r,"reloading")}}_reloadTile(r,o){const c=this._tiles[r];c&&(c.state!=="loading"&&(c.state=o),this._loadTile(c,this._tileLoaded.bind(this,c,r,o)))}_tileLoaded(r,o,c,d){if(d)return r.state="errored",void(d.status!==404?this._source.fire(new u.j(d,{tile:r})):this.update(this.transform,this.terrain));r.timeAdded=u.h.now(),c==="expired"&&(r.refreshedUponExpiration=!0),this._setTileReloadTimer(o,r),this.getSource().type==="raster-dem"&&r.dem&&this._backfillDEM(r),this._state.initializeTileState(r,this.map?this.map.painter:null),r.aborted||this._source.fire(new u.k("data",{dataType:"source",tile:r,coord:r.tileID}))}_backfillDEM(r){const o=this.getRenderableIds();for(let d=0;d<o.length;d++){const g=o[d];if(r.neighboringTiles&&r.neighboringTiles[g]){const x=this.getTileByID(g);c(r,x),c(x,r)}}function c(d,g){d.needsHillshadePrepare=!0,d.needsTerrainPrepare=!0;let x=g.tileID.canonical.x-d.tileID.canonical.x;const w=g.tileID.canonical.y-d.tileID.canonical.y,T=Math.pow(2,d.tileID.canonical.z),E=g.tileID.key;x===0&&w===0||Math.abs(w)>1||(Math.abs(x)>1&&(Math.abs(x+T)===1?x+=T:Math.abs(x-T)===1&&(x-=T)),g.dem&&d.dem&&(d.dem.backfillBorder(g.dem,x,w),d.neighboringTiles&&d.neighboringTiles[E]&&(d.neighboringTiles[E].backfilled=!0)))}}getTile(r){return this.getTileByID(r.key)}getTileByID(r){return this._tiles[r]}_retainLoadedChildren(r,o,c,d){for(const g in this._tiles){let x=this._tiles[g];if(d[g]||!x.hasData()||x.tileID.overscaledZ<=o||x.tileID.overscaledZ>c)continue;let w=x.tileID;for(;x&&x.tileID.overscaledZ>o+1;){const E=x.tileID.scaledTo(x.tileID.overscaledZ-1);x=this._tiles[E.key],x&&x.hasData()&&(w=E)}let T=w;for(;T.overscaledZ>o;)if(T=T.scaledTo(T.overscaledZ-1),r[T.key]){d[w.key]=w;break}}}findLoadedParent(r,o){if(r.key in this._loadedParentTiles){const c=this._loadedParentTiles[r.key];return c&&c.tileID.overscaledZ>=o?c:null}for(let c=r.overscaledZ-1;c>=o;c--){const d=r.scaledTo(c),g=this._getLoadedTile(d);if(g)return g}}_getLoadedTile(r){const o=this._tiles[r.key];return o&&o.hasData()?o:this._cache.getByKey(r.wrapped().key)}updateCacheSize(r){const o=Math.ceil(r.width/this._source.tileSize)+1,c=Math.ceil(r.height/this._source.tileSize)+1,d=Math.floor(o*c*(this._maxTileCacheZoomLevels===null?u.c.MAX_TILE_CACHE_ZOOM_LEVELS:this._maxTileCacheZoomLevels)),g=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,d):d;this._cache.setMaxSize(g)}handleWrapJump(r){const o=Math.round((r-(this._prevLng===void 0?r:this._prevLng))/360);if(this._prevLng=r,o){const c={};for(const d in this._tiles){const g=this._tiles[d];g.tileID=g.tileID.unwrapTo(g.tileID.wrap+o),c[g.tileID.key]=g}this._tiles=c;for(const d in this._timers)clearTimeout(this._timers[d]),delete this._timers[d];for(const d in this._tiles)this._setTileReloadTimer(d,this._tiles[d])}}update(r,o){if(this.transform=r,this.terrain=o,!this._sourceLoaded||this._paused)return;let c;this.updateCacheSize(r),this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?c=r.getVisibleUnwrappedCoordinates(this._source.tileID).map(P=>new u.O(P.canonical.z,P.wrap,P.canonical.z,P.canonical.x,P.canonical.y)):(c=r.coveringTiles({tileSize:this.usedForTerrain?this.tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:!this.usedForTerrain&&this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled,terrain:o}),this._source.hasTile&&(c=c.filter(P=>this._source.hasTile(P)))):c=[];const d=r.coveringZoomLevel(this._source),g=Math.max(d-pn.maxOverzooming,this._source.minzoom),x=Math.max(d+pn.maxUnderzooming,this._source.minzoom);if(this.usedForTerrain){const P={};for(const z of c)if(z.canonical.z>this._source.minzoom){const F=z.scaledTo(z.canonical.z-1);P[F.key]=F;const q=z.scaledTo(Math.max(this._source.minzoom,Math.min(z.canonical.z,5)));P[q.key]=q}c=c.concat(Object.values(P))}const w=c.length===0&&!this._updated&&this._didEmitContent;this._updated=!0,w&&this.fire(new u.k("data",{sourceDataType:"idle",dataType:"source",sourceId:this.id}));const T=this._updateRetainedTiles(c,d);if(Nt(this._source.type)){const P={},z={},F=Object.keys(T),q=u.h.now();for(const $ of F){const G=T[$],U=this._tiles[$];if(!U||U.fadeEndTime!==0&&U.fadeEndTime<=q)continue;const oe=this.findLoadedParent(G,g);oe&&(this._addTile(oe.tileID),P[oe.tileID.key]=oe.tileID),z[$]=G}this._retainLoadedChildren(z,d,x,T);for(const $ in P)T[$]||(this._coveredTiles[$]=!0,T[$]=P[$]);if(o){const $={},G={};for(const U of c)this._tiles[U.key].hasData()?$[U.key]=U:G[U.key]=U;for(const U in G){const oe=G[U].children(this._source.maxzoom);this._tiles[oe[0].key]&&this._tiles[oe[1].key]&&this._tiles[oe[2].key]&&this._tiles[oe[3].key]&&($[oe[0].key]=T[oe[0].key]=oe[0],$[oe[1].key]=T[oe[1].key]=oe[1],$[oe[2].key]=T[oe[2].key]=oe[2],$[oe[3].key]=T[oe[3].key]=oe[3],delete G[U])}for(const U in G){const oe=this.findLoadedParent(G[U],this._source.minzoom);if(oe){$[oe.tileID.key]=T[oe.tileID.key]=oe.tileID;for(const pe in $)$[pe].isChildOf(oe.tileID)&&delete $[pe]}}for(const U in this._tiles)$[U]||(this._coveredTiles[U]=!0)}}for(const P in T)this._tiles[P].clearFadeHold();const E=u.ab(this._tiles,T);for(const P of E){const z=this._tiles[P];z.hasSymbolBuckets&&!z.holdingForFade()?z.setHoldDuration(this.map._fadeDuration):z.hasSymbolBuckets&&!z.symbolFadeFinished()||this._removeTile(P)}this._updateLoadedParentTileCache()}releaseSymbolFadeTiles(){for(const r in this._tiles)this._tiles[r].holdingForFade()&&this._removeTile(r)}_updateRetainedTiles(r,o){const c={},d={},g=Math.max(o-pn.maxOverzooming,this._source.minzoom),x=Math.max(o+pn.maxUnderzooming,this._source.minzoom),w={};for(const T of r){const E=this._addTile(T);c[T.key]=T,E.hasData()||o<this._source.maxzoom&&(w[T.key]=T)}this._retainLoadedChildren(w,o,x,c);for(const T of r){let E=this._tiles[T.key];if(E.hasData())continue;if(o+1>this._source.maxzoom){const z=T.children(this._source.maxzoom)[0],F=this.getTile(z);if(F&&F.hasData()){c[z.key]=z;continue}}else{const z=T.children(this._source.maxzoom);if(c[z[0].key]&&c[z[1].key]&&c[z[2].key]&&c[z[3].key])continue}let P=E.wasRequested();for(let z=T.overscaledZ-1;z>=g;--z){const F=T.scaledTo(z);if(d[F.key])break;if(d[F.key]=!0,E=this.getTile(F),!E&&P&&(E=this._addTile(F)),E){const q=E.hasData();if((P||q)&&(c[F.key]=F),P=E.wasRequested(),q)break}}}return c}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const r in this._tiles){const o=[];let c,d=this._tiles[r].tileID;for(;d.overscaledZ>0;){if(d.key in this._loadedParentTiles){c=this._loadedParentTiles[d.key];break}o.push(d.key);const g=d.scaledTo(d.overscaledZ-1);if(c=this._getLoadedTile(g),c)break;d=g}for(const g of o)this._loadedParentTiles[g]=c}}_addTile(r){let o=this._tiles[r.key];if(o)return o;o=this._cache.getAndRemove(r),o&&(this._setTileReloadTimer(r.key,o),o.tileID=r,this._state.initializeTileState(o,this.map?this.map.painter:null),this._cacheTimers[r.key]&&(clearTimeout(this._cacheTimers[r.key]),delete this._cacheTimers[r.key],this._setTileReloadTimer(r.key,o)));const c=o;return o||(o=new as(r,this._source.tileSize*r.overscaleFactor()),this._loadTile(o,this._tileLoaded.bind(this,o,r.key,o.state))),o.uses++,this._tiles[r.key]=o,c||this._source.fire(new u.k("dataloading",{tile:o,coord:o.tileID,dataType:"source"})),o}_setTileReloadTimer(r,o){r in this._timers&&(clearTimeout(this._timers[r]),delete this._timers[r]);const c=o.getExpiryTimeout();c&&(this._timers[r]=setTimeout(()=>{this._reloadTile(r,"expired"),delete this._timers[r]},c))}_removeTile(r){const o=this._tiles[r];o&&(o.uses--,delete this._tiles[r],this._timers[r]&&(clearTimeout(this._timers[r]),delete this._timers[r]),o.uses>0||(o.hasData()&&o.state!=="reloading"?this._cache.add(o.tileID,o,o.getExpiryTimeout()):(o.aborted=!0,this._abortTile(o),this._unloadTile(o))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const r in this._tiles)this._removeTile(r);this._cache.reset()}tilesIn(r,o,c){const d=[],g=this.transform;if(!g)return d;const x=c?g.getCameraQueryGeometry(r):r,w=r.map($=>g.pointCoordinate($,this.terrain)),T=x.map($=>g.pointCoordinate($,this.terrain)),E=this.getIds();let P=1/0,z=1/0,F=-1/0,q=-1/0;for(const $ of T)P=Math.min(P,$.x),z=Math.min(z,$.y),F=Math.max(F,$.x),q=Math.max(q,$.y);for(let $=0;$<E.length;$++){const G=this._tiles[E[$]];if(G.holdingForFade())continue;const U=G.tileID,oe=Math.pow(2,g.zoom-G.tileID.overscaledZ),pe=o*G.queryPadding*u.N/G.tileSize/oe,Y=[U.getTilePoint(new u.U(P,z)),U.getTilePoint(new u.U(F,q))];if(Y[0].x-pe<u.N&&Y[0].y-pe<u.N&&Y[1].x+pe>=0&&Y[1].y+pe>=0){const ae=w.map(ge=>U.getTilePoint(ge)),me=T.map(ge=>U.getTilePoint(ge));d.push({tile:G,tileID:U,queryGeometry:ae,cameraQueryGeometry:me,scale:oe})}}return d}getVisibleCoordinates(r){const o=this.getRenderableIds(r).map(c=>this._tiles[c].tileID);for(const c of o)c.posMatrix=this.transform.calculatePosMatrix(c.toUnwrapped());return o}hasTransition(){if(this._source.hasTransition())return!0;if(Nt(this._source.type)){const r=u.h.now();for(const o in this._tiles)if(this._tiles[o].fadeEndTime>=r)return!0}return!1}setFeatureState(r,o,c){this._state.updateState(r=r||"_geojsonTileLayer",o,c)}removeFeatureState(r,o,c){this._state.removeFeatureState(r=r||"_geojsonTileLayer",o,c)}getFeatureState(r,o){return this._state.getState(r=r||"_geojsonTileLayer",o)}setDependencies(r,o,c){const d=this._tiles[r];d&&d.setDependencies(o,c)}reloadTilesForDependencies(r,o){for(const c in this._tiles)this._tiles[c].hasDependency(r,o)&&this._reloadTile(c,"reloading");this._cache.filter(c=>!c.hasDependency(r,o))}}function jn(f,r){const o=Math.abs(2*f.wrap)-+(f.wrap<0),c=Math.abs(2*r.wrap)-+(r.wrap<0);return f.overscaledZ-r.overscaledZ||c-o||r.canonical.y-f.canonical.y||r.canonical.x-f.canonical.x}function Nt(f){return f==="raster"||f==="image"||f==="video"}pn.maxOverzooming=10,pn.maxUnderzooming=3;const Et="mapboxgl_preloaded_worker_pool";class _i{constructor(){this.active={}}acquire(r){if(!this.workers)for(this.workers=[];this.workers.length<_i.workerCount;)this.workers.push(new Worker(u.c.WORKER_URL));return this.active[r]=!0,this.workers.slice()}release(r){delete this.active[r],this.numActive()===0&&(this.workers.forEach(o=>{o.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Et]}numActive(){return Object.keys(this.active).length}}const ro=Math.floor(u.h.hardwareConcurrency/2);let Fi;function La(){return Fi||(Fi=new _i),Fi}_i.workerCount=u.ac(globalThis)?Math.max(Math.min(ro,3),1):1;class no{constructor(r,o){this.reset(r,o)}reset(r,o){this.points=r||[],this._distances=[0];for(let c=1;c<this.points.length;c++)this._distances[c]=this._distances[c-1]+this.points[c].dist(this.points[c-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(o||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(r){if(this.points.length===1)return this.points[0];r=u.ad(r,0,1);let o=1,c=this._distances[o];const d=r*this.paddedLength+this.padding;for(;c<d&&o<this._distances.length;)c=this._distances[++o];const g=o-1,x=this._distances[g],w=c-x,T=w>0?(d-x)/w:0;return this.points[g].mult(1-T).add(this.points[o].mult(T))}}function ls(f,r){let o=!0;return f==="always"||f!=="never"&&r!=="never"||(o=!1),o}class ks{constructor(r,o,c){const d=this.boxCells=[],g=this.circleCells=[];this.xCellCount=Math.ceil(r/c),this.yCellCount=Math.ceil(o/c);for(let x=0;x<this.xCellCount*this.yCellCount;x++)d.push([]),g.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=r,this.height=o,this.xScale=this.xCellCount/r,this.yScale=this.yCellCount/o,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(r,o,c,d,g){this._forEachCell(o,c,d,g,this._insertBoxCell,this.boxUid++),this.boxKeys.push(r),this.bboxes.push(o),this.bboxes.push(c),this.bboxes.push(d),this.bboxes.push(g)}insertCircle(r,o,c,d){this._forEachCell(o-d,c-d,o+d,c+d,this._insertCircleCell,this.circleUid++),this.circleKeys.push(r),this.circles.push(o),this.circles.push(c),this.circles.push(d)}_insertBoxCell(r,o,c,d,g,x){this.boxCells[g].push(x)}_insertCircleCell(r,o,c,d,g,x){this.circleCells[g].push(x)}_query(r,o,c,d,g,x,w){if(c<0||r>this.width||d<0||o>this.height)return[];const T=[];if(r<=0&&o<=0&&this.width<=c&&this.height<=d){if(g)return[{key:null,x1:r,y1:o,x2:c,y2:d}];for(let E=0;E<this.boxKeys.length;E++)T.push({key:this.boxKeys[E],x1:this.bboxes[4*E],y1:this.bboxes[4*E+1],x2:this.bboxes[4*E+2],y2:this.bboxes[4*E+3]});for(let E=0;E<this.circleKeys.length;E++){const P=this.circles[3*E],z=this.circles[3*E+1],F=this.circles[3*E+2];T.push({key:this.circleKeys[E],x1:P-F,y1:z-F,x2:P+F,y2:z+F})}}else this._forEachCell(r,o,c,d,this._queryCell,T,{hitTest:g,overlapMode:x,seenUids:{box:{},circle:{}}},w);return T}query(r,o,c,d){return this._query(r,o,c,d,!1,null)}hitTest(r,o,c,d,g,x){return this._query(r,o,c,d,!0,g,x).length>0}hitTestCircle(r,o,c,d,g){const x=r-c,w=r+c,T=o-c,E=o+c;if(w<0||x>this.width||E<0||T>this.height)return!1;const P=[];return this._forEachCell(x,T,w,E,this._queryCellCircle,P,{hitTest:!0,overlapMode:d,circle:{x:r,y:o,radius:c},seenUids:{box:{},circle:{}}},g),P.length>0}_queryCell(r,o,c,d,g,x,w,T){const{seenUids:E,hitTest:P,overlapMode:z}=w,F=this.boxCells[g];if(F!==null){const $=this.bboxes;for(const G of F)if(!E.box[G]){E.box[G]=!0;const U=4*G,oe=this.boxKeys[G];if(r<=$[U+2]&&o<=$[U+3]&&c>=$[U+0]&&d>=$[U+1]&&(!T||T(oe))&&(!P||!ls(z,oe.overlapMode))&&(x.push({key:oe,x1:$[U],y1:$[U+1],x2:$[U+2],y2:$[U+3]}),P))return!0}}const q=this.circleCells[g];if(q!==null){const $=this.circles;for(const G of q)if(!E.circle[G]){E.circle[G]=!0;const U=3*G,oe=this.circleKeys[G];if(this._circleAndRectCollide($[U],$[U+1],$[U+2],r,o,c,d)&&(!T||T(oe))&&(!P||!ls(z,oe.overlapMode))){const pe=$[U],Y=$[U+1],ae=$[U+2];if(x.push({key:oe,x1:pe-ae,y1:Y-ae,x2:pe+ae,y2:Y+ae}),P)return!0}}}return!1}_queryCellCircle(r,o,c,d,g,x,w,T){const{circle:E,seenUids:P,overlapMode:z}=w,F=this.boxCells[g];if(F!==null){const $=this.bboxes;for(const G of F)if(!P.box[G]){P.box[G]=!0;const U=4*G,oe=this.boxKeys[G];if(this._circleAndRectCollide(E.x,E.y,E.radius,$[U+0],$[U+1],$[U+2],$[U+3])&&(!T||T(oe))&&!ls(z,oe.overlapMode))return x.push(!0),!0}}const q=this.circleCells[g];if(q!==null){const $=this.circles;for(const G of q)if(!P.circle[G]){P.circle[G]=!0;const U=3*G,oe=this.circleKeys[G];if(this._circlesCollide($[U],$[U+1],$[U+2],E.x,E.y,E.radius)&&(!T||T(oe))&&!ls(z,oe.overlapMode))return x.push(!0),!0}}}_forEachCell(r,o,c,d,g,x,w,T){const E=this._convertToXCellCoord(r),P=this._convertToYCellCoord(o),z=this._convertToXCellCoord(c),F=this._convertToYCellCoord(d);for(let q=E;q<=z;q++)for(let $=P;$<=F;$++)if(g.call(this,r,o,c,d,this.xCellCount*$+q,x,w,T))return}_convertToXCellCoord(r){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(r*this.xScale)))}_convertToYCellCoord(r){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(r*this.yScale)))}_circlesCollide(r,o,c,d,g,x){const w=d-r,T=g-o,E=c+x;return E*E>w*w+T*T}_circleAndRectCollide(r,o,c,d,g,x,w){const T=(x-d)/2,E=Math.abs(r-(d+T));if(E>T+c)return!1;const P=(w-g)/2,z=Math.abs(o-(g+P));if(z>P+c)return!1;if(E<=T||z<=P)return!0;const F=E-T,q=z-P;return F*F+q*q<=c*c}}function Re(f,r,o,c,d){const g=u.Z();return r?(u.a0(g,g,[1/d,1/d,1]),o||u.ae(g,g,c.angle)):u.a1(g,c.labelPlaneMatrix,f),g}function vi(f,r,o,c,d){if(r){const g=u.af(f);return u.a0(g,g,[d,d,1]),o||u.ae(g,g,-c.angle),g}return c.glCoordMatrix}function er(f,r,o){let c;o?(c=[f.x,f.y,o(f.x,f.y),1],u.ag(c,c,r)):(c=[f.x,f.y,0,1],W(c,c,r));const d=c[3];return{point:new u.P(c[0]/d,c[1]/d),signedDistanceFromCamera:d}}function Es(f,r){return .5+f/r*.5}function Bi(f,r){const o=f[0]/f[3],c=f[1]/f[3];return o>=-r[0]&&o<=r[0]&&c>=-r[1]&&c<=r[1]}function Oe(f,r,o,c,d,g,x,w,T,E){const P=c?f.textSizeData:f.iconSizeData,z=u.ah(P,o.transform.zoom),F=[256/o.width*2+1,256/o.height*2+1],q=c?f.text.dynamicLayoutVertexArray:f.icon.dynamicLayoutVertexArray;q.clear();const $=f.lineVertexArray,G=c?f.text.placedSymbolArray:f.icon.placedSymbolArray,U=o.transform.width/o.transform.height;let oe=!1;for(let pe=0;pe<G.length;pe++){const Y=G.get(pe);if(Y.hidden||Y.writingMode===u.ai.vertical&&!oe){V(Y.numGlyphs,q);continue}let ae;if(oe=!1,E?(ae=[Y.anchorX,Y.anchorY,E(Y.anchorX,Y.anchorY),1],u.ag(ae,ae,r)):(ae=[Y.anchorX,Y.anchorY,0,1],W(ae,ae,r)),!Bi(ae,F)){V(Y.numGlyphs,q);continue}const me=Es(o.transform.cameraToCenterDistance,ae[3]),ge=u.aj(P,z,Y),Te=x?ge/me:ge*me,ze=new u.P(Y.anchorX,Y.anchorY),Ce=er(ze,d,E).point,Ae={projections:{},offsets:{}},Ke=Jr(Y,Te,!1,w,r,d,g,f.glyphOffsetArray,$,q,Ce,ze,Ae,U,T,E);oe=Ke.useVertical,(Ke.notEnoughRoom||oe||Ke.needsFlipping&&Jr(Y,Te,!0,w,r,d,g,f.glyphOffsetArray,$,q,Ce,ze,Ae,U,T,E).notEnoughRoom)&&V(Y.numGlyphs,q)}c?f.text.dynamicLayoutVertexBuffer.updateData(q):f.icon.dynamicLayoutVertexBuffer.updateData(q)}function ft(f,r,o,c,d,g,x,w,T,E,P,z,F){const q=w.glyphStartIndex+w.numGlyphs,$=w.lineStartIndex,G=w.lineStartIndex+w.lineLength,U=r.getoffsetX(w.glyphStartIndex),oe=r.getoffsetX(q-1),pe=A(f*U,o,c,d,g,x,w.segment,$,G,T,E,P,z,F);if(!pe)return null;const Y=A(f*oe,o,c,d,g,x,w.segment,$,G,T,E,P,z,F);return Y?{first:pe,last:Y}:null}function ut(f,r,o,c){return f===u.ai.horizontal&&Math.abs(o.y-r.y)>Math.abs(o.x-r.x)*c?{useVertical:!0}:(f===u.ai.vertical?r.y<o.y:r.x>o.x)?{needsFlipping:!0}:null}function Jr(f,r,o,c,d,g,x,w,T,E,P,z,F,q,$,G){const U=r/24,oe=f.lineOffsetX*U,pe=f.lineOffsetY*U;let Y;if(f.numGlyphs>1){const ae=f.glyphStartIndex+f.numGlyphs,me=f.lineStartIndex,ge=f.lineStartIndex+f.lineLength,Te=ft(U,w,oe,pe,o,P,z,f,T,g,F,$,G);if(!Te)return{notEnoughRoom:!0};const ze=er(Te.first.point,x,G).point,Ce=er(Te.last.point,x,G).point;if(c&&!o){const Ae=ut(f.writingMode,ze,Ce,q);if(Ae)return Ae}Y=[Te.first];for(let Ae=f.glyphStartIndex+1;Ae<ae-1;Ae++)Y.push(A(U*w.getoffsetX(Ae),oe,pe,o,P,z,f.segment,me,ge,T,g,F,$,G));Y.push(Te.last)}else{if(c&&!o){const me=er(z,d,G).point,ge=f.lineStartIndex+f.segment+1,Te=new u.P(T.getx(ge),T.gety(ge)),ze=er(Te,d,G),Ce=ze.signedDistanceFromCamera>0?ze.point:xi(z,Te,me,1,d,G),Ae=ut(f.writingMode,me,Ce,q);if(Ae)return Ae}const ae=A(U*w.getoffsetX(f.glyphStartIndex),oe,pe,o,P,z,f.segment,f.lineStartIndex,f.lineStartIndex+f.lineLength,T,g,F,$,G);if(!ae)return{notEnoughRoom:!0};Y=[ae]}for(const ae of Y)u.ak(E,ae.point,ae.angle);return{}}function xi(f,r,o,c,d,g){const x=er(f.add(f.sub(r)._unit()),d,g).point,w=o.sub(x);return o.add(w._mult(c/w.mag()))}function dt(f,r){const{projectionCache:o,lineVertexArray:c,labelPlaneMatrix:d,tileAnchorPoint:g,distanceFromAnchor:x,getElevation:w,previousVertex:T,direction:E,absOffsetX:P}=r;if(o.projections[f])return o.projections[f];const z=new u.P(c.getx(f),c.gety(f)),F=er(z,d,w);if(F.signedDistanceFromCamera>0)return o.projections[f]=F.point,F.point;const q=f-E;return xi(x===0?g:new u.P(c.getx(q),c.gety(q)),z,T,P-x+1,d,w)}function Oi(f,r,o){return f._unit()._perp()._mult(r*o)}function Z(f,r,o,c,d,g,x,w){const{projectionCache:T,direction:E}=w;if(T.offsets[f])return T.offsets[f];const P=o.add(r);if(f+E<c||f+E>=d)return T.offsets[f]=P,P;const z=dt(f+E,w),F=Oi(z.sub(o),x,E),q=o.add(F),$=z.add(F);return T.offsets[f]=u.al(g,P,q,$)||P,T.offsets[f]}function A(f,r,o,c,d,g,x,w,T,E,P,z,F,q){const $=c?f-r:f+r;let G=$>0?1:-1,U=0;c&&(G*=-1,U=Math.PI),G<0&&(U+=Math.PI);let oe,pe,Y=G>0?w+x:w+x+1,ae=d,me=d,ge=0,Te=0;const ze=Math.abs($),Ce=[];let Ae;for(;ge+Te<=ze;){if(Y+=G,Y<w||Y>=T)return null;ge+=Te,me=ae,pe=oe;const Ne={projectionCache:z,lineVertexArray:E,labelPlaneMatrix:P,tileAnchorPoint:g,distanceFromAnchor:ge,getElevation:q,previousVertex:me,direction:G,absOffsetX:ze};if(ae=dt(Y,Ne),o===0)Ce.push(me),Ae=ae.sub(me);else{let at;const Qe=ae.sub(me);at=Qe.mag()===0?Oi(dt(Y+G,Ne).sub(ae),o,G):Oi(Qe,o,G),pe||(pe=me.add(at)),oe=Z(Y,at,ae,w,T,pe,o,Ne),Ce.push(pe),Ae=oe.sub(pe)}Te=Ae.mag()}const Ke=Ae._mult((ze-ge)/Te)._add(pe||me),_t=U+Math.atan2(ae.y-me.y,ae.x-me.x);return Ce.push(Ke),{point:Ke,angle:F?_t:0,path:Ce}}const R=new Float32Array([-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0,-1/0,-1/0,0]);function V(f,r){for(let o=0;o<f;o++){const c=r.length;r.resize(c+4),r.float32.set(R,3*c)}}function W(f,r,o){const c=r[0],d=r[1];return f[0]=o[0]*c+o[4]*d+o[12],f[1]=o[1]*c+o[5]*d+o[13],f[3]=o[3]*c+o[7]*d+o[15],f}const X=100;class he{constructor(r,o=new ks(r.width+200,r.height+200,25),c=new ks(r.width+200,r.height+200,25)){this.transform=r,this.grid=o,this.ignoredGrid=c,this.pitchfactor=Math.cos(r._pitch)*r.cameraToCenterDistance,this.screenRightBoundary=r.width+X,this.screenBottomBoundary=r.height+X,this.gridRightBoundary=r.width+200,this.gridBottomBoundary=r.height+200,this.perspectiveRatioCutoff=.6}placeCollisionBox(r,o,c,d,g,x){const w=this.projectAndGetPerspectiveRatio(d,r.anchorPointX,r.anchorPointY,x),T=c*w.perspectiveRatio,E=r.x1*T+w.point.x,P=r.y1*T+w.point.y,z=r.x2*T+w.point.x,F=r.y2*T+w.point.y;return!this.isInsideGrid(E,P,z,F)||o!=="always"&&this.grid.hitTest(E,P,z,F,o,g)||w.perspectiveRatio<this.perspectiveRatioCutoff?{box:[],offscreen:!1}:{box:[E,P,z,F],offscreen:this.isOffscreen(E,P,z,F)}}placeCollisionCircles(r,o,c,d,g,x,w,T,E,P,z,F,q,$){const G=[],U=new u.P(o.anchorX,o.anchorY),oe=er(U,x,$),pe=Es(this.transform.cameraToCenterDistance,oe.signedDistanceFromCamera),Y=(P?g/pe:g*pe)/u.ap,ae=er(U,w,$).point,me=ft(Y,d,o.lineOffsetX*Y,o.lineOffsetY*Y,!1,ae,U,o,c,w,{projections:{},offsets:{}},!1,$);let ge=!1,Te=!1,ze=!0;if(me){const Ce=.5*F*pe+q,Ae=new u.P(-100,-100),Ke=new u.P(this.screenRightBoundary,this.screenBottomBoundary),_t=new no,Ne=me.first,at=me.last;let Qe=[];for(let pt=Ne.path.length-1;pt>=1;pt--)Qe.push(Ne.path[pt]);for(let pt=1;pt<at.path.length;pt++)Qe.push(at.path[pt]);const Rt=2.5*Ce;if(T){const pt=Qe.map(vt=>er(vt,T,$));Qe=pt.some(vt=>vt.signedDistanceFromCamera<=0)?[]:pt.map(vt=>vt.point)}let yt=[];if(Qe.length>0){const pt=Qe[0].clone(),vt=Qe[0].clone();for(let ar=1;ar<Qe.length;ar++)pt.x=Math.min(pt.x,Qe[ar].x),pt.y=Math.min(pt.y,Qe[ar].y),vt.x=Math.max(vt.x,Qe[ar].x),vt.y=Math.max(vt.y,Qe[ar].y);yt=pt.x>=Ae.x&&vt.x<=Ke.x&&pt.y>=Ae.y&&vt.y<=Ke.y?[Qe]:vt.x<Ae.x||pt.x>Ke.x||vt.y<Ae.y||pt.y>Ke.y?[]:u.am([Qe],Ae.x,Ae.y,Ke.x,Ke.y)}for(const pt of yt){_t.reset(pt,.25*Ce);let vt=0;vt=_t.length<=.5*Ce?1:Math.ceil(_t.paddedLength/Rt)+1;for(let ar=0;ar<vt;ar++){const jt=ar/Math.max(vt-1,1),Br=_t.lerp(jt),br=Br.x+X,pr=Br.y+X;G.push(br,pr,Ce,0);const An=br-Ce,Zt=pr-Ce,bi=br+Ce,Si=pr+Ce;if(ze=ze&&this.isOffscreen(An,Zt,bi,Si),Te=Te||this.isInsideGrid(An,Zt,bi,Si),r!=="always"&&this.grid.hitTestCircle(br,pr,Ce,r,z)&&(ge=!0,!E))return{circles:[],offscreen:!1,collisionDetected:ge}}}}return{circles:!E&&ge||!Te||pe<this.perspectiveRatioCutoff?[]:G,offscreen:ze,collisionDetected:ge}}queryRenderedSymbols(r){if(r.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const o=[];let c=1/0,d=1/0,g=-1/0,x=-1/0;for(const P of r){const z=new u.P(P.x+X,P.y+X);c=Math.min(c,z.x),d=Math.min(d,z.y),g=Math.max(g,z.x),x=Math.max(x,z.y),o.push(z)}const w=this.grid.query(c,d,g,x).concat(this.ignoredGrid.query(c,d,g,x)),T={},E={};for(const P of w){const z=P.key;if(T[z.bucketInstanceId]===void 0&&(T[z.bucketInstanceId]={}),T[z.bucketInstanceId][z.featureIndex])continue;const F=[new u.P(P.x1,P.y1),new u.P(P.x2,P.y1),new u.P(P.x2,P.y2),new u.P(P.x1,P.y2)];u.an(o,F)&&(T[z.bucketInstanceId][z.featureIndex]=!0,E[z.bucketInstanceId]===void 0&&(E[z.bucketInstanceId]=[]),E[z.bucketInstanceId].push(z.featureIndex))}return E}insertCollisionBox(r,o,c,d,g,x){(c?this.ignoredGrid:this.grid).insert({bucketInstanceId:d,featureIndex:g,collisionGroupID:x,overlapMode:o},r[0],r[1],r[2],r[3])}insertCollisionCircles(r,o,c,d,g,x){const w=c?this.ignoredGrid:this.grid,T={bucketInstanceId:d,featureIndex:g,collisionGroupID:x,overlapMode:o};for(let E=0;E<r.length;E+=4)w.insertCircle(T,r[E],r[E+1],r[E+2])}projectAndGetPerspectiveRatio(r,o,c,d){let g;return d?(g=[o,c,d(o,c),1],u.ag(g,g,r)):(g=[o,c,0,1],W(g,g,r)),{point:new u.P((g[0]/g[3]+1)/2*this.transform.width+X,(-g[1]/g[3]+1)/2*this.transform.height+X),perspectiveRatio:.5+this.transform.cameraToCenterDistance/g[3]*.5}}isOffscreen(r,o,c,d){return c<X||r>=this.screenRightBoundary||d<X||o>this.screenBottomBoundary}isInsideGrid(r,o,c,d){return c>=0&&r<this.gridRightBoundary&&d>=0&&o<this.gridBottomBoundary}getViewportMatrix(){const r=u.ao([]);return u.$(r,r,[-100,-100,0]),r}}function se(f,r,o){return r*(u.N/(f.tileSize*Math.pow(2,o-f.tileID.overscaledZ)))}class J{constructor(r,o,c,d){this.opacity=r?Math.max(0,Math.min(1,r.opacity+(r.placed?o:-o))):d&&c?1:0,this.placed=c}isHidden(){return this.opacity===0&&!this.placed}}class le{constructor(r,o,c,d,g){this.text=new J(r?r.text:null,o,c,g),this.icon=new J(r?r.icon:null,o,d,g)}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class xe{constructor(r,o,c){this.text=r,this.icon=o,this.skipFade=c}}class Se{constructor(){this.invProjMatrix=u.Z(),this.viewportMatrix=u.Z(),this.circles=[]}}class Ie{constructor(r,o,c,d,g){this.bucketInstanceId=r,this.featureIndex=o,this.sourceLayerIndex=c,this.bucketIndex=d,this.tileID=g}}class nt{constructor(r){this.crossSourceCollisions=r,this.maxGroupID=0,this.collisionGroups={}}get(r){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[r]){const o=++this.maxGroupID;this.collisionGroups[r]={ID:o,predicate:c=>c.collisionGroupID===o}}return this.collisionGroups[r]}}function lt(f,r,o,c,d){const{horizontalAlign:g,verticalAlign:x}=u.au(f);return new u.P(-(g-.5)*r+c[0]*d,-(x-.5)*o+c[1]*d)}function Xe(f,r,o,c,d,g){const{x1:x,x2:w,y1:T,y2:E,anchorPointX:P,anchorPointY:z}=f,F=new u.P(r,o);return c&&F._rotate(d?g:-g),{x1:x+F.x,y1:T+F.y,x2:w+F.x,y2:E+F.y,anchorPointX:P,anchorPointY:z}}class st{constructor(r,o,c,d,g){this.transform=r.clone(),this.terrain=o,this.collisionIndex=new he(this.transform),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=c,this.retainedQueryData={},this.collisionGroups=new nt(d),this.collisionCircleArrays={},this.prevPlacement=g,g&&(g.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(r,o,c,d){const g=c.getBucket(o),x=c.latestFeatureIndex;if(!g||!x||o.id!==g.layerIds[0])return;const w=c.collisionBoxArray,T=g.layers[0].layout,E=Math.pow(2,this.transform.zoom-c.tileID.overscaledZ),P=c.tileSize/u.N,z=this.transform.calculatePosMatrix(c.tileID.toUnwrapped()),F=T.get("text-pitch-alignment")==="map",q=T.get("text-rotation-alignment")==="map",$=se(c,1,this.transform.zoom),G=Re(z,F,q,this.transform,$);let U=null;if(F){const pe=vi(z,F,q,this.transform,$);U=u.a1([],this.transform.labelPlaneMatrix,pe)}this.retainedQueryData[g.bucketInstanceId]=new Ie(g.bucketInstanceId,x,g.sourceLayerIndex,g.index,c.tileID);const oe={bucket:g,layout:T,posMatrix:z,textLabelPlaneMatrix:G,labelToScreenMatrix:U,scale:E,textPixelRatio:P,holdingForFade:c.holdingForFade(),collisionBoxArray:w,partiallyEvaluatedTextSize:u.ah(g.textSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(g.sourceID)};if(d)for(const pe of g.sortKeyRanges){const{sortKey:Y,symbolInstanceStart:ae,symbolInstanceEnd:me}=pe;r.push({sortKey:Y,symbolInstanceStart:ae,symbolInstanceEnd:me,parameters:oe})}else r.push({symbolInstanceStart:0,symbolInstanceEnd:g.symbolInstances.length,parameters:oe})}attemptAnchorPlacement(r,o,c,d,g,x,w,T,E,P,z,F,q,$,G,U){const oe=u.aq[r.textAnchor],pe=[r.textOffset0,r.textOffset1],Y=lt(oe,c,d,pe,g),ae=this.collisionIndex.placeCollisionBox(Xe(o,Y.x,Y.y,x,w,this.transform.angle),z,T,E,P.predicate,U);if((!G||this.collisionIndex.placeCollisionBox(Xe(G,Y.x,Y.y,x,w,this.transform.angle),z,T,E,P.predicate,U).box.length!==0)&&ae.box.length>0){let me;if(this.prevPlacement&&this.prevPlacement.variableOffsets[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID]&&this.prevPlacement.placements[F.crossTileID].text&&(me=this.prevPlacement.variableOffsets[F.crossTileID].anchor),F.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");return this.variableOffsets[F.crossTileID]={textOffset:pe,width:c,height:d,anchor:oe,textBoxScale:g,prevAnchor:me},this.markUsedJustification(q,oe,F,$),q.allowVerticalPlacement&&(this.markUsedOrientation(q,$,F),this.placedOrientations[F.crossTileID]=$),{shift:Y,placedGlyphBoxes:ae}}}placeLayerBucketPart(r,o,c){const{bucket:d,layout:g,posMatrix:x,textLabelPlaneMatrix:w,labelToScreenMatrix:T,textPixelRatio:E,holdingForFade:P,collisionBoxArray:z,partiallyEvaluatedTextSize:F,collisionGroup:q}=r.parameters,$=g.get("text-optional"),G=g.get("icon-optional"),U=u.ar(g,"text-overlap","text-allow-overlap"),oe=U==="always",pe=u.ar(g,"icon-overlap","icon-allow-overlap"),Y=pe==="always",ae=g.get("text-rotation-alignment")==="map",me=g.get("text-pitch-alignment")==="map",ge=g.get("icon-text-fit")!=="none",Te=g.get("symbol-z-order")==="viewport-y",ze=oe&&(Y||!d.hasIconData()||G),Ce=Y&&(oe||!d.hasTextData()||$);!d.collisionArrays&&z&&d.deserializeCollisionBoxes(z);const Ae=this.retainedQueryData[d.bucketInstanceId].tileID,Ke=this.terrain?(Ne,at)=>this.terrain.getElevation(Ae,Ne,at):null,_t=(Ne,at)=>{var Qe,Rt;if(o[Ne.crossTileID])return;if(P)return void(this.placements[Ne.crossTileID]=new xe(!1,!1,!1));let yt=!1,pt=!1,vt=!0,ar=null,jt={box:null,offscreen:null},Br={box:null,offscreen:null},br=null,pr=null,An=null,Zt=0,bi=0,Si=0;at.textFeatureIndex?Zt=at.textFeatureIndex:Ne.useRuntimeCollisionCircles&&(Zt=Ne.featureIndex),at.verticalTextFeatureIndex&&(bi=at.verticalTextFeatureIndex);const ms=at.textBox;if(ms){const Gr=lr=>{let Sr=u.ai.horizontal;if(d.allowVerticalPlacement&&!lr&&this.prevPlacement){const gn=this.prevPlacement.placedOrientations[Ne.crossTileID];gn&&(this.placedOrientations[Ne.crossTileID]=gn,Sr=gn,this.markUsedOrientation(d,Sr,Ne))}return Sr},Or=(lr,Sr)=>{if(d.allowVerticalPlacement&&Ne.numVerticalGlyphVertices>0&&at.verticalTextBox){for(const gn of d.writingModes)if(gn===u.ai.vertical?(jt=Sr(),Br=jt):jt=lr(),jt&&jt.box&&jt.box.length)break}else jt=lr()},tn=Ne.textAnchorOffsetStartIndex,Fs=Ne.textAnchorOffsetEndIndex;if(Fs===tn){const lr=(Sr,gn)=>{const ur=this.collisionIndex.placeCollisionBox(Sr,U,E,x,q.predicate,Ke);return ur&&ur.box&&ur.box.length&&(this.markUsedOrientation(d,gn,Ne),this.placedOrientations[Ne.crossTileID]=gn),ur};Or(()=>lr(ms,u.ai.horizontal),()=>{const Sr=at.verticalTextBox;return d.allowVerticalPlacement&&Ne.numVerticalGlyphVertices>0&&Sr?lr(Sr,u.ai.vertical):{box:null,offscreen:null}}),Gr(jt&&jt.box&&jt.box.length)}else{let lr=u.aq[(Rt=(Qe=this.prevPlacement)===null||Qe===void 0?void 0:Qe.variableOffsets[Ne.crossTileID])===null||Rt===void 0?void 0:Rt.anchor];const Sr=(ur,Bs,ul)=>{const Lh=ur.x2-ur.x1,Rh=ur.y2-ur.y1,Jp=Ne.textBoxScale,Bu=ge&&pe==="never"?Bs:null;let Ti={box:[],offscreen:!1},Os=U==="never"?1:2,ki="never";lr&&Os++;for(let Xn=0;Xn<Os;Xn++){for(let Ei=tn;Ei<Fs;Ei++){const Ou=d.textAnchorOffsets.get(Ei);if(lr&&Ou.textAnchor!==lr)continue;const qi=this.attemptAnchorPlacement(Ou,ur,Lh,Rh,Jp,ae,me,E,x,q,ki,Ne,d,ul,Bu,Ke);if(qi&&(Ti=qi.placedGlyphBoxes,Ti&&Ti.box&&Ti.box.length))return yt=!0,ar=qi.shift,Ti}lr?lr=null:ki=U}return Ti};Or(()=>Sr(ms,at.iconBox,u.ai.horizontal),()=>{const ur=at.verticalTextBox;return d.allowVerticalPlacement&&!(jt&&jt.box&&jt.box.length)&&Ne.numVerticalGlyphVertices>0&&ur?Sr(ur,at.verticalIconBox,u.ai.vertical):{box:null,offscreen:null}}),jt&&(yt=jt.box,vt=jt.offscreen);const gn=Gr(jt&&jt.box);if(!yt&&this.prevPlacement){const ur=this.prevPlacement.variableOffsets[Ne.crossTileID];ur&&(this.variableOffsets[Ne.crossTileID]=ur,this.markUsedJustification(d,ur.anchor,Ne,gn))}}}if(br=jt,yt=br&&br.box&&br.box.length>0,vt=br&&br.offscreen,Ne.useRuntimeCollisionCircles){const Gr=d.text.placedSymbolArray.get(Ne.centerJustifiedTextSymbolIndex),Or=u.aj(d.textSizeData,F,Gr),tn=g.get("text-padding");pr=this.collisionIndex.placeCollisionCircles(U,Gr,d.lineVertexArray,d.glyphOffsetArray,Or,x,w,T,c,me,q.predicate,Ne.collisionCircleDiameter,tn,Ke),pr.circles.length&&pr.collisionDetected&&!c&&u.w("Collisions detected, but collision boxes are not shown"),yt=oe||pr.circles.length>0&&!pr.collisionDetected,vt=vt&&pr.offscreen}if(at.iconFeatureIndex&&(Si=at.iconFeatureIndex),at.iconBox){const Gr=Or=>{const tn=ge&&ar?Xe(Or,ar.x,ar.y,ae,me,this.transform.angle):Or;return this.collisionIndex.placeCollisionBox(tn,pe,E,x,q.predicate,Ke)};Br&&Br.box&&Br.box.length&&at.verticalIconBox?(An=Gr(at.verticalIconBox),pt=An.box.length>0):(An=Gr(at.iconBox),pt=An.box.length>0),vt=vt&&An.offscreen}const Rs=$||Ne.numHorizontalGlyphVertices===0&&Ne.numVerticalGlyphVertices===0,_o=G||Ne.numIconVertices===0;if(Rs||_o?_o?Rs||(pt=pt&&yt):yt=pt&&yt:pt=yt=pt&&yt,yt&&br&&br.box&&this.collisionIndex.insertCollisionBox(br.box,U,g.get("text-ignore-placement"),d.bucketInstanceId,Br&&Br.box&&bi?bi:Zt,q.ID),pt&&An&&this.collisionIndex.insertCollisionBox(An.box,pe,g.get("icon-ignore-placement"),d.bucketInstanceId,Si,q.ID),pr&&(yt&&this.collisionIndex.insertCollisionCircles(pr.circles,U,g.get("text-ignore-placement"),d.bucketInstanceId,Zt,q.ID),c)){const Gr=d.bucketInstanceId;let Or=this.collisionCircleArrays[Gr];Or===void 0&&(Or=this.collisionCircleArrays[Gr]=new Se);for(let tn=0;tn<pr.circles.length;tn+=4)Or.circles.push(pr.circles[tn+0]),Or.circles.push(pr.circles[tn+1]),Or.circles.push(pr.circles[tn+2]),Or.circles.push(pr.collisionDetected?1:0)}if(Ne.crossTileID===0)throw new Error("symbolInstance.crossTileID can't be 0");if(d.bucketInstanceId===0)throw new Error("bucket.bucketInstanceId can't be 0");this.placements[Ne.crossTileID]=new xe(yt||ze,pt||Ce,vt||d.justReloaded),o[Ne.crossTileID]=!0};if(Te){if(r.symbolInstanceStart!==0)throw new Error("bucket.bucketInstanceId should be 0");const Ne=d.getSortedSymbolIndexes(this.transform.angle);for(let at=Ne.length-1;at>=0;--at){const Qe=Ne[at];_t(d.symbolInstances.get(Qe),d.collisionArrays[Qe])}}else for(let Ne=r.symbolInstanceStart;Ne<r.symbolInstanceEnd;Ne++)_t(d.symbolInstances.get(Ne),d.collisionArrays[Ne]);if(c&&d.bucketInstanceId in this.collisionCircleArrays){const Ne=this.collisionCircleArrays[d.bucketInstanceId];u.as(Ne.invProjMatrix,x),Ne.viewportMatrix=this.collisionIndex.getViewportMatrix()}d.justReloaded=!1}markUsedJustification(r,o,c,d){let g;g=d===u.ai.vertical?c.verticalPlacedTextSymbolIndex:{left:c.leftJustifiedTextSymbolIndex,center:c.centerJustifiedTextSymbolIndex,right:c.rightJustifiedTextSymbolIndex}[u.at(o)];const x=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex,c.verticalPlacedTextSymbolIndex];for(const w of x)w>=0&&(r.text.placedSymbolArray.get(w).crossTileID=g>=0&&w!==g?0:c.crossTileID)}markUsedOrientation(r,o,c){const d=o===u.ai.horizontal||o===u.ai.horizontalOnly?o:0,g=o===u.ai.vertical?o:0,x=[c.leftJustifiedTextSymbolIndex,c.centerJustifiedTextSymbolIndex,c.rightJustifiedTextSymbolIndex];for(const w of x)r.text.placedSymbolArray.get(w).placedOrientation=d;c.verticalPlacedTextSymbolIndex&&(r.text.placedSymbolArray.get(c.verticalPlacedTextSymbolIndex).placedOrientation=g)}commit(r){this.commitTime=r,this.zoomAtLastRecencyCheck=this.transform.zoom;const o=this.prevPlacement;let c=!1;this.prevZoomAdjustment=o?o.zoomAdjustment(this.transform.zoom):0;const d=o?o.symbolFadeChange(r):1,g=o?o.opacities:{},x=o?o.variableOffsets:{},w=o?o.placedOrientations:{};for(const T in this.placements){const E=this.placements[T],P=g[T];P?(this.opacities[T]=new le(P,d,E.text,E.icon),c=c||E.text!==P.text.placed||E.icon!==P.icon.placed):(this.opacities[T]=new le(null,d,E.text,E.icon,E.skipFade),c=c||E.text||E.icon)}for(const T in g){const E=g[T];if(!this.opacities[T]){const P=new le(E,d,!1,!1);P.isHidden()||(this.opacities[T]=P,c=c||E.text.placed||E.icon.placed)}}for(const T in x)this.variableOffsets[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.variableOffsets[T]=x[T]);for(const T in w)this.placedOrientations[T]||!this.opacities[T]||this.opacities[T].isHidden()||(this.placedOrientations[T]=w[T]);if(o&&o.lastPlacementChangeTime===void 0)throw new Error("Last placement time for previous placement is not defined");c?this.lastPlacementChangeTime=r:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=o?o.lastPlacementChangeTime:r)}updateLayerOpacities(r,o){const c={};for(const d of o){const g=d.getBucket(r);g&&d.latestFeatureIndex&&r.id===g.layerIds[0]&&this.updateBucketOpacities(g,c,d.collisionBoxArray)}}updateBucketOpacities(r,o,c){r.hasTextData()&&(r.text.opacityVertexArray.clear(),r.text.hasVisibleVertices=!1),r.hasIconData()&&(r.icon.opacityVertexArray.clear(),r.icon.hasVisibleVertices=!1),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexArray.clear(),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexArray.clear();const d=r.layers[0],g=d.layout,x=new le(null,0,!1,!1,!0),w=g.get("text-allow-overlap"),T=g.get("icon-allow-overlap"),E=d._unevaluatedLayout.hasValue("text-variable-anchor")||d._unevaluatedLayout.hasValue("text-variable-anchor-offset"),P=g.get("text-rotation-alignment")==="map",z=g.get("text-pitch-alignment")==="map",F=g.get("icon-text-fit")!=="none",q=new le(null,0,w&&(T||!r.hasIconData()||g.get("icon-optional")),T&&(w||!r.hasTextData()||g.get("text-optional")),!0);!r.collisionArrays&&c&&(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData())&&r.deserializeCollisionBoxes(c);const $=(G,U,oe)=>{for(let pe=0;pe<U/4;pe++)G.opacityVertexArray.emplaceBack(oe);G.hasVisibleVertices=G.hasVisibleVertices||oe!==$n};for(let G=0;G<r.symbolInstances.length;G++){const U=r.symbolInstances.get(G),{numHorizontalGlyphVertices:oe,numVerticalGlyphVertices:pe,crossTileID:Y}=U;let ae=this.opacities[Y];o[Y]?ae=x:ae||(ae=q,this.opacities[Y]=ae),o[Y]=!0;const me=U.numIconVertices>0,ge=this.placedOrientations[U.crossTileID],Te=ge===u.ai.vertical,ze=ge===u.ai.horizontal||ge===u.ai.horizontalOnly;if(oe>0||pe>0){const Ce=Rr(ae.text);$(r.text,oe,Te?$n:Ce),$(r.text,pe,ze?$n:Ce);const Ae=ae.text.isHidden();[U.rightJustifiedTextSymbolIndex,U.centerJustifiedTextSymbolIndex,U.leftJustifiedTextSymbolIndex].forEach(Ne=>{Ne>=0&&(r.text.placedSymbolArray.get(Ne).hidden=Ae||Te?1:0)}),U.verticalPlacedTextSymbolIndex>=0&&(r.text.placedSymbolArray.get(U.verticalPlacedTextSymbolIndex).hidden=Ae||ze?1:0);const Ke=this.variableOffsets[U.crossTileID];Ke&&this.markUsedJustification(r,Ke.anchor,U,ge);const _t=this.placedOrientations[U.crossTileID];_t&&(this.markUsedJustification(r,"left",U,_t),this.markUsedOrientation(r,_t,U))}if(me){const Ce=Rr(ae.icon),Ae=!(F&&U.verticalPlacedIconSymbolIndex&&Te);U.placedIconSymbolIndex>=0&&($(r.icon,U.numIconVertices,Ae?Ce:$n),r.icon.placedSymbolArray.get(U.placedIconSymbolIndex).hidden=ae.icon.isHidden()),U.verticalPlacedIconSymbolIndex>=0&&($(r.icon,U.numVerticalIconVertices,Ae?$n:Ce),r.icon.placedSymbolArray.get(U.verticalPlacedIconSymbolIndex).hidden=ae.icon.isHidden())}if(r.hasIconCollisionBoxData()||r.hasTextCollisionBoxData()){const Ce=r.collisionArrays[G];if(Ce){let Ae=new u.P(0,0);if(Ce.textBox||Ce.verticalTextBox){let _t=!0;if(E){const Ne=this.variableOffsets[Y];Ne?(Ae=lt(Ne.anchor,Ne.width,Ne.height,Ne.textOffset,Ne.textBoxScale),P&&Ae._rotate(z?this.transform.angle:-this.transform.angle)):_t=!1}Ce.textBox&&ct(r.textCollisionBox.collisionVertexArray,ae.text.placed,!_t||Te,Ae.x,Ae.y),Ce.verticalTextBox&&ct(r.textCollisionBox.collisionVertexArray,ae.text.placed,!_t||ze,Ae.x,Ae.y)}const Ke=!!(!ze&&Ce.verticalIconBox);Ce.iconBox&&ct(r.iconCollisionBox.collisionVertexArray,ae.icon.placed,Ke,F?Ae.x:0,F?Ae.y:0),Ce.verticalIconBox&&ct(r.iconCollisionBox.collisionVertexArray,ae.icon.placed,!Ke,F?Ae.x:0,F?Ae.y:0)}}}if(r.sortFeatures(this.transform.angle),this.retainedQueryData[r.bucketInstanceId]&&(this.retainedQueryData[r.bucketInstanceId].featureSortOrder=r.featureSortOrder),r.hasTextData()&&r.text.opacityVertexBuffer&&r.text.opacityVertexBuffer.updateData(r.text.opacityVertexArray),r.hasIconData()&&r.icon.opacityVertexBuffer&&r.icon.opacityVertexBuffer.updateData(r.icon.opacityVertexArray),r.hasIconCollisionBoxData()&&r.iconCollisionBox.collisionVertexBuffer&&r.iconCollisionBox.collisionVertexBuffer.updateData(r.iconCollisionBox.collisionVertexArray),r.hasTextCollisionBoxData()&&r.textCollisionBox.collisionVertexBuffer&&r.textCollisionBox.collisionVertexBuffer.updateData(r.textCollisionBox.collisionVertexArray),r.text.opacityVertexArray.length!==r.text.layoutVertexArray.length/4)throw new Error(`bucket.text.opacityVertexArray.length (= ${r.text.opacityVertexArray.length}) !== bucket.text.layoutVertexArray.length (= ${r.text.layoutVertexArray.length}) / 4`);if(r.icon.opacityVertexArray.length!==r.icon.layoutVertexArray.length/4)throw new Error(`bucket.icon.opacityVertexArray.length (= ${r.icon.opacityVertexArray.length}) !== bucket.icon.layoutVertexArray.length (= ${r.icon.layoutVertexArray.length}) / 4`);if(r.bucketInstanceId in this.collisionCircleArrays){const G=this.collisionCircleArrays[r.bucketInstanceId];r.placementInvProjMatrix=G.invProjMatrix,r.placementViewportMatrix=G.viewportMatrix,r.collisionCircleArray=G.circles,delete this.collisionCircleArrays[r.bucketInstanceId]}}symbolFadeChange(r){return this.fadeDuration===0?1:(r-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(r){return Math.max(0,(this.transform.zoom-r)/1.5)}hasTransitions(r){return this.stale||r-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(r,o){const c=this.zoomAtLastRecencyCheck===o?1-this.zoomAdjustment(o):1;return this.zoomAtLastRecencyCheck=o,this.commitTime+this.fadeDuration*c>r}setStale(){this.stale=!0}}function ct(f,r,o,c,d){f.emplaceBack(r?1:0,o?1:0,c||0,d||0),f.emplaceBack(r?1:0,o?1:0,c||0,d||0),f.emplaceBack(r?1:0,o?1:0,c||0,d||0),f.emplaceBack(r?1:0,o?1:0,c||0,d||0)}const Mt=Math.pow(2,25),Bt=Math.pow(2,24),Tt=Math.pow(2,17),St=Math.pow(2,16),qr=Math.pow(2,9),Ut=Math.pow(2,8),_r=Math.pow(2,1);function Rr(f){if(f.opacity===0&&!f.placed)return 0;if(f.opacity===1&&f.placed)return 4294967295;const r=f.placed?1:0,o=Math.floor(127*f.opacity);return o*Mt+r*Bt+o*Tt+r*St+o*qr+r*Ut+o*_r+r}const $n=0;class Kc{constructor(r){this._sortAcrossTiles=r.layout.get("symbol-z-order")!=="viewport-y"&&!r.layout.get("symbol-sort-key").isConstant(),this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs={},this._bucketParts=[]}continuePlacement(r,o,c,d,g){const x=this._bucketParts;for(;this._currentTileIndex<r.length;)if(o.getBucketParts(x,d,r[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,g())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,x.sort((w,T)=>w.sortKey-T.sortKey));this._currentPartIndex<x.length;)if(o.placeLayerBucketPart(x[this._currentPartIndex],this._seenCrossTileIDs,c),this._currentPartIndex++,g())return!0;return!1}}class io{constructor(r,o,c,d,g,x,w,T){this.placement=new st(r,o,x,w,T),this._currentPlacementIndex=c.length-1,this._forceFullPlacement=d,this._showCollisionBoxes=g,this._done=!1}isDone(){return this._done}continuePlacement(r,o,c){const d=u.h.now(),g=()=>!this._forceFullPlacement&&u.h.now()-d>2;for(;this._currentPlacementIndex>=0;){const x=o[r[this._currentPlacementIndex]],w=this.placement.collisionIndex.transform.zoom;if(x.type==="symbol"&&(!x.minzoom||x.minzoom<=w)&&(!x.maxzoom||x.maxzoom>w)){if(this._inProgressLayer||(this._inProgressLayer=new Kc(x)),this._inProgressLayer.continuePlacement(c[x.source],this.placement,this._showCollisionBoxes,x,g))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(r){return this.placement.commit(r),this.placement}}const so=512/u.N/2;class Fp{constructor(r,o,c){this.tileID=r,this.bucketInstanceId=c,this._symbolsByKey={};const d=new Map;for(let g=0;g<o.length;g++){const x=o.get(g),w=x.key,T=d.get(w);T?T.push(x):d.set(w,[x])}for(const[g,x]of d){const w={positions:x.map(T=>({x:Math.floor(T.anchorX*so),y:Math.floor(T.anchorY*so)})),crossTileIDs:x.map(T=>T.crossTileID)};if(w.positions.length>128){const T=new u.av(w.positions.length,16,Uint16Array);for(const{x:E,y:P}of w.positions)T.add(E,P);T.finish(),delete w.positions,w.index=T}this._symbolsByKey[g]=w}}getScaledCoordinates(r,o){const{x:c,y:d,z:g}=this.tileID.canonical,{x,y:w,z:T}=o.canonical,E=so/Math.pow(2,T-g),P=(w*u.N+r.anchorY)*E,z=d*u.N*so;return{x:Math.floor((x*u.N+r.anchorX)*E-c*u.N*so),y:Math.floor(P-z)}}findMatches(r,o,c){const d=this.tileID.canonical.z<o.canonical.z?1:Math.pow(2,this.tileID.canonical.z-o.canonical.z);for(let g=0;g<r.length;g++){const x=r.get(g);if(x.crossTileID)continue;const w=this._symbolsByKey[x.key];if(!w)continue;const T=this.getScaledCoordinates(x,o);if(w.index){const E=w.index.range(T.x-d,T.y-d,T.x+d,T.y+d).sort();for(const P of E){const z=w.crossTileIDs[P];if(!c[z]){c[z]=!0,x.crossTileID=z;break}}}else if(w.positions)for(let E=0;E<w.positions.length;E++){const P=w.positions[E],z=w.crossTileIDs[E];if(Math.abs(P.x-T.x)<=d&&Math.abs(P.y-T.y)<=d&&!c[z]){c[z]=!0,x.crossTileID=z;break}}}}getCrossTileIDsLists(){return Object.values(this._symbolsByKey).map(({crossTileIDs:r})=>r)}}class Lt{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Kl{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(r){const o=Math.round((r-this.lng)/360);if(o!==0)for(const c in this.indexes){const d=this.indexes[c],g={};for(const x in d){const w=d[x];w.tileID=w.tileID.unwrapTo(w.tileID.wrap+o),g[w.tileID.key]=w}this.indexes[c]=g}this.lng=r}addBucket(r,o,c){if(this.indexes[r.overscaledZ]&&this.indexes[r.overscaledZ][r.key]){if(this.indexes[r.overscaledZ][r.key].bucketInstanceId===o.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(r.overscaledZ,this.indexes[r.overscaledZ][r.key])}for(let g=0;g<o.symbolInstances.length;g++)o.symbolInstances.get(g).crossTileID=0;this.usedCrossTileIDs[r.overscaledZ]||(this.usedCrossTileIDs[r.overscaledZ]={});const d=this.usedCrossTileIDs[r.overscaledZ];for(const g in this.indexes){const x=this.indexes[g];if(Number(g)>r.overscaledZ)for(const w in x){const T=x[w];T.tileID.isChildOf(r)&&T.findMatches(o.symbolInstances,r,d)}else{const w=x[r.scaledTo(Number(g)).key];w&&w.findMatches(o.symbolInstances,r,d)}}for(let g=0;g<o.symbolInstances.length;g++){const x=o.symbolInstances.get(g);x.crossTileID||(x.crossTileID=c.generate(),d[x.crossTileID]=!0)}return this.indexes[r.overscaledZ]===void 0&&(this.indexes[r.overscaledZ]={}),this.indexes[r.overscaledZ][r.key]=new Fp(r,o.symbolInstances,o.bucketInstanceId),!0}removeBucketCrossTileIDs(r,o){for(const c of o.getCrossTileIDsLists())for(const d of c)delete this.usedCrossTileIDs[r][d]}removeStaleBuckets(r){let o=!1;for(const c in this.indexes){const d=this.indexes[c];for(const g in d)r[d[g].bucketInstanceId]||(this.removeBucketCrossTileIDs(c,d[g]),delete d[g],o=!0)}return o}}class Ra{constructor(){this.layerIndexes={},this.crossTileIDs=new Lt,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(r,o,c){let d=this.layerIndexes[r.id];d===void 0&&(d=this.layerIndexes[r.id]=new Kl);let g=!1;const x={};d.handleWrapJump(c);for(const w of o){const T=w.getBucket(r);T&&r.id===T.layerIds[0]&&(T.bucketInstanceId||(T.bucketInstanceId=++this.maxBucketInstanceId),d.addBucket(w.tileID,T,this.crossTileIDs)&&(g=!0),x[T.bucketInstanceId]=!0)}return d.removeStaleBuckets(x)&&(g=!0),g}pruneUnusedLayers(r){const o={};r.forEach(c=>{o[c]=!0});for(const c in this.layerIndexes)o[c]||delete this.layerIndexes[c]}}const Zr=(f,r)=>u.x(f,r&&r.filter(o=>o.identifier!=="source.canvas")),In=u.F(u.ax,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setGlyphs","setSprite"]),Bp=u.F(u.ax,["setCenter","setZoom","setBearing","setPitch"]),qn=u.aw();class Fr extends u.E{constructor(r,o={}){super(),this.map=r,this.dispatcher=new Vt(La(),this,r._getMapId()),this.imageManager=new Lr,this.imageManager.setEventedParent(this),this.glyphManager=new En(r._requestManager,o.localIdeographFontFamily),this.lineAtlas=new mt(256,512),this.crossTileSymbolIndex=new Ra,this._spritesImagesIds={},this._layers={},this._order=[],this.sourceCaches={},this.zoomHistory=new u.ay,this._loaded=!1,this._availableImages=[],this._resetUpdates(),this.dispatcher.broadcast("setReferrer",u.az());const c=this;this._rtlTextPluginCallback=Fr.registerForPluginStateChange(d=>{c.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:d.pluginStatus,pluginURL:d.pluginURL},(g,x)=>{if(u.aA(g),x&&x.every(w=>w))for(const w in c.sourceCaches){const T=c.sourceCaches[w].getSource().type;T!=="vector"&&T!=="geojson"||c.sourceCaches[w].reload()}})}),this.on("data",d=>{if(d.dataType!=="source"||d.sourceDataType!=="metadata")return;const g=this.sourceCaches[d.sourceId];if(!g)return;const x=g.getSource();if(x&&x.vectorLayerIds)for(const w in this._layers){const T=this._layers[w];T.source===x.id&&this._validateLayer(T)}})}loadURL(r,o={},c){this.fire(new u.k("dataloading",{dataType:"style"})),o.validate=typeof o.validate!="boolean"||o.validate;const d=this.map._requestManager.transformRequest(r,K.Style);this._request=u.f(d,(g,x)=>{this._request=null,g?this.fire(new u.j(g)):x&&this._load(x,o,c)})}loadJSON(r,o={},c){this.fire(new u.k("dataloading",{dataType:"style"})),this._request=u.h.frame(()=>{this._request=null,o.validate=o.validate!==!1,this._load(r,o,c)})}loadEmpty(){this.fire(new u.k("dataloading",{dataType:"style"})),this._load(qn,{validate:!1})}_load(r,o,c){var d;const g=o.transformStyle?o.transformStyle(c,r):r;if(!o.validate||!Zr(this,u.y(g))){this._loaded=!0,this.stylesheet=g;for(const x in g.sources)this.addSource(x,g.sources[x],{validate:!1});g.sprite?this._loadSprite(g.sprite):this.imageManager.setLoaded(!0),this.glyphManager.setURL(g.glyphs),this._createLayers(),this.light=new ht(this.stylesheet.light),this.map.setTerrain((d=this.stylesheet.terrain)!==null&&d!==void 0?d:null),this.fire(new u.k("data",{dataType:"style"})),this.fire(new u.k("style.load"))}}_createLayers(){const r=u.aB(this.stylesheet.layers);this.dispatcher.broadcast("setLayers",r),this._order=r.map(o=>o.id),this._layers={},this._serializedLayers=null;for(const o of r){const c=u.aC(o);c.setEventedParent(this,{layer:{id:o.id}}),this._layers[o.id]=c}}_loadSprite(r,o=!1,c=void 0){this.imageManager.setLoaded(!1),this._spriteRequest=function(d,g,x,w){const T=Ze(d),E=T.length,P=x>1?"@2x":"",z={},F={},q={};for(const{id:$,url:G}of T){const U=g.transformRequest(g.normalizeSpriteURL(G,P,".json"),K.SpriteJSON),oe=`${$}_${U.url}`;z[oe]=u.f(U,(ae,me)=>{delete z[oe],F[$]=me,kt(w,F,q,ae,E)});const pe=g.transformRequest(g.normalizeSpriteURL(G,P,".png"),K.SpriteImage),Y=`${$}_${pe.url}`;z[Y]=we.getImage(pe,(ae,me)=>{delete z[Y],q[$]=me,kt(w,F,q,ae,E)})}return{cancel(){for(const $ of Object.values(z))$.cancel()}}}(r,this.map._requestManager,this.map.getPixelRatio(),(d,g)=>{if(this._spriteRequest=null,d)this.fire(new u.j(d));else if(g)for(const x in g){this._spritesImagesIds[x]=[];const w=this._spritesImagesIds[x]?this._spritesImagesIds[x].filter(T=>!(T in g)):[];for(const T of w)this.imageManager.removeImage(T),this._changedImages[T]=!0;for(const T in g[x]){const E=x==="default"?T:`${x}:${T}`;this._spritesImagesIds[x].push(E),E in this.imageManager.images?this.imageManager.updateImage(E,g[x][T],!1):this.imageManager.addImage(E,g[x][T]),o&&(this._changedImages[E]=!0)}}this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),o&&(this._changed=!0),this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.k("data",{dataType:"style"})),c&&c(d)})}_unloadSprite(){for(const r of Object.values(this._spritesImagesIds).flat())this.imageManager.removeImage(r),this._changedImages[r]=!0;this._spritesImagesIds={},this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}_validateLayer(r){const o=this.sourceCaches[r.source];if(!o)return;const c=r.sourceLayer;if(!c)return;const d=o.getSource();(d.type==="geojson"||d.vectorLayerIds&&d.vectorLayerIds.indexOf(c)===-1)&&this.fire(new u.j(new Error(`Source layer "${c}" does not exist on source "${d.id}" as specified by style layer "${r.id}".`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const r in this.sourceCaches)if(!this.sourceCaches[r].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeByIds(r){const o=this._serializedAllLayers();if(!r||r.length===0)return Object.values(o);const c=[];for(const d of r)o[d]&&c.push(o[d]);return c}_serializedAllLayers(){let r=this._serializedLayers;if(r)return r;r=this._serializedLayers={};const o=Object.keys(this._layers);for(const c of o){const d=this._layers[c];d.type!=="custom"&&(r[c]=d.serialize())}return r}hasTransitions(){if(this.light&&this.light.hasTransition())return!0;for(const r in this.sourceCaches)if(this.sourceCaches[r].hasTransition())return!0;for(const r in this._layers)if(this._layers[r].hasTransition())return!0;return!1}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading.")}update(r){if(!this._loaded)return;const o=this._changed;if(this._changed){const d=Object.keys(this._updatedLayers),g=Object.keys(this._removedLayers);(d.length||g.length)&&this._updateWorkerLayers(d,g);for(const x in this._updatedSources){const w=this._updatedSources[x];if(w==="reload")this._reloadSource(x);else{if(w!=="clear")throw new Error(`Invalid action ${w}`);this._clearSource(x)}}this._updateTilesForChangedImages(),this._updateTilesForChangedGlyphs();for(const x in this._updatedPaintProps)this._layers[x].updateTransitions(r);this.light.updateTransitions(r),this._resetUpdates()}const c={};for(const d in this.sourceCaches){const g=this.sourceCaches[d];c[d]=g.used,g.used=!1}for(const d of this._order){const g=this._layers[d];g.recalculate(r,this._availableImages),!g.isHidden(r.zoom)&&g.source&&(this.sourceCaches[g.source].used=!0)}for(const d in c){const g=this.sourceCaches[d];c[d]!==g.used&&g.fire(new u.k("data",{sourceDataType:"visibility",dataType:"source",sourceId:d}))}this.light.recalculate(r),this.z=r.zoom,o&&this.fire(new u.k("data",{dataType:"style"}))}_updateTilesForChangedImages(){const r=Object.keys(this._changedImages);if(r.length){for(const o in this.sourceCaches)this.sourceCaches[o].reloadTilesForDependencies(["icons","patterns"],r);this._changedImages={}}}_updateTilesForChangedGlyphs(){if(this._glyphsDidChange){for(const r in this.sourceCaches)this.sourceCaches[r].reloadTilesForDependencies(["glyphs"],[""]);this._glyphsDidChange=!1}}_updateWorkerLayers(r,o){this.dispatcher.broadcast("updateLayers",{layers:this._serializeByIds(r),removedIds:o})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={},this._glyphsDidChange=!1}setState(r,o={}){this._checkLoaded();const c=this.serialize();if(r=o.transformStyle?o.transformStyle(c,r):r,Zr(this,u.y(r)))return!1;(r=u.aD(r)).layers=u.aB(r.layers);const d=u.aE(c,r).filter(x=>!(x.command in Bp));if(d.length===0)return!1;const g=d.filter(x=>!(x.command in In));if(g.length>0)throw new Error(`Unimplemented: ${g.map(x=>x.command).join(", ")}.`);for(const x of d)x.command!=="setTransition"&&this[x.command].apply(this,x.args);return this.stylesheet=r,this._serializedLayers=null,!0}addImage(r,o){if(this.getImage(r))return this.fire(new u.j(new Error(`An image named "${r}" already exists.`)));this.imageManager.addImage(r,o),this._afterImageUpdated(r)}updateImage(r,o){this.imageManager.updateImage(r,o)}getImage(r){return this.imageManager.getImage(r)}removeImage(r){if(!this.getImage(r))return this.fire(new u.j(new Error(`An image named "${r}" does not exist.`)));this.imageManager.removeImage(r),this._afterImageUpdated(r)}_afterImageUpdated(r){this._availableImages=this.imageManager.listImages(),this._changedImages[r]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this.imageManager.listImages()}addSource(r,o,c={}){if(this._checkLoaded(),this.sourceCaches[r]!==void 0)throw new Error(`Source "${r}" already exists.`);if(!o.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(o).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(o.type)>=0&&this._validate(u.y.source,`sources.${r}`,o,null,c))return;this.map&&this.map._collectResourceTiming&&(o.collectResourceTiming=!0);const d=this.sourceCaches[r]=new pn(r,o,this.dispatcher);d.style=this,d.setEventedParent(this,()=>({isSourceLoaded:d.loaded(),source:d.serialize(),sourceId:r})),d.onAdd(this.map),this._changed=!0}removeSource(r){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error("There is no source with this ID");for(const c in this._layers)if(this._layers[c].source===r)return this.fire(new u.j(new Error(`Source "${r}" cannot be removed while layer "${c}" is using it.`)));const o=this.sourceCaches[r];delete this.sourceCaches[r],delete this._updatedSources[r],o.fire(new u.k("data",{sourceDataType:"metadata",dataType:"source",sourceId:r})),o.setEventedParent(null),o.onRemove(this.map),this._changed=!0}setGeoJSONSourceData(r,o){if(this._checkLoaded(),this.sourceCaches[r]===void 0)throw new Error(`There is no source with this ID=${r}`);const c=this.sourceCaches[r].getSource();if(c.type!=="geojson")throw new Error(`geojsonSource.type is ${c.type}, which is !== 'geojson`);c.setData(o),this._changed=!0}getSource(r){return this.sourceCaches[r]&&this.sourceCaches[r].getSource()}addLayer(r,o,c={}){this._checkLoaded();const d=r.id;if(this.getLayer(d))return void this.fire(new u.j(new Error(`Layer "${d}" already exists on this map.`)));let g;if(r.type==="custom"){if(Zr(this,u.aF(r)))return;g=u.aC(r)}else{if("source"in r&&typeof r.source=="object"&&(this.addSource(d,r.source),r=u.aD(r),r=u.e(r,{source:d})),this._validate(u.y.layer,`layers.${d}`,r,{arrayIndex:-1},c))return;g=u.aC(r),this._validateLayer(g),g.setEventedParent(this,{layer:{id:d}})}const x=o?this._order.indexOf(o):this._order.length;if(o&&x===-1)this.fire(new u.j(new Error(`Cannot add layer "${d}" before non-existing layer "${o}".`)));else{if(this._order.splice(x,0,d),this._layerOrderChanged=!0,this._layers[d]=g,this._removedLayers[d]&&g.source&&g.type!=="custom"){const w=this._removedLayers[d];delete this._removedLayers[d],w.type!==g.type?this._updatedSources[g.source]="clear":(this._updatedSources[g.source]="reload",this.sourceCaches[g.source].pause())}this._updateLayer(g),g.onAdd&&g.onAdd(this.map)}}moveLayer(r,o){if(this._checkLoaded(),this._changed=!0,!this._layers[r])return void this.fire(new u.j(new Error(`The layer '${r}' does not exist in the map's style and cannot be moved.`)));if(r===o)return;const c=this._order.indexOf(r);this._order.splice(c,1);const d=o?this._order.indexOf(o):this._order.length;o&&d===-1?this.fire(new u.j(new Error(`Cannot move layer "${r}" before non-existing layer "${o}".`))):(this._order.splice(d,0,r),this._layerOrderChanged=!0)}removeLayer(r){this._checkLoaded();const o=this._layers[r];if(!o)return void this.fire(new u.j(new Error(`Cannot remove non-existing layer "${r}".`)));o.setEventedParent(null);const c=this._order.indexOf(r);this._order.splice(c,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[r]=o,delete this._layers[r],this._serializedLayers&&delete this._serializedLayers[r],delete this._updatedLayers[r],delete this._updatedPaintProps[r],o.onRemove&&o.onRemove(this.map)}getLayer(r){return this._layers[r]}getLayersOrder(){return[...this._order]}hasLayer(r){return r in this._layers}setLayerZoomRange(r,o,c){this._checkLoaded();const d=this.getLayer(r);d?d.minzoom===o&&d.maxzoom===c||(o!=null&&(d.minzoom=o),c!=null&&(d.maxzoom=c),this._updateLayer(d)):this.fire(new u.j(new Error(`Cannot set the zoom range of non-existing layer "${r}".`)))}setFilter(r,o,c={}){this._checkLoaded();const d=this.getLayer(r);if(d){if(!u.aG(d.filter,o))return o==null?(d.filter=void 0,void this._updateLayer(d)):void(this._validate(u.y.filter,`layers.${d.id}.filter`,o,null,c)||(d.filter=u.aD(o),this._updateLayer(d)))}else this.fire(new u.j(new Error(`Cannot filter non-existing layer "${r}".`)))}getFilter(r){return u.aD(this.getLayer(r).filter)}setLayoutProperty(r,o,c,d={}){this._checkLoaded();const g=this.getLayer(r);g?u.aG(g.getLayoutProperty(o),c)||(g.setLayoutProperty(o,c,d),this._updateLayer(g)):this.fire(new u.j(new Error(`Cannot style non-existing layer "${r}".`)))}getLayoutProperty(r,o){const c=this.getLayer(r);if(c)return c.getLayoutProperty(o);this.fire(new u.j(new Error(`Cannot get style of non-existing layer "${r}".`)))}setPaintProperty(r,o,c,d={}){this._checkLoaded();const g=this.getLayer(r);g?u.aG(g.getPaintProperty(o),c)||(g.setPaintProperty(o,c,d)&&this._updateLayer(g),this._changed=!0,this._updatedPaintProps[r]=!0):this.fire(new u.j(new Error(`Cannot style non-existing layer "${r}".`)))}getPaintProperty(r,o){return this.getLayer(r).getPaintProperty(o)}setFeatureState(r,o){this._checkLoaded();const c=r.source,d=r.sourceLayer,g=this.sourceCaches[c];if(g===void 0)return void this.fire(new u.j(new Error(`The source '${c}' does not exist in the map's style.`)));const x=g.getSource().type;x==="geojson"&&d?this.fire(new u.j(new Error("GeoJSON sources cannot have a sourceLayer parameter."))):x!=="vector"||d?(r.id===void 0&&this.fire(new u.j(new Error("The feature id parameter must be provided."))),g.setFeatureState(d,r.id,o)):this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}removeFeatureState(r,o){this._checkLoaded();const c=r.source,d=this.sourceCaches[c];if(d===void 0)return void this.fire(new u.j(new Error(`The source '${c}' does not exist in the map's style.`)));const g=d.getSource().type,x=g==="vector"?r.sourceLayer:void 0;g!=="vector"||x?o&&typeof r.id!="string"&&typeof r.id!="number"?this.fire(new u.j(new Error("A feature id is required to remove its specific state property."))):d.removeFeatureState(x,r.id,o):this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")))}getFeatureState(r){this._checkLoaded();const o=r.source,c=r.sourceLayer,d=this.sourceCaches[o];if(d!==void 0)return d.getSource().type!=="vector"||c?(r.id===void 0&&this.fire(new u.j(new Error("The feature id parameter must be provided."))),d.getFeatureState(c,r.id)):void this.fire(new u.j(new Error("The sourceLayer parameter must be provided for vector source types.")));this.fire(new u.j(new Error(`The source '${o}' does not exist in the map's style.`)))}getTransition(){return u.e({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){if(!this._loaded)return;const r=u.aH(this.sourceCaches,g=>g.serialize()),o=this._serializeByIds(this._order),c=this.map.getTerrain()||void 0,d=this.stylesheet;return u.aI({version:d.version,name:d.name,metadata:d.metadata,light:d.light,center:d.center,zoom:d.zoom,bearing:d.bearing,pitch:d.pitch,sprite:d.sprite,glyphs:d.glyphs,transition:d.transition,sources:r,layers:o,terrain:c},g=>g!==void 0)}_updateLayer(r){this._updatedLayers[r.id]=!0,r.source&&!this._updatedSources[r.source]&&this.sourceCaches[r.source].getSource().type!=="raster"&&(this._updatedSources[r.source]="reload",this.sourceCaches[r.source].pause()),this._serializedLayers=null,this._changed=!0}_flattenAndSortRenderedFeatures(r){const o=x=>this._layers[x].type==="fill-extrusion",c={},d=[];for(let x=this._order.length-1;x>=0;x--){const w=this._order[x];if(o(w)){c[w]=x;for(const T of r){const E=T[w];if(E)for(const P of E)d.push(P)}}}d.sort((x,w)=>w.intersectionZ-x.intersectionZ);const g=[];for(let x=this._order.length-1;x>=0;x--){const w=this._order[x];if(o(w))for(let T=d.length-1;T>=0;T--){const E=d[T].feature;if(c[E.layer.id]<x)break;g.push(E),d.pop()}else for(const T of r){const E=T[w];if(E)for(const P of E)g.push(P.feature)}}return g}queryRenderedFeatures(r,o,c){o&&o.filter&&this._validate(u.y.filter,"queryRenderedFeatures.filter",o.filter,null,o);const d={};if(o&&o.layers){if(!Array.isArray(o.layers))return this.fire(new u.j(new Error("parameters.layers must be an Array."))),[];for(const w of o.layers){const T=this._layers[w];if(!T)return this.fire(new u.j(new Error(`The layer '${w}' does not exist in the map's style and cannot be queried for features.`))),[];d[T.source]=!0}}const g=[];o.availableImages=this._availableImages;const x=this._serializedAllLayers();for(const w in this.sourceCaches)o.layers&&!d[w]||g.push(Ss(this.sourceCaches[w],this._layers,x,r,o,c));return this.placement&&g.push(function(w,T,E,P,z,F,q){const $={},G=F.queryRenderedSymbols(P),U=[];for(const oe of Object.keys(G).map(Number))U.push(q[oe]);U.sort(os);for(const oe of U){const pe=oe.featureIndex.lookupSymbolFeatures(G[oe.bucketInstanceId],T,oe.bucketIndex,oe.sourceLayerIndex,z.filter,z.layers,z.availableImages,w);for(const Y in pe){const ae=$[Y]=$[Y]||[],me=pe[Y];me.sort((ge,Te)=>{const ze=oe.featureSortOrder;if(ze){const Ce=ze.indexOf(ge.featureIndex);return ze.indexOf(Te.featureIndex)-Ce}return Te.featureIndex-ge.featureIndex});for(const ge of me)ae.push(ge)}}for(const oe in $)$[oe].forEach(pe=>{const Y=pe.feature,ae=E[w[oe].source].getFeatureState(Y.layer["source-layer"],Y.id);Y.source=Y.layer.source,Y.layer["source-layer"]&&(Y.sourceLayer=Y.layer["source-layer"]),Y.state=ae});return $}(this._layers,x,this.sourceCaches,r,o,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(g)}querySourceFeatures(r,o){o&&o.filter&&this._validate(u.y.filter,"querySourceFeatures.filter",o.filter,null,o);const c=this.sourceCaches[r];return c?function(d,g){const x=d.getRenderableIds().map(E=>d.getTileByID(E)),w=[],T={};for(let E=0;E<x.length;E++){const P=x[E],z=P.tileID.canonical.key;T[z]||(T[z]=!0,P.querySourceFeatures(w,g))}return w}(c,o):[]}addSourceType(r,o,c){return Ri(r)?c(new Error(`A source type called "${r}" already exists.`)):(((d,g)=>{Xo[d]=g})(r,o),o.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:r,url:o.workerSourceURL},c):c(null,null))}getLight(){return this.light.getLight()}setLight(r,o={}){this._checkLoaded();const c=this.light.getLight();let d=!1;for(const x in r)if(!u.aG(r[x],c[x])){d=!0;break}if(!d)return;const g={now:u.h.now(),transition:u.e({duration:300,delay:0},this.stylesheet.transition)};this.light.setLight(r,o),this.light.updateTransitions(g)}_validate(r,o,c,d,g={}){return(!g||g.validate!==!1)&&Zr(this,r.call(u.y,u.e({key:o,style:this.serialize(),value:c,styleSpec:u.v},d)))}_remove(r=!0){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),u.aJ.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this.sourceCaches){const c=this.sourceCaches[o];c.setEventedParent(null),c.onRemove(this.map)}this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove(r)}_clearSource(r){this.sourceCaches[r].clearTiles()}_reloadSource(r){this.sourceCaches[r].resume(),this.sourceCaches[r].reload()}_updateSources(r){for(const o in this.sourceCaches)this.sourceCaches[o].update(r,this.map.terrain)}_generateCollisionBoxes(){for(const r in this.sourceCaches)this._reloadSource(r)}_updatePlacement(r,o,c,d,g=!1){let x=!1,w=!1;const T={};for(const E of this._order){const P=this._layers[E];if(P.type!=="symbol")continue;if(!T[P.source]){const F=this.sourceCaches[P.source];T[P.source]=F.getRenderableIds(!0).map(q=>F.getTileByID(q)).sort((q,$)=>$.tileID.overscaledZ-q.tileID.overscaledZ||(q.tileID.isLessThan($.tileID)?-1:1))}const z=this.crossTileSymbolIndex.addLayer(P,T[P.source],r.center.lng);x=x||z}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),((g=g||this._layerOrderChanged||c===0)||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(u.h.now(),r.zoom))&&(this.pauseablePlacement=new io(r,this.map.terrain,this._order,g,o,c,d,this.placement),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,T),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(u.h.now()),w=!0),x&&this.pauseablePlacement.placement.setStale()),w||x)for(const E of this._order){const P=this._layers[E];P.type==="symbol"&&this.placement.updateLayerOpacities(P,T[P.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(u.h.now())}_releaseSymbolFadeTiles(){for(const r in this.sourceCaches)this.sourceCaches[r].releaseSymbolFadeTiles()}getImages(r,o,c){this.imageManager.getImages(o.icons,c),this._updateTilesForChangedImages();const d=this.sourceCaches[o.source];d&&d.setDependencies(o.tileID.key,o.type,o.icons)}getGlyphs(r,o,c){this.glyphManager.getGlyphs(o.stacks,c);const d=this.sourceCaches[o.source];d&&d.setDependencies(o.tileID.key,o.type,[""])}getResource(r,o,c){return u.m(o,c)}getGlyphsUrl(){return this.stylesheet.glyphs||null}setGlyphs(r,o={}){this._checkLoaded(),r&&this._validate(u.y.glyphs,"glyphs",r,null,o)||(this._glyphsDidChange=!0,this.stylesheet.glyphs=r,this.glyphManager.entries={},this.glyphManager.setURL(r))}addSprite(r,o,c={},d){this._checkLoaded();const g=[{id:r,url:o}],x=[...Ze(this.stylesheet.sprite),...g];this._validate(u.y.sprite,"sprite",x,null,c)||(this.stylesheet.sprite=x,this._loadSprite(g,!0,d))}removeSprite(r){this._checkLoaded();const o=Ze(this.stylesheet.sprite);if(o.find(c=>c.id===r)){if(this._spritesImagesIds[r])for(const c of this._spritesImagesIds[r])this.imageManager.removeImage(c),this._changedImages[c]=!0;o.splice(o.findIndex(c=>c.id===r),1),this.stylesheet.sprite=o.length>0?o:void 0,delete this._spritesImagesIds[r],this._availableImages=this.imageManager.listImages(),this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new u.k("data",{dataType:"style"}))}else this.fire(new u.j(new Error(`Sprite "${r}" doesn't exists on this map.`)))}getSprite(){return Ze(this.stylesheet.sprite)}setSprite(r,o={},c){this._checkLoaded(),r&&this._validate(u.y.sprite,"sprite",r,null,o)||(this.stylesheet.sprite=r,r?this._loadSprite(r,!0,c):(this._unloadSprite(),c&&c(null)))}}Fr.registerForPluginStateChange=u.aK;var Fa=u.Q([{name:"a_pos",type:"Int16",components:2}]),oo="attribute vec3 a_pos3d;uniform mat4 u_matrix;uniform float u_ele_delta;varying vec2 v_texture_pos;varying float v_depth;void main() {float extent=8192.0;float ele_delta=a_pos3d.z==1.0 ? u_ele_delta : 0.0;v_texture_pos=a_pos3d.xy/extent;gl_Position=u_matrix*vec4(a_pos3d.xy,get_elevation(a_pos3d.xy)-ele_delta,1.0);v_depth=gl_Position.z/gl_Position.w;}";const Xt={prelude:Ct(`#ifdef GL_ES
precision mediump float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
`,`#ifdef GL_ES
precision highp float;
#else
#if !defined(lowp)
#define lowp
#endif
#if !defined(mediump)
#define mediump
#endif
#if !defined(highp)
#define highp
#endif
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}
#ifdef TERRAIN3D
uniform sampler2D u_terrain;uniform float u_terrain_dim;uniform mat4 u_terrain_matrix;uniform vec4 u_terrain_unpack;uniform float u_terrain_exaggeration;uniform highp sampler2D u_depth;
#endif
const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitShifts=vec4(1.)/bitSh;highp float unpack(highp vec4 color) {return dot(color,bitShifts);}highp float depthOpacity(vec3 frag) {
#ifdef TERRAIN3D
highp float d=unpack(texture2D(u_depth,frag.xy*0.5+0.5))+0.0001-frag.z;return 1.0-max(0.0,min(1.0,-d*500.0));
#else
return 1.0;
#endif
}float calculate_visibility(vec4 pos) {
#ifdef TERRAIN3D
vec3 frag=pos.xyz/pos.w;highp float d=depthOpacity(frag);if (d > 0.95) return 1.0;return (d+depthOpacity(frag+vec3(0.0,0.01,0.0)))/2.0;
#else
return 1.0;
#endif
}float ele(vec2 pos) {
#ifdef TERRAIN3D
vec4 rgb=(texture2D(u_terrain,pos)*255.0)*u_terrain_unpack;return rgb.r+rgb.g+rgb.b-u_terrain_unpack.a;
#else
return 0.0;
#endif
}float get_elevation(vec2 pos) {
#ifdef TERRAIN3D
vec2 coord=(u_terrain_matrix*vec4(pos,0.0,1.0)).xy*u_terrain_dim+1.0;vec2 f=fract(coord);vec2 c=(floor(coord)+0.5)/(u_terrain_dim+2.0);float d=1.0/(u_terrain_dim+2.0);float tl=ele(c);float tr=ele(c+vec2(d,0.0));float bl=ele(c+vec2(0.0,d));float br=ele(c+vec2(d,d));float elevation=mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);return elevation*u_terrain_exaggeration;
#else
return 0.0;
#endif
}`),background:Ct(`uniform vec4 u_color;uniform float u_opacity;void main() {gl_FragColor=u_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),backgroundPattern:Ct(`uniform vec2 u_pattern_tl_a;uniform vec2 u_pattern_br_a;uniform vec2 u_pattern_tl_b;uniform vec2 u_pattern_br_b;uniform vec2 u_texsize;uniform float u_mix;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(u_pattern_tl_a/u_texsize,u_pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(u_pattern_tl_b/u_texsize,u_pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_mix)*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_pattern_size_a;uniform vec2 u_pattern_size_b;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_scale_a;uniform float u_scale_b;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_a*u_pattern_size_a,u_tile_units_to_pixels,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_scale_b*u_pattern_size_b,u_tile_units_to_pixels,a_pos);}"),circle:Ct(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width));gl_FragColor=v_visibility*opacity_t*mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform bool u_scale_with_map;uniform bool u_pitch_with_map;uniform vec2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);float ele=get_elevation(circle_center);v_visibility=calculate_visibility(u_matrix*vec4(circle_center,ele,1.0));if (u_pitch_with_map) {vec2 corner_position=circle_center;if (u_scale_with_map) {corner_position+=extrude*(radius+stroke_width)*u_extrude_scale;} else {vec4 projected_center=u_matrix*vec4(circle_center,0,1);corner_position+=extrude*(radius+stroke_width)*u_extrude_scale*(projected_center.w/u_camera_to_center_distance);}gl_Position=u_matrix*vec4(corner_position,ele,1);} else {gl_Position=u_matrix*vec4(circle_center,ele,1);if (u_scale_with_map) {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*u_camera_to_center_distance;} else {gl_Position.xy+=extrude*(radius+stroke_width)*u_extrude_scale*gl_Position.w;}}lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);}`),clippingMask:Ct("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Ct(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec4 pos=vec4(floor(a_pos*0.5)+extrude,0,1);gl_Position=u_matrix*pos;}`),heatmapTexture:Ct(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_world;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos*u_world,0,1);v_pos.x=a_pos.x;v_pos.y=1.0-a_pos.y;}"),collisionBox:Ct("varying float v_placed;varying float v_notUsed;void main() {float alpha=0.5;gl_FragColor=vec4(1.0,0.0,0.0,1.0)*alpha;if (v_placed > 0.5) {gl_FragColor=vec4(0.0,0.0,1.0,0.5)*alpha;}if (v_notUsed > 0.5) {gl_FragColor*=.1;}}","attribute vec2 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_anchor_pos,0,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);gl_Position=u_matrix*vec4(a_pos,get_elevation(a_pos),1.0);gl_Position.xy+=(a_extrude+a_shift)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}"),collisionCircle:Ct("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}","attribute vec2 a_pos;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}"),debug:Ct("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}","attribute vec2 a_pos;varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {v_uv=a_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,get_elevation(a_pos),1);}"),fill:Ct(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_FragColor=color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);}`),fillOutline:Ct(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=outline_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillOutlinePattern:Ct(`uniform vec2 u_texsize;uniform sampler2D u_image;uniform float u_fade;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);gl_FragColor=mix(color1,color2,u_fade)*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,a_pos);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;}`),fillPattern:Ct(`#ifdef GL_ES
precision highp float;
#endif
uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);gl_FragColor=mix(color1,color2,u_fade)*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec3 u_scale;attribute vec2 a_pos;varying vec2 v_pos_a;varying vec2 v_pos_b;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileZoomRatio,a_pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileZoomRatio,a_pos);}`),fillExtrusion:Ct(`varying vec4 v_color;void main() {gl_FragColor=v_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec4 v_color;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec3 normal=a_normal_ed.xyz;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);gl_Position=u_matrix*vec4(a_pos,t > 0.0 ? height : base,1);float colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;v_color=vec4(0.0,0.0,0.0,1.0);vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;float directional=clamp(dot(normal/16384.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_color.r+=clamp(color.r*directional*u_lightcolor.r,mix(0.0,0.3,1.0-u_lightcolor.r),1.0);v_color.g+=clamp(color.g*directional*u_lightcolor.g,mix(0.0,0.3,1.0-u_lightcolor.g),1.0);v_color.b+=clamp(color.b*directional*u_lightcolor.b,mix(0.0,0.3,1.0-u_lightcolor.b),1.0);v_color*=u_opacity;}`),fillExtrusionPattern:Ct(`uniform vec2 u_texsize;uniform float u_fade;uniform sampler2D u_image;varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;vec2 imagecoord=mod(v_pos_a,1.0);vec2 pos=mix(pattern_tl_a/u_texsize,pattern_br_a/u_texsize,imagecoord);vec4 color1=texture2D(u_image,pos);vec2 imagecoord_b=mod(v_pos_b,1.0);vec2 pos2=mix(pattern_tl_b/u_texsize,pattern_br_b/u_texsize,imagecoord_b);vec4 color2=texture2D(u_image,pos2);vec4 mixedColor=mix(color1,color2,u_fade);gl_FragColor=mixedColor*v_lighting;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform vec3 u_scale;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec2 a_pos;attribute vec4 a_normal_ed;
#ifdef TERRAIN3D
attribute vec2 a_centroid;
#endif
varying vec2 v_pos_a;varying vec2 v_pos_b;varying vec4 v_lighting;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec3 normal=a_normal_ed.xyz;float edgedistance=a_normal_ed.w;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;
#ifdef TERRAIN3D
float height_terrain3d_offset=get_elevation(a_centroid);float base_terrain3d_offset=height_terrain3d_offset-(base > 0.0 ? 0.0 : 10.0);
#else
float height_terrain3d_offset=0.0;float base_terrain3d_offset=0.0;
#endif
base=max(0.0,base)+base_terrain3d_offset;height=max(0.0,height)+height_terrain3d_offset;float t=mod(normal.x,2.0);float z=t > 0.0 ? height : base;gl_Position=u_matrix*vec4(a_pos,z,1);vec2 pos=normal.x==1.0 && normal.y==0.0 && normal.z==16384.0
? a_pos
: vec2(edgedistance,z*u_height_factor);v_pos_a=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,fromScale*display_size_a,tileRatio,pos);v_pos_b=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,toScale*display_size_b,tileRatio,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float directional=clamp(dot(normal/16383.0,u_lightpos),0.0,1.0);directional=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),directional);if (normal.y !=0.0) {directional*=((1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),mix(0.7,0.98,1.0-u_lightintensity),1.0)));}v_lighting.rgb+=clamp(directional*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;}`),hillshadePrepare:Ct(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord,float bias) {vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y),0.0);float b=getElevation(v_pos+vec2(0,-epsilon.y),0.0);float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y),0.0);float d=getElevation(v_pos+vec2(-epsilon.x,0),0.0);float e=getElevation(v_pos,0.0);float f=getElevation(v_pos+vec2(epsilon.x,0),0.0);float g=getElevation(v_pos+vec2(-epsilon.x,epsilon.y),0.0);float h=getElevation(v_pos+vec2(0,epsilon.y),0.0);float i=getElevation(v_pos+vec2(epsilon.x,epsilon.y),0.0);float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2((c+f+f+i)-(a+d+d+g),(g+h+h+i)-(a+b+b+c))/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Ct(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;
#define PI 3.141592653589793
void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;}"),line:Ct(`uniform lowp float u_device_pixel_ratio;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp float v_linesofar;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;v_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*2.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),lineGradient:Ct(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);vec4 color=texture2D(u_image,v_uv);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_uv_x;attribute float a_split_index;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_units_to_pixels;uniform float u_image_height;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec2 v_uv;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec2(a_uv_x,a_split_index*texel_height-half_texel_height);vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_width2=vec2(outset,inset);}`),linePattern:Ct(`#ifdef GL_ES
precision highp float;
#endif
uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_fade;uniform mediump vec3 u_scale;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl_a=pattern_from.xy;vec2 pattern_br_a=pattern_from.zw;vec2 pattern_tl_b=pattern_to.xy;vec2 pattern_br_b=pattern_to.zw;float tileZoomRatio=u_scale.x;float fromScale=u_scale.y;float toScale=u_scale.z;vec2 display_size_a=(pattern_br_a-pattern_tl_a)/pixel_ratio_from;vec2 display_size_b=(pattern_br_b-pattern_tl_b)/pixel_ratio_to;vec2 pattern_size_a=vec2(display_size_a.x*fromScale/tileZoomRatio,display_size_a.y);vec2 pattern_size_b=vec2(display_size_b.x*toScale/tileZoomRatio,display_size_b.y);float aspect_a=display_size_a.y/v_width;float aspect_b=display_size_b.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x_a=mod(v_linesofar/pattern_size_a.x*aspect_a,1.0);float x_b=mod(v_linesofar/pattern_size_b.x*aspect_b,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos_a=mix(pattern_tl_a*texel_size-texel_size,pattern_br_a*texel_size+texel_size,vec2(x_a,y));vec2 pos_b=mix(pattern_tl_b*texel_size-texel_size,pattern_br_b*texel_size+texel_size,vec2(x_b,y));vec4 color=mix(texture2D(u_image,pos_a),texture2D(u_image,pos_b),u_fade);gl_FragColor=color*alpha*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern_from
#pragma mapbox: define lowp vec4 pattern_to
#pragma mapbox: define lowp float pixel_ratio_from
#pragma mapbox: define lowp float pixel_ratio_to
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern_from
#pragma mapbox: initialize mediump vec4 pattern_to
#pragma mapbox: initialize lowp float pixel_ratio_from
#pragma mapbox: initialize lowp float pixel_ratio_to
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;}`),lineSDF:Ct(`uniform lowp float u_device_pixel_ratio;uniform sampler2D u_image;uniform float u_sdfgamma;uniform float u_mix;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float sdfdist_a=texture2D(u_image,v_tex_a).a;float sdfdist_b=texture2D(u_image,v_tex_b).a;float sdfdist=mix(sdfdist_a,sdfdist_b,u_mix);alpha*=smoothstep(0.5-u_sdfgamma/floorwidth,0.5+u_sdfgamma/floorwidth,sdfdist);gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
#define LINE_DISTANCE_SCALE 2.0
attribute vec2 a_pos_normal;attribute vec4 a_data;uniform mat4 u_matrix;uniform mediump float u_ratio;uniform lowp float u_device_pixel_ratio;uniform vec2 u_patternscale_a;uniform float u_tex_y_a;uniform vec2 u_patternscale_b;uniform float u_tex_y_b;uniform vec2 u_units_to_pixels;varying vec2 v_normal;varying vec2 v_width2;varying vec2 v_tex_a;varying vec2 v_tex_b;varying float v_gamma_scale;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;float a_linesofar=(floor(a_data.z/4.0)+a_data.w*64.0)*LINE_DISTANCE_SCALE;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist/u_ratio,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2/u_ratio,0.0,1.0)+projected_extrude;
#ifdef TERRAIN3D
v_gamma_scale=1.0;
#else
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#endif
v_tex_a=vec2(a_linesofar*u_patternscale_a.x/floorwidth,normal.y*u_patternscale_a.y+u_tex_y_a);v_tex_b=vec2(a_linesofar*u_patternscale_b.x/floorwidth,normal.y*u_patternscale_b.y+u_tex_y_b);v_width2=vec2(outset,inset);}`),raster:Ct(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);gl_FragColor=vec4(mix(u_high_vec,u_low_vec,rgb)*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_buffer_scale;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos0=(((a_texture_pos/8192.0)-0.5)/u_buffer_scale )+0.5;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}"),symbolIcon:Ct(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_minFontScale=a_pixeloffset.zw/256.0;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*max(a_minFontScale,fontScale)+a_pxoffset/16.0),z,1.0);v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float visibility=calculate_visibility(projectedPoint);v_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));}`),symbolSDF:Ct(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float inner_edge=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);inner_edge=inner_edge+gamma*gamma_scale;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(inner_edge-gamma_scaled,inner_edge+gamma_scaled,dist);if (u_is_halo) {lowp float halo_edge=(6.0-halo_width/fontScale)/SDF_PX;alpha=min(smoothstep(halo_edge-gamma_scaled,halo_edge+gamma_scaled,dist),1.0-alpha);}gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec4 a_pixeloffset;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity);}`),symbolTextAndIcon:Ct(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`const float PI=3.141592653589793;attribute vec4 a_pos_offset;attribute vec4 a_data;attribute vec3 a_projected_pos;attribute float a_fade_opacity;uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform highp float u_pitch;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec2 u_texsize_icon;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_data.xy;vec2 a_size=a_data.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;float ele=get_elevation(a_pos);highp float segment_angle=-a_projected_pos[2];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec4 projectedPoint=u_matrix*vec4(a_pos,ele,1);highp float camera_to_anchor_distance=projectedPoint.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(0.5+0.5*distance_ratio,0.0,4.0);size*=perspective_ratio;float fontScale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjectedPoint=u_matrix*vec4(a_pos+vec2(1,0),ele,1);vec2 a=projectedPoint.xy/projectedPoint.w;vec2 b=offsetProjectedPoint.xy/offsetProjectedPoint.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);vec4 projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,ele,1.0);float z=float(u_pitch_with_map)*projected_pos.z/projected_pos.w;gl_Position=u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+rotation_matrix*(a_offset/32.0*fontScale),z,1.0);float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float visibility=calculate_visibility(projectedPoint);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(visibility,fade_opacity[0]+fade_change));v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity,is_sdf);}`),terrain:Ct("uniform sampler2D u_texture;varying vec2 v_texture_pos;void main() {gl_FragColor=texture2D(u_texture,v_texture_pos);}",oo),terrainDepth:Ct("varying float v_depth;const highp vec4 bitSh=vec4(256.*256.*256.,256.*256.,256.,1.);const highp vec4 bitMsk=vec4(0.,vec3(1./256.0));highp vec4 pack(highp float value) {highp vec4 comp=fract(value*bitSh);comp-=comp.xxyz*bitMsk;return comp;}void main() {gl_FragColor=pack(v_depth);}",oo),terrainCoords:Ct("precision mediump float;uniform sampler2D u_texture;uniform float u_terrain_coords_id;varying vec2 v_texture_pos;void main() {vec4 rgba=texture2D(u_texture,v_texture_pos);gl_FragColor=vec4(rgba.r,rgba.g,rgba.b,u_terrain_coords_id);}",oo)};function Ct(f,r){const o=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,c=r.match(/attribute ([\w]+) ([\w]+)/g),d=f.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),g=r.match(/uniform ([\w]+) ([\w]+)([\s]*)([\w]*)/g),x=g?g.concat(d):d,w={};return{fragmentSource:f=f.replace(o,(T,E,P,z,F)=>(w[F]=!0,E==="define"?`
#ifndef HAS_UNIFORM_u_${F}
varying ${P} ${z} ${F};
#else
uniform ${P} ${z} u_${F};
#endif
`:`
#ifdef HAS_UNIFORM_u_${F}
    ${P} ${z} ${F} = u_${F};
#endif
`)),vertexSource:r=r.replace(o,(T,E,P,z,F)=>{const q=z==="float"?"vec2":"vec4",$=F.match(/color/)?"color":q;return w[F]?E==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${P} ${q} a_${F};
varying ${P} ${z} ${F};
#else
uniform ${P} ${z} u_${F};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = a_${F};
#else
    ${P} ${z} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${F} = unpack_mix_${$}(a_${F}, u_${F}_t);
#else
    ${P} ${z} ${F} = u_${F};
#endif
`:E==="define"?`
#ifndef HAS_UNIFORM_u_${F}
uniform lowp float u_${F}_t;
attribute ${P} ${q} a_${F};
#else
uniform ${P} ${z} u_${F};
#endif
`:$==="vec4"?`
#ifndef HAS_UNIFORM_u_${F}
    ${P} ${z} ${F} = a_${F};
#else
    ${P} ${z} ${F} = u_${F};
#endif
`:`
#ifndef HAS_UNIFORM_u_${F}
    ${P} ${z} ${F} = unpack_mix_${$}(a_${F}, u_${F}_t);
#else
    ${P} ${z} ${F} = u_${F};
#endif
`}),staticAttributes:c,staticUniforms:x}}class Is{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffer=null,this.vao=null}bind(r,o,c,d,g,x,w,T,E){this.context=r;let P=this.boundPaintVertexBuffers.length!==d.length;for(let z=0;!P&&z<d.length;z++)this.boundPaintVertexBuffers[z]!==d[z]&&(P=!0);!this.vao||this.boundProgram!==o||this.boundLayoutVertexBuffer!==c||P||this.boundIndexBuffer!==g||this.boundVertexOffset!==x||this.boundDynamicVertexBuffer!==w||this.boundDynamicVertexBuffer2!==T||this.boundDynamicVertexBuffer3!==E?this.freshBind(o,c,d,g,x,w,T,E):(r.bindVertexArray.set(this.vao),w&&w.bind(),g&&g.dynamicDraw&&g.bind(),T&&T.bind(),E&&E.bind())}freshBind(r,o,c,d,g,x,w,T){const E=r.numAttributes,P=this.context,z=P.gl;this.vao&&this.destroy(),this.vao=P.createVertexArray(),P.bindVertexArray.set(this.vao),this.boundProgram=r,this.boundLayoutVertexBuffer=o,this.boundPaintVertexBuffers=c,this.boundIndexBuffer=d,this.boundVertexOffset=g,this.boundDynamicVertexBuffer=x,this.boundDynamicVertexBuffer2=w,this.boundDynamicVertexBuffer3=T,o.enableAttributes(z,r);for(const F of c)F.enableAttributes(z,r);x&&x.enableAttributes(z,r),w&&w.enableAttributes(z,r),T&&T.enableAttributes(z,r),o.bind(),o.setVertexAttribPointers(z,r,g);for(const F of c)F.bind(),F.setVertexAttribPointers(z,r,g);x&&(x.bind(),x.setVertexAttribPointers(z,r,g)),d&&d.bind(),w&&(w.bind(),w.setVertexAttribPointers(z,r,g)),T&&(T.bind(),T.setVertexAttribPointers(z,r,g)),P.currentNumAttributes=E}destroy(){this.vao&&(this.context.deleteVertexArray(this.vao),this.vao=null)}}function tr(f){const r=[];for(let o=0;o<f.length;o++){if(f[o]===null)continue;const c=f[o].split(" ");r.push(c.pop())}return r}class Ba{constructor(r,o,c,d,g,x){const w=r.gl;this.program=w.createProgram();const T=tr(o.staticAttributes),E=c?c.getBinderAttributes():[],P=T.concat(E),z=Xt.prelude.staticUniforms?tr(Xt.prelude.staticUniforms):[],F=o.staticUniforms?tr(o.staticUniforms):[],q=c?c.getBinderUniforms():[],$=z.concat(F).concat(q),G=[];for(const ge of $)G.indexOf(ge)<0&&G.push(ge);const U=c?c.defines():[];g&&U.push("#define OVERDRAW_INSPECTOR;"),x&&U.push("#define TERRAIN3D;");const oe=U.concat(Xt.prelude.fragmentSource,o.fragmentSource).join(`
`),pe=U.concat(Xt.prelude.vertexSource,o.vertexSource).join(`
`),Y=w.createShader(w.FRAGMENT_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(Y,oe),w.compileShader(Y),!w.getShaderParameter(Y,w.COMPILE_STATUS))throw new Error(`Could not compile fragment shader: ${w.getShaderInfoLog(Y)}`);w.attachShader(this.program,Y);const ae=w.createShader(w.VERTEX_SHADER);if(w.isContextLost())return void(this.failedToCreate=!0);if(w.shaderSource(ae,pe),w.compileShader(ae),!w.getShaderParameter(ae,w.COMPILE_STATUS))throw new Error(`Could not compile vertex shader: ${w.getShaderInfoLog(ae)}`);w.attachShader(this.program,ae),this.attributes={};const me={};this.numAttributes=P.length;for(let ge=0;ge<this.numAttributes;ge++)P[ge]&&(w.bindAttribLocation(this.program,ge,P[ge]),this.attributes[P[ge]]=ge);if(w.linkProgram(this.program),!w.getProgramParameter(this.program,w.LINK_STATUS))throw new Error(`Program failed to link: ${w.getProgramInfoLog(this.program)}`);w.deleteShader(ae),w.deleteShader(Y);for(let ge=0;ge<G.length;ge++){const Te=G[ge];if(Te&&!me[Te]){const ze=w.getUniformLocation(this.program,Te);ze&&(me[Te]=ze)}}this.fixedUniforms=d(r,me),this.terrainUniforms=((ge,Te)=>({u_depth:new u.aL(ge,Te.u_depth),u_terrain:new u.aL(ge,Te.u_terrain),u_terrain_dim:new u.aM(ge,Te.u_terrain_dim),u_terrain_matrix:new u.aN(ge,Te.u_terrain_matrix),u_terrain_unpack:new u.aO(ge,Te.u_terrain_unpack),u_terrain_exaggeration:new u.aM(ge,Te.u_terrain_exaggeration)}))(r,me),this.binderUniforms=c?c.getUniforms(r,me):[]}draw(r,o,c,d,g,x,w,T,E,P,z,F,q,$,G,U,oe,pe){const Y=r.gl;if(this.failedToCreate)return;if(r.program.set(this.program),r.setDepthMode(c),r.setStencilMode(d),r.setColorMode(g),r.setCullFace(x),T){r.activeTexture.set(Y.TEXTURE2),Y.bindTexture(Y.TEXTURE_2D,T.depthTexture),r.activeTexture.set(Y.TEXTURE3),Y.bindTexture(Y.TEXTURE_2D,T.texture);for(const me in this.terrainUniforms)this.terrainUniforms[me].set(T[me])}for(const me in this.fixedUniforms)this.fixedUniforms[me].set(w[me]);G&&G.setUniforms(r,this.binderUniforms,q,{zoom:$});let ae=0;switch(o){case Y.LINES:ae=2;break;case Y.TRIANGLES:ae=3;break;case Y.LINE_STRIP:ae=1}for(const me of F.get()){const ge=me.vaos||(me.vaos={});(ge[E]||(ge[E]=new Is)).bind(r,this,P,G?G.getPaintVertexBuffers():[],z,me.vertexOffset,U,oe,pe),Y.drawElements(o,me.primitiveLength*ae,Y.UNSIGNED_SHORT,me.primitiveOffset*ae*2)}}}function Zn(f,r,o){const c=1/se(o,1,r.transform.tileZoom),d=Math.pow(2,o.tileID.overscaledZ),g=o.tileSize*Math.pow(2,r.transform.tileZoom)/d,x=g*(o.tileID.canonical.x+o.tileID.wrap*d),w=g*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_scale:[c,f.fromScale,f.toScale],u_fade:f.t,u_pixel_coord_upper:[x>>16,w>>16],u_pixel_coord_lower:[65535&x,65535&w]}}const Yl=(f,r,o,c)=>{const d=r.style.light,g=d.properties.get("position"),x=[g.x,g.y,g.z],w=function(){var E=new u.A(9);return u.A!=Float32Array&&(E[1]=0,E[2]=0,E[3]=0,E[5]=0,E[6]=0,E[7]=0),E[0]=1,E[4]=1,E[8]=1,E}();d.properties.get("anchor")==="viewport"&&function(E,P){var z=Math.sin(P),F=Math.cos(P);E[0]=F,E[1]=z,E[2]=0,E[3]=-z,E[4]=F,E[5]=0,E[6]=0,E[7]=0,E[8]=1}(w,-r.transform.angle),function(E,P,z){var F=P[0],q=P[1],$=P[2];E[0]=F*z[0]+q*z[3]+$*z[6],E[1]=F*z[1]+q*z[4]+$*z[7],E[2]=F*z[2]+q*z[5]+$*z[8]}(x,x,w);const T=d.properties.get("color");return{u_matrix:f,u_lightpos:x,u_lightintensity:d.properties.get("intensity"),u_lightcolor:[T.r,T.g,T.b],u_vertical_gradient:+o,u_opacity:c}},us=(f,r,o,c,d,g,x)=>u.e(Yl(f,r,o,c),Zn(g,r,x),{u_height_factor:-Math.pow(2,d.overscaledZ)/x.tileSize/8}),Yc=f=>({u_matrix:f}),Ql=(f,r,o,c)=>u.e(Yc(f),Zn(o,r,c)),Oa=(f,r)=>({u_matrix:f,u_world:r}),Na=(f,r,o,c,d)=>u.e(Ql(f,r,o,c),{u_world:d}),cs=(f,r,o,c)=>{const d=f.transform;let g,x;if(c.paint.get("circle-pitch-alignment")==="map"){const w=se(o,1,d.zoom);g=!0,x=[w,w]}else g=!1,x=d.pixelsToGLUnits;return{u_camera_to_center_distance:d.cameraToCenterDistance,u_scale_with_map:+(c.paint.get("circle-pitch-scale")==="map"),u_matrix:f.translatePosMatrix(r.posMatrix,o,c.paint.get("circle-translate"),c.paint.get("circle-translate-anchor")),u_pitch_with_map:+g,u_device_pixel_ratio:f.pixelRatio,u_extrude_scale:x}},Jl=(f,r,o)=>{const c=se(o,1,r.zoom),d=Math.pow(2,r.zoom-o.tileID.overscaledZ),g=o.tileID.overscaleFactor();return{u_matrix:f,u_camera_to_center_distance:r.cameraToCenterDistance,u_pixels_to_tile_units:c,u_extrude_scale:[r.pixelsToGLUnits[0]/(c*d),r.pixelsToGLUnits[1]/(c*d)],u_overscale_factor:g}},Ko=(f,r,o=1)=>({u_matrix:f,u_color:r,u_overlay:0,u_overlay_scale:o}),Qc=f=>({u_matrix:f}),Op=(f,r,o,c)=>({u_matrix:f,u_extrude_scale:se(r,1,o),u_intensity:c});function eu(f,r){const o=Math.pow(2,r.canonical.z),c=r.canonical.y;return[new u.U(0,c/o).toLngLat().lat,new u.U(0,(c+1)/o).toLngLat().lat]}const tu=(f,r,o,c)=>{const d=f.transform;return{u_matrix:Va(f,r,o,c),u_ratio:1/se(r,1,d.zoom),u_device_pixel_ratio:f.pixelRatio,u_units_to_pixels:[1/d.pixelsToGLUnits[0],1/d.pixelsToGLUnits[1]]}},Jc=(f,r,o,c,d)=>u.e(tu(f,r,o,d),{u_image:0,u_image_height:c}),Np=(f,r,o,c,d)=>{const g=f.transform,x=th(r,g);return{u_matrix:Va(f,r,o,d),u_texsize:r.imageAtlasTexture.size,u_ratio:1/se(r,1,g.zoom),u_device_pixel_ratio:f.pixelRatio,u_image:0,u_scale:[x,c.fromScale,c.toScale],u_fade:c.t,u_units_to_pixels:[1/g.pixelsToGLUnits[0],1/g.pixelsToGLUnits[1]]}},eh=(f,r,o,c,d,g)=>{const x=f.lineAtlas,w=th(r,f.transform),T=o.layout.get("line-cap")==="round",E=x.getDash(c.from,T),P=x.getDash(c.to,T),z=E.width*d.fromScale,F=P.width*d.toScale;return u.e(tu(f,r,o,g),{u_patternscale_a:[w/z,-E.height/2],u_patternscale_b:[w/F,-P.height/2],u_sdfgamma:x.width/(256*Math.min(z,F)*f.pixelRatio)/2,u_image:0,u_tex_y_a:E.y,u_tex_y_b:P.y,u_mix:d.t})};function th(f,r){return 1/se(f,1,r.tileZoom)}function Va(f,r,o,c){return f.translatePosMatrix(c?c.posMatrix:r.tileID.posMatrix,r,o.paint.get("line-translate"),o.paint.get("line-translate-anchor"))}const rh=(f,r,o,c,d)=>{return{u_matrix:f,u_tl_parent:r,u_scale_parent:o,u_buffer_scale:1,u_fade_t:c.mix,u_opacity:c.opacity*d.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:d.paint.get("raster-brightness-min"),u_brightness_high:d.paint.get("raster-brightness-max"),u_saturation_factor:(x=d.paint.get("raster-saturation"),x>0?1-1/(1.001-x):-x),u_contrast_factor:(g=d.paint.get("raster-contrast"),g>0?1/(1-g):1+g),u_spin_weights:nh(d.paint.get("raster-hue-rotate"))};var g,x};function nh(f){f*=Math.PI/180;const r=Math.sin(f),o=Math.cos(f);return[(2*o+1)/3,(-Math.sqrt(3)*r-o+1)/3,(Math.sqrt(3)*r-o+1)/3]}const ru=(f,r,o,c,d,g,x,w,T,E)=>{const P=d.transform;return{u_is_size_zoom_constant:+(f==="constant"||f==="source"),u_is_size_feature_constant:+(f==="constant"||f==="camera"),u_size_t:r?r.uSizeT:0,u_size:r?r.uSize:0,u_camera_to_center_distance:P.cameraToCenterDistance,u_pitch:P.pitch/360*2*Math.PI,u_rotate_symbol:+o,u_aspect_ratio:P.width/P.height,u_fade_change:d.options.fadeDuration?d.symbolFadeChange:1,u_matrix:g,u_label_plane_matrix:x,u_coord_matrix:w,u_is_text:+T,u_pitch_with_map:+c,u_texsize:E,u_texture:0}},nu=(f,r,o,c,d,g,x,w,T,E,P)=>{const z=d.transform;return u.e(ru(f,r,o,c,d,g,x,w,T,E),{u_gamma_scale:c?Math.cos(z._pitch)*z.cameraToCenterDistance:1,u_device_pixel_ratio:d.pixelRatio,u_is_halo:+P})},Cs=(f,r,o,c,d,g,x,w,T,E)=>u.e(nu(f,r,o,c,d,g,x,w,!0,T,!0),{u_texsize_icon:E,u_texture_icon:1}),Ua=(f,r,o)=>({u_matrix:f,u_opacity:r,u_color:o}),Gn=(f,r,o,c,d,g)=>u.e(function(x,w,T,E){const P=T.imageManager.getPattern(x.from.toString()),z=T.imageManager.getPattern(x.to.toString()),{width:F,height:q}=T.imageManager.getPixelSize(),$=Math.pow(2,E.tileID.overscaledZ),G=E.tileSize*Math.pow(2,T.transform.tileZoom)/$,U=G*(E.tileID.canonical.x+E.tileID.wrap*$),oe=G*E.tileID.canonical.y;return{u_image:0,u_pattern_tl_a:P.tl,u_pattern_br_a:P.br,u_pattern_tl_b:z.tl,u_pattern_br_b:z.br,u_texsize:[F,q],u_mix:w.t,u_pattern_size_a:P.displaySize,u_pattern_size_b:z.displaySize,u_scale_a:w.fromScale,u_scale_b:w.toScale,u_tile_units_to_pixels:1/se(E,1,T.transform.tileZoom),u_pixel_coord_upper:[U>>16,oe>>16],u_pixel_coord_lower:[65535&U,65535&oe]}}(c,g,o,d),{u_matrix:f,u_opacity:r}),ja={fillExtrusion:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_lightpos:new u.aP(f,r.u_lightpos),u_lightintensity:new u.aM(f,r.u_lightintensity),u_lightcolor:new u.aP(f,r.u_lightcolor),u_vertical_gradient:new u.aM(f,r.u_vertical_gradient),u_opacity:new u.aM(f,r.u_opacity)}),fillExtrusionPattern:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_lightpos:new u.aP(f,r.u_lightpos),u_lightintensity:new u.aM(f,r.u_lightintensity),u_lightcolor:new u.aP(f,r.u_lightcolor),u_vertical_gradient:new u.aM(f,r.u_vertical_gradient),u_height_factor:new u.aM(f,r.u_height_factor),u_image:new u.aL(f,r.u_image),u_texsize:new u.aQ(f,r.u_texsize),u_pixel_coord_upper:new u.aQ(f,r.u_pixel_coord_upper),u_pixel_coord_lower:new u.aQ(f,r.u_pixel_coord_lower),u_scale:new u.aP(f,r.u_scale),u_fade:new u.aM(f,r.u_fade),u_opacity:new u.aM(f,r.u_opacity)}),fill:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix)}),fillPattern:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_image:new u.aL(f,r.u_image),u_texsize:new u.aQ(f,r.u_texsize),u_pixel_coord_upper:new u.aQ(f,r.u_pixel_coord_upper),u_pixel_coord_lower:new u.aQ(f,r.u_pixel_coord_lower),u_scale:new u.aP(f,r.u_scale),u_fade:new u.aM(f,r.u_fade)}),fillOutline:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_world:new u.aQ(f,r.u_world)}),fillOutlinePattern:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_world:new u.aQ(f,r.u_world),u_image:new u.aL(f,r.u_image),u_texsize:new u.aQ(f,r.u_texsize),u_pixel_coord_upper:new u.aQ(f,r.u_pixel_coord_upper),u_pixel_coord_lower:new u.aQ(f,r.u_pixel_coord_lower),u_scale:new u.aP(f,r.u_scale),u_fade:new u.aM(f,r.u_fade)}),circle:(f,r)=>({u_camera_to_center_distance:new u.aM(f,r.u_camera_to_center_distance),u_scale_with_map:new u.aL(f,r.u_scale_with_map),u_pitch_with_map:new u.aL(f,r.u_pitch_with_map),u_extrude_scale:new u.aQ(f,r.u_extrude_scale),u_device_pixel_ratio:new u.aM(f,r.u_device_pixel_ratio),u_matrix:new u.aN(f,r.u_matrix)}),collisionBox:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_camera_to_center_distance:new u.aM(f,r.u_camera_to_center_distance),u_pixels_to_tile_units:new u.aM(f,r.u_pixels_to_tile_units),u_extrude_scale:new u.aQ(f,r.u_extrude_scale),u_overscale_factor:new u.aM(f,r.u_overscale_factor)}),collisionCircle:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_inv_matrix:new u.aN(f,r.u_inv_matrix),u_camera_to_center_distance:new u.aM(f,r.u_camera_to_center_distance),u_viewport_size:new u.aQ(f,r.u_viewport_size)}),debug:(f,r)=>({u_color:new u.aR(f,r.u_color),u_matrix:new u.aN(f,r.u_matrix),u_overlay:new u.aL(f,r.u_overlay),u_overlay_scale:new u.aM(f,r.u_overlay_scale)}),clippingMask:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix)}),heatmap:(f,r)=>({u_extrude_scale:new u.aM(f,r.u_extrude_scale),u_intensity:new u.aM(f,r.u_intensity),u_matrix:new u.aN(f,r.u_matrix)}),heatmapTexture:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_world:new u.aQ(f,r.u_world),u_image:new u.aL(f,r.u_image),u_color_ramp:new u.aL(f,r.u_color_ramp),u_opacity:new u.aM(f,r.u_opacity)}),hillshade:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_image:new u.aL(f,r.u_image),u_latrange:new u.aQ(f,r.u_latrange),u_light:new u.aQ(f,r.u_light),u_shadow:new u.aR(f,r.u_shadow),u_highlight:new u.aR(f,r.u_highlight),u_accent:new u.aR(f,r.u_accent)}),hillshadePrepare:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_image:new u.aL(f,r.u_image),u_dimension:new u.aQ(f,r.u_dimension),u_zoom:new u.aM(f,r.u_zoom),u_unpack:new u.aO(f,r.u_unpack)}),line:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_ratio:new u.aM(f,r.u_ratio),u_device_pixel_ratio:new u.aM(f,r.u_device_pixel_ratio),u_units_to_pixels:new u.aQ(f,r.u_units_to_pixels)}),lineGradient:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_ratio:new u.aM(f,r.u_ratio),u_device_pixel_ratio:new u.aM(f,r.u_device_pixel_ratio),u_units_to_pixels:new u.aQ(f,r.u_units_to_pixels),u_image:new u.aL(f,r.u_image),u_image_height:new u.aM(f,r.u_image_height)}),linePattern:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_texsize:new u.aQ(f,r.u_texsize),u_ratio:new u.aM(f,r.u_ratio),u_device_pixel_ratio:new u.aM(f,r.u_device_pixel_ratio),u_image:new u.aL(f,r.u_image),u_units_to_pixels:new u.aQ(f,r.u_units_to_pixels),u_scale:new u.aP(f,r.u_scale),u_fade:new u.aM(f,r.u_fade)}),lineSDF:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_ratio:new u.aM(f,r.u_ratio),u_device_pixel_ratio:new u.aM(f,r.u_device_pixel_ratio),u_units_to_pixels:new u.aQ(f,r.u_units_to_pixels),u_patternscale_a:new u.aQ(f,r.u_patternscale_a),u_patternscale_b:new u.aQ(f,r.u_patternscale_b),u_sdfgamma:new u.aM(f,r.u_sdfgamma),u_image:new u.aL(f,r.u_image),u_tex_y_a:new u.aM(f,r.u_tex_y_a),u_tex_y_b:new u.aM(f,r.u_tex_y_b),u_mix:new u.aM(f,r.u_mix)}),raster:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_tl_parent:new u.aQ(f,r.u_tl_parent),u_scale_parent:new u.aM(f,r.u_scale_parent),u_buffer_scale:new u.aM(f,r.u_buffer_scale),u_fade_t:new u.aM(f,r.u_fade_t),u_opacity:new u.aM(f,r.u_opacity),u_image0:new u.aL(f,r.u_image0),u_image1:new u.aL(f,r.u_image1),u_brightness_low:new u.aM(f,r.u_brightness_low),u_brightness_high:new u.aM(f,r.u_brightness_high),u_saturation_factor:new u.aM(f,r.u_saturation_factor),u_contrast_factor:new u.aM(f,r.u_contrast_factor),u_spin_weights:new u.aP(f,r.u_spin_weights)}),symbolIcon:(f,r)=>({u_is_size_zoom_constant:new u.aL(f,r.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aL(f,r.u_is_size_feature_constant),u_size_t:new u.aM(f,r.u_size_t),u_size:new u.aM(f,r.u_size),u_camera_to_center_distance:new u.aM(f,r.u_camera_to_center_distance),u_pitch:new u.aM(f,r.u_pitch),u_rotate_symbol:new u.aL(f,r.u_rotate_symbol),u_aspect_ratio:new u.aM(f,r.u_aspect_ratio),u_fade_change:new u.aM(f,r.u_fade_change),u_matrix:new u.aN(f,r.u_matrix),u_label_plane_matrix:new u.aN(f,r.u_label_plane_matrix),u_coord_matrix:new u.aN(f,r.u_coord_matrix),u_is_text:new u.aL(f,r.u_is_text),u_pitch_with_map:new u.aL(f,r.u_pitch_with_map),u_texsize:new u.aQ(f,r.u_texsize),u_texture:new u.aL(f,r.u_texture)}),symbolSDF:(f,r)=>({u_is_size_zoom_constant:new u.aL(f,r.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aL(f,r.u_is_size_feature_constant),u_size_t:new u.aM(f,r.u_size_t),u_size:new u.aM(f,r.u_size),u_camera_to_center_distance:new u.aM(f,r.u_camera_to_center_distance),u_pitch:new u.aM(f,r.u_pitch),u_rotate_symbol:new u.aL(f,r.u_rotate_symbol),u_aspect_ratio:new u.aM(f,r.u_aspect_ratio),u_fade_change:new u.aM(f,r.u_fade_change),u_matrix:new u.aN(f,r.u_matrix),u_label_plane_matrix:new u.aN(f,r.u_label_plane_matrix),u_coord_matrix:new u.aN(f,r.u_coord_matrix),u_is_text:new u.aL(f,r.u_is_text),u_pitch_with_map:new u.aL(f,r.u_pitch_with_map),u_texsize:new u.aQ(f,r.u_texsize),u_texture:new u.aL(f,r.u_texture),u_gamma_scale:new u.aM(f,r.u_gamma_scale),u_device_pixel_ratio:new u.aM(f,r.u_device_pixel_ratio),u_is_halo:new u.aL(f,r.u_is_halo)}),symbolTextAndIcon:(f,r)=>({u_is_size_zoom_constant:new u.aL(f,r.u_is_size_zoom_constant),u_is_size_feature_constant:new u.aL(f,r.u_is_size_feature_constant),u_size_t:new u.aM(f,r.u_size_t),u_size:new u.aM(f,r.u_size),u_camera_to_center_distance:new u.aM(f,r.u_camera_to_center_distance),u_pitch:new u.aM(f,r.u_pitch),u_rotate_symbol:new u.aL(f,r.u_rotate_symbol),u_aspect_ratio:new u.aM(f,r.u_aspect_ratio),u_fade_change:new u.aM(f,r.u_fade_change),u_matrix:new u.aN(f,r.u_matrix),u_label_plane_matrix:new u.aN(f,r.u_label_plane_matrix),u_coord_matrix:new u.aN(f,r.u_coord_matrix),u_is_text:new u.aL(f,r.u_is_text),u_pitch_with_map:new u.aL(f,r.u_pitch_with_map),u_texsize:new u.aQ(f,r.u_texsize),u_texsize_icon:new u.aQ(f,r.u_texsize_icon),u_texture:new u.aL(f,r.u_texture),u_texture_icon:new u.aL(f,r.u_texture_icon),u_gamma_scale:new u.aM(f,r.u_gamma_scale),u_device_pixel_ratio:new u.aM(f,r.u_device_pixel_ratio),u_is_halo:new u.aL(f,r.u_is_halo)}),background:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_opacity:new u.aM(f,r.u_opacity),u_color:new u.aR(f,r.u_color)}),backgroundPattern:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_opacity:new u.aM(f,r.u_opacity),u_image:new u.aL(f,r.u_image),u_pattern_tl_a:new u.aQ(f,r.u_pattern_tl_a),u_pattern_br_a:new u.aQ(f,r.u_pattern_br_a),u_pattern_tl_b:new u.aQ(f,r.u_pattern_tl_b),u_pattern_br_b:new u.aQ(f,r.u_pattern_br_b),u_texsize:new u.aQ(f,r.u_texsize),u_mix:new u.aM(f,r.u_mix),u_pattern_size_a:new u.aQ(f,r.u_pattern_size_a),u_pattern_size_b:new u.aQ(f,r.u_pattern_size_b),u_scale_a:new u.aM(f,r.u_scale_a),u_scale_b:new u.aM(f,r.u_scale_b),u_pixel_coord_upper:new u.aQ(f,r.u_pixel_coord_upper),u_pixel_coord_lower:new u.aQ(f,r.u_pixel_coord_lower),u_tile_units_to_pixels:new u.aM(f,r.u_tile_units_to_pixels)}),terrain:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_texture:new u.aL(f,r.u_texture),u_ele_delta:new u.aM(f,r.u_ele_delta)}),terrainDepth:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_ele_delta:new u.aM(f,r.u_ele_delta)}),terrainCoords:(f,r)=>({u_matrix:new u.aN(f,r.u_matrix),u_texture:new u.aL(f,r.u_texture),u_terrain_coords_id:new u.aM(f,r.u_terrain_coords_id),u_ele_delta:new u.aM(f,r.u_ele_delta)})};class $a{constructor(r,o,c){this.context=r;const d=r.gl;this.buffer=d.createBuffer(),this.dynamicDraw=!!c,this.context.unbindVAO(),r.bindElementBuffer.set(this.buffer),d.bufferData(d.ELEMENT_ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?d.DYNAMIC_DRAW:d.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(r){const o=this.context.gl;if(!this.dynamicDraw)throw new Error("Attempted to update data while not in dynamic mode.");this.context.unbindVAO(),this.bind(),o.bufferSubData(o.ELEMENT_ARRAY_BUFFER,0,r.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const Yo={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class qa{constructor(r,o,c,d){this.length=o.length,this.attributes=c,this.itemSize=o.bytesPerElement,this.dynamicDraw=d,this.context=r;const g=r.gl;this.buffer=g.createBuffer(),r.bindVertexBuffer.set(this.buffer),g.bufferData(g.ARRAY_BUFFER,o.arrayBuffer,this.dynamicDraw?g.DYNAMIC_DRAW:g.STATIC_DRAW),this.dynamicDraw||delete o.arrayBuffer}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(r){if(r.length!==this.length)throw new Error(`Length of new data is ${r.length}, which doesn't match current length of ${this.length}`);const o=this.context.gl;this.bind(),o.bufferSubData(o.ARRAY_BUFFER,0,r.arrayBuffer)}enableAttributes(r,o){for(let c=0;c<this.attributes.length;c++){const d=o.attributes[this.attributes[c].name];d!==void 0&&r.enableVertexAttribArray(d)}}setVertexAttribPointers(r,o,c){for(let d=0;d<this.attributes.length;d++){const g=this.attributes[d],x=o.attributes[g.name];x!==void 0&&r.vertexAttribPointer(x,g.components,r[Yo[g.type]],!1,this.itemSize,g.offset+this.itemSize*(c||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const ao=new WeakMap;function hs(f){var r;if(ao.has(f))return ao.get(f);{const o=(r=f.getParameter(f.VERSION))===null||r===void 0?void 0:r.startsWith("WebGL 2.0");return ao.set(f,o),o}}class wt{constructor(r){this.gl=r.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(r){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class Za extends wt{getDefault(){return u.aT.transparent}set(r){const o=this.current;(r.r!==o.r||r.g!==o.g||r.b!==o.b||r.a!==o.a||this.dirty)&&(this.gl.clearColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Cn extends wt{getDefault(){return 1}set(r){(r!==this.current||this.dirty)&&(this.gl.clearDepth(r),this.current=r,this.dirty=!1)}}class Pn extends wt{getDefault(){return 0}set(r){(r!==this.current||this.dirty)&&(this.gl.clearStencil(r),this.current=r,this.dirty=!1)}}class iu extends wt{getDefault(){return[!0,!0,!0,!0]}set(r){const o=this.current;(r[0]!==o[0]||r[1]!==o[1]||r[2]!==o[2]||r[3]!==o[3]||this.dirty)&&(this.gl.colorMask(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Ga extends wt{getDefault(){return!0}set(r){(r!==this.current||this.dirty)&&(this.gl.depthMask(r),this.current=r,this.dirty=!1)}}class Wa extends wt{getDefault(){return 255}set(r){(r!==this.current||this.dirty)&&(this.gl.stencilMask(r),this.current=r,this.dirty=!1)}}class su extends wt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(r){const o=this.current;(r.func!==o.func||r.ref!==o.ref||r.mask!==o.mask||this.dirty)&&(this.gl.stencilFunc(r.func,r.ref,r.mask),this.current=r,this.dirty=!1)}}class ou extends wt{getDefault(){const r=this.gl;return[r.KEEP,r.KEEP,r.KEEP]}set(r){const o=this.current;(r[0]!==o[0]||r[1]!==o[1]||r[2]!==o[2]||this.dirty)&&(this.gl.stencilOp(r[0],r[1],r[2]),this.current=r,this.dirty=!1)}}class Ha extends wt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;r?o.enable(o.STENCIL_TEST):o.disable(o.STENCIL_TEST),this.current=r,this.dirty=!1}}class au extends wt{getDefault(){return[0,1]}set(r){const o=this.current;(r[0]!==o[0]||r[1]!==o[1]||this.dirty)&&(this.gl.depthRange(r[0],r[1]),this.current=r,this.dirty=!1)}}class lu extends wt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;r?o.enable(o.DEPTH_TEST):o.disable(o.DEPTH_TEST),this.current=r,this.dirty=!1}}class Xa extends wt{getDefault(){return this.gl.LESS}set(r){(r!==this.current||this.dirty)&&(this.gl.depthFunc(r),this.current=r,this.dirty=!1)}}class ih extends wt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;r?o.enable(o.BLEND):o.disable(o.BLEND),this.current=r,this.dirty=!1}}class sh extends wt{getDefault(){const r=this.gl;return[r.ONE,r.ZERO]}set(r){const o=this.current;(r[0]!==o[0]||r[1]!==o[1]||this.dirty)&&(this.gl.blendFunc(r[0],r[1]),this.current=r,this.dirty=!1)}}class lo extends wt{getDefault(){return u.aT.transparent}set(r){const o=this.current;(r.r!==o.r||r.g!==o.g||r.b!==o.b||r.a!==o.a||this.dirty)&&(this.gl.blendColor(r.r,r.g,r.b,r.a),this.current=r,this.dirty=!1)}}class Vp extends wt{getDefault(){return this.gl.FUNC_ADD}set(r){(r!==this.current||this.dirty)&&(this.gl.blendEquation(r),this.current=r,this.dirty=!1)}}class Up extends wt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;r?o.enable(o.CULL_FACE):o.disable(o.CULL_FACE),this.current=r,this.dirty=!1}}class jp extends wt{getDefault(){return this.gl.BACK}set(r){(r!==this.current||this.dirty)&&(this.gl.cullFace(r),this.current=r,this.dirty=!1)}}class $p extends wt{getDefault(){return this.gl.CCW}set(r){(r!==this.current||this.dirty)&&(this.gl.frontFace(r),this.current=r,this.dirty=!1)}}class qp extends wt{getDefault(){return null}set(r){(r!==this.current||this.dirty)&&(this.gl.useProgram(r),this.current=r,this.dirty=!1)}}class Zp extends wt{getDefault(){return this.gl.TEXTURE0}set(r){(r!==this.current||this.dirty)&&(this.gl.activeTexture(r),this.current=r,this.dirty=!1)}}class uu extends wt{getDefault(){const r=this.gl;return[0,0,r.drawingBufferWidth,r.drawingBufferHeight]}set(r){const o=this.current;(r[0]!==o[0]||r[1]!==o[1]||r[2]!==o[2]||r[3]!==o[3]||this.dirty)&&(this.gl.viewport(r[0],r[1],r[2],r[3]),this.current=r,this.dirty=!1)}}class Ka extends wt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.bindFramebuffer(o.FRAMEBUFFER,r),this.current=r,this.dirty=!1}}class cu extends wt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.bindRenderbuffer(o.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class hu extends wt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.bindTexture(o.TEXTURE_2D,r),this.current=r,this.dirty=!1}}class uo extends wt{getDefault(){return null}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.bindBuffer(o.ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class oh extends wt{getDefault(){return null}set(r){const o=this.gl;o.bindBuffer(o.ELEMENT_ARRAY_BUFFER,r),this.current=r,this.dirty=!1}}class ah extends wt{getDefault(){return null}set(r){var o;if(r===this.current&&!this.dirty)return;const c=this.gl;hs(c)?c.bindVertexArray(r):(o=c.getExtension("OES_vertex_array_object"))===null||o===void 0||o.bindVertexArrayOES(r),this.current=r,this.dirty=!1}}class du extends wt{getDefault(){return 4}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_ALIGNMENT,r),this.current=r,this.dirty=!1}}class Ps extends wt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r),this.current=r,this.dirty=!1}}class lh extends wt{getDefault(){return!1}set(r){if(r===this.current&&!this.dirty)return;const o=this.gl;o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,r),this.current=r,this.dirty=!1}}class ds extends wt{constructor(r,o){super(r),this.context=r,this.parent=o}getDefault(){return null}}class co extends ds{setDirty(){this.dirty=!0}set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferTexture2D(o.FRAMEBUFFER,o.COLOR_ATTACHMENT0,o.TEXTURE_2D,r,0),this.current=r,this.dirty=!1}}class uh extends ds{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_ATTACHMENT,o.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class pu extends ds{set(r){if(r===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const o=this.gl;o.framebufferRenderbuffer(o.FRAMEBUFFER,o.DEPTH_STENCIL_ATTACHMENT,o.RENDERBUFFER,r),this.current=r,this.dirty=!1}}class Pt{constructor(r,o,c,d,g){this.context=r,this.width=o,this.height=c;const x=r.gl,w=this.framebuffer=x.createFramebuffer();if(this.colorAttachment=new co(r,w),d)this.depthAttachment=g?new pu(r,w):new uh(r,w);else if(g)throw new Error("Stencil cannot be setted without depth");if(x.checkFramebufferStatus(x.FRAMEBUFFER)!==x.FRAMEBUFFER_COMPLETE)throw new Error("Framebuffer is not complete")}destroy(){const r=this.context.gl,o=this.colorAttachment.get();if(o&&r.deleteTexture(o),this.depthAttachment){const c=this.depthAttachment.get();c&&r.deleteRenderbuffer(c)}r.deleteFramebuffer(this.framebuffer)}}class Kt{constructor(r,o,c){this.blendFunction=r,this.blendColor=o,this.mask=c}}Kt.Replace=[1,0],Kt.disabled=new Kt(Kt.Replace,u.aT.transparent,[!1,!1,!1,!1]),Kt.unblended=new Kt(Kt.Replace,u.aT.transparent,[!0,!0,!0,!0]),Kt.alphaBlended=new Kt([1,771],u.aT.transparent,[!0,!0,!0,!0]);class Gp{constructor(r){var o,c;if(this.gl=r,this.clearColor=new Za(this),this.clearDepth=new Cn(this),this.clearStencil=new Pn(this),this.colorMask=new iu(this),this.depthMask=new Ga(this),this.stencilMask=new Wa(this),this.stencilFunc=new su(this),this.stencilOp=new ou(this),this.stencilTest=new Ha(this),this.depthRange=new au(this),this.depthTest=new lu(this),this.depthFunc=new Xa(this),this.blend=new ih(this),this.blendFunc=new sh(this),this.blendColor=new lo(this),this.blendEquation=new Vp(this),this.cullFace=new Up(this),this.cullFaceSide=new jp(this),this.frontFace=new $p(this),this.program=new qp(this),this.activeTexture=new Zp(this),this.viewport=new uu(this),this.bindFramebuffer=new Ka(this),this.bindRenderbuffer=new cu(this),this.bindTexture=new hu(this),this.bindVertexBuffer=new uo(this),this.bindElementBuffer=new oh(this),this.bindVertexArray=new ah(this),this.pixelStoreUnpack=new du(this),this.pixelStoreUnpackPremultiplyAlpha=new Ps(this),this.pixelStoreUnpackFlipY=new lh(this),this.extTextureFilterAnisotropic=r.getExtension("EXT_texture_filter_anisotropic")||r.getExtension("MOZ_EXT_texture_filter_anisotropic")||r.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=r.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.maxTextureSize=r.getParameter(r.MAX_TEXTURE_SIZE),hs(r)){this.HALF_FLOAT=r.HALF_FLOAT;const d=r.getExtension("EXT_color_buffer_half_float");this.RGBA16F=(o=r.RGBA16F)!==null&&o!==void 0?o:d==null?void 0:d.RGBA16F_EXT,this.RGB16F=(c=r.RGB16F)!==null&&c!==void 0?c:d==null?void 0:d.RGB16F_EXT,r.getExtension("EXT_color_buffer_float")}else{r.getExtension("EXT_color_buffer_half_float"),r.getExtension("OES_texture_half_float_linear");const d=r.getExtension("OES_texture_half_float");this.HALF_FLOAT=d==null?void 0:d.HALF_FLOAT_OES}}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArray.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(r,o){return new $a(this,r,o)}createVertexBuffer(r,o,c){return new qa(this,r,o,c)}createRenderbuffer(r,o,c){const d=this.gl,g=d.createRenderbuffer();return this.bindRenderbuffer.set(g),d.renderbufferStorage(d.RENDERBUFFER,r,o,c),this.bindRenderbuffer.set(null),g}createFramebuffer(r,o,c,d){return new Pt(this,r,o,c,d)}clear({color:r,depth:o,stencil:c}){const d=this.gl;let g=0;r&&(g|=d.COLOR_BUFFER_BIT,this.clearColor.set(r),this.colorMask.set([!0,!0,!0,!0])),o!==void 0&&(g|=d.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(o),this.depthMask.set(!0)),c!==void 0&&(g|=d.STENCIL_BUFFER_BIT,this.clearStencil.set(c),this.stencilMask.set(255)),d.clear(g)}setCullFace(r){r.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(r.mode),this.frontFace.set(r.frontFace))}setDepthMode(r){r.func!==this.gl.ALWAYS||r.mask?(this.depthTest.set(!0),this.depthFunc.set(r.func),this.depthMask.set(r.mask),this.depthRange.set(r.range)):this.depthTest.set(!1)}setStencilMode(r){r.test.func!==this.gl.ALWAYS||r.mask?(this.stencilTest.set(!0),this.stencilMask.set(r.mask),this.stencilOp.set([r.fail,r.depthFail,r.pass]),this.stencilFunc.set({func:r.test.func,ref:r.ref,mask:r.test.mask})):this.stencilTest.set(!1)}setColorMode(r){u.aG(r.blendFunction,Kt.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(r.blendFunction),this.blendColor.set(r.blendColor)),this.colorMask.set(r.mask)}createVertexArray(){var r;return hs(this.gl)?this.gl.createVertexArray():(r=this.gl.getExtension("OES_vertex_array_object"))===null||r===void 0?void 0:r.createVertexArrayOES()}deleteVertexArray(r){var o;return hs(this.gl)?this.gl.deleteVertexArray(r):(o=this.gl.getExtension("OES_vertex_array_object"))===null||o===void 0?void 0:o.deleteVertexArrayOES(r)}unbindVAO(){this.bindVertexArray.set(null)}}class bt{constructor(r,o,c){this.func=r,this.mask=o,this.range=c}}bt.ReadOnly=!1,bt.ReadWrite=!0,bt.disabled=new bt(519,bt.ReadOnly,[0,1]);const zs=7680;class Yt{constructor(r,o,c,d,g,x){this.test=r,this.ref=o,this.mask=c,this.fail=d,this.depthFail=g,this.pass=x}}Yt.disabled=new Yt({func:519,mask:0},0,0,zs,zs,zs);class Wt{constructor(r,o,c){this.enable=r,this.mode=o,this.frontFace=c}}let Qo;function ch(f,r,o,c,d,g,x){const w=f.context,T=w.gl,E=f.useProgram("collisionBox"),P=[];let z=0,F=0;for(let Y=0;Y<c.length;Y++){const ae=c[Y],me=r.getTile(ae),ge=me.getBucket(o);if(!ge)continue;let Te=ae.posMatrix;d[0]===0&&d[1]===0||(Te=f.translatePosMatrix(ae.posMatrix,me,d,g));const ze=x?ge.textCollisionBox:ge.iconCollisionBox,Ce=ge.collisionCircleArray;if(Ce.length>0){const Ae=u.Z(),Ke=Te;u.aU(Ae,ge.placementInvProjMatrix,f.transform.glCoordMatrix),u.aU(Ae,Ae,ge.placementViewportMatrix),P.push({circleArray:Ce,circleOffset:F,transform:Ke,invTransform:Ae,coord:ae}),z+=Ce.length/4,F=z}ze&&E.draw(w,T.LINES,bt.disabled,Yt.disabled,f.colorModeForRenderPass(),Wt.disabled,Jl(Te,f.transform,me),f.style.map.terrain&&f.style.map.terrain.getTerrainData(ae),o.id,ze.layoutVertexBuffer,ze.indexBuffer,ze.segments,null,f.transform.zoom,null,null,ze.collisionVertexBuffer)}if(!x||!P.length)return;const q=f.useProgram("collisionCircle"),$=new u.aV;$.resize(4*z),$._trim();let G=0;for(const Y of P)for(let ae=0;ae<Y.circleArray.length/4;ae++){const me=4*ae,ge=Y.circleArray[me+0],Te=Y.circleArray[me+1],ze=Y.circleArray[me+2],Ce=Y.circleArray[me+3];$.emplace(G++,ge,Te,ze,Ce,0),$.emplace(G++,ge,Te,ze,Ce,1),$.emplace(G++,ge,Te,ze,Ce,2),$.emplace(G++,ge,Te,ze,Ce,3)}(!Qo||Qo.length<2*z)&&(Qo=function(Y){const ae=2*Y,me=new u.aX;me.resize(ae),me._trim();for(let ge=0;ge<ae;ge++){const Te=6*ge;me.uint16[Te+0]=4*ge+0,me.uint16[Te+1]=4*ge+1,me.uint16[Te+2]=4*ge+2,me.uint16[Te+3]=4*ge+2,me.uint16[Te+4]=4*ge+3,me.uint16[Te+5]=4*ge+0}return me}(z));const U=w.createIndexBuffer(Qo,!0),oe=w.createVertexBuffer($,u.aW.members,!0);for(const Y of P){const ae={u_matrix:Y.transform,u_inv_matrix:Y.invTransform,u_camera_to_center_distance:(pe=f.transform).cameraToCenterDistance,u_viewport_size:[pe.width,pe.height]};q.draw(w,T.TRIANGLES,bt.disabled,Yt.disabled,f.colorModeForRenderPass(),Wt.disabled,ae,f.style.map.terrain&&f.style.map.terrain.getTerrainData(Y.coord),o.id,oe,U,u.S.simpleSegment(0,2*Y.circleOffset,Y.circleArray.length,Y.circleArray.length/2),null,f.transform.zoom,null,null,null)}var pe;oe.destroy(),U.destroy()}Wt.disabled=new Wt(!1,1029,2305),Wt.backCCW=new Wt(!0,1029,2305);const fu=u.ao(new Float32Array(16));function Ya(f,r,o,c,d,g){const{horizontalAlign:x,verticalAlign:w}=u.au(f);return new u.P((-(x-.5)*r/d+c[0])*g,(-(w-.5)*o/d+c[1])*g)}function Qa(f,r,o,c,d,g,x,w,T,E,P){const z=f.text.placedSymbolArray,F=f.text.dynamicLayoutVertexArray,q=f.icon.dynamicLayoutVertexArray,$={};F.clear();for(let G=0;G<z.length;G++){const U=z.get(G),oe=U.hidden||!U.crossTileID||f.allowVerticalPlacement&&!U.placedOrientation?null:c[U.crossTileID];if(oe){const pe=new u.P(U.anchorX,U.anchorY),Y=er(pe,o?x:g,P),ae=Es(d.cameraToCenterDistance,Y.signedDistanceFromCamera);let me=u.aj(f.textSizeData,T,U)*ae/u.ap;o&&(me*=f.tilePixelRatio/w);const{width:ge,height:Te,anchor:ze,textOffset:Ce,textBoxScale:Ae}=oe,Ke=Ya(ze,ge,Te,Ce,Ae,me),_t=o?er(pe.add(Ke),g,P).point:Y.point.add(r?Ke.rotate(-d.angle):Ke),Ne=f.allowVerticalPlacement&&U.placedOrientation===u.ai.vertical?Math.PI/2:0;for(let at=0;at<U.numGlyphs;at++)u.ak(F,_t,Ne);E&&U.associatedIconIndex>=0&&($[U.associatedIconIndex]={shiftedAnchor:_t,angle:Ne})}else V(U.numGlyphs,F)}if(E){q.clear();const G=f.icon.placedSymbolArray;for(let U=0;U<G.length;U++){const oe=G.get(U);if(oe.hidden)V(oe.numGlyphs,q);else{const pe=$[U];if(pe)for(let Y=0;Y<oe.numGlyphs;Y++)u.ak(q,pe.shiftedAnchor,pe.angle);else V(oe.numGlyphs,q)}}f.icon.dynamicLayoutVertexBuffer.updateData(q)}f.text.dynamicLayoutVertexBuffer.updateData(F)}function mu(f,r,o){return o.iconsInText&&r?"symbolTextAndIcon":f?"symbolSDF":"symbolIcon"}function Ja(f,r,o,c,d,g,x,w,T,E,P,z){const F=f.context,q=F.gl,$=f.transform,G=w==="map",U=T==="map",oe=w!=="viewport"&&o.layout.get("symbol-placement")!=="point",pe=G&&!U&&!oe,Y=!o.layout.get("symbol-sort-key").isConstant();let ae=!1;const me=f.depthModeForSublayer(0,bt.ReadOnly),ge=o._unevaluatedLayout.hasValue("text-variable-anchor")||o._unevaluatedLayout.hasValue("text-variable-anchor-offset"),Te=[];for(const ze of c){const Ce=r.getTile(ze),Ae=Ce.getBucket(o);if(!Ae)continue;const Ke=d?Ae.text:Ae.icon;if(!Ke||!Ke.segments.get().length||!Ke.hasVisibleVertices)continue;const _t=Ke.programConfigurations.get(o.id),Ne=d||Ae.sdfIcons,at=d?Ae.textSizeData:Ae.iconSizeData,Qe=U||$.pitch!==0,Rt=f.useProgram(mu(Ne,d,Ae),_t),yt=u.ah(at,$.zoom),pt=f.style.map.terrain&&f.style.map.terrain.getTerrainData(ze);let vt,ar,jt,Br,br=[0,0],pr=null;if(d)ar=Ce.glyphAtlasTexture,jt=q.LINEAR,vt=Ce.glyphAtlasTexture.size,Ae.iconsInText&&(br=Ce.imageAtlasTexture.size,pr=Ce.imageAtlasTexture,Br=Qe||f.options.rotating||f.options.zooming||at.kind==="composite"||at.kind==="camera"?q.LINEAR:q.NEAREST);else{const lr=o.layout.get("icon-size").constantOr(0)!==1||Ae.iconsNeedLinear;ar=Ce.imageAtlasTexture,jt=Ne||f.options.rotating||f.options.zooming||lr||Qe?q.LINEAR:q.NEAREST,vt=Ce.imageAtlasTexture.size}const An=se(Ce,1,f.transform.zoom),Zt=Re(ze.posMatrix,U,G,f.transform,An),bi=vi(ze.posMatrix,U,G,f.transform,An),Si=ge&&Ae.hasTextData(),ms=o.layout.get("icon-text-fit")!=="none"&&Si&&Ae.hasIconData();if(oe){const lr=f.style.map.terrain?(gn,ur)=>f.style.map.terrain.getElevation(ze,gn,ur):null,Sr=o.layout.get("text-rotation-alignment")==="map";Oe(Ae,ze.posMatrix,f,d,Zt,bi,U,E,Sr,lr)}const Rs=f.translatePosMatrix(ze.posMatrix,Ce,g,x),_o=oe||d&&ge||ms?fu:Zt,Gr=f.translatePosMatrix(bi,Ce,g,x,!0),Or=Ne&&o.paint.get(d?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let tn;tn=Ne?Ae.iconsInText?Cs(at.kind,yt,pe,U,f,Rs,_o,Gr,vt,br):nu(at.kind,yt,pe,U,f,Rs,_o,Gr,d,vt,!0):ru(at.kind,yt,pe,U,f,Rs,_o,Gr,d,vt);const Fs={program:Rt,buffers:Ke,uniformValues:tn,atlasTexture:ar,atlasTextureIcon:pr,atlasInterpolation:jt,atlasInterpolationIcon:Br,isSDF:Ne,hasHalo:Or};if(Y&&Ae.canOverlap){ae=!0;const lr=Ke.segments.get();for(const Sr of lr)Te.push({segments:new u.S([Sr]),sortKey:Sr.sortKey,state:Fs,terrainData:pt})}else Te.push({segments:Ke.segments,sortKey:0,state:Fs,terrainData:pt})}ae&&Te.sort((ze,Ce)=>ze.sortKey-Ce.sortKey);for(const ze of Te){const Ce=ze.state;if(F.activeTexture.set(q.TEXTURE0),Ce.atlasTexture.bind(Ce.atlasInterpolation,q.CLAMP_TO_EDGE),Ce.atlasTextureIcon&&(F.activeTexture.set(q.TEXTURE1),Ce.atlasTextureIcon&&Ce.atlasTextureIcon.bind(Ce.atlasInterpolationIcon,q.CLAMP_TO_EDGE)),Ce.isSDF){const Ae=Ce.uniformValues;Ce.hasHalo&&(Ae.u_is_halo=1,gu(Ce.buffers,ze.segments,o,f,Ce.program,me,P,z,Ae,ze.terrainData)),Ae.u_is_halo=0}gu(Ce.buffers,ze.segments,o,f,Ce.program,me,P,z,Ce.uniformValues,ze.terrainData)}}function gu(f,r,o,c,d,g,x,w,T,E){const P=c.context;d.draw(P,P.gl.TRIANGLES,g,x,w,Wt.disabled,T,E,o.id,f.layoutVertexBuffer,f.indexBuffer,r,o.paint,c.transform.zoom,f.programConfigurations.get(o.id),f.dynamicLayoutVertexBuffer,f.opacityVertexBuffer)}function Jo(f,r,o,c,d){if(!o||!c||!c.imageAtlas)return;const g=c.imageAtlas.patternPositions;let x=g[o.to.toString()],w=g[o.from.toString()];if(!x&&w&&(x=w),!w&&x&&(w=x),!x||!w){const T=d.getPaintProperty(r);x=g[T],w=g[T]}x&&w&&f.setConstantPatternPositions(x,w)}function ea(f,r,o,c,d,g,x){const w=f.context.gl,T="fill-pattern",E=o.paint.get(T),P=E&&E.constantOr(1),z=o.getCrossfadeParameters();let F,q,$,G,U;x?(q=P&&!o.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",F=w.LINES):(q=P?"fillPattern":"fill",F=w.TRIANGLES);const oe=E.constantOr(null);for(const pe of c){const Y=r.getTile(pe);if(P&&!Y.patternsLoaded())continue;const ae=Y.getBucket(o);if(!ae)continue;const me=ae.programConfigurations.get(o.id),ge=f.useProgram(q,me),Te=f.style.map.terrain&&f.style.map.terrain.getTerrainData(pe);P&&(f.context.activeTexture.set(w.TEXTURE0),Y.imageAtlasTexture.bind(w.LINEAR,w.CLAMP_TO_EDGE),me.updatePaintBuffers(z)),Jo(me,T,oe,Y,o);const ze=Te?pe:null,Ce=f.translatePosMatrix(ze?ze.posMatrix:pe.posMatrix,Y,o.paint.get("fill-translate"),o.paint.get("fill-translate-anchor"));if(x){G=ae.indexBuffer2,U=ae.segments2;const Ae=[w.drawingBufferWidth,w.drawingBufferHeight];$=q==="fillOutlinePattern"&&P?Na(Ce,f,z,Y,Ae):Oa(Ce,Ae)}else G=ae.indexBuffer,U=ae.segments,$=P?Ql(Ce,f,z,Y):Yc(Ce);ge.draw(f.context,F,d,f.stencilModeForClipping(pe),g,Wt.disabled,$,Te,o.id,ae.layoutVertexBuffer,G,U,o.paint,f.transform.zoom,me)}}function ta(f,r,o,c,d,g,x){const w=f.context,T=w.gl,E="fill-extrusion-pattern",P=o.paint.get(E),z=P.constantOr(1),F=o.getCrossfadeParameters(),q=o.paint.get("fill-extrusion-opacity"),$=P.constantOr(null);for(const G of c){const U=r.getTile(G),oe=U.getBucket(o);if(!oe)continue;const pe=f.style.map.terrain&&f.style.map.terrain.getTerrainData(G),Y=oe.programConfigurations.get(o.id),ae=f.useProgram(z?"fillExtrusionPattern":"fillExtrusion",Y);z&&(f.context.activeTexture.set(T.TEXTURE0),U.imageAtlasTexture.bind(T.LINEAR,T.CLAMP_TO_EDGE),Y.updatePaintBuffers(F)),Jo(Y,E,$,U,o);const me=f.translatePosMatrix(G.posMatrix,U,o.paint.get("fill-extrusion-translate"),o.paint.get("fill-extrusion-translate-anchor")),ge=o.paint.get("fill-extrusion-vertical-gradient"),Te=z?us(me,f,ge,q,G,F,U):Yl(me,f,ge,q);ae.draw(w,w.gl.TRIANGLES,d,g,x,Wt.backCCW,Te,pe,o.id,oe.layoutVertexBuffer,oe.indexBuffer,oe.segments,o.paint,f.transform.zoom,Y,f.style.map.terrain&&oe.centroidVertexBuffer)}}function Wp(f,r,o,c,d,g,x){const w=f.context,T=w.gl,E=o.fbo;if(!E)return;const P=f.useProgram("hillshade"),z=f.style.map.terrain&&f.style.map.terrain.getTerrainData(r);w.activeTexture.set(T.TEXTURE0),T.bindTexture(T.TEXTURE_2D,E.colorAttachment.get()),P.draw(w,T.TRIANGLES,d,g,x,Wt.disabled,((F,q,$,G)=>{const U=$.paint.get("hillshade-shadow-color"),oe=$.paint.get("hillshade-highlight-color"),pe=$.paint.get("hillshade-accent-color");let Y=$.paint.get("hillshade-illumination-direction")*(Math.PI/180);$.paint.get("hillshade-illumination-anchor")==="viewport"&&(Y-=F.transform.angle);const ae=!F.options.moving;return{u_matrix:G?G.posMatrix:F.transform.calculatePosMatrix(q.tileID.toUnwrapped(),ae),u_image:0,u_latrange:eu(0,q.tileID),u_light:[$.paint.get("hillshade-exaggeration"),Y],u_shadow:U,u_highlight:oe,u_accent:pe}})(f,o,c,z?r:null),z,c.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments)}function yu(f,r,o,c,d,g){const x=f.context,w=x.gl,T=r.dem;if(T&&T.data){const E=T.dim,P=T.stride,z=T.getPixels();if(x.activeTexture.set(w.TEXTURE1),x.pixelStoreUnpackPremultiplyAlpha.set(!1),r.demTexture=r.demTexture||f.getTileTexture(P),r.demTexture){const q=r.demTexture;q.update(z,{premultiply:!1}),q.bind(w.NEAREST,w.CLAMP_TO_EDGE)}else r.demTexture=new rt(x,z,w.RGBA,{premultiply:!1}),r.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);x.activeTexture.set(w.TEXTURE0);let F=r.fbo;if(!F){const q=new rt(x,{width:E,height:E,data:null},w.RGBA);q.bind(w.LINEAR,w.CLAMP_TO_EDGE),F=r.fbo=x.createFramebuffer(E,E,!0,!1),F.colorAttachment.set(q.texture)}x.bindFramebuffer.set(F.framebuffer),x.viewport.set([0,0,E,E]),f.useProgram("hillshadePrepare").draw(x,w.TRIANGLES,c,d,g,Wt.disabled,((q,$)=>{const G=$.stride,U=u.Z();return u.aS(U,0,u.N,-u.N,0,0,1),u.$(U,U,[0,-u.N,0]),{u_matrix:U,u_image:1,u_dimension:[G,G],u_zoom:q.overscaledZ,u_unpack:$.getUnpackVector()}})(r.tileID,T),null,o.id,f.rasterBoundsBuffer,f.quadTriangleIndexBuffer,f.rasterBoundsSegments),r.needsHillshadePrepare=!1}}function Hp(f,r,o,c,d,g){const x=c.paint.get("raster-fade-duration");if(!g&&x>0){const w=u.h.now(),T=(w-f.timeAdded)/x,E=r?(w-r.timeAdded)/x:-1,P=o.getSource(),z=d.coveringZoomLevel({tileSize:P.tileSize,roundZoom:P.roundZoom}),F=!r||Math.abs(r.tileID.overscaledZ-z)>Math.abs(f.tileID.overscaledZ-z),q=F&&f.refreshedUponExpiration?1:u.ad(F?T:1-E,0,1);return f.refreshedUponExpiration&&T>=1&&(f.refreshedUponExpiration=!1),r?{opacity:1,mix:1-q}:{opacity:q,mix:0}}return{opacity:1,mix:0}}const hh=new u.aT(1,0,0,1),el=new u.aT(0,1,0,1),_u=new u.aT(0,0,1,1),dh=new u.aT(1,0,1,1),ph=new u.aT(0,1,1,1);function ra(f,r,o,c){rl(f,0,r+o/2,f.transform.width,o,c)}function tl(f,r,o,c){rl(f,r-o/2,0,o,f.transform.height,c)}function rl(f,r,o,c,d,g){const x=f.context,w=x.gl;w.enable(w.SCISSOR_TEST),w.scissor(r*f.pixelRatio,o*f.pixelRatio,c*f.pixelRatio,d*f.pixelRatio),x.clear({color:g}),w.disable(w.SCISSOR_TEST)}function fh(f,r,o){const c=f.context,d=c.gl,g=o.posMatrix,x=f.useProgram("debug"),w=bt.disabled,T=Yt.disabled,E=f.colorModeForRenderPass(),P="$debug",z=f.style.map.terrain&&f.style.map.terrain.getTerrainData(o);c.activeTexture.set(d.TEXTURE0);const F=r.getTileByID(o.key).latestRawTileData,q=Math.floor((F&&F.byteLength||0)/1024),$=r.getTile(o).tileSize,G=512/Math.min($,512)*(o.overscaledZ/f.transform.zoom)*.5;let U=o.canonical.toString();o.overscaledZ!==o.canonical.z&&(U+=` => ${o.overscaledZ}`),function(oe,pe){oe.initDebugOverlayCanvas();const Y=oe.debugOverlayCanvas,ae=oe.context.gl,me=oe.debugOverlayCanvas.getContext("2d");me.clearRect(0,0,Y.width,Y.height),me.shadowColor="white",me.shadowBlur=2,me.lineWidth=1.5,me.strokeStyle="white",me.textBaseline="top",me.font="bold 36px Open Sans, sans-serif",me.fillText(pe,5,5),me.strokeText(pe,5,5),oe.debugOverlayTexture.update(Y),oe.debugOverlayTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE)}(f,`${U} ${q}kB`),x.draw(c,d.TRIANGLES,w,T,Kt.alphaBlended,Wt.disabled,Ko(g,u.aT.transparent,G),null,P,f.debugBuffer,f.quadTriangleIndexBuffer,f.debugSegments),x.draw(c,d.LINE_STRIP,w,T,E,Wt.disabled,Ko(g,u.aT.red),z,P,f.debugBuffer,f.tileBorderIndexBuffer,f.debugSegments)}function rr(f,r,o){const c=f.context,d=c.gl,g=f.colorModeForRenderPass(),x=new bt(d.LEQUAL,bt.ReadWrite,f.depthRangeFor3D),w=f.useProgram("terrain"),T=r.getTerrainMesh();c.bindFramebuffer.set(null),c.viewport.set([0,0,f.width,f.height]);for(const E of o){const P=f.renderToTexture.getTexture(E),z=r.getTerrainData(E.tileID);c.activeTexture.set(d.TEXTURE0),d.bindTexture(d.TEXTURE_2D,P.texture);const F={u_matrix:f.transform.calculatePosMatrix(E.tileID.toUnwrapped()),u_texture:0,u_ele_delta:r.getMeshFrameDelta(f.transform.zoom)};w.draw(c,d.TRIANGLES,x,Yt.disabled,g,Wt.backCCW,F,z,"terrain",T.vertexBuffer,T.indexBuffer,T.segments)}}class Ms{constructor(r,o){this.context=new Gp(r),this.transform=o,this._tileTextures={},this.terrainFacilitator={dirty:!0,matrix:u.Z(),renderTime:0},this.setup(),this.numSublayers=pn.maxUnderzooming+pn.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.crossTileSymbolIndex=new Ra}resize(r,o,c){if(this.width=Math.floor(r*c),this.height=Math.floor(o*c),this.pixelRatio=c,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const d of this.style._order)this.style._layers[d].resize()}setup(){const r=this.context,o=new u.a_;o.emplaceBack(0,0),o.emplaceBack(u.N,0),o.emplaceBack(0,u.N),o.emplaceBack(u.N,u.N),this.tileExtentBuffer=r.createVertexBuffer(o,Fa.members),this.tileExtentSegments=u.S.simpleSegment(0,0,4,2);const c=new u.a_;c.emplaceBack(0,0),c.emplaceBack(u.N,0),c.emplaceBack(0,u.N),c.emplaceBack(u.N,u.N),this.debugBuffer=r.createVertexBuffer(c,Fa.members),this.debugSegments=u.S.simpleSegment(0,0,4,5);const d=new u.V;d.emplaceBack(0,0,0,0),d.emplaceBack(u.N,0,u.N,0),d.emplaceBack(0,u.N,0,u.N),d.emplaceBack(u.N,u.N,u.N,u.N),this.rasterBoundsBuffer=r.createVertexBuffer(d,ii.members),this.rasterBoundsSegments=u.S.simpleSegment(0,0,4,2);const g=new u.a_;g.emplaceBack(0,0),g.emplaceBack(1,0),g.emplaceBack(0,1),g.emplaceBack(1,1),this.viewportBuffer=r.createVertexBuffer(g,Fa.members),this.viewportSegments=u.S.simpleSegment(0,0,4,2);const x=new u.a$;x.emplaceBack(0),x.emplaceBack(1),x.emplaceBack(3),x.emplaceBack(2),x.emplaceBack(0),this.tileBorderIndexBuffer=r.createIndexBuffer(x);const w=new u.b0;w.emplaceBack(0,1,2),w.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=r.createIndexBuffer(w);const T=this.context.gl;this.stencilClearMode=new Yt({func:T.ALWAYS,mask:0},0,255,T.ZERO,T.ZERO,T.ZERO)}clearStencil(){const r=this.context,o=r.gl;this.nextStencilID=1,this.currentStencilSource=void 0;const c=u.Z();u.aS(c,0,this.width,this.height,0,0,1),u.a0(c,c,[o.drawingBufferWidth,o.drawingBufferHeight,0]),this.useProgram("clippingMask").draw(r,o.TRIANGLES,bt.disabled,this.stencilClearMode,Kt.disabled,Wt.disabled,Qc(c),null,"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}_renderTileClippingMasks(r,o){if(this.currentStencilSource===r.source||!r.isTileClipped()||!o||!o.length)return;this.currentStencilSource=r.source;const c=this.context,d=c.gl;this.nextStencilID+o.length>256&&this.clearStencil(),c.setColorMode(Kt.disabled),c.setDepthMode(bt.disabled);const g=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const x of o){const w=this._tileClippingMaskIDs[x.key]=this.nextStencilID++,T=this.style.map.terrain&&this.style.map.terrain.getTerrainData(x);g.draw(c,d.TRIANGLES,bt.disabled,new Yt({func:d.ALWAYS,mask:0},w,255,d.KEEP,d.KEEP,d.REPLACE),Kt.disabled,Wt.disabled,Qc(x.posMatrix),T,"$clipping",this.tileExtentBuffer,this.quadTriangleIndexBuffer,this.tileExtentSegments)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const r=this.nextStencilID++,o=this.context.gl;return new Yt({func:o.NOTEQUAL,mask:255},r,255,o.KEEP,o.KEEP,o.REPLACE)}stencilModeForClipping(r){const o=this.context.gl;return new Yt({func:o.EQUAL,mask:255},this._tileClippingMaskIDs[r.key],0,o.KEEP,o.KEEP,o.REPLACE)}stencilConfigForOverlap(r){const o=this.context.gl,c=r.sort((x,w)=>w.overscaledZ-x.overscaledZ),d=c[c.length-1].overscaledZ,g=c[0].overscaledZ-d+1;if(g>1){this.currentStencilSource=void 0,this.nextStencilID+g>256&&this.clearStencil();const x={};for(let w=0;w<g;w++)x[w+d]=new Yt({func:o.GEQUAL,mask:255},w+this.nextStencilID,255,o.KEEP,o.KEEP,o.REPLACE);return this.nextStencilID+=g,[x,c]}return[{[d]:Yt.disabled},c]}colorModeForRenderPass(){const r=this.context.gl;return this._showOverdrawInspector?new Kt([r.CONSTANT_COLOR,r.ONE],new u.aT(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?Kt.unblended:Kt.alphaBlended}depthModeForSublayer(r,o,c){if(!this.opaquePassEnabledForLayer())return bt.disabled;const d=1-((1+this.currentLayer)*this.numSublayers+r)*this.depthEpsilon;return new bt(c||this.context.gl.LEQUAL,o,[d,d])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(r,o){this.style=r,this.options=o,this.lineAtlas=r.lineAtlas,this.imageManager=r.imageManager,this.glyphManager=r.glyphManager,this.symbolFadeChange=r.placement.symbolFadeChange(u.h.now()),this.imageManager.beginFrame();const c=this.style._order,d=this.style.sourceCaches,g={},x={},w={};for(const T in d){const E=d[T];E.used&&E.prepare(this.context),g[T]=E.getVisibleCoordinates(),x[T]=g[T].slice().reverse(),w[T]=E.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let T=0;T<c.length;T++)if(this.style._layers[c[T]].is3D()){this.opaquePassCutoff=T;break}if(this.renderToTexture){this.renderToTexture.prepareForRender(this.style,this.transform.zoom),this.opaquePassCutoff=0;const T=this.style.map.terrain.sourceCache.tilesAfterTime(this.terrainFacilitator.renderTime);(this.terrainFacilitator.dirty||!u.b1(this.terrainFacilitator.matrix,this.transform.projMatrix)||T.length)&&(u.b2(this.terrainFacilitator.matrix,this.transform.projMatrix),this.terrainFacilitator.renderTime=Date.now(),this.terrainFacilitator.dirty=!1,function(E,P){const z=E.context,F=z.gl,q=Kt.unblended,$=new bt(F.LEQUAL,bt.ReadWrite,[0,1]),G=P.getTerrainMesh(),U=P.sourceCache.getRenderableTiles(),oe=E.useProgram("terrainDepth");z.bindFramebuffer.set(P.getFramebuffer("depth").framebuffer),z.viewport.set([0,0,E.width/devicePixelRatio,E.height/devicePixelRatio]),z.clear({color:u.aT.transparent,depth:1});for(const pe of U){const Y=P.getTerrainData(pe.tileID),ae={u_matrix:E.transform.calculatePosMatrix(pe.tileID.toUnwrapped()),u_ele_delta:P.getMeshFrameDelta(E.transform.zoom)};oe.draw(z,F.TRIANGLES,$,Yt.disabled,q,Wt.backCCW,ae,Y,"terrain",G.vertexBuffer,G.indexBuffer,G.segments)}z.bindFramebuffer.set(null),z.viewport.set([0,0,E.width,E.height])}(this,this.style.map.terrain),function(E,P){const z=E.context,F=z.gl,q=Kt.unblended,$=new bt(F.LEQUAL,bt.ReadWrite,[0,1]),G=P.getTerrainMesh(),U=P.getCoordsTexture(),oe=P.sourceCache.getRenderableTiles(),pe=E.useProgram("terrainCoords");z.bindFramebuffer.set(P.getFramebuffer("coords").framebuffer),z.viewport.set([0,0,E.width/devicePixelRatio,E.height/devicePixelRatio]),z.clear({color:u.aT.transparent,depth:1}),P.coordsIndex=[];for(const Y of oe){const ae=P.getTerrainData(Y.tileID);z.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,U.texture);const me={u_matrix:E.transform.calculatePosMatrix(Y.tileID.toUnwrapped()),u_terrain_coords_id:(255-P.coordsIndex.length)/255,u_texture:0,u_ele_delta:P.getMeshFrameDelta(E.transform.zoom)};pe.draw(z,F.TRIANGLES,$,Yt.disabled,q,Wt.backCCW,me,ae,"terrain",G.vertexBuffer,G.indexBuffer,G.segments),P.coordsIndex.push(Y.tileID.key)}z.bindFramebuffer.set(null),z.viewport.set([0,0,E.width,E.height])}(this,this.style.map.terrain))}this.renderPass="offscreen";for(const T of c){const E=this.style._layers[T];if(!E.hasOffscreenPass()||E.isHidden(this.transform.zoom))continue;const P=x[E.source];(E.type==="custom"||P.length)&&this.renderLayer(this,d[E.source],E,P)}if(this.context.bindFramebuffer.set(null),this.context.clear({color:o.showOverdrawInspector?u.aT.black:u.aT.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=o.showOverdrawInspector,this.depthRangeFor3D=[0,1-(r._order.length+2)*this.numSublayers*this.depthEpsilon],!this.renderToTexture)for(this.renderPass="opaque",this.currentLayer=c.length-1;this.currentLayer>=0;this.currentLayer--){const T=this.style._layers[c[this.currentLayer]],E=d[T.source],P=g[T.source];this._renderTileClippingMasks(T,P),this.renderLayer(this,E,T,P)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<c.length;this.currentLayer++){const T=this.style._layers[c[this.currentLayer]],E=d[T.source];if(this.renderToTexture&&this.renderToTexture.renderLayer(T))continue;const P=(T.type==="symbol"?w:x)[T.source];this._renderTileClippingMasks(T,g[T.source]),this.renderLayer(this,E,T,P)}if(this.options.showTileBoundaries){const T=function(E,P){let z=null;const F=Object.values(E._layers).flatMap(U=>U.source&&!U.isHidden(P)?[E.sourceCaches[U.source]]:[]),q=F.filter(U=>U.getSource().type==="vector"),$=F.filter(U=>U.getSource().type!=="vector"),G=U=>{(!z||z.getSource().maxzoom<U.getSource().maxzoom)&&(z=U)};return q.forEach(U=>G(U)),z||$.forEach(U=>G(U)),z}(this.style,this.transform.zoom);T&&function(E,P,z){for(let F=0;F<z.length;F++)fh(E,P,z[F])}(this,T,T.getVisibleCoordinates())}this.options.showPadding&&function(T){const E=T.transform.padding;ra(T,T.transform.height-(E.top||0),3,hh),ra(T,E.bottom||0,3,el),tl(T,E.left||0,3,_u),tl(T,T.transform.width-(E.right||0),3,dh);const P=T.transform.centerPoint;(function(z,F,q,$){rl(z,F-1,q-10,2,20,$),rl(z,F-10,q-1,20,2,$)})(T,P.x,T.transform.height-P.y,ph)}(this),this.context.setDefault()}renderLayer(r,o,c,d){if(!c.isHidden(this.transform.zoom)&&(c.type==="background"||c.type==="custom"||(d||[]).length))switch(this.id=c.id,c.type){case"symbol":(function(g,x,w,T,E){if(g.renderPass!=="translucent")return;const P=Yt.disabled,z=g.colorModeForRenderPass();(w._unevaluatedLayout.hasValue("text-variable-anchor")||w._unevaluatedLayout.hasValue("text-variable-anchor-offset"))&&function(F,q,$,G,U,oe,pe){const Y=q.transform,ae=U==="map",me=oe==="map";for(const ge of F){const Te=G.getTile(ge),ze=Te.getBucket($);if(!ze||!ze.text||!ze.text.segments.get().length)continue;const Ce=u.ah(ze.textSizeData,Y.zoom),Ae=se(Te,1,q.transform.zoom),Ke=Re(ge.posMatrix,me,ae,q.transform,Ae),_t=$.layout.get("icon-text-fit")!=="none"&&ze.hasIconData();if(Ce){const Ne=Math.pow(2,Y.zoom-Te.tileID.overscaledZ);Qa(ze,ae,me,pe,Y,Ke,ge.posMatrix,Ne,Ce,_t,q.style.map.terrain?(at,Qe)=>q.style.map.terrain.getElevation(ge,at,Qe):null)}}}(T,g,w,x,w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),E),w.paint.get("icon-opacity").constantOr(1)!==0&&Ja(g,x,w,T,!1,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),w.layout.get("icon-rotation-alignment"),w.layout.get("icon-pitch-alignment"),w.layout.get("icon-keep-upright"),P,z),w.paint.get("text-opacity").constantOr(1)!==0&&Ja(g,x,w,T,!0,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),w.layout.get("text-rotation-alignment"),w.layout.get("text-pitch-alignment"),w.layout.get("text-keep-upright"),P,z),x.map.showCollisionBoxes&&(ch(g,x,w,T,w.paint.get("text-translate"),w.paint.get("text-translate-anchor"),!0),ch(g,x,w,T,w.paint.get("icon-translate"),w.paint.get("icon-translate-anchor"),!1))})(r,o,c,d,this.style.placement.variableOffsets);break;case"circle":(function(g,x,w,T){if(g.renderPass!=="translucent")return;const E=w.paint.get("circle-opacity"),P=w.paint.get("circle-stroke-width"),z=w.paint.get("circle-stroke-opacity"),F=!w.layout.get("circle-sort-key").isConstant();if(E.constantOr(1)===0&&(P.constantOr(1)===0||z.constantOr(1)===0))return;const q=g.context,$=q.gl,G=g.depthModeForSublayer(0,bt.ReadOnly),U=Yt.disabled,oe=g.colorModeForRenderPass(),pe=[];for(let Y=0;Y<T.length;Y++){const ae=T[Y],me=x.getTile(ae),ge=me.getBucket(w);if(!ge)continue;const Te=ge.programConfigurations.get(w.id),ze=g.useProgram("circle",Te),Ce=ge.layoutVertexBuffer,Ae=ge.indexBuffer,Ke=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ae),_t={programConfiguration:Te,program:ze,layoutVertexBuffer:Ce,indexBuffer:Ae,uniformValues:cs(g,ae,me,w),terrainData:Ke};if(F){const Ne=ge.segments.get();for(const at of Ne)pe.push({segments:new u.S([at]),sortKey:at.sortKey,state:_t})}else pe.push({segments:ge.segments,sortKey:0,state:_t})}F&&pe.sort((Y,ae)=>Y.sortKey-ae.sortKey);for(const Y of pe){const{programConfiguration:ae,program:me,layoutVertexBuffer:ge,indexBuffer:Te,uniformValues:ze,terrainData:Ce}=Y.state;me.draw(q,$.TRIANGLES,G,U,oe,Wt.disabled,ze,Ce,w.id,ge,Te,Y.segments,w.paint,g.transform.zoom,ae)}})(r,o,c,d);break;case"heatmap":(function(g,x,w,T){if(w.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const E=g.context,P=E.gl,z=Yt.disabled,F=new Kt([P.ONE,P.ONE],u.aT.transparent,[!0,!0,!0,!0]);(function(q,$,G){const U=q.gl;q.activeTexture.set(U.TEXTURE1),q.viewport.set([0,0,$.width/4,$.height/4]);let oe=G.heatmapFbo;if(oe)U.bindTexture(U.TEXTURE_2D,oe.colorAttachment.get()),q.bindFramebuffer.set(oe.framebuffer);else{const pe=U.createTexture();U.bindTexture(U.TEXTURE_2D,pe),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_WRAP_S,U.CLAMP_TO_EDGE),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_WRAP_T,U.CLAMP_TO_EDGE),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_MIN_FILTER,U.LINEAR),U.texParameteri(U.TEXTURE_2D,U.TEXTURE_MAG_FILTER,U.LINEAR),oe=G.heatmapFbo=q.createFramebuffer($.width/4,$.height/4,!1,!1),function(Y,ae,me,ge){var Te,ze;const Ce=Y.gl,Ae=(Te=Y.HALF_FLOAT)!==null&&Te!==void 0?Te:Ce.UNSIGNED_BYTE,Ke=(ze=Y.RGBA16F)!==null&&ze!==void 0?ze:Ce.RGBA;Ce.texImage2D(Ce.TEXTURE_2D,0,Ke,ae.width/4,ae.height/4,0,Ce.RGBA,Ae,null),ge.colorAttachment.set(me)}(q,$,pe,oe)}})(E,g,w),E.clear({color:u.aT.transparent});for(let q=0;q<T.length;q++){const $=T[q];if(x.hasRenderableParent($))continue;const G=x.getTile($),U=G.getBucket(w);if(!U)continue;const oe=U.programConfigurations.get(w.id),pe=g.useProgram("heatmap",oe),{zoom:Y}=g.transform;pe.draw(E,P.TRIANGLES,bt.disabled,z,F,Wt.disabled,Op($.posMatrix,G,Y,w.paint.get("heatmap-intensity")),null,w.id,U.layoutVertexBuffer,U.indexBuffer,U.segments,w.paint,g.transform.zoom,oe)}E.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),function(E,P){const z=E.context,F=z.gl,q=P.heatmapFbo;if(!q)return;z.activeTexture.set(F.TEXTURE0),F.bindTexture(F.TEXTURE_2D,q.colorAttachment.get()),z.activeTexture.set(F.TEXTURE1);let $=P.colorRampTexture;$||($=P.colorRampTexture=new rt(z,P.colorRamp,F.RGBA)),$.bind(F.LINEAR,F.CLAMP_TO_EDGE),E.useProgram("heatmapTexture").draw(z,F.TRIANGLES,bt.disabled,Yt.disabled,E.colorModeForRenderPass(),Wt.disabled,((G,U,oe,pe)=>{const Y=u.Z();u.aS(Y,0,G.width,G.height,0,0,1);const ae=G.context.gl;return{u_matrix:Y,u_world:[ae.drawingBufferWidth,ae.drawingBufferHeight],u_image:0,u_color_ramp:1,u_opacity:U.paint.get("heatmap-opacity")}})(E,P),null,P.id,E.viewportBuffer,E.quadTriangleIndexBuffer,E.viewportSegments,P.paint,E.transform.zoom)}(g,w))})(r,o,c,d);break;case"line":(function(g,x,w,T){if(g.renderPass!=="translucent")return;const E=w.paint.get("line-opacity"),P=w.paint.get("line-width");if(E.constantOr(1)===0||P.constantOr(1)===0)return;const z=g.depthModeForSublayer(0,bt.ReadOnly),F=g.colorModeForRenderPass(),q=w.paint.get("line-dasharray"),$=w.paint.get("line-pattern"),G=$.constantOr(1),U=w.paint.get("line-gradient"),oe=w.getCrossfadeParameters(),pe=G?"linePattern":q?"lineSDF":U?"lineGradient":"line",Y=g.context,ae=Y.gl;let me=!0;for(const ge of T){const Te=x.getTile(ge);if(G&&!Te.patternsLoaded())continue;const ze=Te.getBucket(w);if(!ze)continue;const Ce=ze.programConfigurations.get(w.id),Ae=g.context.program.get(),Ke=g.useProgram(pe,Ce),_t=me||Ke.program!==Ae,Ne=g.style.map.terrain&&g.style.map.terrain.getTerrainData(ge),at=$.constantOr(null);if(at&&Te.imageAtlas){const yt=Te.imageAtlas,pt=yt.patternPositions[at.to.toString()],vt=yt.patternPositions[at.from.toString()];pt&&vt&&Ce.setConstantPatternPositions(pt,vt)}const Qe=Ne?ge:null,Rt=G?Np(g,Te,w,oe,Qe):q?eh(g,Te,w,q,oe,Qe):U?Jc(g,Te,w,ze.lineClipsArray.length,Qe):tu(g,Te,w,Qe);if(G)Y.activeTexture.set(ae.TEXTURE0),Te.imageAtlasTexture.bind(ae.LINEAR,ae.CLAMP_TO_EDGE),Ce.updatePaintBuffers(oe);else if(q&&(_t||g.lineAtlas.dirty))Y.activeTexture.set(ae.TEXTURE0),g.lineAtlas.bind(Y);else if(U){const yt=ze.gradients[w.id];let pt=yt.texture;if(w.gradientVersion!==yt.version){let vt=256;if(w.stepInterpolant){const ar=x.getSource().maxzoom,jt=ge.canonical.z===ar?Math.ceil(1<<g.transform.maxZoom-ge.canonical.z):1;vt=u.ad(u.aY(ze.maxLineLength/u.N*1024*jt),256,Y.maxTextureSize)}yt.gradient=u.aZ({expression:w.gradientExpression(),evaluationKey:"lineProgress",resolution:vt,image:yt.gradient||void 0,clips:ze.lineClipsArray}),yt.texture?yt.texture.update(yt.gradient):yt.texture=new rt(Y,yt.gradient,ae.RGBA),yt.version=w.gradientVersion,pt=yt.texture}Y.activeTexture.set(ae.TEXTURE0),pt.bind(w.stepInterpolant?ae.NEAREST:ae.LINEAR,ae.CLAMP_TO_EDGE)}Ke.draw(Y,ae.TRIANGLES,z,g.stencilModeForClipping(ge),F,Wt.disabled,Rt,Ne,w.id,ze.layoutVertexBuffer,ze.indexBuffer,ze.segments,w.paint,g.transform.zoom,Ce,ze.layoutVertexBuffer2),me=!1}})(r,o,c,d);break;case"fill":(function(g,x,w,T){const E=w.paint.get("fill-color"),P=w.paint.get("fill-opacity");if(P.constantOr(1)===0)return;const z=g.colorModeForRenderPass(),F=w.paint.get("fill-pattern"),q=g.opaquePassEnabledForLayer()&&!F.constantOr(1)&&E.constantOr(u.aT.transparent).a===1&&P.constantOr(0)===1?"opaque":"translucent";if(g.renderPass===q){const $=g.depthModeForSublayer(1,g.renderPass==="opaque"?bt.ReadWrite:bt.ReadOnly);ea(g,x,w,T,$,z,!1)}if(g.renderPass==="translucent"&&w.paint.get("fill-antialias")){const $=g.depthModeForSublayer(w.getPaintProperty("fill-outline-color")?2:0,bt.ReadOnly);ea(g,x,w,T,$,z,!0)}})(r,o,c,d);break;case"fill-extrusion":(function(g,x,w,T){const E=w.paint.get("fill-extrusion-opacity");if(E!==0&&g.renderPass==="translucent"){const P=new bt(g.context.gl.LEQUAL,bt.ReadWrite,g.depthRangeFor3D);if(E!==1||w.paint.get("fill-extrusion-pattern").constantOr(1))ta(g,x,w,T,P,Yt.disabled,Kt.disabled),ta(g,x,w,T,P,g.stencilModeFor3D(),g.colorModeForRenderPass());else{const z=g.colorModeForRenderPass();ta(g,x,w,T,P,Yt.disabled,z)}}})(r,o,c,d);break;case"hillshade":(function(g,x,w,T){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent")return;const E=g.context,P=g.depthModeForSublayer(0,bt.ReadOnly),z=g.colorModeForRenderPass(),[F,q]=g.renderPass==="translucent"?g.stencilConfigForOverlap(T):[{},T];for(const $ of q){const G=x.getTile($);G.needsHillshadePrepare!==void 0&&G.needsHillshadePrepare&&g.renderPass==="offscreen"?yu(g,G,w,P,Yt.disabled,z):g.renderPass==="translucent"&&Wp(g,$,G,w,P,F[$.overscaledZ],z)}E.viewport.set([0,0,g.width,g.height])})(r,o,c,d);break;case"raster":(function(g,x,w,T){if(g.renderPass!=="translucent"||w.paint.get("raster-opacity")===0||!T.length)return;const E=g.context,P=E.gl,z=x.getSource(),F=g.useProgram("raster"),q=g.colorModeForRenderPass(),[$,G]=z instanceof Un?[{},T]:g.stencilConfigForOverlap(T),U=G[G.length-1].overscaledZ,oe=!g.options.moving;for(const pe of G){const Y=g.depthModeForSublayer(pe.overscaledZ-U,w.paint.get("raster-opacity")===1?bt.ReadWrite:bt.ReadOnly,P.LESS),ae=x.getTile(pe);ae.registerFadeDuration(w.paint.get("raster-fade-duration"));const me=x.findLoadedParent(pe,0),ge=Hp(ae,me,x,w,g.transform,g.style.map.terrain);let Te,ze;const Ce=w.paint.get("raster-resampling")==="nearest"?P.NEAREST:P.LINEAR;E.activeTexture.set(P.TEXTURE0),ae.texture.bind(Ce,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST),E.activeTexture.set(P.TEXTURE1),me?(me.texture.bind(Ce,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST),Te=Math.pow(2,me.tileID.overscaledZ-ae.tileID.overscaledZ),ze=[ae.tileID.canonical.x*Te%1,ae.tileID.canonical.y*Te%1]):ae.texture.bind(Ce,P.CLAMP_TO_EDGE,P.LINEAR_MIPMAP_NEAREST);const Ae=g.style.map.terrain&&g.style.map.terrain.getTerrainData(pe),Ke=Ae?pe:null,_t=Ke?Ke.posMatrix:g.transform.calculatePosMatrix(pe.toUnwrapped(),oe),Ne=rh(_t,ze||[0,0],Te||1,ge,w);z instanceof Un?F.draw(E,P.TRIANGLES,Y,Yt.disabled,q,Wt.disabled,Ne,Ae,w.id,z.boundsBuffer,g.quadTriangleIndexBuffer,z.boundsSegments):F.draw(E,P.TRIANGLES,Y,$[pe.overscaledZ],q,Wt.disabled,Ne,Ae,w.id,g.rasterBoundsBuffer,g.quadTriangleIndexBuffer,g.rasterBoundsSegments)}})(r,o,c,d);break;case"background":(function(g,x,w,T){const E=w.paint.get("background-color"),P=w.paint.get("background-opacity");if(P===0)return;const z=g.context,F=z.gl,q=g.transform,$=q.tileSize,G=w.paint.get("background-pattern");if(g.isPatternMissing(G))return;const U=!G&&E.a===1&&P===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==U)return;const oe=Yt.disabled,pe=g.depthModeForSublayer(0,U==="opaque"?bt.ReadWrite:bt.ReadOnly),Y=g.colorModeForRenderPass(),ae=g.useProgram(G?"backgroundPattern":"background"),me=T||q.coveringTiles({tileSize:$,terrain:g.style.map.terrain});G&&(z.activeTexture.set(F.TEXTURE0),g.imageManager.bind(g.context));const ge=w.getCrossfadeParameters();for(const Te of me){const ze=T?Te.posMatrix:g.transform.calculatePosMatrix(Te.toUnwrapped()),Ce=G?Gn(ze,P,g,G,{tileID:Te,tileSize:$},ge):Ua(ze,P,E),Ae=g.style.map.terrain&&g.style.map.terrain.getTerrainData(Te);ae.draw(z,F.TRIANGLES,pe,oe,Y,Wt.disabled,Ce,Ae,w.id,g.tileExtentBuffer,g.quadTriangleIndexBuffer,g.tileExtentSegments)}})(r,0,c,d);break;case"custom":(function(g,x,w){const T=g.context,E=w.implementation;if(g.renderPass==="offscreen"){const P=E.prerender;P&&(g.setCustomLayerDefaults(),T.setColorMode(g.colorModeForRenderPass()),P.call(E,T.gl,g.transform.customLayerMatrix()),T.setDirty(),g.setBaseState())}else if(g.renderPass==="translucent"){g.setCustomLayerDefaults(),T.setColorMode(g.colorModeForRenderPass()),T.setStencilMode(Yt.disabled);const P=E.renderingMode==="3d"?new bt(g.context.gl.LEQUAL,bt.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,bt.ReadOnly);T.setDepthMode(P),E.render(T.gl,g.transform.customLayerMatrix()),T.setDirty(),g.setBaseState(),T.bindFramebuffer.set(null)}})(r,0,c)}}translatePosMatrix(r,o,c,d,g){if(!c[0]&&!c[1])return r;const x=g?d==="map"?this.transform.angle:0:d==="viewport"?-this.transform.angle:0;if(x){const E=Math.sin(x),P=Math.cos(x);c=[c[0]*P-c[1]*E,c[0]*E+c[1]*P]}const w=[g?c[0]:se(o,c[0],this.transform.zoom),g?c[1]:se(o,c[1],this.transform.zoom),0],T=new Float32Array(16);return u.$(T,r,w),T}saveTileTexture(r){const o=this._tileTextures[r.size[0]];o?o.push(r):this._tileTextures[r.size[0]]=[r]}getTileTexture(r){const o=this._tileTextures[r];return o&&o.length>0?o.pop():null}isPatternMissing(r){if(!r)return!1;if(!r.from||!r.to)return!0;const o=this.imageManager.getPattern(r.from.toString()),c=this.imageManager.getPattern(r.to.toString());return!o||!c}useProgram(r,o){this.cache=this.cache||{};const c=r+(o?o.cacheKey:"")+(this._showOverdrawInspector?"/overdraw":"")+(this.style.map.terrain?"/terrain":"");return this.cache[c]||(this.cache[c]=new Ba(this.context,Xt[r],o,ja[r],this._showOverdrawInspector,this.style.map.terrain)),this.cache[c]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const r=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(r.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new rt(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this.debugOverlayTexture&&this.debugOverlayTexture.destroy()}overLimit(){const{drawingBufferWidth:r,drawingBufferHeight:o}=this.context.gl;return this.width!==r||this.height!==o}}class fn{constructor(r,o){this.points=r,this.planes=o}static fromInvProjectionMatrix(r,o,c){const d=Math.pow(2,c),g=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(w=>{const T=1/(w=u.ag([],w,r))[3]/o*d;return u.b3(w,w,[T,T,1/w[3],T])}),x=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(w=>{const T=function(F,q){var $=q[0],G=q[1],U=q[2],oe=$*$+G*G+U*U;return oe>0&&(oe=1/Math.sqrt(oe)),F[0]=q[0]*oe,F[1]=q[1]*oe,F[2]=q[2]*oe,F}([],function(F,q,$){var G=q[0],U=q[1],oe=q[2],pe=$[0],Y=$[1],ae=$[2];return F[0]=U*ae-oe*Y,F[1]=oe*pe-G*ae,F[2]=G*Y-U*pe,F}([],Le([],g[w[0]],g[w[1]]),Le([],g[w[2]],g[w[1]]))),E=-((P=T)[0]*(z=g[w[1]])[0]+P[1]*z[1]+P[2]*z[2]);var P,z;return T.concat(E)});return new fn(g,x)}}class ho{constructor(r,o){this.min=r,this.max=o,this.center=function(c,d,g){return c[0]=.5*d[0],c[1]=.5*d[1],c[2]=.5*d[2],c}([],function(c,d,g){return c[0]=d[0]+g[0],c[1]=d[1]+g[1],c[2]=d[2]+g[2],c}([],this.min,this.max))}quadrant(r){const o=[r%2==0,r<2],c=ye(this.min),d=ye(this.max);for(let g=0;g<o.length;g++)c[g]=o[g]?this.min[g]:this.center[g],d[g]=o[g]?this.center[g]:this.max[g];return d[2]=this.max[2],new ho(c,d)}distanceX(r){return Math.max(Math.min(this.max[0],r[0]),this.min[0])-r[0]}distanceY(r){return Math.max(Math.min(this.max[1],r[1]),this.min[1])-r[1]}intersects(r){const o=[[this.min[0],this.min[1],this.min[2],1],[this.max[0],this.min[1],this.min[2],1],[this.max[0],this.max[1],this.min[2],1],[this.min[0],this.max[1],this.min[2],1],[this.min[0],this.min[1],this.max[2],1],[this.max[0],this.min[1],this.max[2],1],[this.max[0],this.max[1],this.max[2],1],[this.min[0],this.max[1],this.max[2],1]];let c=!0;for(let d=0;d<r.planes.length;d++){const g=r.planes[d];let x=0;for(let w=0;w<o.length;w++)u.b4(g,o[w])>=0&&x++;if(x===0)return 0;x!==o.length&&(c=!1)}if(c)return 2;for(let d=0;d<3;d++){let g=Number.MAX_VALUE,x=-Number.MAX_VALUE;for(let w=0;w<r.points.length;w++){const T=r.points[w][d]-this.min[d];g=Math.min(g,T),x=Math.max(x,T)}if(x<0||g>this.max[d]-this.min[d])return 0}return 1}}class na{constructor(r=0,o=0,c=0,d=0){if(isNaN(r)||r<0||isNaN(o)||o<0||isNaN(c)||c<0||isNaN(d)||d<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=r,this.bottom=o,this.left=c,this.right=d}interpolate(r,o,c){return o.top!=null&&r.top!=null&&(this.top=u.B.number(r.top,o.top,c)),o.bottom!=null&&r.bottom!=null&&(this.bottom=u.B.number(r.bottom,o.bottom,c)),o.left!=null&&r.left!=null&&(this.left=u.B.number(r.left,o.left,c)),o.right!=null&&r.right!=null&&(this.right=u.B.number(r.right,o.right,c)),this}getCenter(r,o){const c=u.ad((this.left+r-this.right)/2,0,r),d=u.ad((this.top+o-this.bottom)/2,0,o);return new u.P(c,d)}equals(r){return this.top===r.top&&this.bottom===r.bottom&&this.left===r.left&&this.right===r.right}clone(){return new na(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}class nl{constructor(r,o,c,d,g){this.tileSize=512,this.maxValidLatitude=85.051129,this._renderWorldCopies=g===void 0||!!g,this._minZoom=r||0,this._maxZoom=o||22,this._minPitch=c??0,this._maxPitch=d??60,this.setMaxBounds(),this.width=0,this.height=0,this._center=new u.L(0,0),this._elevation=0,this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._unmodified=!0,this._edgeInsets=new na,this._posMatrixCache={},this._alignedPosMatrixCache={},this._minEleveationForCurrentTile=0}clone(){const r=new nl(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies);return r.apply(this),r}apply(r){this.tileSize=r.tileSize,this.latRange=r.latRange,this.width=r.width,this.height=r.height,this._center=r._center,this._elevation=r._elevation,this._minEleveationForCurrentTile=r._minEleveationForCurrentTile,this.zoom=r.zoom,this.angle=r.angle,this._fov=r._fov,this._pitch=r._pitch,this._unmodified=r._unmodified,this._edgeInsets=r._edgeInsets.clone(),this._calcMatrices()}get minZoom(){return this._minZoom}set minZoom(r){this._minZoom!==r&&(this._minZoom=r,this.zoom=Math.max(this.zoom,r))}get maxZoom(){return this._maxZoom}set maxZoom(r){this._maxZoom!==r&&(this._maxZoom=r,this.zoom=Math.min(this.zoom,r))}get minPitch(){return this._minPitch}set minPitch(r){this._minPitch!==r&&(this._minPitch=r,this.pitch=Math.max(this.pitch,r))}get maxPitch(){return this._maxPitch}set maxPitch(r){this._maxPitch!==r&&(this._maxPitch=r,this.pitch=Math.min(this.pitch,r))}get renderWorldCopies(){return this._renderWorldCopies}set renderWorldCopies(r){r===void 0?r=!0:r===null&&(r=!1),this._renderWorldCopies=r}get worldSize(){return this.tileSize*this.scale}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new u.P(this.width,this.height)}get bearing(){return-this.angle/Math.PI*180}set bearing(r){const o=-u.b5(r,-180,180)*Math.PI/180;this.angle!==o&&(this._unmodified=!1,this.angle=o,this._calcMatrices(),this.rotationMatrix=function(){var c=new u.A(4);return u.A!=Float32Array&&(c[1]=0,c[2]=0),c[0]=1,c[3]=1,c}(),function(c,d,g){var x=d[0],w=d[1],T=d[2],E=d[3],P=Math.sin(g),z=Math.cos(g);c[0]=x*z+T*P,c[1]=w*z+E*P,c[2]=x*-P+T*z,c[3]=w*-P+E*z}(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(r){const o=u.ad(r,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==o&&(this._unmodified=!1,this._pitch=o,this._calcMatrices())}get fov(){return this._fov/Math.PI*180}set fov(r){r=Math.max(.01,Math.min(60,r)),this._fov!==r&&(this._unmodified=!1,this._fov=r/180*Math.PI,this._calcMatrices())}get zoom(){return this._zoom}set zoom(r){const o=Math.min(Math.max(r,this.minZoom),this.maxZoom);this._zoom!==o&&(this._unmodified=!1,this._zoom=o,this.tileZoom=Math.max(0,Math.floor(o)),this.scale=this.zoomScale(o),this._constrain(),this._calcMatrices())}get center(){return this._center}set center(r){r.lat===this._center.lat&&r.lng===this._center.lng||(this._unmodified=!1,this._center=r,this._constrain(),this._calcMatrices())}get elevation(){return this._elevation}set elevation(r){r!==this._elevation&&(this._elevation=r,this._constrain(),this._calcMatrices())}get padding(){return this._edgeInsets.toJSON()}set padding(r){this._edgeInsets.equals(r)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,r,1),this._calcMatrices())}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}isPaddingEqual(r){return this._edgeInsets.equals(r)}interpolatePadding(r,o,c){this._unmodified=!1,this._edgeInsets.interpolate(r,o,c),this._constrain(),this._calcMatrices()}coveringZoomLevel(r){const o=(r.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/r.tileSize));return Math.max(0,o)}getVisibleUnwrappedCoordinates(r){const o=[new u.b6(0,r)];if(this._renderWorldCopies){const c=this.pointCoordinate(new u.P(0,0)),d=this.pointCoordinate(new u.P(this.width,0)),g=this.pointCoordinate(new u.P(this.width,this.height)),x=this.pointCoordinate(new u.P(0,this.height)),w=Math.floor(Math.min(c.x,d.x,g.x,x.x)),T=Math.floor(Math.max(c.x,d.x,g.x,x.x)),E=1;for(let P=w-E;P<=T+E;P++)P!==0&&o.push(new u.b6(P,r))}return o}coveringTiles(r){var o,c;let d=this.coveringZoomLevel(r);const g=d;if(r.minzoom!==void 0&&d<r.minzoom)return[];r.maxzoom!==void 0&&d>r.maxzoom&&(d=r.maxzoom);const x=this.pointCoordinate(this.getCameraPoint()),w=u.U.fromLngLat(this.center),T=Math.pow(2,d),E=[T*x.x,T*x.y,0],P=[T*w.x,T*w.y,0],z=fn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,d);let F=r.minzoom||0;!r.terrain&&this.pitch<=60&&this._edgeInsets.top<.1&&(F=d);const q=r.terrain?2/Math.min(this.tileSize,r.tileSize)*this.tileSize:3,$=Y=>({aabb:new ho([Y*T,0,0],[(Y+1)*T,T,0]),zoom:0,x:0,y:0,wrap:Y,fullyVisible:!1}),G=[],U=[],oe=d,pe=r.reparseOverscaled?g:d;if(this._renderWorldCopies)for(let Y=1;Y<=3;Y++)G.push($(-Y)),G.push($(Y));for(G.push($(0));G.length>0;){const Y=G.pop(),ae=Y.x,me=Y.y;let ge=Y.fullyVisible;if(!ge){const Ke=Y.aabb.intersects(z);if(Ke===0)continue;ge=Ke===2}const Te=r.terrain?E:P,ze=Y.aabb.distanceX(Te),Ce=Y.aabb.distanceY(Te),Ae=Math.max(Math.abs(ze),Math.abs(Ce));if(Y.zoom===oe||Ae>q+(1<<oe-Y.zoom)-2&&Y.zoom>=F){const Ke=oe-Y.zoom,_t=E[0]-.5-(ae<<Ke),Ne=E[1]-.5-(me<<Ke);U.push({tileID:new u.O(Y.zoom===oe?pe:Y.zoom,Y.wrap,Y.zoom,ae,me),distanceSq:je([P[0]-.5-ae,P[1]-.5-me]),tileDistanceToCamera:Math.sqrt(_t*_t+Ne*Ne)})}else for(let Ke=0;Ke<4;Ke++){const _t=(ae<<1)+Ke%2,Ne=(me<<1)+(Ke>>1),at=Y.zoom+1;let Qe=Y.aabb.quadrant(Ke);if(r.terrain){const Rt=new u.O(at,Y.wrap,at,_t,Ne),yt=r.terrain.getMinMaxElevation(Rt),pt=(o=yt.minElevation)!==null&&o!==void 0?o:this.elevation,vt=(c=yt.maxElevation)!==null&&c!==void 0?c:this.elevation;Qe=new ho([Qe.min[0],Qe.min[1],pt],[Qe.max[0],Qe.max[1],vt])}G.push({aabb:Qe,zoom:at,x:_t,y:Ne,wrap:Y.wrap,fullyVisible:ge})}}return U.sort((Y,ae)=>Y.distanceSq-ae.distanceSq).map(Y=>Y.tileID)}resize(r,o){this.width=r,this.height=o,this.pixelsToGLUnits=[2/r,-2/o],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(r){return Math.pow(2,r)}scaleZoom(r){return Math.log(r)/Math.LN2}project(r){const o=u.ad(r.lat,-this.maxValidLatitude,this.maxValidLatitude);return new u.P(u.G(r.lng)*this.worldSize,u.H(o)*this.worldSize)}unproject(r){return new u.U(r.x/this.worldSize,r.y/this.worldSize).toLngLat()}get point(){return this.project(this.center)}getCameraPosition(){return{lngLat:this.pointLocation(this.getCameraPoint()),altitude:Math.cos(this._pitch)*this.cameraToCenterDistance/this._pixelPerMeter+this.elevation}}recalculateZoom(r){const o=this.pointLocation(this.centerPoint,r),c=r.getElevationForLngLatZoom(o,this.tileZoom);if(!(this.elevation-c))return;const d=this.getCameraPosition(),g=u.U.fromLngLat(d.lngLat,d.altitude),x=u.U.fromLngLat(o,c),w=g.x-x.x,T=g.y-x.y,E=g.z-x.z,P=Math.sqrt(w*w+T*T+E*E),z=this.scaleZoom(this.cameraToCenterDistance/P/this.tileSize);this._elevation=c,this._center=o,this.zoom=z}setLocationAtPoint(r,o){const c=this.pointCoordinate(o),d=this.pointCoordinate(this.centerPoint),g=this.locationCoordinate(r),x=new u.U(g.x-(c.x-d.x),g.y-(c.y-d.y));this.center=this.coordinateLocation(x),this._renderWorldCopies&&(this.center=this.center.wrap())}locationPoint(r,o){return o?this.coordinatePoint(this.locationCoordinate(r),o.getElevationForLngLatZoom(r,this.tileZoom),this.pixelMatrix3D):this.coordinatePoint(this.locationCoordinate(r))}pointLocation(r,o){return this.coordinateLocation(this.pointCoordinate(r,o))}locationCoordinate(r){return u.U.fromLngLat(r)}coordinateLocation(r){return r&&r.toLngLat()}pointCoordinate(r,o){if(o){const F=o.pointCoordinate(r);if(F!=null)return F}const c=[r.x,r.y,0,1],d=[r.x,r.y,1,1];u.ag(c,c,this.pixelMatrixInverse),u.ag(d,d,this.pixelMatrixInverse);const g=c[3],x=d[3],w=c[1]/g,T=d[1]/x,E=c[2]/g,P=d[2]/x,z=E===P?0:(0-E)/(P-E);return new u.U(u.B.number(c[0]/g,d[0]/x,z)/this.worldSize,u.B.number(w,T,z)/this.worldSize)}coordinatePoint(r,o=0,c=this.pixelMatrix){const d=[r.x*this.worldSize,r.y*this.worldSize,o,1];return u.ag(d,d,c),new u.P(d[0]/d[3],d[1]/d[3])}getBounds(){const r=Math.max(0,this.height/2-this.getHorizon());return new At().extend(this.pointLocation(new u.P(0,r))).extend(this.pointLocation(new u.P(this.width,r))).extend(this.pointLocation(new u.P(this.width,this.height))).extend(this.pointLocation(new u.P(0,this.height)))}getMaxBounds(){return this.latRange&&this.latRange.length===2&&this.lngRange&&this.lngRange.length===2?new At([this.lngRange[0],this.latRange[0]],[this.lngRange[1],this.latRange[1]]):null}getHorizon(){return Math.tan(Math.PI/2-this._pitch)*this.cameraToCenterDistance*.85}setMaxBounds(r){r?(this.lngRange=[r.getWest(),r.getEast()],this.latRange=[r.getSouth(),r.getNorth()],this._constrain()):(this.lngRange=null,this.latRange=[-this.maxValidLatitude,this.maxValidLatitude])}calculatePosMatrix(r,o=!1){const c=r.key,d=o?this._alignedPosMatrixCache:this._posMatrixCache;if(d[c])return d[c];const g=r.canonical,x=this.worldSize/this.zoomScale(g.z),w=g.x+Math.pow(2,g.z)*r.wrap,T=u.ao(new Float64Array(16));return u.$(T,T,[w*x,g.y*x,0]),u.a0(T,T,[x/u.N,x/u.N,1]),u.a1(T,o?this.alignedProjMatrix:this.projMatrix,T),d[c]=new Float32Array(T),d[c]}customLayerMatrix(){return this.mercatorMatrix.slice()}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;let r,o,c,d,g=-90,x=90,w=-180,T=180;const E=this.size,P=this._unmodified;if(this.latRange){const q=this.latRange;g=u.H(q[1])*this.worldSize,x=u.H(q[0])*this.worldSize,r=x-g<E.y?E.y/(x-g):0}if(this.lngRange){const q=this.lngRange;w=u.b5(u.G(q[0])*this.worldSize,0,this.worldSize),T=u.b5(u.G(q[1])*this.worldSize,0,this.worldSize),T<w&&(T+=this.worldSize),o=T-w<E.x?E.x/(T-w):0}const z=this.point,F=Math.max(o||0,r||0);if(F)return this.center=this.unproject(new u.P(o?(T+w)/2:z.x,r?(x+g)/2:z.y)),this.zoom+=this.scaleZoom(F),this._unmodified=P,void(this._constraining=!1);if(this.latRange){const q=z.y,$=E.y/2;q-$<g&&(d=g+$),q+$>x&&(d=x-$)}if(this.lngRange){const q=(w+T)/2,$=u.b5(z.x,q-this.worldSize/2,q+this.worldSize/2),G=E.x/2;$-G<w&&(c=w+G),$+G>T&&(c=T-G)}c===void 0&&d===void 0||(this.center=this.unproject(new u.P(c!==void 0?c:z.x,d!==void 0?d:z.y)).wrap()),this._unmodified=P,this._constraining=!1}_calcMatrices(){if(!this.height)return;const r=this.centerOffset,o=this.point.x,c=this.point.y;this.cameraToCenterDistance=.5/Math.tan(this._fov/2)*this.height,this._pixelPerMeter=u.b7(1,this.center.lat)*this.worldSize;let d=u.ao(new Float64Array(16));u.a0(d,d,[this.width/2,-this.height/2,1]),u.$(d,d,[1,-1,0]),this.labelPlaneMatrix=d,d=u.ao(new Float64Array(16)),u.a0(d,d,[1,-1,1]),u.$(d,d,[-1,-1,0]),u.a0(d,d,[2/this.width,2/this.height,1]),this.glCoordMatrix=d;const g=this.cameraToCenterDistance+this._elevation*this._pixelPerMeter/Math.cos(this._pitch),x=Math.min(this.elevation,this._minEleveationForCurrentTile),w=g-x*this._pixelPerMeter/Math.cos(this._pitch),T=x<0?w:g,E=Math.PI/2+this._pitch,P=this._fov*(.5+r.y/this.height),z=Math.sin(P)*T/Math.sin(u.ad(Math.PI-E-P,.01,Math.PI-.01)),F=this.getHorizon(),q=2*Math.atan(F/this.cameraToCenterDistance)*(.5+r.y/(2*F)),$=Math.sin(q)*T/Math.sin(u.ad(Math.PI-E-q,.01,Math.PI-.01)),G=Math.min(z,$),U=1.01*(Math.cos(Math.PI/2-this._pitch)*G+T),oe=this.height/50;d=new Float64Array(16),u.b8(d,this._fov,this.width/this.height,oe,U),d[8]=2*-r.x/this.width,d[9]=2*r.y/this.height,u.a0(d,d,[1,-1,1]),u.$(d,d,[0,0,-this.cameraToCenterDistance]),u.b9(d,d,this._pitch),u.ae(d,d,this.angle),u.$(d,d,[-o,-c,0]),this.mercatorMatrix=u.a0([],d,[this.worldSize,this.worldSize,this.worldSize]),u.a0(d,d,[1,1,this._pixelPerMeter]),this.pixelMatrix=u.a1(new Float64Array(16),this.labelPlaneMatrix,d),u.$(d,d,[0,0,-this.elevation]),this.projMatrix=d,this.invProjMatrix=u.as([],d),this.pixelMatrix3D=u.a1(new Float64Array(16),this.labelPlaneMatrix,d);const pe=this.width%2/2,Y=this.height%2/2,ae=Math.cos(this.angle),me=Math.sin(this.angle),ge=o-Math.round(o)+ae*pe+me*Y,Te=c-Math.round(c)+ae*Y+me*pe,ze=new Float64Array(d);if(u.$(ze,ze,[ge>.5?ge-1:ge,Te>.5?Te-1:Te,0]),this.alignedProjMatrix=ze,d=u.as(new Float64Array(16),this.pixelMatrix),!d)throw new Error("failed to invert matrix");this.pixelMatrixInverse=d,this._posMatrixCache={},this._alignedPosMatrixCache={}}maxPitchScaleFactor(){if(!this.pixelMatrixInverse)return 1;const r=this.pointCoordinate(new u.P(0,0)),o=[r.x*this.worldSize,r.y*this.worldSize,0,1];return u.ag(o,o,this.pixelMatrix)[3]/this.cameraToCenterDistance}getCameraPoint(){const r=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new u.P(0,r))}getCameraQueryGeometry(r){const o=this.getCameraPoint();if(r.length===1)return[r[0],o];{let c=o.x,d=o.y,g=o.x,x=o.y;for(const w of r)c=Math.min(c,w.x),d=Math.min(d,w.y),g=Math.max(g,w.x),x=Math.max(x,w.y);return[new u.P(c,d),new u.P(g,d),new u.P(g,x),new u.P(c,x),new u.P(c,d)]}}}function As(f,r){let o,c=!1,d=null,g=null;const x=()=>{d=null,c&&(f.apply(g,o),d=setTimeout(x,r),c=!1)};return(...w)=>(c=!0,g=this,o=w,d||x(),d)}class ia{constructor(r){this._getCurrentHash=()=>{const o=window.location.hash.replace("#","");if(this._hashName){let c;return o.split("&").map(d=>d.split("=")).forEach(d=>{d[0]===this._hashName&&(c=d)}),(c&&c[1]||"").split("/")}return o.split("/")},this._onHashChange=()=>{const o=this._getCurrentHash();if(o.length>=3&&!o.some(c=>isNaN(c))){const c=this._map.dragRotate.isEnabled()&&this._map.touchZoomRotate.isEnabled()?+(o[3]||0):this._map.getBearing();return this._map.jumpTo({center:[+o[2],+o[1]],zoom:+o[0],bearing:c,pitch:+(o[4]||0)}),!0}return!1},this._updateHashUnthrottled=()=>{const o=window.location.href.replace(/(#.+)?$/,this.getHashString());try{window.history.replaceState(window.history.state,null,o)}catch{}},this._updateHash=As(this._updateHashUnthrottled,300),this._hashName=r&&encodeURIComponent(r)}addTo(r){return this._map=r,addEventListener("hashchange",this._onHashChange,!1),this._map.on("moveend",this._updateHash),this}remove(){return removeEventListener("hashchange",this._onHashChange,!1),this._map.off("moveend",this._updateHash),clearTimeout(this._updateHash()),delete this._map,this}getHashString(r){const o=this._map.getCenter(),c=Math.round(100*this._map.getZoom())/100,d=Math.ceil((c*Math.LN2+Math.log(512/360/.5))/Math.LN10),g=Math.pow(10,d),x=Math.round(o.lng*g)/g,w=Math.round(o.lat*g)/g,T=this._map.getBearing(),E=this._map.getPitch();let P="";if(P+=r?`/${x}/${w}/${c}`:`${c}/${w}/${x}`,(T||E)&&(P+="/"+Math.round(10*T)/10),E&&(P+=`/${Math.round(E)}`),this._hashName){const z=this._hashName;let F=!1;const q=window.location.hash.slice(1).split("&").map($=>{const G=$.split("=")[0];return G===z?(F=!0,`${G}=${P}`):$}).filter($=>$);return F||q.push(`${z}=${P}`),`#${q.join("&")}`}return`#${P}`}}const po={linearity:.3,easing:u.ba(0,0,.3,1)},mh=u.e({deceleration:2500,maxSpeed:1400},po),gh=u.e({deceleration:20,maxSpeed:1400},po),yh=u.e({deceleration:1e3,maxSpeed:360},po),_h=u.e({deceleration:1e3,maxSpeed:90},po);class vh{constructor(r){this._map=r,this.clear()}clear(){this._inertiaBuffer=[]}record(r){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:u.h.now(),settings:r})}_drainInertiaBuffer(){const r=this._inertiaBuffer,o=u.h.now();for(;r.length>0&&o-r[0].time>160;)r.shift()}_onMoveEnd(r){if(this._drainInertiaBuffer(),this._inertiaBuffer.length<2)return;const o={zoom:0,bearing:0,pitch:0,pan:new u.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:g}of this._inertiaBuffer)o.zoom+=g.zoomDelta||0,o.bearing+=g.bearingDelta||0,o.pitch+=g.pitchDelta||0,g.panDelta&&o.pan._add(g.panDelta),g.around&&(o.around=g.around),g.pinchAround&&(o.pinchAround=g.pinchAround);const c=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,d={};if(o.pan.mag()){const g=sa(o.pan.mag(),c,u.e({},mh,r||{}));d.offset=o.pan.mult(g.amount/o.pan.mag()),d.center=this._map.transform.center,wi(d,g)}if(o.zoom){const g=sa(o.zoom,c,gh);d.zoom=this._map.transform.zoom+g.amount,wi(d,g)}if(o.bearing){const g=sa(o.bearing,c,yh);d.bearing=this._map.transform.bearing+u.ad(g.amount,-179,179),wi(d,g)}if(o.pitch){const g=sa(o.pitch,c,_h);d.pitch=this._map.transform.pitch+g.amount,wi(d,g)}if(d.zoom||d.bearing){const g=o.pinchAround===void 0?o.around:o.pinchAround;d.around=g?this._map.unproject(g):this._map.getCenter()}return this.clear(),u.e(d,{noMoveStart:!0})}}function wi(f,r){(!f.duration||f.duration<r.duration)&&(f.duration=r.duration,f.easing=r.easing)}function sa(f,r,o){const{maxSpeed:c,linearity:d,deceleration:g}=o,x=u.ad(f*d/(r/1e3),-c,c),w=Math.abs(x)/(g*d);return{easing:o.easing,duration:1e3*w,amount:x*(w/2)}}class zn extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,o,c,d={}){const g=D.mousePos(o.getCanvasContainer(),c),x=o.unproject(g);super(r,u.e({point:g,lngLat:x,originalEvent:c},d)),this._defaultPrevented=!1,this.target=o}}class oa extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,o,c){const d=r==="touchend"?c.changedTouches:c.touches,g=D.touchPos(o.getCanvasContainer(),d),x=g.map(T=>o.unproject(T)),w=g.reduce((T,E,P,z)=>T.add(E.div(z.length)),new u.P(0,0));super(r,{points:g,point:w,lngLats:x,lngLat:o.unproject(w),originalEvent:c}),this._defaultPrevented=!1}}class xh extends u.k{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(r,o,c){super(r,{originalEvent:c}),this._defaultPrevented=!1}}class wh{constructor(r,o){this._map=r,this._clickTolerance=o.clickTolerance}reset(){delete this._mousedownPos}wheel(r){return this._firePreventable(new xh(r.type,this._map,r))}mousedown(r,o){return this._mousedownPos=o,this._firePreventable(new zn(r.type,this._map,r))}mouseup(r){this._map.fire(new zn(r.type,this._map,r))}click(r,o){this._mousedownPos&&this._mousedownPos.dist(o)>=this._clickTolerance||this._map.fire(new zn(r.type,this._map,r))}dblclick(r){return this._firePreventable(new zn(r.type,this._map,r))}mouseover(r){this._map.fire(new zn(r.type,this._map,r))}mouseout(r){this._map.fire(new zn(r.type,this._map,r))}touchstart(r){return this._firePreventable(new oa(r.type,this._map,r))}touchmove(r){this._map.fire(new oa(r.type,this._map,r))}touchend(r){this._map.fire(new oa(r.type,this._map,r))}touchcancel(r){this._map.fire(new oa(r.type,this._map,r))}_firePreventable(r){if(this._map.fire(r),r.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class bh{constructor(r){this._map=r}reset(){this._delayContextMenu=!1,this._ignoreContextMenu=!0,delete this._contextMenuEvent}mousemove(r){this._map.fire(new zn(r.type,this._map,r))}mousedown(){this._delayContextMenu=!0,this._ignoreContextMenu=!1}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new zn("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(r){this._delayContextMenu?this._contextMenuEvent=r:this._ignoreContextMenu||this._map.fire(new zn(r.type,this._map,r)),this._map.listens("contextmenu")&&r.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Ni{constructor(r){this._map=r}get transform(){return this._map._requestedCameraState||this._map.transform}get center(){return{lng:this.transform.center.lng,lat:this.transform.center.lat}}get zoom(){return this.transform.zoom}get pitch(){return this.transform.pitch}get bearing(){return this.transform.bearing}unproject(r){return this.transform.pointLocation(u.P.convert(r),this._map.terrain)}}class Sh{constructor(r,o){this._map=r,this._tr=new Ni(r),this._el=r.getCanvasContainer(),this._container=r.getContainer(),this._clickTolerance=o.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(r,o){this.isEnabled()&&r.shiftKey&&r.button===0&&(D.disableDrag(),this._startPos=this._lastPos=o,this._active=!0)}mousemoveWindow(r,o){if(!this._active)return;const c=o;if(this._lastPos.equals(c)||!this._box&&c.dist(this._startPos)<this._clickTolerance)return;const d=this._startPos;this._lastPos=c,this._box||(this._box=D.create("div","maplibregl-boxzoom",this._container),this._container.classList.add("maplibregl-crosshair"),this._fireEvent("boxzoomstart",r));const g=Math.min(d.x,c.x),x=Math.max(d.x,c.x),w=Math.min(d.y,c.y),T=Math.max(d.y,c.y);D.setTransform(this._box,`translate(${g}px,${w}px)`),this._box.style.width=x-g+"px",this._box.style.height=T-w+"px"}mouseupWindow(r,o){if(!this._active||r.button!==0)return;const c=this._startPos,d=o;if(this.reset(),D.suppressClick(),c.x!==d.x||c.y!==d.y)return this._map.fire(new u.k("boxzoomend",{originalEvent:r})),{cameraAnimation:g=>g.fitScreenCoordinates(c,d,this._tr.bearing,{linear:!0})};this._fireEvent("boxzoomcancel",r)}keydown(r){this._active&&r.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",r))}reset(){this._active=!1,this._container.classList.remove("maplibregl-crosshair"),this._box&&(D.remove(this._box),this._box=null),D.enableDrag(),delete this._startPos,delete this._lastPos}_fireEvent(r,o){return this._map.fire(new u.k(r,{originalEvent:o}))}}function Wn(f,r){if(f.length!==r.length)throw new Error(`The number of touches and points are not equal - touches ${f.length}, points ${r.length}`);const o={};for(let c=0;c<f.length;c++)o[f[c].identifier]=r[c];return o}class Vi{constructor(r){this.reset(),this.numTouches=r.numTouches}reset(){delete this.centroid,delete this.startTime,delete this.touches,this.aborted=!1}touchstart(r,o,c){(this.centroid||c.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===void 0&&(this.startTime=r.timeStamp),c.length===this.numTouches&&(this.centroid=function(d){const g=new u.P(0,0);for(const x of d)g._add(x);return g.div(d.length)}(o),this.touches=Wn(c,o)))}touchmove(r,o,c){if(this.aborted||!this.centroid)return;const d=Wn(c,o);for(const g in this.touches){const x=d[g];(!x||x.dist(this.touches[g])>30)&&(this.aborted=!0)}}touchend(r,o,c){if((!this.centroid||r.timeStamp-this.startTime>500)&&(this.aborted=!0),c.length===0){const d=!this.aborted&&this.centroid;if(this.reset(),d)return d}}}class il{constructor(r){this.singleTap=new Vi(r),this.numTaps=r.numTaps,this.reset()}reset(){this.lastTime=1/0,delete this.lastTap,this.count=0,this.singleTap.reset()}touchstart(r,o,c){this.singleTap.touchstart(r,o,c)}touchmove(r,o,c){this.singleTap.touchmove(r,o,c)}touchend(r,o,c){const d=this.singleTap.touchend(r,o,c);if(d){const g=r.timeStamp-this.lastTime<500,x=!this.lastTap||this.lastTap.dist(d)<30;if(g&&x||this.reset(),this.count++,this.lastTime=r.timeStamp,this.lastTap=d,this.count===this.numTaps)return this.reset(),d}}}class Ui{constructor(r){this._tr=new Ni(r),this._zoomIn=new il({numTouches:1,numTaps:2}),this._zoomOut=new il({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(r,o,c){this._zoomIn.touchstart(r,o,c),this._zoomOut.touchstart(r,o,c)}touchmove(r,o,c){this._zoomIn.touchmove(r,o,c),this._zoomOut.touchmove(r,o,c)}touchend(r,o,c){const d=this._zoomIn.touchend(r,o,c),g=this._zoomOut.touchend(r,o,c),x=this._tr;return d?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:x.zoom+1,around:x.unproject(d)},{originalEvent:r})}):g?(this._active=!0,r.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:w=>w.easeTo({duration:300,zoom:x.zoom-1,around:x.unproject(g)},{originalEvent:r})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ji{constructor(r){this._enabled=!!r.enable,this._moveStateManager=r.moveStateManager,this._clickTolerance=r.clickTolerance||1,this._moveFunction=r.move,this._activateOnStart=!!r.activateOnStart,r.assignEvents(this),this.reset()}reset(r){this._active=!1,this._moved=!1,delete this._lastPoint,this._moveStateManager.endMove(r)}_move(...r){const o=this._moveFunction(...r);if(o.bearingDelta||o.pitchDelta||o.around||o.panDelta)return this._active=!0,o}dragStart(r,o){this.isEnabled()&&!this._lastPoint&&this._moveStateManager.isValidStartEvent(r)&&(this._moveStateManager.startMove(r),this._lastPoint=o.length?o[0]:o,this._activateOnStart&&this._lastPoint&&(this._active=!0))}dragMove(r,o){if(!this.isEnabled())return;const c=this._lastPoint;if(!c)return;if(r.preventDefault(),!this._moveStateManager.isValidMoveEvent(r))return void this.reset(r);const d=o.length?o[0]:o;return!this._moved&&d.dist(c)<this._clickTolerance?void 0:(this._moved=!0,this._lastPoint=d,this._move(c,d))}dragEnd(r){this.isEnabled()&&this._lastPoint&&this._moveStateManager.isValidEndEvent(r)&&(this._moved&&D.suppressClick(),this.reset(r))}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}getClickTolerance(){return this._clickTolerance}}const Xp={0:1,2:2};class vu{constructor(r){this._correctEvent=r.checkCorrectEvent}startMove(r){const o=D.mouseButton(r);this._eventButton=o}endMove(r){delete this._eventButton}isValidStartEvent(r){return this._correctEvent(r)}isValidMoveEvent(r){return!function(o,c){const d=Xp[c];return o.buttons===void 0||(o.buttons&d)!==d}(r,this._eventButton)}isValidEndEvent(r){return D.mouseButton(r)===this._eventButton}}class Th{constructor(){this._firstTouch=void 0}_isOneFingerTouch(r){return r.targetTouches.length===1}_isSameTouchEvent(r){return r.targetTouches[0].identifier===this._firstTouch}startMove(r){this._firstTouch=r.targetTouches[0].identifier}endMove(r){delete this._firstTouch}isValidStartEvent(r){return this._isOneFingerTouch(r)}isValidMoveEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}isValidEndEvent(r){return this._isOneFingerTouch(r)&&this._isSameTouchEvent(r)}}const sl=f=>{f.mousedown=f.dragStart,f.mousemoveWindow=f.dragMove,f.mouseup=f.dragEnd,f.contextmenu=function(r){r.preventDefault()}},fo=({enable:f,clickTolerance:r,bearingDegreesPerPixelMoved:o=.8})=>{const c=new vu({checkCorrectEvent:d=>D.mouseButton(d)===0&&d.ctrlKey||D.mouseButton(d)===2});return new ji({clickTolerance:r,move:(d,g)=>({bearingDelta:(g.x-d.x)*o}),moveStateManager:c,enable:f,assignEvents:sl})},$i=({enable:f,clickTolerance:r,pitchDegreesPerPixelMoved:o=-.5})=>{const c=new vu({checkCorrectEvent:d=>D.mouseButton(d)===0&&d.ctrlKey||D.mouseButton(d)===2});return new ji({clickTolerance:r,move:(d,g)=>({pitchDelta:(g.y-d.y)*o}),moveStateManager:c,enable:f,assignEvents:sl})};class Ge{constructor(r,o){this._minTouches=r.cooperativeGestures?2:1,this._clickTolerance=r.clickTolerance||1,this._map=o,this.reset()}reset(){this._active=!1,this._touches={},this._sum=new u.P(0,0),setTimeout(()=>{this._cancelCooperativeMessage=!1},200)}touchstart(r,o,c){return this._calculateTransform(r,o,c)}touchmove(r,o,c){if(this._map._cooperativeGestures&&(this._minTouches===2&&c.length<2&&!this._cancelCooperativeMessage?this._map._onCooperativeGesture(r,!1,c.length):this._cancelCooperativeMessage||(this._cancelCooperativeMessage=!0)),this._active&&!(c.length<this._minTouches))return r.preventDefault(),this._calculateTransform(r,o,c)}touchend(r,o,c){this._calculateTransform(r,o,c),this._active&&c.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(r,o,c){c.length>0&&(this._active=!0);const d=Wn(c,o),g=new u.P(0,0),x=new u.P(0,0);let w=0;for(const E in d){const P=d[E],z=this._touches[E];z&&(g._add(P),x._add(P.sub(z)),w++,d[E]=P)}if(this._touches=d,w<this._minTouches||!x.mag())return;const T=x.div(w);return this._sum._add(T),this._sum.mag()<this._clickTolerance?void 0:{around:g.div(w),panDelta:T}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ol{constructor(){this.reset()}reset(){this._active=!1,delete this._firstTwoTouches}touchstart(r,o,c){this._firstTwoTouches||c.length<2||(this._firstTwoTouches=[c[0].identifier,c[1].identifier],this._start([o[0],o[1]]))}touchmove(r,o,c){if(!this._firstTwoTouches)return;r.preventDefault();const[d,g]=this._firstTwoTouches,x=ps(c,o,d),w=ps(c,o,g);if(!x||!w)return;const T=this._aroundCenter?null:x.add(w).div(2);return this._move([x,w],T,r)}touchend(r,o,c){if(!this._firstTwoTouches)return;const[d,g]=this._firstTwoTouches,x=ps(c,o,d),w=ps(c,o,g);x&&w||(this._active&&D.suppressClick(),this.reset())}touchcancel(){this.reset()}enable(r){this._enabled=!0,this._aroundCenter=!!r&&r.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ps(f,r,o){for(let c=0;c<f.length;c++)if(f[c].identifier===o)return r[c]}function mo(f,r){return Math.log(f/r)/Math.LN2}class kh extends ol{reset(){super.reset(),delete this._distance,delete this._startDistance}_start(r){this._startDistance=this._distance=r[0].dist(r[1])}_move(r,o){const c=this._distance;if(this._distance=r[0].dist(r[1]),this._active||!(Math.abs(mo(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:mo(this._distance,c),pinchAround:o}}}function $e(f,r){return 180*f.angleWith(r)/Math.PI}class xu extends ol{reset(){super.reset(),delete this._minDiameter,delete this._startVector,delete this._vector}_start(r){this._startVector=this._vector=r[0].sub(r[1]),this._minDiameter=r[0].dist(r[1])}_move(r,o){const c=this._vector;if(this._vector=r[0].sub(r[1]),this._active||!this._isBelowThreshold(this._vector))return this._active=!0,{bearingDelta:$e(this._vector,c),pinchAround:o}}_isBelowThreshold(r){this._minDiameter=Math.min(this._minDiameter,r.mag());const o=25/(Math.PI*this._minDiameter)*360,c=$e(r,this._startVector);return Math.abs(c)<o}}function wu(f){return Math.abs(f.y)>Math.abs(f.x)}class Kp extends ol{constructor(r){super(),this._map=r}reset(){super.reset(),this._valid=void 0,delete this._firstMove,delete this._lastPoints}touchstart(r,o,c){super.touchstart(r,o,c),this._currentTouchCount=c.length}_start(r){this._lastPoints=r,wu(r[0].sub(r[1]))&&(this._valid=!1)}_move(r,o,c){if(this._map._cooperativeGestures&&this._currentTouchCount<3)return;const d=r[0].sub(this._lastPoints[0]),g=r[1].sub(this._lastPoints[1]);return this._valid=this.gestureBeginsVertically(d,g,c.timeStamp),this._valid?(this._lastPoints=r,this._active=!0,{pitchDelta:(d.y+g.y)/2*-.5}):void 0}gestureBeginsVertically(r,o,c){if(this._valid!==void 0)return this._valid;const d=r.mag()>=2,g=o.mag()>=2;if(!d&&!g)return;if(!d||!g)return this._firstMove===void 0&&(this._firstMove=c),c-this._firstMove<100&&void 0;const x=r.y>0==o.y>0;return wu(r)&&wu(o)&&x}}const bu={panStep:100,bearingStep:15,pitchStep:10};class Eh{constructor(r){this._tr=new Ni(r);const o=bu;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}reset(){this._active=!1}keydown(r){if(r.altKey||r.ctrlKey||r.metaKey)return;let o=0,c=0,d=0,g=0,x=0;switch(r.keyCode){case 61:case 107:case 171:case 187:o=1;break;case 189:case 109:case 173:o=-1;break;case 37:r.shiftKey?c=-1:(r.preventDefault(),g=-1);break;case 39:r.shiftKey?c=1:(r.preventDefault(),g=1);break;case 38:r.shiftKey?d=1:(r.preventDefault(),x=-1);break;case 40:r.shiftKey?d=-1:(r.preventDefault(),x=1);break;default:return}return this._rotationDisabled&&(c=0,d=0),{cameraAnimation:w=>{const T=this._tr;w.easeTo({duration:300,easeId:"keyboardHandler",easing:Ih,zoom:o?Math.round(T.zoom)+o*(r.shiftKey?2:1):T.zoom,bearing:T.bearing+c*this._bearingStep,pitch:T.pitch+d*this._pitchStep,offset:[-g*this._panStep,-x*this._panStep],center:T.center},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function Ih(f){return f*(2-f)}const Ch=4.000244140625;class Yp{constructor(r,o){this._onTimeout=c=>{this._type="wheel",this._delta-=this._lastValue,this._active||this._start(c)},this._map=r,this._tr=new Ni(r),this._el=r.getCanvasContainer(),this._triggerRenderFrame=o,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222}setZoomRate(r){this._defaultZoomRate=r}setWheelZoomRate(r){this._wheelZoomRate=r}isEnabled(){return!!this._enabled}isActive(){return!!this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(r){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!r&&r.around==="center")}disable(){this.isEnabled()&&(this._enabled=!1)}wheel(r){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!r[this._map._metaKey])return;r.preventDefault()}let o=r.deltaMode===WheelEvent.DOM_DELTA_LINE?40*r.deltaY:r.deltaY;const c=u.h.now(),d=c-(this._lastWheelEventTime||0);this._lastWheelEventTime=c,o!==0&&o%Ch==0?this._type="wheel":o!==0&&Math.abs(o)<4?this._type="trackpad":d>400?(this._type=null,this._lastValue=o,this._timeout=setTimeout(this._onTimeout,40,r)):this._type||(this._type=Math.abs(d*o)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,o+=this._lastValue)),r.shiftKey&&o&&(o/=4),this._type&&(this._lastWheelEvent=r,this._delta-=o,this._active||this._start(r)),r.preventDefault()}_start(r){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const o=D.mousePos(this._el,r),c=this._tr;this._around=u.L.convert(this._aroundCenter?c.center:c.unproject(o)),this._aroundPoint=c.transform.locationPoint(this._around),this._frameId||(this._frameId=!0,this._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const r=this._tr.transform;if(this._delta!==0){const w=this._type==="wheel"&&Math.abs(this._delta)>Ch?this._wheelZoomRate:this._defaultZoomRate;let T=2/(1+Math.exp(-Math.abs(this._delta*w)));this._delta<0&&T!==0&&(T=1/T);const E=typeof this._targetZoom=="number"?r.zoomScale(this._targetZoom):r.scale;this._targetZoom=Math.min(r.maxZoom,Math.max(r.minZoom,r.scaleZoom(E*T))),this._type==="wheel"&&(this._startZoom=r.zoom,this._easing=this._smoothOutEasing(200)),this._delta=0}const o=typeof this._targetZoom=="number"?this._targetZoom:r.zoom,c=this._startZoom,d=this._easing;let g,x=!1;if(this._type==="wheel"&&c&&d){const w=Math.min((u.h.now()-this._lastWheelEventTime)/200,1),T=d(w);g=u.B.number(c,o,T),w<1?this._frameId||(this._frameId=!0):x=!0}else g=o,x=!0;return this._active=!0,x&&(this._active=!1,this._finishTimeout=setTimeout(()=>{this._zooming=!1,this._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200)),{noInertia:!0,needsRenderFrame:!x,zoomDelta:g-r.zoom,around:this._aroundPoint,originalEvent:this._lastWheelEvent}}_smoothOutEasing(r){let o=u.bb;if(this._prevEase){const c=this._prevEase,d=(u.h.now()-c.start)/c.duration,g=c.easing(d+.01)-c.easing(d),x=.27/Math.sqrt(g*g+1e-4)*.01,w=Math.sqrt(.0729-x*x);o=u.ba(x,w,.25,1)}return this._prevEase={start:u.h.now(),duration:r,easing:o},o}reset(){this._active=!1,this._zooming=!1,delete this._targetZoom,this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout)}}class Su{constructor(r,o){this._clickZoom=r,this._tapZoom=o}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Tu{constructor(r){this._tr=new Ni(r),this.reset()}reset(){this._active=!1}dblclick(r,o){return r.preventDefault(),{cameraAnimation:c=>{c.easeTo({duration:300,zoom:this._tr.zoom+(r.shiftKey?-1:1),around:this._tr.unproject(o)},{originalEvent:r})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class ku{constructor(){this._tap=new il({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,delete this._swipePoint,delete this._swipeTouch,delete this._tapTime,delete this._tapPoint,this._tap.reset()}touchstart(r,o,c){if(!this._swipePoint)if(this._tapTime){const d=o[0],g=r.timeStamp-this._tapTime<500,x=this._tapPoint.dist(d)<30;g&&x?c.length>0&&(this._swipePoint=d,this._swipeTouch=c[0].identifier):this.reset()}else this._tap.touchstart(r,o,c)}touchmove(r,o,c){if(this._tapTime){if(this._swipePoint){if(c[0].identifier!==this._swipeTouch)return;const d=o[0],g=d.y-this._swipePoint.y;return this._swipePoint=d,r.preventDefault(),this._active=!0,{zoomDelta:g/128}}}else this._tap.touchmove(r,o,c)}touchend(r,o,c){if(this._tapTime)this._swipePoint&&c.length===0&&this.reset();else{const d=this._tap.touchend(r,o,c);d&&(this._tapTime=r.timeStamp,this._tapPoint=d)}}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Eu{constructor(r,o,c){this._el=r,this._mousePan=o,this._touchPan=c}enable(r){this._inertiaOptions=r||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("maplibregl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("maplibregl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class mn{constructor(r,o,c){this._pitchWithRotate=r.pitchWithRotate,this._mouseRotate=o,this._mousePitch=c}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class fs{constructor(r,o,c,d){this._el=r,this._touchZoom=o,this._touchRotate=c,this._tapDragZoom=d,this._rotationDisabled=!1,this._enabled=!0}enable(r){this._touchZoom.enable(r),this._rotationDisabled||this._touchRotate.enable(r),this._tapDragZoom.enable(),this._el.classList.add("maplibregl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("maplibregl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const aa=f=>f.zoom||f.drag||f.pitch||f.rotate;class Iu extends u.k{}function la(f){return f.panDelta&&f.panDelta.mag()||f.zoomDelta||f.bearingDelta||f.pitchDelta}class Cu{constructor(r,o){this.handleWindowEvent=d=>{this.handleEvent(d,`${d.type}Window`)},this.handleEvent=(d,g)=>{if(d.type==="blur")return void this.stop(!0);this._updatingCamera=!0;const x=d.type==="renderFrame"?void 0:d,w={needsRenderFrame:!1},T={},E={},P=d.touches,z=P?this._getMapTouches(P):void 0,F=z?D.touchPos(this._el,z):D.mousePos(this._el,d);for(const{handlerName:G,handler:U,allowed:oe}of this._handlers){if(!U.isEnabled())continue;let pe;this._blockedByActive(E,oe,G)?U.reset():U[g||d.type]&&(pe=U[g||d.type](d,F,z),this.mergeHandlerResult(w,T,pe,G,x),pe&&pe.needsRenderFrame&&this._triggerRenderFrame()),(pe||U.isActive())&&(E[G]=U)}const q={};for(const G in this._previousActiveHandlers)E[G]||(q[G]=x);this._previousActiveHandlers=E,(Object.keys(q).length||la(w))&&(this._changes.push([w,T,q]),this._triggerRenderFrame()),(Object.keys(E).length||la(w))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:$}=w;$&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],$(this._map))},this._map=r,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new vh(r),this._bearingSnap=o.bearingSnap,this._previousActiveHandlers={},this._eventsInProgress={},this._addDefaultHandlers(o);const c=this._el;this._listeners=[[c,"touchstart",{passive:!0}],[c,"touchmove",{passive:!1}],[c,"touchend",void 0],[c,"touchcancel",void 0],[c,"mousedown",void 0],[c,"mousemove",void 0],[c,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[c,"mouseover",void 0],[c,"mouseout",void 0],[c,"dblclick",void 0],[c,"click",void 0],[c,"keydown",{capture:!1}],[c,"keyup",void 0],[c,"wheel",{passive:!1}],[c,"contextmenu",void 0],[window,"blur",void 0]];for(const[d,g,x]of this._listeners)D.addEventListener(d,g,d===document?this.handleWindowEvent:this.handleEvent,x)}destroy(){for(const[r,o,c]of this._listeners)D.removeEventListener(r,o,r===document?this.handleWindowEvent:this.handleEvent,c)}_addDefaultHandlers(r){const o=this._map,c=o.getCanvasContainer();this._add("mapEvent",new wh(o,r));const d=o.boxZoom=new Sh(o,r);this._add("boxZoom",d),r.interactive&&r.boxZoom&&d.enable();const g=new Ui(o),x=new Tu(o);o.doubleClickZoom=new Su(x,g),this._add("tapZoom",g),this._add("clickZoom",x),r.interactive&&r.doubleClickZoom&&o.doubleClickZoom.enable();const w=new ku;this._add("tapDragZoom",w);const T=o.touchPitch=new Kp(o);this._add("touchPitch",T),r.interactive&&r.touchPitch&&o.touchPitch.enable(r.touchPitch);const E=fo(r),P=$i(r);o.dragRotate=new mn(r,E,P),this._add("mouseRotate",E,["mousePitch"]),this._add("mousePitch",P,["mouseRotate"]),r.interactive&&r.dragRotate&&o.dragRotate.enable();const z=(({enable:oe,clickTolerance:pe})=>{const Y=new vu({checkCorrectEvent:ae=>D.mouseButton(ae)===0&&!ae.ctrlKey});return new ji({clickTolerance:pe,move:(ae,me)=>({around:me,panDelta:me.sub(ae)}),activateOnStart:!0,moveStateManager:Y,enable:oe,assignEvents:sl})})(r),F=new Ge(r,o);o.dragPan=new Eu(c,z,F),this._add("mousePan",z),this._add("touchPan",F,["touchZoom","touchRotate"]),r.interactive&&r.dragPan&&o.dragPan.enable(r.dragPan);const q=new xu,$=new kh;o.touchZoomRotate=new fs(c,$,q,w),this._add("touchRotate",q,["touchPan","touchZoom"]),this._add("touchZoom",$,["touchPan","touchRotate"]),r.interactive&&r.touchZoomRotate&&o.touchZoomRotate.enable(r.touchZoomRotate);const G=o.scrollZoom=new Yp(o,()=>this._triggerRenderFrame());this._add("scrollZoom",G,["mousePan"]),r.interactive&&r.scrollZoom&&o.scrollZoom.enable(r.scrollZoom);const U=o.keyboard=new Eh(o);this._add("keyboard",U),r.interactive&&r.keyboard&&o.keyboard.enable(),this._add("blockableMapEvent",new bh(o))}_add(r,o,c){this._handlers.push({handlerName:r,handler:o,allowed:c}),this._handlersById[r]=o}stop(r){if(!this._updatingCamera){for(const{handler:o}of this._handlers)o.reset();this._inertia.clear(),this._fireEvents({},{},r),this._changes=[]}}isActive(){for(const{handler:r}of this._handlers)if(r.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!aa(this._eventsInProgress)||this.isZooming()}_blockedByActive(r,o,c){for(const d in r)if(d!==c&&(!o||o.indexOf(d)<0))return!0;return!1}_getMapTouches(r){const o=[];for(const c of r)this._el.contains(c.target)&&o.push(c);return o}mergeHandlerResult(r,o,c,d,g){if(!c)return;u.e(r,c);const x={handlerName:d,originalEvent:c.originalEvent||g};c.zoomDelta!==void 0&&(o.zoom=x),c.panDelta!==void 0&&(o.drag=x),c.pitchDelta!==void 0&&(o.pitch=x),c.bearingDelta!==void 0&&(o.rotate=x)}_applyChanges(){const r={},o={},c={};for(const[d,g,x]of this._changes)d.panDelta&&(r.panDelta=(r.panDelta||new u.P(0,0))._add(d.panDelta)),d.zoomDelta&&(r.zoomDelta=(r.zoomDelta||0)+d.zoomDelta),d.bearingDelta&&(r.bearingDelta=(r.bearingDelta||0)+d.bearingDelta),d.pitchDelta&&(r.pitchDelta=(r.pitchDelta||0)+d.pitchDelta),d.around!==void 0&&(r.around=d.around),d.pinchAround!==void 0&&(r.pinchAround=d.pinchAround),d.noInertia&&(r.noInertia=d.noInertia),u.e(o,g),u.e(c,x);this._updateMapTransform(r,o,c),this._changes=[]}_updateMapTransform(r,o,c){const d=this._map,g=d._getTransformForUpdate(),x=d.terrain;if(!(la(r)||x&&this._terrainMovement))return this._fireEvents(o,c,!0);let{panDelta:w,zoomDelta:T,bearingDelta:E,pitchDelta:P,around:z,pinchAround:F}=r;F!==void 0&&(z=F),d._stop(!0),z=z||d.transform.centerPoint;const q=g.pointLocation(w?z.sub(w):z);E&&(g.bearing+=E),P&&(g.pitch+=P),T&&(g.zoom+=T),x?this._terrainMovement||!o.drag&&!o.zoom?o.drag&&this._terrainMovement?g.center=g.pointLocation(g.centerPoint.sub(w)):g.setLocationAtPoint(q,z):(this._terrainMovement=!0,this._map._elevationFreeze=!0,g.setLocationAtPoint(q,z),this._map.once("moveend",()=>{this._map._elevationFreeze=!1,this._terrainMovement=!1,g.recalculateZoom(d.terrain)})):g.setLocationAtPoint(q,z),d._applyUpdatedTransform(g),this._map._update(),r.noInertia||this._inertia.record(r),this._fireEvents(o,c,!0)}_fireEvents(r,o,c){const d=aa(this._eventsInProgress),g=aa(r),x={};for(const P in r){const{originalEvent:z}=r[P];this._eventsInProgress[P]||(x[`${P}start`]=z),this._eventsInProgress[P]=r[P]}!d&&g&&this._fireEvent("movestart",g.originalEvent);for(const P in x)this._fireEvent(P,x[P]);g&&this._fireEvent("move",g.originalEvent);for(const P in r){const{originalEvent:z}=r[P];this._fireEvent(P,z)}const w={};let T;for(const P in this._eventsInProgress){const{handlerName:z,originalEvent:F}=this._eventsInProgress[P];this._handlersById[z].isActive()||(delete this._eventsInProgress[P],T=o[z]||F,w[`${P}end`]=T)}for(const P in w)this._fireEvent(P,w[P]);const E=aa(this._eventsInProgress);if(c&&(d||g)&&!E){this._updatingCamera=!0;const P=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),z=F=>F!==0&&-this._bearingSnap<F&&F<this._bearingSnap;!P||!P.essential&&u.h.prefersReducedMotion?(this._map.fire(new u.k("moveend",{originalEvent:T})),z(this._map.getBearing())&&this._map.resetNorth()):(z(P.bearing||this._map.getBearing())&&(P.bearing=0),P.freezeElevation=!0,this._map.easeTo(P,{originalEvent:T})),this._updatingCamera=!1}}_fireEvent(r,o){this._map.fire(new u.k(r,o?{originalEvent:o}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(r=>{delete this._frameId,this.handleEvent(new Iu("renderFrame",{timeStamp:r})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}class Ph extends u.E{constructor(r,o){super(),this._renderFrameCallback=()=>{const c=Math.min((u.h.now()-this._easeStart)/this._easeOptions.duration,1);this._onEaseFrame(this._easeOptions.easing(c)),c<1&&this._easeFrameId?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()},this._moving=!1,this._zooming=!1,this.transform=r,this._bearingSnap=o.bearingSnap,this.on("moveend",()=>{delete this._requestedCameraState})}getCenter(){return new u.L(this.transform.center.lng,this.transform.center.lat)}setCenter(r,o){return this.jumpTo({center:r},o)}panBy(r,o,c){return r=u.P.convert(r).mult(-1),this.panTo(this.transform.center,u.e({offset:r},o),c)}panTo(r,o,c){return this.easeTo(u.e({center:r},o),c)}getZoom(){return this.transform.zoom}setZoom(r,o){return this.jumpTo({zoom:r},o),this}zoomTo(r,o,c){return this.easeTo(u.e({zoom:r},o),c)}zoomIn(r,o){return this.zoomTo(this.getZoom()+1,r,o),this}zoomOut(r,o){return this.zoomTo(this.getZoom()-1,r,o),this}getBearing(){return this.transform.bearing}setBearing(r,o){return this.jumpTo({bearing:r},o),this}getPadding(){return this.transform.padding}setPadding(r,o){return this.jumpTo({padding:r},o),this}rotateTo(r,o,c){return this.easeTo(u.e({bearing:r},o),c)}resetNorth(r,o){return this.rotateTo(0,u.e({duration:1e3},r),o),this}resetNorthPitch(r,o){return this.easeTo(u.e({bearing:0,pitch:0,duration:1e3},r),o),this}snapToNorth(r,o){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(r,o):this}getPitch(){return this.transform.pitch}setPitch(r,o){return this.jumpTo({pitch:r},o),this}cameraForBounds(r,o){r=At.convert(r);const c=o&&o.bearing||0;return this._cameraForBoxAndBearing(r.getNorthWest(),r.getSouthEast(),c,o)}_cameraForBoxAndBearing(r,o,c,d){const g={top:0,bottom:0,right:0,left:0};if(typeof(d=u.e({padding:g,offset:[0,0],maxZoom:this.transform.maxZoom},d)).padding=="number"){const me=d.padding;d.padding={top:me,bottom:me,right:me,left:me}}d.padding=u.e(g,d.padding);const x=this.transform,w=x.padding,T=x.project(u.L.convert(r)),E=x.project(u.L.convert(o)),P=T.rotate(-c*Math.PI/180),z=E.rotate(-c*Math.PI/180),F=new u.P(Math.max(P.x,z.x),Math.max(P.y,z.y)),q=new u.P(Math.min(P.x,z.x),Math.min(P.y,z.y)),$=F.sub(q),G=(x.width-(w.left+w.right+d.padding.left+d.padding.right))/$.x,U=(x.height-(w.top+w.bottom+d.padding.top+d.padding.bottom))/$.y;if(U<0||G<0)return void u.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");const oe=Math.min(x.scaleZoom(x.scale*Math.min(G,U)),d.maxZoom),pe=u.P.convert(d.offset),Y=new u.P((d.padding.left-d.padding.right)/2,(d.padding.top-d.padding.bottom)/2).rotate(c*Math.PI/180),ae=pe.add(Y).mult(x.scale/x.zoomScale(oe));return{center:x.unproject(T.add(E).div(2).sub(ae)),zoom:oe,bearing:c}}fitBounds(r,o,c){return this._fitInternal(this.cameraForBounds(r,o),o,c)}fitScreenCoordinates(r,o,c,d,g){return this._fitInternal(this._cameraForBoxAndBearing(this.transform.pointLocation(u.P.convert(r)),this.transform.pointLocation(u.P.convert(o)),c,d),d,g)}_fitInternal(r,o,c){return r?(delete(o=u.e(r,o)).padding,o.linear?this.easeTo(o,c):this.flyTo(o,c)):this}jumpTo(r,o){this.stop();const c=this._getTransformForUpdate();let d=!1,g=!1,x=!1;return"zoom"in r&&c.zoom!==+r.zoom&&(d=!0,c.zoom=+r.zoom),r.center!==void 0&&(c.center=u.L.convert(r.center)),"bearing"in r&&c.bearing!==+r.bearing&&(g=!0,c.bearing=+r.bearing),"pitch"in r&&c.pitch!==+r.pitch&&(x=!0,c.pitch=+r.pitch),r.padding==null||c.isPaddingEqual(r.padding)||(c.padding=r.padding),this._applyUpdatedTransform(c),this.fire(new u.k("movestart",o)).fire(new u.k("move",o)),d&&this.fire(new u.k("zoomstart",o)).fire(new u.k("zoom",o)).fire(new u.k("zoomend",o)),g&&this.fire(new u.k("rotatestart",o)).fire(new u.k("rotate",o)).fire(new u.k("rotateend",o)),x&&this.fire(new u.k("pitchstart",o)).fire(new u.k("pitch",o)).fire(new u.k("pitchend",o)),this.fire(new u.k("moveend",o))}calculateCameraOptionsFromTo(r,o,c,d=0){const g=u.U.fromLngLat(r,o),x=u.U.fromLngLat(c,d),w=x.x-g.x,T=x.y-g.y,E=x.z-g.z,P=Math.hypot(w,T,E);if(P===0)throw new Error("Can't calculate camera options with same From and To");const z=Math.hypot(w,T),F=this.transform.scaleZoom(this.transform.cameraToCenterDistance/P/this.transform.tileSize),q=180*Math.atan2(w,-T)/Math.PI;let $=180*Math.acos(z/P)/Math.PI;return $=E<0?90-$:90+$,{center:x.toLngLat(),zoom:F,pitch:$,bearing:q}}easeTo(r,o){this._stop(!1,r.easeId),((r=u.e({offset:[0,0],duration:500,easing:u.bb},r)).animate===!1||!r.essential&&u.h.prefersReducedMotion)&&(r.duration=0);const c=this._getTransformForUpdate(),d=this.getZoom(),g=this.getBearing(),x=this.getPitch(),w=this.getPadding(),T="zoom"in r?+r.zoom:d,E="bearing"in r?this._normalizeBearing(r.bearing,g):g,P="pitch"in r?+r.pitch:x,z="padding"in r?r.padding:c.padding,F=u.P.convert(r.offset);let q=c.centerPoint.add(F);const $=c.pointLocation(q),G=u.L.convert(r.center||$);this._normalizeCenter(G);const U=c.project($),oe=c.project(G).sub(U),pe=c.zoomScale(T-d);let Y,ae;r.around&&(Y=u.L.convert(r.around),ae=c.locationPoint(Y));const me={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=this._zooming||T!==d,this._rotating=this._rotating||g!==E,this._pitching=this._pitching||P!==x,this._padding=!c.isPaddingEqual(z),this._easeId=r.easeId,this._prepareEase(o,r.noMoveStart,me),this.terrain&&this._prepareElevation(G),this._ease(ge=>{if(this._zooming&&(c.zoom=u.B.number(d,T,ge)),this._rotating&&(c.bearing=u.B.number(g,E,ge)),this._pitching&&(c.pitch=u.B.number(x,P,ge)),this._padding&&(c.interpolatePadding(w,z,ge),q=c.centerPoint.add(F)),this.terrain&&!r.freezeElevation&&this._updateElevation(ge),Y)c.setLocationAtPoint(Y,ae);else{const Te=c.zoomScale(c.zoom-d),ze=T>d?Math.min(2,pe):Math.max(.5,pe),Ce=Math.pow(ze,1-ge),Ae=c.unproject(U.add(oe.mult(ge*Ce)).mult(Te));c.setLocationAtPoint(c.renderWorldCopies?Ae.wrap():Ae,q)}this._applyUpdatedTransform(c),this._fireMoveEvents(o)},ge=>{this.terrain&&this._finalizeElevation(),this._afterEase(o,ge)},r),this}_prepareEase(r,o,c={}){this._moving=!0,o||c.moving||this.fire(new u.k("movestart",r)),this._zooming&&!c.zooming&&this.fire(new u.k("zoomstart",r)),this._rotating&&!c.rotating&&this.fire(new u.k("rotatestart",r)),this._pitching&&!c.pitching&&this.fire(new u.k("pitchstart",r))}_prepareElevation(r){this._elevationCenter=r,this._elevationStart=this.transform.elevation,this._elevationTarget=this.terrain.getElevationForLngLatZoom(r,this.transform.tileZoom),this._elevationFreeze=!0}_updateElevation(r){this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);const o=this.terrain.getElevationForLngLatZoom(this._elevationCenter,this.transform.tileZoom);if(r<1&&o!==this._elevationTarget){const c=this._elevationTarget-this._elevationStart;this._elevationStart+=r*(c-(o-(c*r+this._elevationStart))/(1-r)),this._elevationTarget=o}this.transform.elevation=u.B.number(this._elevationStart,this._elevationTarget,r)}_finalizeElevation(){this._elevationFreeze=!1,this.transform.recalculateZoom(this.terrain)}_getTransformForUpdate(){return this.transformCameraUpdate?(this._requestedCameraState||(this._requestedCameraState=this.transform.clone()),this._requestedCameraState):this.transform}_applyUpdatedTransform(r){if(!this.transformCameraUpdate)return;const o=r.clone(),{center:c,zoom:d,pitch:g,bearing:x,elevation:w}=this.transformCameraUpdate(o);c&&(o.center=c),d!==void 0&&(o.zoom=d),g!==void 0&&(o.pitch=g),x!==void 0&&(o.bearing=x),w!==void 0&&(o.elevation=w),this.transform.apply(o)}_fireMoveEvents(r){this.fire(new u.k("move",r)),this._zooming&&this.fire(new u.k("zoom",r)),this._rotating&&this.fire(new u.k("rotate",r)),this._pitching&&this.fire(new u.k("pitch",r))}_afterEase(r,o){if(this._easeId&&o&&this._easeId===o)return;delete this._easeId;const c=this._zooming,d=this._rotating,g=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,c&&this.fire(new u.k("zoomend",r)),d&&this.fire(new u.k("rotateend",r)),g&&this.fire(new u.k("pitchend",r)),this.fire(new u.k("moveend",r))}flyTo(r,o){if(!r.essential&&u.h.prefersReducedMotion){const Qe=u.F(r,["center","zoom","bearing","pitch","around"]);return this.jumpTo(Qe,o)}this.stop(),r=u.e({offset:[0,0],speed:1.2,curve:1.42,easing:u.bb},r);const c=this._getTransformForUpdate(),d=this.getZoom(),g=this.getBearing(),x=this.getPitch(),w=this.getPadding(),T="zoom"in r?u.ad(+r.zoom,c.minZoom,c.maxZoom):d,E="bearing"in r?this._normalizeBearing(r.bearing,g):g,P="pitch"in r?+r.pitch:x,z="padding"in r?r.padding:c.padding,F=c.zoomScale(T-d),q=u.P.convert(r.offset);let $=c.centerPoint.add(q);const G=c.pointLocation($),U=u.L.convert(r.center||G);this._normalizeCenter(U);const oe=c.project(G),pe=c.project(U).sub(oe);let Y=r.curve;const ae=Math.max(c.width,c.height),me=ae/F,ge=pe.mag();if("minZoom"in r){const Qe=u.ad(Math.min(r.minZoom,d,T),c.minZoom,c.maxZoom),Rt=ae/c.zoomScale(Qe-d);Y=Math.sqrt(Rt/ge*2)}const Te=Y*Y;function ze(Qe){const Rt=(me*me-ae*ae+(Qe?-1:1)*Te*Te*ge*ge)/(2*(Qe?me:ae)*Te*ge);return Math.log(Math.sqrt(Rt*Rt+1)-Rt)}function Ce(Qe){return(Math.exp(Qe)-Math.exp(-Qe))/2}function Ae(Qe){return(Math.exp(Qe)+Math.exp(-Qe))/2}const Ke=ze(!1);let _t=function(Qe){return Ae(Ke)/Ae(Ke+Y*Qe)},Ne=function(Qe){return ae*((Ae(Ke)*(Ce(Rt=Ke+Y*Qe)/Ae(Rt))-Ce(Ke))/Te)/ge;var Rt},at=(ze(!0)-Ke)/Y;if(Math.abs(ge)<1e-6||!isFinite(at)){if(Math.abs(ae-me)<1e-6)return this.easeTo(r,o);const Qe=me<ae?-1:1;at=Math.abs(Math.log(me/ae))/Y,Ne=function(){return 0},_t=function(Rt){return Math.exp(Qe*Y*Rt)}}return r.duration="duration"in r?+r.duration:1e3*at/("screenSpeed"in r?+r.screenSpeed/Y:+r.speed),r.maxDuration&&r.duration>r.maxDuration&&(r.duration=0),this._zooming=!0,this._rotating=g!==E,this._pitching=P!==x,this._padding=!c.isPaddingEqual(z),this._prepareEase(o,!1),this.terrain&&this._prepareElevation(U),this._ease(Qe=>{const Rt=Qe*at,yt=1/_t(Rt);c.zoom=Qe===1?T:d+c.scaleZoom(yt),this._rotating&&(c.bearing=u.B.number(g,E,Qe)),this._pitching&&(c.pitch=u.B.number(x,P,Qe)),this._padding&&(c.interpolatePadding(w,z,Qe),$=c.centerPoint.add(q)),this.terrain&&!r.freezeElevation&&this._updateElevation(Qe);const pt=Qe===1?U:c.unproject(oe.add(pe.mult(Ne(Rt))).mult(yt));c.setLocationAtPoint(c.renderWorldCopies?pt.wrap():pt,$),this._applyUpdatedTransform(c),this._fireMoveEvents(o)},()=>{this.terrain&&this._finalizeElevation(),this._afterEase(o)},r),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(r,o){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),delete this._easeFrameId,delete this._onEaseFrame),this._onEaseEnd){const c=this._onEaseEnd;delete this._onEaseEnd,c.call(this,o)}if(!r){const c=this.handlers;c&&c.stop(!1)}return this}_ease(r,o,c){c.animate===!1||c.duration===0?(r(1),o()):(this._easeStart=u.h.now(),this._easeOptions=c,this._onEaseFrame=r,this._onEaseEnd=o,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_normalizeBearing(r,o){r=u.b5(r,-180,180);const c=Math.abs(r-o);return Math.abs(r-360-o)<c&&(r-=360),Math.abs(r+360-o)<c&&(r+=360),r}_normalizeCenter(r){const o=this.transform;if(!o.renderWorldCopies||o.lngRange)return;const c=r.lng-o.center.lng;r.lng+=c>180?-360:c<-180?360:0}queryTerrainElevation(r){return this.terrain?this.terrain.getElevationForLngLatZoom(u.L.convert(r),this.transform.tileZoom)-this.transform.elevation:null}}class Mn{constructor(r={}){this._toggleAttribution=()=>{this._container.classList.contains("maplibregl-compact")&&(this._container.classList.contains("maplibregl-compact-show")?(this._container.setAttribute("open",""),this._container.classList.remove("maplibregl-compact-show")):(this._container.classList.add("maplibregl-compact-show"),this._container.removeAttribute("open")))},this._updateData=o=>{!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"&&o.type!=="terrain"||this._updateAttributions()},this._updateCompact=()=>{this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact===!1?this._container.setAttribute("open",""):this._container.classList.contains("maplibregl-compact")||this._container.classList.contains("maplibregl-attrib-empty")||(this._container.setAttribute("open",""),this._container.classList.add("maplibregl-compact","maplibregl-compact-show")):(this._container.setAttribute("open",""),this._container.classList.contains("maplibregl-compact")&&this._container.classList.remove("maplibregl-compact","maplibregl-compact-show"))},this._updateCompactMinimize=()=>{this._container.classList.contains("maplibregl-compact")&&this._container.classList.contains("maplibregl-compact-show")&&this._container.classList.remove("maplibregl-compact-show")},this.options=r}getDefaultPosition(){return"bottom-right"}onAdd(r){return this._map=r,this._compact=this.options&&this.options.compact,this._container=D.create("details","maplibregl-ctrl maplibregl-ctrl-attrib"),this._compactButton=D.create("summary","maplibregl-ctrl-attrib-button",this._container),this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=D.create("div","maplibregl-ctrl-attrib-inner",this._container),this._updateAttributions(),this._updateCompact(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("terrain",this._updateData),this._map.on("resize",this._updateCompact),this._map.on("drag",this._updateCompactMinimize),this._container}onRemove(){D.remove(this._container),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("terrain",this._updateData),this._map.off("resize",this._updateCompact),this._map.off("drag",this._updateCompactMinimize),this._map=void 0,this._compact=void 0,this._attribHTML=void 0}_setElementTitle(r,o){const c=this._map._getUIString(`AttributionControl.${o}`);r.title=c,r.setAttribute("aria-label",c)}_updateAttributions(){if(!this._map.style)return;let r=[];if(this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?r=r.concat(this.options.customAttribution.map(d=>typeof d!="string"?"":d)):typeof this.options.customAttribution=="string"&&r.push(this.options.customAttribution)),this._map.style.stylesheet){const d=this._map.style.stylesheet;this.styleOwner=d.owner,this.styleId=d.id}const o=this._map.style.sourceCaches;for(const d in o){const g=o[d];if(g.used||g.usedForTerrain){const x=g.getSource();x.attribution&&r.indexOf(x.attribution)<0&&r.push(x.attribution)}}r=r.filter(d=>String(d).trim()),r.sort((d,g)=>d.length-g.length),r=r.filter((d,g)=>{for(let x=g+1;x<r.length;x++)if(r[x].indexOf(d)>=0)return!1;return!0});const c=r.join(" | ");c!==this._attribHTML&&(this._attribHTML=c,r.length?(this._innerContainer.innerHTML=c,this._container.classList.remove("maplibregl-attrib-empty")):this._container.classList.add("maplibregl-attrib-empty"),this._updateCompact(),this._editLink=null)}}class qt{constructor(r={}){this._updateCompact=()=>{const o=this._container.children;if(o.length){const c=o[0];this._map.getCanvasContainer().offsetWidth<=640||this._compact?this._compact!==!1&&c.classList.add("maplibregl-compact"):c.classList.remove("maplibregl-compact")}},this.options=r}getDefaultPosition(){return"bottom-left"}onAdd(r){this._map=r,this._compact=this.options&&this.options.compact,this._container=D.create("div","maplibregl-ctrl");const o=D.create("a","maplibregl-ctrl-logo");return o.target="_blank",o.rel="noopener nofollow",o.href="https://maplibre.org/",o.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),o.setAttribute("rel","noopener nofollow"),this._container.appendChild(o),this._container.style.display="block",this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){D.remove(this._container),this._map.off("resize",this._updateCompact),this._map=void 0,this._compact=void 0}}class al{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(r){const o=++this._id;return this._queue.push({callback:r,id:o,cancelled:!1}),o}remove(r){const o=this._currentlyRunning,c=o?this._queue.concat(o):this._queue;for(const d of c)if(d.id===r)return void(d.cancelled=!0)}run(r=0){if(this._currentlyRunning)throw new Error("Attempting to run(), but is already running.");const o=this._currentlyRunning=this._queue;this._queue=[];for(const c of o)if(!c.cancelled&&(c.callback(r),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}const Pu={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScaleControl.Feet":"ft","ScaleControl.Meters":"m","ScaleControl.Kilometers":"km","ScaleControl.Miles":"mi","ScaleControl.NauticalMiles":"nm","TerrainControl.enableTerrain":"Enable terrain","TerrainControl.disableTerrain":"Disable terrain"};var zh=u.Q([{name:"a_pos3d",type:"Int16",components:3}]);class Mh extends u.E{constructor(r){super(),this.sourceCache=r,this._tiles={},this._renderableTilesKeys=[],this._sourceTileCache={},this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.deltaZoom=1,r.usedForTerrain=!0,r.tileSize=this.tileSize*2**this.deltaZoom}destruct(){this.sourceCache.usedForTerrain=!1,this.sourceCache.tileSize=null}update(r,o){this.sourceCache.update(r,o),this._renderableTilesKeys=[];const c={};for(const d of r.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,reparseOverscaled:!1,terrain:o}))c[d.key]=!0,this._renderableTilesKeys.push(d.key),this._tiles[d.key]||(d.posMatrix=new Float64Array(16),u.aS(d.posMatrix,0,u.N,0,u.N,0,1),this._tiles[d.key]=new as(d,this.tileSize));for(const d in this._tiles)c[d]||delete this._tiles[d]}freeRtt(r){for(const o in this._tiles){const c=this._tiles[o];(!r||c.tileID.equals(r)||c.tileID.isChildOf(r)||r.isChildOf(c.tileID))&&(c.rtt=[])}}getRenderableTiles(){return this._renderableTilesKeys.map(r=>this.getTileByID(r))}getTileByID(r){return this._tiles[r]}getTerrainCoords(r){const o={};for(const c of this._renderableTilesKeys){const d=this._tiles[c].tileID;if(d.canonical.equals(r.canonical)){const g=r.clone();g.posMatrix=new Float64Array(16),u.aS(g.posMatrix,0,u.N,0,u.N,0,1),o[c]=g}else if(d.canonical.isChildOf(r.canonical)){const g=r.clone();g.posMatrix=new Float64Array(16);const x=d.canonical.z-r.canonical.z,w=d.canonical.x-(d.canonical.x>>x<<x),T=d.canonical.y-(d.canonical.y>>x<<x),E=u.N>>x;u.aS(g.posMatrix,0,E,0,E,0,1),u.$(g.posMatrix,g.posMatrix,[-w*E,-T*E,0]),o[c]=g}else if(r.canonical.isChildOf(d.canonical)){const g=r.clone();g.posMatrix=new Float64Array(16);const x=r.canonical.z-d.canonical.z,w=r.canonical.x-(r.canonical.x>>x<<x),T=r.canonical.y-(r.canonical.y>>x<<x),E=u.N>>x;u.aS(g.posMatrix,0,u.N,0,u.N,0,1),u.$(g.posMatrix,g.posMatrix,[w*E,T*E,0]),u.a0(g.posMatrix,g.posMatrix,[1/2**x,1/2**x,0]),o[c]=g}}return o}getSourceTile(r,o){const c=this.sourceCache._source;let d=r.overscaledZ-this.deltaZoom;if(d>c.maxzoom&&(d=c.maxzoom),d<c.minzoom)return null;this._sourceTileCache[r.key]||(this._sourceTileCache[r.key]=r.scaledTo(d).key);let g=this.sourceCache.getTileByID(this._sourceTileCache[r.key]);if((!g||!g.dem)&&o)for(;d>=c.minzoom&&(!g||!g.dem);)g=this.sourceCache.getTileByID(r.scaledTo(d--).key);return g}tilesAfterTime(r=Date.now()){return Object.values(this._tiles).filter(o=>o.timeAdded>=r)}}class Ah{constructor(r,o,c){this.painter=r,this.sourceCache=new Mh(o),this.options=c,this.exaggeration=typeof c.exaggeration=="number"?c.exaggeration:1,this.qualityFactor=2,this.meshSize=128,this._demMatrixCache={},this.coordsIndex=[],this._coordsTextureSize=1024}getDEMElevation(r,o,c,d=u.N){var g;if(!(o>=0&&o<d&&c>=0&&c<d))return 0;const x=this.getTerrainData(r),w=(g=x.tile)===null||g===void 0?void 0:g.dem;if(!w)return 0;const T=function($,G,U){var oe=G[0],pe=G[1];return $[0]=U[0]*oe+U[4]*pe+U[12],$[1]=U[1]*oe+U[5]*pe+U[13],$}([],[o/d*u.N,c/d*u.N],x.u_terrain_matrix),E=[T[0]*w.dim,T[1]*w.dim],P=Math.floor(E[0]),z=Math.floor(E[1]),F=E[0]-P,q=E[1]-z;return w.get(P,z)*(1-F)*(1-q)+w.get(P+1,z)*F*(1-q)+w.get(P,z+1)*(1-F)*q+w.get(P+1,z+1)*F*q}getElevationForLngLatZoom(r,o){const{tileID:c,mercatorX:d,mercatorY:g}=this._getOverscaledTileIDFromLngLatZoom(r,o);return this.getElevation(c,d%u.N,g%u.N,u.N)}getElevation(r,o,c,d=u.N){return this.getDEMElevation(r,o,c,d)*this.exaggeration}getTerrainData(r){if(!this._emptyDemTexture){const d=this.painter.context,g=new u.R({width:1,height:1},new Uint8Array(4));this._emptyDepthTexture=new rt(d,g,d.gl.RGBA,{premultiply:!1}),this._emptyDemUnpack=[0,0,0,0],this._emptyDemTexture=new rt(d,new u.R({width:1,height:1}),d.gl.RGBA,{premultiply:!1}),this._emptyDemTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),this._emptyDemMatrix=u.ao([])}const o=this.sourceCache.getSourceTile(r,!0);if(o&&o.dem&&(!o.demTexture||o.needsTerrainPrepare)){const d=this.painter.context;o.demTexture=this.painter.getTileTexture(o.dem.stride),o.demTexture?o.demTexture.update(o.dem.getPixels(),{premultiply:!1}):o.demTexture=new rt(d,o.dem.getPixels(),d.gl.RGBA,{premultiply:!1}),o.demTexture.bind(d.gl.NEAREST,d.gl.CLAMP_TO_EDGE),o.needsTerrainPrepare=!1}const c=o&&o+o.tileID.key+r.key;if(c&&!this._demMatrixCache[c]){const d=this.sourceCache.sourceCache._source.maxzoom;let g=r.canonical.z-o.tileID.canonical.z;r.overscaledZ>r.canonical.z&&(r.canonical.z>=d?g=r.canonical.z-d:u.w("cannot calculate elevation if elevation maxzoom > source.maxzoom"));const x=r.canonical.x-(r.canonical.x>>g<<g),w=r.canonical.y-(r.canonical.y>>g<<g),T=u.bc(new Float64Array(16),[1/(u.N<<g),1/(u.N<<g),0]);u.$(T,T,[x*u.N,w*u.N,0]),this._demMatrixCache[r.key]={matrix:T,coord:r}}return{u_depth:2,u_terrain:3,u_terrain_dim:o&&o.dem&&o.dem.dim||1,u_terrain_matrix:c?this._demMatrixCache[r.key].matrix:this._emptyDemMatrix,u_terrain_unpack:o&&o.dem&&o.dem.getUnpackVector()||this._emptyDemUnpack,u_terrain_exaggeration:this.exaggeration,texture:(o&&o.demTexture||this._emptyDemTexture).texture,depthTexture:(this._fboDepthTexture||this._emptyDepthTexture).texture,tile:o}}getFramebuffer(r){const o=this.painter,c=o.width/devicePixelRatio,d=o.height/devicePixelRatio;return!this._fbo||this._fbo.width===c&&this._fbo.height===d||(this._fbo.destroy(),this._fboCoordsTexture.destroy(),this._fboDepthTexture.destroy(),delete this._fbo,delete this._fboDepthTexture,delete this._fboCoordsTexture),this._fboCoordsTexture||(this._fboCoordsTexture=new rt(o.context,{width:c,height:d,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboCoordsTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fboDepthTexture||(this._fboDepthTexture=new rt(o.context,{width:c,height:d,data:null},o.context.gl.RGBA,{premultiply:!1}),this._fboDepthTexture.bind(o.context.gl.NEAREST,o.context.gl.CLAMP_TO_EDGE)),this._fbo||(this._fbo=o.context.createFramebuffer(c,d,!0,!1),this._fbo.depthAttachment.set(o.context.createRenderbuffer(o.context.gl.DEPTH_COMPONENT16,c,d))),this._fbo.colorAttachment.set(r==="coords"?this._fboCoordsTexture.texture:this._fboDepthTexture.texture),this._fbo}getCoordsTexture(){const r=this.painter.context;if(this._coordsTexture)return this._coordsTexture;const o=new Uint8Array(this._coordsTextureSize*this._coordsTextureSize*4);for(let g=0,x=0;g<this._coordsTextureSize;g++)for(let w=0;w<this._coordsTextureSize;w++,x+=4)o[x+0]=255&w,o[x+1]=255&g,o[x+2]=w>>8<<4|g>>8,o[x+3]=0;const c=new u.R({width:this._coordsTextureSize,height:this._coordsTextureSize},new Uint8Array(o.buffer)),d=new rt(r,c,r.gl.RGBA,{premultiply:!1});return d.bind(r.gl.NEAREST,r.gl.CLAMP_TO_EDGE),this._coordsTexture=d,d}pointCoordinate(r){const o=new Uint8Array(4),c=this.painter.context,d=c.gl;c.bindFramebuffer.set(this.getFramebuffer("coords").framebuffer),d.readPixels(r.x,this.painter.height/devicePixelRatio-r.y-1,1,1,d.RGBA,d.UNSIGNED_BYTE,o),c.bindFramebuffer.set(null);const g=o[0]+(o[2]>>4<<8),x=o[1]+((15&o[2])<<8),w=this.coordsIndex[255-o[3]],T=w&&this.sourceCache.getTileByID(w);if(!T)return null;const E=this._coordsTextureSize,P=(1<<T.tileID.canonical.z)*E;return new u.U(this._allowMercatorOverflow(r,(T.tileID.canonical.x*E+g)/P),(T.tileID.canonical.y*E+x)/P,this.getElevation(T.tileID,g,x,E))}getTerrainMesh(){if(this._mesh)return this._mesh;const r=this.painter.context,o=new u.bd,c=new u.b0,d=this.meshSize,g=u.N/d,x=d*d;for(let z=0;z<=d;z++)for(let F=0;F<=d;F++)o.emplaceBack(F*g,z*g,0);for(let z=0;z<x;z+=d+1)for(let F=0;F<d;F++)c.emplaceBack(F+z,d+F+z+1,d+F+z+2),c.emplaceBack(F+z,d+F+z+2,F+z+1);const w=o.length,T=w+2*(d+1);for(const z of[0,1])for(let F=0;F<=d;F++)for(const q of[0,1])o.emplaceBack(F*g,z*u.N,q);for(let z=0;z<2*d;z+=2)c.emplaceBack(T+z,T+z+1,T+z+3),c.emplaceBack(T+z,T+z+3,T+z+2),c.emplaceBack(w+z,w+z+3,w+z+1),c.emplaceBack(w+z,w+z+2,w+z+3);const E=o.length,P=E+2*(d+1);for(const z of[0,1])for(let F=0;F<=d;F++)for(const q of[0,1])o.emplaceBack(z*u.N,F*g,q);for(let z=0;z<2*d;z+=2)c.emplaceBack(E+z,E+z+1,E+z+3),c.emplaceBack(E+z,E+z+3,E+z+2),c.emplaceBack(P+z,P+z+3,P+z+1),c.emplaceBack(P+z,P+z+2,P+z+3);return this._mesh={indexBuffer:r.createIndexBuffer(c),vertexBuffer:r.createVertexBuffer(o,zh.members),segments:u.S.simpleSegment(0,0,o.length,c.length)},this._mesh}getMeshFrameDelta(r){return 2*Math.PI*u.be/Math.pow(2,r)/5}getMinTileElevationForLngLatZoom(r,o){var c;const{tileID:d}=this._getOverscaledTileIDFromLngLatZoom(r,o);return(c=this.getMinMaxElevation(d).minElevation)!==null&&c!==void 0?c:0}getMinMaxElevation(r){const o=this.getTerrainData(r).tile,c={minElevation:null,maxElevation:null};return o&&o.dem&&(c.minElevation=o.dem.min*this.exaggeration,c.maxElevation=o.dem.max*this.exaggeration),c}_getOverscaledTileIDFromLngLatZoom(r,o){const c=u.U.fromLngLat(r.wrap()),d=(1<<o)*u.N,g=c.x*d,x=c.y*d,w=Math.floor(g/u.N),T=Math.floor(x/u.N);return{tileID:new u.O(o,0,o,w,T),mercatorX:g,mercatorY:x}}_allowMercatorOverflow(r,o){const c=r.x<this.painter.width/2;let d=u.bf(o);const g=this.painter.transform.center.lng;return c&&Math.sign(d)>0&&Math.sign(g)<0||!c&&Math.sign(d)<0&&Math.sign(g)>0?(d=360*Math.sign(g)+d,u.G(d)):o}}class Qp{constructor(r,o,c){this._context=r,this._size=o,this._tileSize=c,this._objects=[],this._recentlyUsed=[],this._stamp=0}destruct(){for(const r of this._objects)r.texture.destroy(),r.fbo.destroy()}_createObject(r){const o=this._context.createFramebuffer(this._tileSize,this._tileSize,!0,!0),c=new rt(this._context,{width:this._tileSize,height:this._tileSize,data:null},this._context.gl.RGBA);return c.bind(this._context.gl.LINEAR,this._context.gl.CLAMP_TO_EDGE),o.depthAttachment.set(this._context.createRenderbuffer(this._context.gl.DEPTH_STENCIL,this._tileSize,this._tileSize)),o.colorAttachment.set(c.texture),{id:r,fbo:o,texture:c,stamp:-1,inUse:!1}}getObjectForId(r){return this._objects[r]}useObject(r){r.inUse=!0,this._recentlyUsed=this._recentlyUsed.filter(o=>r.id!==o),this._recentlyUsed.push(r.id)}stampObject(r){r.stamp=++this._stamp}getOrCreateFreeObject(){for(const o of this._recentlyUsed)if(!this._objects[o].inUse)return this._objects[o];if(this._objects.length>=this._size)throw new Error("No free RenderPool available, call freeAllObjects() required!");const r=this._createObject(this._objects.length);return this._objects.push(r),r}freeObject(r){r.inUse=!1}freeAllObjects(){for(const r of this._objects)this.freeObject(r)}isFull(){return!(this._objects.length<this._size)&&this._objects.some(r=>!r.inUse)===!1}}const en={background:!0,fill:!0,line:!0,raster:!0,hillshade:!0};class ll{constructor(r,o){this.painter=r,this.terrain=o,this.pool=new Qp(r.context,30,o.sourceCache.tileSize*o.qualityFactor)}destruct(){this.pool.destruct()}getTexture(r){return this.pool.getObjectForId(r.rtt[this._stacks.length-1].id).texture}prepareForRender(r,o){this._stacks=[],this._prevType=null,this._rttTiles=[],this._renderableTiles=this.terrain.sourceCache.getRenderableTiles(),this._renderableLayerIds=r._order.filter(c=>!r._layers[c].isHidden(o)),this._coordsDescendingInv={};for(const c in r.sourceCaches){this._coordsDescendingInv[c]={};const d=r.sourceCaches[c].getVisibleCoordinates();for(const g of d){const x=this.terrain.sourceCache.getTerrainCoords(g);for(const w in x)this._coordsDescendingInv[c][w]||(this._coordsDescendingInv[c][w]=[]),this._coordsDescendingInv[c][w].push(x[w])}}this._coordsDescendingInvStr={};for(const c of r._order){const d=r._layers[c],g=d.source;if(en[d.type]&&!this._coordsDescendingInvStr[g]){this._coordsDescendingInvStr[g]={};for(const x in this._coordsDescendingInv[g])this._coordsDescendingInvStr[g][x]=this._coordsDescendingInv[g][x].map(w=>w.key).sort().join()}}for(const c of this._renderableTiles)for(const d in this._coordsDescendingInvStr){const g=this._coordsDescendingInvStr[d][c.tileID.key];g&&g!==c.rttCoords[d]&&(c.rtt=[])}}renderLayer(r){if(r.isHidden(this.painter.transform.zoom))return!1;const o=r.type,c=this.painter,d=this._renderableLayerIds[this._renderableLayerIds.length-1]===r.id;if(en[o]&&(this._prevType&&en[this._prevType]||this._stacks.push([]),this._prevType=o,this._stacks[this._stacks.length-1].push(r.id),!d))return!0;if(en[this._prevType]||en[o]&&d){this._prevType=o;const g=this._stacks.length-1,x=this._stacks[g]||[];for(const w of this._renderableTiles){if(this.pool.isFull()&&(rr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects()),this._rttTiles.push(w),w.rtt[g]){const E=this.pool.getObjectForId(w.rtt[g].id);if(E.stamp===w.rtt[g].stamp){this.pool.useObject(E);continue}}const T=this.pool.getOrCreateFreeObject();this.pool.useObject(T),this.pool.stampObject(T),w.rtt[g]={id:T.id,stamp:T.stamp},c.context.bindFramebuffer.set(T.fbo.framebuffer),c.context.clear({color:u.aT.transparent,stencil:0}),c.currentStencilSource=void 0;for(let E=0;E<x.length;E++){const P=c.style._layers[x[E]],z=P.source?this._coordsDescendingInv[P.source][w.tileID.key]:[w.tileID];c.context.viewport.set([0,0,T.fbo.width,T.fbo.height]),c._renderTileClippingMasks(P,z),c.renderLayer(c,c.style.sourceCaches[P.source],P,z),P.source&&(w.rttCoords[P.source]=this._coordsDescendingInvStr[P.source][w.tileID.key])}}return rr(this.painter,this.terrain,this._rttTiles),this._rttTiles=[],this.pool.freeAllObjects(),en[o]}return!1}}const et=B,ot={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:60,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:void 0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,maplibreLogo:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,maxTileCacheSize:null,maxTileCacheZoomLevels:u.c.MAX_TILE_CACHE_ZOOM_LEVELS,localIdeographFontFamily:"sans-serif",transformRequest:null,transformCameraUpdate:null,fadeDuration:300,crossSourceCollisions:!0,validateStyle:!0,maxCanvasSize:[4096,4096]},ua=f=>{f.touchstart=f.dragStart,f.touchmoveWindow=f.dragMove,f.touchend=f.dragEnd},zu={showCompass:!0,showZoom:!0,visualizePitch:!1};class Mu{constructor(r,o,c=!1){this.mousedown=x=>{this.startMouse(u.e({},x,{ctrlKey:!0,preventDefault:()=>x.preventDefault()}),D.mousePos(this.element,x)),D.addEventListener(window,"mousemove",this.mousemove),D.addEventListener(window,"mouseup",this.mouseup)},this.mousemove=x=>{this.moveMouse(x,D.mousePos(this.element,x))},this.mouseup=x=>{this.mouseRotate.dragEnd(x),this.mousePitch&&this.mousePitch.dragEnd(x),this.offTemp()},this.touchstart=x=>{x.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=D.touchPos(this.element,x.targetTouches)[0],this.startTouch(x,this._startPos),D.addEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.addEventListener(window,"touchend",this.touchend))},this.touchmove=x=>{x.targetTouches.length!==1?this.reset():(this._lastPos=D.touchPos(this.element,x.targetTouches)[0],this.moveTouch(x,this._lastPos))},this.touchend=x=>{x.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),delete this._startPos,delete this._lastPos,this.offTemp()},this.reset=()=>{this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),this.touchRotate.reset(),this.touchPitch&&this.touchPitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()},this._clickTolerance=10;const d=r.dragRotate._mouseRotate.getClickTolerance(),g=r.dragRotate._mousePitch.getClickTolerance();this.element=o,this.mouseRotate=fo({clickTolerance:d,enable:!0}),this.touchRotate=(({enable:x,clickTolerance:w,bearingDegreesPerPixelMoved:T=.8})=>{const E=new Th;return new ji({clickTolerance:w,move:(P,z)=>({bearingDelta:(z.x-P.x)*T}),moveStateManager:E,enable:x,assignEvents:ua})})({clickTolerance:d,enable:!0}),this.map=r,c&&(this.mousePitch=$i({clickTolerance:g,enable:!0}),this.touchPitch=(({enable:x,clickTolerance:w,pitchDegreesPerPixelMoved:T=-.5})=>{const E=new Th;return new ji({clickTolerance:w,move:(P,z)=>({pitchDelta:(z.y-P.y)*T}),moveStateManager:E,enable:x,assignEvents:ua})})({clickTolerance:g,enable:!0})),D.addEventListener(o,"mousedown",this.mousedown),D.addEventListener(o,"touchstart",this.touchstart,{passive:!1}),D.addEventListener(o,"touchcancel",this.reset)}startMouse(r,o){this.mouseRotate.dragStart(r,o),this.mousePitch&&this.mousePitch.dragStart(r,o),D.disableDrag()}startTouch(r,o){this.touchRotate.dragStart(r,o),this.touchPitch&&this.touchPitch.dragStart(r,o),D.disableDrag()}moveMouse(r,o){const c=this.map,{bearingDelta:d}=this.mouseRotate.dragMove(r,o)||{};if(d&&c.setBearing(c.getBearing()+d),this.mousePitch){const{pitchDelta:g}=this.mousePitch.dragMove(r,o)||{};g&&c.setPitch(c.getPitch()+g)}}moveTouch(r,o){const c=this.map,{bearingDelta:d}=this.touchRotate.dragMove(r,o)||{};if(d&&c.setBearing(c.getBearing()+d),this.touchPitch){const{pitchDelta:g}=this.touchPitch.dragMove(r,o)||{};g&&c.setPitch(c.getPitch()+g)}}off(){const r=this.element;D.removeEventListener(r,"mousedown",this.mousedown),D.removeEventListener(r,"touchstart",this.touchstart,{passive:!1}),D.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.removeEventListener(window,"touchend",this.touchend),D.removeEventListener(r,"touchcancel",this.reset),this.offTemp()}offTemp(){D.enableDrag(),D.removeEventListener(window,"mousemove",this.mousemove),D.removeEventListener(window,"mouseup",this.mouseup),D.removeEventListener(window,"touchmove",this.touchmove,{passive:!1}),D.removeEventListener(window,"touchend",this.touchend)}}let dr;function Au(f,r,o){if(f=new u.L(f.lng,f.lat),r){const c=new u.L(f.lng-360,f.lat),d=new u.L(f.lng+360,f.lat),g=o.locationPoint(f).distSqr(r);o.locationPoint(c).distSqr(r)<g?f=c:o.locationPoint(d).distSqr(r)<g&&(f=d)}for(;Math.abs(f.lng-o.center.lng)>180;){const c=o.locationPoint(f);if(c.x>=0&&c.y>=0&&c.x<=o.width&&c.y<=o.height)break;f.lng>o.center.lng?f.lng-=360:f.lng+=360}return f}const Hn={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};function Dh(f,r,o){const c=f.classList;for(const d in Hn)c.remove(`maplibregl-${o}-anchor-${d}`);c.add(`maplibregl-${o}-anchor-${r}`)}class Ds extends u.E{constructor(r){if(super(),this._onKeyPress=o=>{const c=o.code,d=o.charCode||o.keyCode;c!=="Space"&&c!=="Enter"&&d!==32&&d!==13||this.togglePopup()},this._onMapClick=o=>{const c=o.originalEvent.target,d=this._element;this._popup&&(c===d||d.contains(c))&&this.togglePopup()},this._update=o=>{if(!this._map)return;const c=this._map.loaded()&&!this._map.isMoving();((o==null?void 0:o.type)==="terrain"||(o==null?void 0:o.type)==="render"&&!c)&&this._map.once("render",this._update),this._map.transform.renderWorldCopies&&(this._lngLat=Au(this._lngLat,this._pos,this._map.transform)),this._pos=this._map.project(this._lngLat)._add(this._offset);let d="";this._rotationAlignment==="viewport"||this._rotationAlignment==="auto"?d=`rotateZ(${this._rotation}deg)`:this._rotationAlignment==="map"&&(d=`rotateZ(${this._rotation-this._map.getBearing()}deg)`);let g="";this._pitchAlignment==="viewport"||this._pitchAlignment==="auto"?g="rotateX(0deg)":this._pitchAlignment==="map"&&(g=`rotateX(${this._map.getPitch()}deg)`),o&&o.type!=="moveend"||(this._pos=this._pos.round()),D.setTransform(this._element,`${Hn[this._anchor]} translate(${this._pos.x}px, ${this._pos.y}px) ${g} ${d}`),this._map.terrain&&!this._opacityTimeout&&(this._opacityTimeout=setTimeout(()=>{const x=this._map.unproject(this._pos),w=40075016686e-3*Math.abs(Math.cos(this._lngLat.lat*Math.PI/180))/Math.pow(2,this._map.transform.tileZoom+8);this._element.style.opacity=x.distanceTo(this._lngLat)>20*w?"0.2":"1.0",this._opacityTimeout=null},100))},this._onMove=o=>{if(!this._isDragging){const c=this._clickTolerance||this._map._clickTolerance;this._isDragging=o.point.dist(this._pointerdownPos)>=c}this._isDragging&&(this._pos=o.point.sub(this._positionDelta),this._lngLat=this._map.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new u.k("dragstart"))),this.fire(new u.k("drag")))},this._onUp=()=>{this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1,this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),this._state==="active"&&this.fire(new u.k("dragend")),this._state="inactive"},this._addDragHandler=o=>{this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(this._pos).add(this._offset),this._pointerdownPos=o.point,this._state="pending",this._map.on("mousemove",this._onMove),this._map.on("touchmove",this._onMove),this._map.once("mouseup",this._onUp),this._map.once("touchend",this._onUp))},this._anchor=r&&r.anchor||"center",this._color=r&&r.color||"#3FB1CE",this._scale=r&&r.scale||1,this._draggable=r&&r.draggable||!1,this._clickTolerance=r&&r.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=r&&r.rotation||0,this._rotationAlignment=r&&r.rotationAlignment||"auto",this._pitchAlignment=r&&r.pitchAlignment&&r.pitchAlignment!=="auto"?r.pitchAlignment:this._rotationAlignment,r&&r.element)this._element=r.element,this._offset=u.P.convert(r&&r.offset||[0,0]);else{this._defaultMarker=!0,this._element=D.create("div"),this._element.setAttribute("aria-label","Map marker");const o=D.createNS("http://www.w3.org/2000/svg","svg"),c=41,d=27;o.setAttributeNS(null,"display","block"),o.setAttributeNS(null,"height",`${c}px`),o.setAttributeNS(null,"width",`${d}px`),o.setAttributeNS(null,"viewBox",`0 0 ${d} ${c}`);const g=D.createNS("http://www.w3.org/2000/svg","g");g.setAttributeNS(null,"stroke","none"),g.setAttributeNS(null,"stroke-width","1"),g.setAttributeNS(null,"fill","none"),g.setAttributeNS(null,"fill-rule","evenodd");const x=D.createNS("http://www.w3.org/2000/svg","g");x.setAttributeNS(null,"fill-rule","nonzero");const w=D.createNS("http://www.w3.org/2000/svg","g");w.setAttributeNS(null,"transform","translate(3.0, 29.0)"),w.setAttributeNS(null,"fill","#000000");const T=[{rx:"10.5",ry:"5.25002273"},{rx:"10.5",ry:"5.25002273"},{rx:"9.5",ry:"4.77275007"},{rx:"8.5",ry:"4.29549936"},{rx:"7.5",ry:"3.81822308"},{rx:"6.5",ry:"3.34094679"},{rx:"5.5",ry:"2.86367051"},{rx:"4.5",ry:"2.38636864"}];for(const oe of T){const pe=D.createNS("http://www.w3.org/2000/svg","ellipse");pe.setAttributeNS(null,"opacity","0.04"),pe.setAttributeNS(null,"cx","10.5"),pe.setAttributeNS(null,"cy","5.80029008"),pe.setAttributeNS(null,"rx",oe.rx),pe.setAttributeNS(null,"ry",oe.ry),w.appendChild(pe)}const E=D.createNS("http://www.w3.org/2000/svg","g");E.setAttributeNS(null,"fill",this._color);const P=D.createNS("http://www.w3.org/2000/svg","path");P.setAttributeNS(null,"d","M27,13.5 C27,19.074644 20.250001,27.000002 14.75,34.500002 C14.016665,35.500004 12.983335,35.500004 12.25,34.500002 C6.7499993,27.000002 0,19.222562 0,13.5 C0,6.0441559 6.0441559,0 13.5,0 C20.955844,0 27,6.0441559 27,13.5 Z"),E.appendChild(P);const z=D.createNS("http://www.w3.org/2000/svg","g");z.setAttributeNS(null,"opacity","0.25"),z.setAttributeNS(null,"fill","#000000");const F=D.createNS("http://www.w3.org/2000/svg","path");F.setAttributeNS(null,"d","M13.5,0 C6.0441559,0 0,6.0441559 0,13.5 C0,19.222562 6.7499993,27 12.25,34.5 C13,35.522727 14.016664,35.500004 14.75,34.5 C20.250001,27 27,19.074644 27,13.5 C27,6.0441559 20.955844,0 13.5,0 Z M13.5,1 C20.415404,1 26,6.584596 26,13.5 C26,15.898657 24.495584,19.181431 22.220703,22.738281 C19.945823,26.295132 16.705119,30.142167 13.943359,33.908203 C13.743445,34.180814 13.612715,34.322738 13.5,34.441406 C13.387285,34.322738 13.256555,34.180814 13.056641,33.908203 C10.284481,30.127985 7.4148684,26.314159 5.015625,22.773438 C2.6163816,19.232715 1,15.953538 1,13.5 C1,6.584596 6.584596,1 13.5,1 Z"),z.appendChild(F);const q=D.createNS("http://www.w3.org/2000/svg","g");q.setAttributeNS(null,"transform","translate(6.0, 7.0)"),q.setAttributeNS(null,"fill","#FFFFFF");const $=D.createNS("http://www.w3.org/2000/svg","g");$.setAttributeNS(null,"transform","translate(8.0, 8.0)");const G=D.createNS("http://www.w3.org/2000/svg","circle");G.setAttributeNS(null,"fill","#000000"),G.setAttributeNS(null,"opacity","0.25"),G.setAttributeNS(null,"cx","5.5"),G.setAttributeNS(null,"cy","5.5"),G.setAttributeNS(null,"r","5.4999962");const U=D.createNS("http://www.w3.org/2000/svg","circle");U.setAttributeNS(null,"fill","#FFFFFF"),U.setAttributeNS(null,"cx","5.5"),U.setAttributeNS(null,"cy","5.5"),U.setAttributeNS(null,"r","5.4999962"),$.appendChild(G),$.appendChild(U),x.appendChild(w),x.appendChild(E),x.appendChild(z),x.appendChild(q),x.appendChild($),o.appendChild(x),o.setAttributeNS(null,"height",c*this._scale+"px"),o.setAttributeNS(null,"width",d*this._scale+"px"),this._element.appendChild(o),this._offset=u.P.convert(r&&r.offset||[0,-14])}if(this._element.classList.add("maplibregl-marker"),this._element.addEventListener("dragstart",o=>{o.preventDefault()}),this._element.addEventListener("mousedown",o=>{o.preventDefault()}),Dh(this._element,this._anchor,"marker"),r&&r.className)for(const o of r.className.split(" "))this._element.classList.add(o);this._popup=null}addTo(r){return this.remove(),this._map=r,r.getCanvasContainer().appendChild(this._element),r.on("move",this._update),r.on("moveend",this._update),r.on("terrain",this._update),this.setDraggable(this._draggable),this._update(),this._map.on("click",this._onMapClick),this}remove(){return this._opacityTimeout&&(clearTimeout(this._opacityTimeout),delete this._opacityTimeout),this._map&&(this._map.off("click",this._onMapClick),this._map.off("move",this._update),this._map.off("moveend",this._update),this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler),this._map.off("mouseup",this._onUp),this._map.off("touchend",this._onUp),this._map.off("mousemove",this._onMove),this._map.off("touchmove",this._onMove),delete this._map),D.remove(this._element),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(r){return this._lngLat=u.L.convert(r),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(),this}getElement(){return this._element}setPopup(r){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),r){if(!("offset"in r.options)){const d=Math.abs(13.5)/Math.SQRT2;r.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[d,-1*(38.1-13.5+d)],"bottom-right":[-d,-1*(38.1-13.5+d)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=r,this._lngLat&&this._popup.setLngLat(this._lngLat),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress)}return this}getPopup(){return this._popup}togglePopup(){const r=this._popup;return r?(r.isOpen()?r.remove():r.addTo(this._map),this):this}getOffset(){return this._offset}setOffset(r){return this._offset=u.P.convert(r),this._update(),this}addClassName(r){this._element.classList.add(r)}removeClassName(r){this._element.classList.remove(r)}toggleClassName(r){return this._element.classList.toggle(r)}setDraggable(r){return this._draggable=!!r,this._map&&(r?(this._map.on("mousedown",this._addDragHandler),this._map.on("touchstart",this._addDragHandler)):(this._map.off("mousedown",this._addDragHandler),this._map.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(r){return this._rotation=r||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(r){return this._rotationAlignment=r||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment}setPitchAlignment(r){return this._pitchAlignment=r&&r!=="auto"?r:this._rotationAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment}}const nr={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0};let Qt=0,go=!1;const ca={maxWidth:100,unit:"metric"};function ha(f,r,o){const c=o&&o.maxWidth||100,d=f._container.clientHeight/2,g=f.unproject([0,d]),x=f.unproject([c,d]),w=g.distanceTo(x);if(o&&o.unit==="imperial"){const T=3.2808*w;T>5280?Ls(r,c,T/5280,f._getUIString("ScaleControl.Miles")):Ls(r,c,T,f._getUIString("ScaleControl.Feet"))}else o&&o.unit==="nautical"?Ls(r,c,w/1852,f._getUIString("ScaleControl.NauticalMiles")):w>=1e3?Ls(r,c,w/1e3,f._getUIString("ScaleControl.Kilometers")):Ls(r,c,w,f._getUIString("ScaleControl.Meters"))}function Ls(f,r,o,c){const d=function(g){const x=Math.pow(10,`${Math.floor(g)}`.length-1);let w=g/x;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:w>=1?1:function(T){const E=Math.pow(10,Math.ceil(-Math.log(T)/Math.LN10));return Math.round(T*E)/E}(w),x*w}(o);f.style.width=r*(d/o)+"px",f.innerHTML=`${d}&nbsp;${c}`}const Du={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},Lu=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function yo(f){if(f){if(typeof f=="number"){const r=Math.round(Math.abs(f)/Math.SQRT2);return{center:new u.P(0,0),top:new u.P(0,f),"top-left":new u.P(r,r),"top-right":new u.P(-r,r),bottom:new u.P(0,-f),"bottom-left":new u.P(r,-r),"bottom-right":new u.P(-r,-r),left:new u.P(f,0),right:new u.P(-f,0)}}if(f instanceof u.P||Array.isArray(f)){const r=u.P.convert(f);return{center:r,top:r,"top-left":r,"top-right":r,bottom:r,"bottom-left":r,"bottom-right":r,left:r,right:r}}return{center:u.P.convert(f.center||[0,0]),top:u.P.convert(f.top||[0,0]),"top-left":u.P.convert(f["top-left"]||[0,0]),"top-right":u.P.convert(f["top-right"]||[0,0]),bottom:u.P.convert(f.bottom||[0,0]),"bottom-left":u.P.convert(f["bottom-left"]||[0,0]),"bottom-right":u.P.convert(f["bottom-right"]||[0,0]),left:u.P.convert(f.left||[0,0]),right:u.P.convert(f.right||[0,0])}}return yo(new u.P(0,0))}const Ru={extend:(f,...r)=>u.e(f,...r),run(f){f()},logToElement(f,r=!1,o="log"){const c=window.document.getElementById(o);c&&(r&&(c.innerHTML=""),c.innerHTML+=`<br>${f}`)}},Fu=B;class zt{static get version(){return Fu}static get workerCount(){return _i.workerCount}static set workerCount(r){_i.workerCount=r}static get maxParallelImageRequests(){return u.c.MAX_PARALLEL_IMAGE_REQUESTS}static set maxParallelImageRequests(r){u.c.MAX_PARALLEL_IMAGE_REQUESTS=r}static get workerUrl(){return u.c.WORKER_URL}static set workerUrl(r){u.c.WORKER_URL=r}static addProtocol(r,o){u.c.REGISTERED_PROTOCOLS[r]=o}static removeProtocol(r){delete u.c.REGISTERED_PROTOCOLS[r]}}return zt.Map=class extends Ph{constructor(f){if(u.bg.mark(u.bh.create),(f=u.e({},ot,f)).minZoom!=null&&f.maxZoom!=null&&f.minZoom>f.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(f.minPitch!=null&&f.maxPitch!=null&&f.minPitch>f.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(f.minPitch!=null&&f.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(f.maxPitch!=null&&f.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(super(new nl(f.minZoom,f.maxZoom,f.minPitch,f.maxPitch,f.renderWorldCopies),{bearingSnap:f.bearingSnap}),this._cooperativeGesturesOnWheel=r=>{this._onCooperativeGesture(r,r[this._metaKey],1)},this._contextLost=r=>{r.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new u.k("webglcontextlost",{originalEvent:r}))},this._contextRestored=r=>{this._setupPainter(),this.resize(),this._update(),this.fire(new u.k("webglcontextrestored",{originalEvent:r}))},this._onMapScroll=r=>{if(r.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1},this._onWindowOnline=()=>{this._update()},this._interactive=f.interactive,this._cooperativeGestures=f.cooperativeGestures,this._metaKey=navigator.platform.indexOf("Mac")===0?"metaKey":"ctrlKey",this._maxTileCacheSize=f.maxTileCacheSize,this._maxTileCacheZoomLevels=f.maxTileCacheZoomLevels,this._failIfMajorPerformanceCaveat=f.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=f.preserveDrawingBuffer,this._antialias=f.antialias,this._trackResize=f.trackResize,this._bearingSnap=f.bearingSnap,this._refreshExpiredTiles=f.refreshExpiredTiles,this._fadeDuration=f.fadeDuration,this._crossSourceCollisions=f.crossSourceCollisions,this._crossFadingFactor=1,this._collectResourceTiming=f.collectResourceTiming,this._renderTaskQueue=new al,this._controls=[],this._mapId=u.a2(),this._locale=u.e({},Pu,f.locale),this._clickTolerance=f.clickTolerance,this._overridePixelRatio=f.pixelRatio,this._maxCanvasSize=f.maxCanvasSize,this.transformCameraUpdate=f.transformCameraUpdate,this._imageQueueHandle=we.addThrottleControl(()=>this.isMoving()),this._requestManager=new ee(f.transformRequest),typeof f.container=="string"){if(this._container=document.getElementById(f.container),!this._container)throw new Error(`Container '${f.container}' not found.`)}else{if(!(f.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=f.container}if(f.maxBounds&&this.setMaxBounds(f.maxBounds),this._setupContainer(),this._setupPainter(),this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this.on("terrain",()=>{this.painter.terrainFacilitator.dirty=!0,this._update(!0)}),this.once("idle",()=>{this._idleTriggered=!0}),typeof window<"u"){addEventListener("online",this._onWindowOnline,!1);let r=!1;const o=As(c=>{this._trackResize&&!this._removed&&this.resize(c)._update()},50);this._resizeObserver=new ResizeObserver(c=>{r?o(c):r=!0}),this._resizeObserver.observe(this._container)}this.handlers=new Cu(this,f),this._cooperativeGestures&&this._setupCooperativeGestures(),this._hash=f.hash&&new ia(typeof f.hash=="string"&&f.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:f.center,zoom:f.zoom,bearing:f.bearing,pitch:f.pitch}),f.bounds&&(this.resize(),this.fitBounds(f.bounds,u.e({},f.fitBoundsOptions,{duration:0})))),this.resize(),this._localIdeographFontFamily=f.localIdeographFontFamily,this._validateStyle=f.validateStyle,f.style&&this.setStyle(f.style,{localIdeographFontFamily:f.localIdeographFontFamily}),f.attributionControl&&this.addControl(new Mn({customAttribution:f.customAttribution})),f.maplibreLogo&&this.addControl(new qt,f.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)}),this.on("data",r=>{this._update(r.dataType==="style"),this.fire(new u.k(`${r.dataType}data`,r))}),this.on("dataloading",r=>{this.fire(new u.k(`${r.dataType}dataloading`,r))}),this.on("dataabort",r=>{this.fire(new u.k("sourcedataabort",r))})}_getMapId(){return this._mapId}addControl(f,r){if(r===void 0&&(r=f.getDefaultPosition?f.getDefaultPosition():"top-right"),!f||!f.onAdd)return this.fire(new u.j(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const o=f.onAdd(this);this._controls.push(f);const c=this._controlPositions[r];return r.indexOf("bottom")!==-1?c.insertBefore(o,c.firstChild):c.appendChild(o),this}removeControl(f){if(!f||!f.onRemove)return this.fire(new u.j(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const r=this._controls.indexOf(f);return r>-1&&this._controls.splice(r,1),f.onRemove(this),this}hasControl(f){return this._controls.indexOf(f)>-1}calculateCameraOptionsFromTo(f,r,o,c){return c==null&&this.terrain&&(c=this.terrain.getElevationForLngLatZoom(o,this.transform.tileZoom)),super.calculateCameraOptionsFromTo(f,r,o,c)}resize(f){var r;const o=this._containerDimensions(),c=o[0],d=o[1],g=this._getClampedPixelRatio(c,d);if(this._resizeCanvas(c,d,g),this.painter.resize(c,d,g),this.painter.overLimit()){const w=this.painter.context.gl;this._maxCanvasSize=[w.drawingBufferWidth,w.drawingBufferHeight];const T=this._getClampedPixelRatio(c,d);this._resizeCanvas(c,d,T),this.painter.resize(c,d,T)}this.transform.resize(c,d),(r=this._requestedCameraState)===null||r===void 0||r.resize(c,d);const x=!this._moving;return x&&(this.stop(),this.fire(new u.k("movestart",f)).fire(new u.k("move",f))),this.fire(new u.k("resize",f)),x&&this.fire(new u.k("moveend",f)),this}_getClampedPixelRatio(f,r){const{0:o,1:c}=this._maxCanvasSize,d=this.getPixelRatio(),g=f*d,x=r*d;return Math.min(g>o?o/g:1,x>c?c/x:1)*d}getPixelRatio(){var f;return(f=this._overridePixelRatio)!==null&&f!==void 0?f:devicePixelRatio}setPixelRatio(f){this._overridePixelRatio=f,this.resize()}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()}setMaxBounds(f){return this.transform.setMaxBounds(At.convert(f)),this._update()}setMinZoom(f){if((f=f??-2)>=-2&&f<=this.transform.maxZoom)return this.transform.minZoom=f,this._update(),this.getZoom()<f&&this.setZoom(f),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(f){if((f=f??22)>=this.transform.minZoom)return this.transform.maxZoom=f,this._update(),this.getZoom()>f&&this.setZoom(f),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(f){if((f=f??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(f>=0&&f<=this.transform.maxPitch)return this.transform.minPitch=f,this._update(),this.getPitch()<f&&this.setPitch(f),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(f){if((f=f??60)>85)throw new Error("maxPitch must be less than or equal to 85");if(f>=this.transform.minPitch)return this.transform.maxPitch=f,this._update(),this.getPitch()>f&&this.setPitch(f),this;throw new Error("maxPitch must be greater than the current minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(f){return this.transform.renderWorldCopies=f,this._update()}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(f){return this._cooperativeGestures=f,this._cooperativeGestures?this._setupCooperativeGestures():this._destroyCooperativeGestures(),this}project(f){return this.transform.locationPoint(u.L.convert(f),this.style&&this.terrain)}unproject(f){return this.transform.pointLocation(u.P.convert(f),this.terrain)}isMoving(){var f;return this._moving||((f=this.handlers)===null||f===void 0?void 0:f.isMoving())}isZooming(){var f;return this._zooming||((f=this.handlers)===null||f===void 0?void 0:f.isZooming())}isRotating(){var f;return this._rotating||((f=this.handlers)===null||f===void 0?void 0:f.isRotating())}_createDelegatedListener(f,r,o){if(f==="mouseenter"||f==="mouseover"){let c=!1;return{layer:r,listener:o,delegates:{mousemove:g=>{const x=this.getLayer(r)?this.queryRenderedFeatures(g.point,{layers:[r]}):[];x.length?c||(c=!0,o.call(this,new zn(f,this,g.originalEvent,{features:x}))):c=!1},mouseout:()=>{c=!1}}}}if(f==="mouseleave"||f==="mouseout"){let c=!1;return{layer:r,listener:o,delegates:{mousemove:x=>{(this.getLayer(r)?this.queryRenderedFeatures(x.point,{layers:[r]}):[]).length?c=!0:c&&(c=!1,o.call(this,new zn(f,this,x.originalEvent)))},mouseout:x=>{c&&(c=!1,o.call(this,new zn(f,this,x.originalEvent)))}}}}{const c=d=>{const g=this.getLayer(r)?this.queryRenderedFeatures(d.point,{layers:[r]}):[];g.length&&(d.features=g,o.call(this,d),delete d.features)};return{layer:r,listener:o,delegates:{[f]:c}}}}on(f,r,o){if(o===void 0)return super.on(f,r);const c=this._createDelegatedListener(f,r,o);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[f]=this._delegatedListeners[f]||[],this._delegatedListeners[f].push(c);for(const d in c.delegates)this.on(d,c.delegates[d]);return this}once(f,r,o){if(o===void 0)return super.once(f,r);const c=this._createDelegatedListener(f,r,o);for(const d in c.delegates)this.once(d,c.delegates[d]);return this}off(f,r,o){return o===void 0?super.off(f,r):(this._delegatedListeners&&this._delegatedListeners[f]&&(c=>{const d=this._delegatedListeners[f];for(let g=0;g<d.length;g++){const x=d[g];if(x.layer===r&&x.listener===o){for(const w in x.delegates)this.off(w,x.delegates[w]);return d.splice(g,1),this}}})(),this)}queryRenderedFeatures(f,r){if(!this.style)return[];let o;const c=f instanceof u.P||Array.isArray(f),d=c?f:[[0,0],[this.transform.width,this.transform.height]];if(r=r||(c?{}:f)||{},d instanceof u.P||typeof d[0]=="number")o=[u.P.convert(d)];else{const g=u.P.convert(d[0]),x=u.P.convert(d[1]);o=[g,new u.P(x.x,g.y),x,new u.P(g.x,x.y),g]}return this.style.queryRenderedFeatures(o,r,this.transform)}querySourceFeatures(f,r){return this.style.querySourceFeatures(f,r)}setStyle(f,r){return(r=u.e({},{localIdeographFontFamily:this._localIdeographFontFamily,validate:this._validateStyle},r)).diff!==!1&&r.localIdeographFontFamily===this._localIdeographFontFamily&&this.style&&f?(this._diffStyle(f,r),this):(this._localIdeographFontFamily=r.localIdeographFontFamily,this._updateStyle(f,r))}setTransformRequest(f){return this._requestManager.setTransformRequest(f),this}_getUIString(f){const r=this._locale[f];if(r==null)throw new Error(`Missing UI string '${f}'`);return r}_updateStyle(f,r){if(r.transformStyle&&this.style&&!this.style._loaded)return void this.style.once("style.load",()=>this._updateStyle(f,r));const o=this.style&&r.transformStyle?this.style.serialize():void 0;return this.style&&(this.style.setEventedParent(null),this.style._remove(!f)),f?(this.style=new Fr(this,r||{}),this.style.setEventedParent(this,{style:this.style}),typeof f=="string"?this.style.loadURL(f,r,o):this.style.loadJSON(f,r,o),this):(delete this.style,this)}_lazyInitEmptyStyle(){this.style||(this.style=new Fr(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(f,r){if(typeof f=="string"){const o=this._requestManager.transformRequest(f,K.Style);u.f(o,(c,d)=>{c?this.fire(new u.j(c)):d&&this._updateDiff(d,r)})}else typeof f=="object"&&this._updateDiff(f,r)}_updateDiff(f,r){try{this.style.setState(f,r)&&this._update(!0)}catch(o){u.w(`Unable to perform style diff: ${o.message||o.error||o}.  Rebuilding the style from scratch.`),this._updateStyle(f,r)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():u.w("There is no style added to the map.")}addSource(f,r){return this._lazyInitEmptyStyle(),this.style.addSource(f,r),this._update(!0)}isSourceLoaded(f){const r=this.style&&this.style.sourceCaches[f];if(r!==void 0)return r.loaded();this.fire(new u.j(new Error(`There is no source with ID '${f}'`)))}setTerrain(f){if(this.style._checkLoaded(),this._terrainDataCallback&&this.style.off("data",this._terrainDataCallback),f){const r=this.style.sourceCaches[f.source];if(!r)throw new Error(`cannot load terrain, because there exists no source with ID: ${f.source}`);for(const o in this.style._layers){const c=this.style._layers[o];c.type==="hillshade"&&c.source===f.source&&u.w("You are using the same source for a hillshade layer and for 3D terrain. Please consider using two separate sources to improve rendering quality.")}this.terrain=new Ah(this.painter,r,f),this.painter.renderToTexture=new ll(this.painter,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._terrainDataCallback=o=>{o.dataType==="style"?this.terrain.sourceCache.freeRtt():o.dataType==="source"&&o.tile&&(o.sourceId!==f.source||this._elevationFreeze||(this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom)),this.terrain.sourceCache.freeRtt(o.tile.tileID))},this.style.on("data",this._terrainDataCallback)}else this.terrain&&this.terrain.sourceCache.destruct(),this.terrain=null,this.painter.renderToTexture&&this.painter.renderToTexture.destruct(),this.painter.renderToTexture=null,this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0;return this.fire(new u.k("terrain",{terrain:f})),this}getTerrain(){var f,r;return(r=(f=this.terrain)===null||f===void 0?void 0:f.options)!==null&&r!==void 0?r:null}areTilesLoaded(){const f=this.style&&this.style.sourceCaches;for(const r in f){const o=f[r]._tiles;for(const c in o){const d=o[c];if(d.state!=="loaded"&&d.state!=="errored")return!1}}return!0}addSourceType(f,r,o){return this._lazyInitEmptyStyle(),this.style.addSourceType(f,r,o)}removeSource(f){return this.style.removeSource(f),this._update(!0)}getSource(f){return this.style.getSource(f)}addImage(f,r,o={}){const{pixelRatio:c=1,sdf:d=!1,stretchX:g,stretchY:x,content:w}=o;if(this._lazyInitEmptyStyle(),!(r instanceof HTMLImageElement||u.a(r))){if(r.width===void 0||r.height===void 0)return this.fire(new u.j(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));{const{width:T,height:E,data:P}=r,z=r;return this.style.addImage(f,{data:new u.R({width:T,height:E},new Uint8Array(P)),pixelRatio:c,stretchX:g,stretchY:x,content:w,sdf:d,version:0,userImage:z}),z.onAdd&&z.onAdd(this,f),this}}{const{width:T,height:E,data:P}=u.h.getImageData(r);this.style.addImage(f,{data:new u.R({width:T,height:E},P),pixelRatio:c,stretchX:g,stretchY:x,content:w,sdf:d,version:0})}}updateImage(f,r){const o=this.style.getImage(f);if(!o)return this.fire(new u.j(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const c=r instanceof HTMLImageElement||u.a(r)?u.h.getImageData(r):r,{width:d,height:g,data:x}=c;if(d===void 0||g===void 0)return this.fire(new u.j(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(d!==o.data.width||g!==o.data.height)return this.fire(new u.j(new Error("The width and height of the updated image must be that same as the previous version of the image")));const w=!(r instanceof HTMLImageElement||u.a(r));return o.data.replace(x,w),this.style.updateImage(f,o),this}getImage(f){return this.style.getImage(f)}hasImage(f){return f?!!this.style.getImage(f):(this.fire(new u.j(new Error("Missing required image id"))),!1)}removeImage(f){this.style.removeImage(f)}loadImage(f,r){we.getImage(this._requestManager.transformRequest(f,K.Image),r)}listImages(){return this.style.listImages()}addLayer(f,r){return this._lazyInitEmptyStyle(),this.style.addLayer(f,r),this._update(!0)}moveLayer(f,r){return this.style.moveLayer(f,r),this._update(!0)}removeLayer(f){return this.style.removeLayer(f),this._update(!0)}getLayer(f){return this.style.getLayer(f)}getLayersOrder(){return this.style.getLayersOrder()}setLayerZoomRange(f,r,o){return this.style.setLayerZoomRange(f,r,o),this._update(!0)}setFilter(f,r,o={}){return this.style.setFilter(f,r,o),this._update(!0)}getFilter(f){return this.style.getFilter(f)}setPaintProperty(f,r,o,c={}){return this.style.setPaintProperty(f,r,o,c),this._update(!0)}getPaintProperty(f,r){return this.style.getPaintProperty(f,r)}setLayoutProperty(f,r,o,c={}){return this.style.setLayoutProperty(f,r,o,c),this._update(!0)}getLayoutProperty(f,r){return this.style.getLayoutProperty(f,r)}setGlyphs(f,r={}){return this._lazyInitEmptyStyle(),this.style.setGlyphs(f,r),this._update(!0)}getGlyphs(){return this.style.getGlyphsUrl()}addSprite(f,r,o={}){return this._lazyInitEmptyStyle(),this.style.addSprite(f,r,o,c=>{c||this._update(!0)}),this}removeSprite(f){return this._lazyInitEmptyStyle(),this.style.removeSprite(f),this._update(!0)}getSprite(){return this.style.getSprite()}setSprite(f,r={}){return this._lazyInitEmptyStyle(),this.style.setSprite(f,r,o=>{o||this._update(!0)}),this}setLight(f,r={}){return this._lazyInitEmptyStyle(),this.style.setLight(f,r),this._update(!0)}getLight(){return this.style.getLight()}setFeatureState(f,r){return this.style.setFeatureState(f,r),this._update()}removeFeatureState(f,r){return this.style.removeFeatureState(f,r),this._update()}getFeatureState(f){return this.style.getFeatureState(f)}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}_containerDimensions(){let f=0,r=0;return this._container&&(f=this._container.clientWidth||400,r=this._container.clientHeight||300),[f,r]}_setupContainer(){const f=this._container;f.classList.add("maplibregl-map");const r=this._canvasContainer=D.create("div","maplibregl-canvas-container",f);this._interactive&&r.classList.add("maplibregl-interactive"),this._canvas=D.create("canvas","maplibregl-canvas",r),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label","Map"),this._canvas.setAttribute("role","region");const o=this._containerDimensions(),c=this._getClampedPixelRatio(o[0],o[1]);this._resizeCanvas(o[0],o[1],c);const d=this._controlContainer=D.create("div","maplibregl-control-container",f),g=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach(x=>{g[x]=D.create("div",`maplibregl-ctrl-${x} `,d)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_setupCooperativeGestures(){this._cooperativeGesturesScreen=D.create("div","maplibregl-cooperative-gesture-screen",this._container);let f=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.windowsHelpText?this._cooperativeGestures.windowsHelpText:"Use Ctrl + scroll to zoom the map";navigator.platform.indexOf("Mac")===0&&(f=typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.macHelpText?this._cooperativeGestures.macHelpText:"Use  + scroll to zoom the map"),this._cooperativeGesturesScreen.innerHTML=`
            <div class="maplibregl-desktop-message">${f}</div>
            <div class="maplibregl-mobile-message">${typeof this._cooperativeGestures!="boolean"&&this._cooperativeGestures.mobileHelpText?this._cooperativeGestures.mobileHelpText:"Use two fingers to move the map"}</div>
        `,this._cooperativeGesturesScreen.setAttribute("aria-hidden","true"),this._canvasContainer.addEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.add("maplibregl-cooperative-gestures")}_destroyCooperativeGestures(){D.remove(this._cooperativeGesturesScreen),this._canvasContainer.removeEventListener("wheel",this._cooperativeGesturesOnWheel,!1),this._canvasContainer.classList.remove("maplibregl-cooperative-gestures")}_resizeCanvas(f,r,o){this._canvas.width=Math.floor(o*f),this._canvas.height=Math.floor(o*r),this._canvas.style.width=`${f}px`,this._canvas.style.height=`${r}px`}_setupPainter(){const f={alpha:!0,stencil:!0,depth:!0,failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1};let r=null;this._canvas.addEventListener("webglcontextcreationerror",c=>{r={requestedAttributes:f},c&&(r.statusMessage=c.statusMessage,r.type=c.type)},{once:!0});const o=this._canvas.getContext("webgl2",f)||this._canvas.getContext("webgl",f);if(!o){const c="Failed to initialize WebGL";throw r?(r.message=c,new Error(JSON.stringify(r))):new Error(c)}this.painter=new Ms(o,this.transform),ne.testSupport(o)}_onCooperativeGesture(f,r,o){return!r&&o<2&&(this._cooperativeGesturesScreen.classList.add("maplibregl-show"),setTimeout(()=>{this._cooperativeGesturesScreen.classList.remove("maplibregl-show")},100)),!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(f){return this.style&&this.style._loaded?(this._styleDirty=this._styleDirty||f,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(f){return this._update(),this._renderTaskQueue.add(f)}_cancelRenderFrame(f){this._renderTaskQueue.remove(f)}_render(f){const r=this._idleTriggered?this._fadeDuration:0;if(this.painter.context.setDirty(),this.painter.setBaseState(),this._renderTaskQueue.run(f),this._removed)return;let o=!1;if(this.style&&this._styleDirty){this._styleDirty=!1;const d=this.transform.zoom,g=u.h.now();this.style.zoomHistory.update(d,g);const x=new u.a8(d,{now:g,fadeDuration:r,zoomHistory:this.style.zoomHistory,transition:this.style.getTransition()}),w=x.crossFadingFactor();w===1&&w===this._crossFadingFactor||(o=!0,this._crossFadingFactor=w),this.style.update(x)}this.style&&this._sourcesDirty&&(this._sourcesDirty=!1,this.style._updateSources(this.transform)),this.terrain?(this.terrain.sourceCache.update(this.transform,this.terrain),this.transform._minEleveationForCurrentTile=this.terrain.getMinTileElevationForLngLatZoom(this.transform.center,this.transform.tileZoom),this._elevationFreeze||(this.transform.elevation=this.terrain.getElevationForLngLatZoom(this.transform.center,this.transform.tileZoom))):(this.transform._minEleveationForCurrentTile=0,this.transform.elevation=0),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,r,this._crossSourceCollisions),this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showOverdrawInspector:this._showOverdrawInspector,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:r,showPadding:this.showPadding}),this.fire(new u.k("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,u.bg.mark(u.bh.load),this.fire(new u.k("load"))),this.style&&(this.style.hasTransitions()||o)&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles();const c=this._sourcesDirty||this._styleDirty||this._placementDirty;return c||this._repaint?this.triggerRepaint():!this.isMoving()&&this.loaded()&&this.fire(new u.k("idle")),!this._loaded||this._fullyLoaded||c||(this._fullyLoaded=!0,u.bg.mark(u.bh.fullLoad)),this}redraw(){return this.style&&(this._frame&&(this._frame.cancel(),this._frame=null),this._render(0)),this}remove(){var f;this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this.painter.destroy(),this.handlers.destroy(),delete this.handlers,this.setStyle(null),typeof window<"u"&&removeEventListener("online",this._onWindowOnline,!1),we.removeThrottleControl(this._imageQueueHandle),(f=this._resizeObserver)===null||f===void 0||f.disconnect();const r=this.painter.context.gl.getExtension("WEBGL_lose_context");r&&r.loseContext(),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),D.remove(this._canvasContainer),D.remove(this._controlContainer),this._cooperativeGestures&&this._destroyCooperativeGestures(),this._container.classList.remove("maplibregl-map"),u.bg.clearMetrics(),this._removed=!0,this.fire(new u.k("remove"))}triggerRepaint(){this.style&&!this._frame&&(this._frame=u.h.frame(f=>{u.bg.frame(f),this._frame=null,this._render(f)}))}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(f){this._showTileBoundaries!==f&&(this._showTileBoundaries=f,this._update())}get showPadding(){return!!this._showPadding}set showPadding(f){this._showPadding!==f&&(this._showPadding=f,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(f){this._showCollisionBoxes!==f&&(this._showCollisionBoxes=f,f?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(f){this._showOverdrawInspector!==f&&(this._showOverdrawInspector=f,this._update())}get repaint(){return!!this._repaint}set repaint(f){this._repaint!==f&&(this._repaint=f,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(f){this._vertices=f,this._update()}get version(){return et}getCameraTargetElevation(){return this.transform.elevation}},zt.NavigationControl=class{constructor(f){this._updateZoomButtons=()=>{const r=this._map.getZoom(),o=r===this._map.getMaxZoom(),c=r===this._map.getMinZoom();this._zoomInButton.disabled=o,this._zoomOutButton.disabled=c,this._zoomInButton.setAttribute("aria-disabled",o.toString()),this._zoomOutButton.setAttribute("aria-disabled",c.toString())},this._rotateCompassArrow=()=>{const r=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(this._map.transform.pitch*(Math.PI/180)),.5)}) rotateX(${this._map.transform.pitch}deg) rotateZ(${this._map.transform.angle*(180/Math.PI)}deg)`:`rotate(${this._map.transform.angle*(180/Math.PI)}deg)`;this._compassIcon.style.transform=r},this._setButtonTitle=(r,o)=>{const c=this._map._getUIString(`NavigationControl.${o}`);r.title=c,r.setAttribute("aria-label",c)},this.options=u.e({},zu,f),this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._container.addEventListener("contextmenu",r=>r.preventDefault()),this.options.showZoom&&(this._zoomInButton=this._createButton("maplibregl-ctrl-zoom-in",r=>this._map.zoomIn({},{originalEvent:r})),D.create("span","maplibregl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("maplibregl-ctrl-zoom-out",r=>this._map.zoomOut({},{originalEvent:r})),D.create("span","maplibregl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(this._compass=this._createButton("maplibregl-ctrl-compass",r=>{this.options.visualizePitch?this._map.resetNorthPitch({},{originalEvent:r}):this._map.resetNorth({},{originalEvent:r})}),this._compassIcon=D.create("span","maplibregl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}onAdd(f){return this._map=f,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),this._map.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&this._map.on("pitch",this._rotateCompassArrow),this._map.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Mu(this._map,this._compass,this.options.visualizePitch)),this._container}onRemove(){D.remove(this._container),this.options.showZoom&&this._map.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&this._map.off("pitch",this._rotateCompassArrow),this._map.off("rotate",this._rotateCompassArrow),this._handler.off(),delete this._handler),delete this._map}_createButton(f,r){const o=D.create("button",f,this._container);return o.type="button",o.addEventListener("click",r),o}},zt.GeolocateControl=class extends u.E{constructor(f){super(),this._onSuccess=r=>{if(this._map){if(this._isOutOfMapMaxBounds(r))return this._setErrorState(),this.fire(new u.k("outofmaxbounds",r)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=r,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background");break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(r),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(r),this.options.showUserLocation&&this._dotElement.classList.remove("maplibregl-user-location-dot-stale"),this.fire(new u.k("geolocate",r)),this._finish()}},this._updateCamera=r=>{const o=new u.L(r.coords.longitude,r.coords.latitude),c=r.coords.accuracy,d=this._map.getBearing(),g=u.e({bearing:d},this.options.fitBoundsOptions),x=At.fromLngLat(o,c);this._map.fitBounds(x,g,{geolocateSource:!0})},this._updateMarker=r=>{if(r){const o=new u.L(r.coords.longitude,r.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=r.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()},this._onZoom=()=>{this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()},this._onError=r=>{if(this._map){if(this.options.trackUserLocation)if(r.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(r.code===3&&go)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("maplibregl-user-location-dot-stale"),this.fire(new u.k("error",r)),this._finish()}},this._finish=()=>{this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0},this._setupUI=r=>{if(this._map){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=D.create("button","maplibregl-ctrl-geolocate",this._container),D.create("span","maplibregl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",r===!1){u.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.title=o,this._geolocateButton.setAttribute("aria-label",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=D.create("div","maplibregl-user-location-dot"),this._userLocationDotMarker=new Ds({element:this._dotElement}),this._circleElement=D.create("div","maplibregl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ds({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this.fire(new u.k("trackuserlocationend")))})}},this.options=u.e({},nr,f)}onAdd(f){return this._map=f,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),function(r,o=!1){dr===void 0||o?window.navigator.permissions!==void 0?window.navigator.permissions.query({name:"geolocation"}).then(c=>{dr=c.state!=="denied",r(dr)}).catch(()=>{dr=!!window.navigator.geolocation,r(dr)}):(dr=!!window.navigator.geolocation,r(dr)):r(dr)}(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),D.remove(this._container),this._map.off("zoom",this._onZoom),this._map=void 0,Qt=0,go=!1}_isOutOfMapMaxBounds(f){const r=this._map.getMaxBounds(),o=f.coords;return r&&(o.longitude<r.getWest()||o.longitude>r.getEast()||o.latitude<r.getSouth()||o.latitude>r.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting");break;case"ACTIVE_ERROR":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}}_updateCircleRadius(){const f=this._map.getBounds(),r=f.getSouthEast(),o=f.getNorthEast(),c=r.distanceTo(o),d=Math.ceil(this._accuracy/(c/this._map._container.clientHeight)*2);this._circleElement.style.width=`${d}px`,this._circleElement.style.height=`${d}px`}trigger(){if(!this._setup)return u.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new u.k("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":Qt--,go=!1,this._watchState="OFF",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background-error"),this.fire(new u.k("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new u.k("trackuserlocationstart"));break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-active");break;case"OFF":break;default:throw new Error(`Unexpected watchState ${this._watchState}`)}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let f;this._geolocateButton.classList.add("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),Qt++,Qt>1?(f={maximumAge:6e5,timeout:0},go=!0):(f=this.options.positionOptions,go=!1),this._geolocationWatchID=window.navigator.geolocation.watchPosition(this._onSuccess,this._onError,f)}}else window.navigator.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_clearWatch(){window.navigator.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("maplibregl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},zt.AttributionControl=Mn,zt.LogoControl=qt,zt.ScaleControl=class{constructor(f){this._onMove=()=>{ha(this._map,this._container,this.options)},this.setUnit=r=>{this.options.unit=r,ha(this._map,this._container,this.options)},this.options=u.e({},ca,f)}getDefaultPosition(){return"bottom-left"}onAdd(f){return this._map=f,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-scale",f.getContainer()),this._map.on("move",this._onMove),this._onMove(),this._container}onRemove(){D.remove(this._container),this._map.off("move",this._onMove),this._map=void 0}},zt.FullscreenControl=class extends u.E{constructor(f={}){super(),this._onFullscreenChange=()=>{(window.document.fullscreenElement||window.document.mozFullScreenElement||window.document.webkitFullscreenElement||window.document.msFullscreenElement)===this._container!==this._fullscreen&&this._handleFullscreenChange()},this._onClickFullscreen=()=>{this._isFullscreen()?this._exitFullscreen():this._requestFullscreen()},this._fullscreen=!1,f&&f.container&&(f.container instanceof HTMLElement?this._container=f.container:u.w("Full screen control 'container' must be a DOM element.")),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onmozfullscreenchange"in document?this._fullscreenchange="mozfullscreenchange":"onwebkitfullscreenchange"in document?this._fullscreenchange="webkitfullscreenchange":"onmsfullscreenchange"in document&&(this._fullscreenchange="MSFullscreenChange")}onAdd(f){return this._map=f,this._container||(this._container=this._map.getContainer()),this._controlContainer=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._setupUI(),this._controlContainer}onRemove(){D.remove(this._controlContainer),this._map=null,window.document.removeEventListener(this._fullscreenchange,this._onFullscreenChange)}_setupUI(){const f=this._fullscreenButton=D.create("button","maplibregl-ctrl-fullscreen",this._controlContainer);D.create("span","maplibregl-ctrl-icon",f).setAttribute("aria-hidden","true"),f.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),window.document.addEventListener(this._fullscreenchange,this._onFullscreenChange)}_updateTitle(){const f=this._getTitle();this._fullscreenButton.setAttribute("aria-label",f),this._fullscreenButton.title=f}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_handleFullscreenChange(){this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("maplibregl-ctrl-shrink"),this._fullscreenButton.classList.toggle("maplibregl-ctrl-fullscreen"),this._updateTitle(),this._fullscreen?(this.fire(new u.k("fullscreenstart")),this._map._cooperativeGestures&&(this._prevCooperativeGestures=this._map._cooperativeGestures,this._map.setCooperativeGestures())):(this.fire(new u.k("fullscreenend")),this._prevCooperativeGestures&&(this._map.setCooperativeGestures(this._prevCooperativeGestures),delete this._prevCooperativeGestures))}_exitFullscreen(){window.document.exitFullscreen?window.document.exitFullscreen():window.document.mozCancelFullScreen?window.document.mozCancelFullScreen():window.document.msExitFullscreen?window.document.msExitFullscreen():window.document.webkitCancelFullScreen?window.document.webkitCancelFullScreen():this._togglePseudoFullScreen()}_requestFullscreen(){this._container.requestFullscreen?this._container.requestFullscreen():this._container.mozRequestFullScreen?this._container.mozRequestFullScreen():this._container.msRequestFullscreen?this._container.msRequestFullscreen():this._container.webkitRequestFullscreen?this._container.webkitRequestFullscreen():this._togglePseudoFullScreen()}_togglePseudoFullScreen(){this._container.classList.toggle("maplibregl-pseudo-fullscreen"),this._handleFullscreenChange(),this._map.resize()}},zt.TerrainControl=class{constructor(f){this._toggleTerrain=()=>{this._map.getTerrain()?this._map.setTerrain(null):this._map.setTerrain(this.options),this._updateTerrainIcon()},this._updateTerrainIcon=()=>{this._terrainButton.classList.remove("maplibregl-ctrl-terrain"),this._terrainButton.classList.remove("maplibregl-ctrl-terrain-enabled"),this._map.terrain?(this._terrainButton.classList.add("maplibregl-ctrl-terrain-enabled"),this._terrainButton.title=this._map._getUIString("TerrainControl.disableTerrain")):(this._terrainButton.classList.add("maplibregl-ctrl-terrain"),this._terrainButton.title=this._map._getUIString("TerrainControl.enableTerrain"))},this.options=f}onAdd(f){return this._map=f,this._container=D.create("div","maplibregl-ctrl maplibregl-ctrl-group"),this._terrainButton=D.create("button","maplibregl-ctrl-terrain",this._container),D.create("span","maplibregl-ctrl-icon",this._terrainButton).setAttribute("aria-hidden","true"),this._terrainButton.type="button",this._terrainButton.addEventListener("click",this._toggleTerrain),this._updateTerrainIcon(),this._map.on("terrain",this._updateTerrainIcon),this._container}onRemove(){D.remove(this._container),this._map.off("terrain",this._updateTerrainIcon),this._map=void 0}},zt.Popup=class extends u.E{constructor(f){super(),this.remove=()=>(this._content&&D.remove(this._content),this._container&&(D.remove(this._container),delete this._container),this._map&&(this._map.off("move",this._update),this._map.off("move",this._onClose),this._map.off("click",this._onClose),this._map.off("remove",this.remove),this._map.off("mousemove",this._onMouseMove),this._map.off("mouseup",this._onMouseUp),this._map.off("drag",this._onDrag),delete this._map),this.fire(new u.k("close")),this),this._onMouseUp=r=>{this._update(r.point)},this._onMouseMove=r=>{this._update(r.point)},this._onDrag=r=>{this._update(r.point)},this._update=r=>{if(!this._map||!this._lngLat&&!this._trackPointer||!this._content)return;if(!this._container){if(this._container=D.create("div","maplibregl-popup",this._map.getContainer()),this._tip=D.create("div","maplibregl-popup-tip",this._container),this._container.appendChild(this._content),this.options.className)for(const x of this.options.className.split(" "))this._container.classList.add(x);this._trackPointer&&this._container.classList.add("maplibregl-popup-track-pointer")}if(this.options.maxWidth&&this._container.style.maxWidth!==this.options.maxWidth&&(this._container.style.maxWidth=this.options.maxWidth),this._map.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Au(this._lngLat,this._pos,this._map.transform)),this._trackPointer&&!r)return;const o=this._pos=this._trackPointer&&r?r:this._map.project(this._lngLat);let c=this.options.anchor;const d=yo(this.options.offset);if(!c){const x=this._container.offsetWidth,w=this._container.offsetHeight;let T;T=o.y+d.bottom.y<w?["top"]:o.y>this._map.transform.height-w?["bottom"]:[],o.x<x/2?T.push("left"):o.x>this._map.transform.width-x/2&&T.push("right"),c=T.length===0?"bottom":T.join("-")}const g=o.add(d[c]).round();D.setTransform(this._container,`${Hn[c]} translate(${g.x}px,${g.y}px)`),Dh(this._container,c,"popup")},this._onClose=()=>{this.remove()},this.options=u.e(Object.create(Du),f)}addTo(f){return this._map&&this.remove(),this._map=f,this.options.closeOnClick&&this._map.on("click",this._onClose),this.options.closeOnMove&&this._map.on("move",this._onClose),this._map.on("remove",this.remove),this._update(),this._focusFirstElement(),this._trackPointer?(this._map.on("mousemove",this._onMouseMove),this._map.on("mouseup",this._onMouseUp),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")):this._map.on("move",this._update),this.fire(new u.k("open")),this}isOpen(){return!!this._map}getLngLat(){return this._lngLat}setLngLat(f){return this._lngLat=u.L.convert(f),this._pos=null,this._trackPointer=!1,this._update(),this._map&&(this._map.on("move",this._update),this._map.off("mousemove",this._onMouseMove),this._container&&this._container.classList.remove("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.remove("maplibregl-track-pointer")),this}trackPointer(){return this._trackPointer=!0,this._pos=null,this._update(),this._map&&(this._map.off("move",this._update),this._map.on("mousemove",this._onMouseMove),this._map.on("drag",this._onDrag),this._container&&this._container.classList.add("maplibregl-popup-track-pointer"),this._map._canvasContainer.classList.add("maplibregl-track-pointer")),this}getElement(){return this._container}setText(f){return this.setDOMContent(document.createTextNode(f))}setHTML(f){const r=document.createDocumentFragment(),o=document.createElement("body");let c;for(o.innerHTML=f;c=o.firstChild,c;)r.appendChild(c);return this.setDOMContent(r)}getMaxWidth(){var f;return(f=this._container)===null||f===void 0?void 0:f.style.maxWidth}setMaxWidth(f){return this.options.maxWidth=f,this._update(),this}setDOMContent(f){if(this._content)for(;this._content.hasChildNodes();)this._content.firstChild&&this._content.removeChild(this._content.firstChild);else this._content=D.create("div","maplibregl-popup-content",this._container);return this._content.appendChild(f),this._createCloseButton(),this._update(),this._focusFirstElement(),this}addClassName(f){this._container&&this._container.classList.add(f)}removeClassName(f){this._container&&this._container.classList.remove(f)}setOffset(f){return this.options.offset=f,this._update(),this}toggleClassName(f){if(this._container)return this._container.classList.toggle(f)}_createCloseButton(){this.options.closeButton&&(this._closeButton=D.create("button","maplibregl-popup-close-button",this._content),this._closeButton.type="button",this._closeButton.setAttribute("aria-label","Close popup"),this._closeButton.innerHTML="&#215;",this._closeButton.addEventListener("click",this._onClose))}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const f=this._container.querySelector(Lu);f&&f.focus()}},zt.Marker=Ds,zt.Style=Fr,zt.LngLat=u.L,zt.LngLatBounds=At,zt.Point=u.P,zt.MercatorCoordinate=u.U,zt.Evented=u.E,zt.AJAXError=u.bi,zt.config=u.c,zt.CanvasSource=ss,zt.GeoJSONSource=is,zt.ImageSource=Un,zt.RasterDEMTileSource=ni,zt.RasterTileSource=dn,zt.VectorTileSource=ri,zt.VideoSource=Ho,zt.setRTLTextPlugin=u.bj,zt.getRTLTextPluginStatus=u.bk,zt.prewarm=function(){La().acquire(Et)},zt.clearPrewarmedResources=function(){const f=Fi;f&&(f.isPreloaded()&&f.numActive()===1?(f.release(Et),Fi=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},Ru.extend(zt,{isSafari:u.ac,getPerformanceMetrics:u.bg.getPerformanceMetrics}),zt});var I=_;return I})})(pw);var yk=pw.exports;const E0=J0(yk);const _k=({coordinates:t})=>{const i=hr.useRef(null),l=hr.useRef(null);return hr.useEffect(()=>{l.current=new E0.Map({container:i.current,style:"https://tiles.basemaps.cartocdn.com/gl/dark-matter-gl-style/style.json",center:t,zoom:t[0]!==0&&t[1]!==0?10:2}),new E0.Marker().setLngLat(t).addTo(l.current);const p=()=>{l.current&&l.current.resize()};return window.addEventListener("resize",p),()=>{window.removeEventListener("resize",p),l.current&&l.current.remove()}},[t]),Ur.jsx("div",{className:"map",ref:i})};var mw={exports:{}},gw={};/**
 * @license React
 * use-sync-external-store-with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Xc=hr;function vk(t,i){return t===i&&(t!==0||1/t===1/i)||t!==t&&i!==i}var xk=typeof Object.is=="function"?Object.is:vk,wk=Xc.useSyncExternalStore,bk=Xc.useRef,Sk=Xc.useEffect,Tk=Xc.useMemo,kk=Xc.useDebugValue;gw.useSyncExternalStoreWithSelector=function(t,i,l,p,_){var b=bk(null);if(b.current===null){var I={hasValue:!1,value:null};b.current=I}else I=b.current;b=Tk(function(){function B(_e){if(!D){if(D=!0,ne=_e,_e=p(_e),_!==void 0&&I.hasValue){var be=I.value;if(_(be,_e))return re=be}return re=_e}if(be=re,xk(ne,_e))return be;var ke=p(_e);return _!==void 0&&_(be,ke)?be:(ne=_e,re=ke)}var D=!1,ne,re,te=l===void 0?null:l;return[function(){return B(i())},te===null?void 0:function(){return B(te())}]},[i,l,p,_]);var u=wk(t,b[0],b[1]);return Sk(function(){I.hasValue=!0,I.value=u},[u]),kk(u),u};mw.exports=gw;var Ek=mw.exports,hi="default"in bm?Mg:bm,I0=Symbol.for("react-redux-context"),C0=typeof globalThis<"u"?globalThis:{};function Ik(){if(!hi.createContext)return{};const t=C0[I0]??(C0[I0]=new Map);let i=t.get(hi.createContext);return i||(i=hi.createContext(null),t.set(hi.createContext,i)),i}var $o=Ik(),Ck=()=>{throw new Error("uSES not initialized!")};function by(t=$o){return function(){return hi.useContext(t)}}var yw=by(),_w=Ck,Pk=t=>{_w=t},zk=(t,i)=>t===i;function Mk(t=$o){const i=t===$o?yw:by(t),l=(p,_={})=>{const{equalityFn:b=zk,devModeChecks:I={}}=typeof _=="function"?{equalityFn:_}:_,{store:u,subscription:B,getServerState:D,stabilityCheck:ne,identityFunctionCheck:re}=i();hi.useRef(!0);const te=hi.useCallback({[p.name](be){return p(be)}}[p.name],[p,ne,I.stabilityCheck]),_e=_w(B.addNestedSub,u.getState,D||u.getState,te,b);return hi.useDebugValue(_e),_e};return Object.assign(l,{withTypes:()=>l}),l}var Ak=Mk();function Dk(t){t()}function Lk(){let t=null,i=null;return{clear(){t=null,i=null},notify(){Dk(()=>{let l=t;for(;l;)l.callback(),l=l.next})},get(){const l=[];let p=t;for(;p;)l.push(p),p=p.next;return l},subscribe(l){let p=!0;const _=i={callback:l,next:null,prev:i};return _.prev?_.prev.next=_:t=_,function(){!p||t===null||(p=!1,_.next?_.next.prev=_.prev:i=_.prev,_.prev?_.prev.next=_.next:t=_.next)}}}}var P0={notify(){},get:()=>[]};function Rk(t,i){let l,p=P0,_=0,b=!1;function I(ke){ne();const we=p.subscribe(ke);let K=!1;return()=>{K||(K=!0,we(),re())}}function u(){p.notify()}function B(){be.onStateChange&&be.onStateChange()}function D(){return b}function ne(){_++,l||(l=i?i.addNestedSub(B):t.subscribe(B),p=Lk())}function re(){_--,l&&_===0&&(l(),l=void 0,p.clear(),p=P0)}function te(){b||(b=!0,ne())}function _e(){b&&(b=!1,re())}const be={addNestedSub:I,notifyNestedSubs:u,handleChangeWrapper:B,isSubscribed:D,trySubscribe:te,tryUnsubscribe:_e,getListeners:()=>p};return be}var Fk=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",Bk=Fk?hi.useLayoutEffect:hi.useEffect;function Ok({store:t,context:i,children:l,serverState:p,stabilityCheck:_="once",identityFunctionCheck:b="once"}){const I=hi.useMemo(()=>{const D=Rk(t);return{store:t,subscription:D,getServerState:p?()=>p:void 0,stabilityCheck:_,identityFunctionCheck:b}},[t,p,_,b]),u=hi.useMemo(()=>t.getState(),[t]);Bk(()=>{const{subscription:D}=I;return D.onStateChange=D.notifyNestedSubs,D.trySubscribe(),u!==t.getState()&&D.notifyNestedSubs(),()=>{D.tryUnsubscribe(),D.onStateChange=void 0}},[I,u]);const B=i||$o;return hi.createElement(B.Provider,{value:I},l)}var Nk=Ok;function vw(t=$o){const i=t===$o?yw:by(t),l=()=>{const{store:p}=i();return p};return Object.assign(l,{withTypes:()=>l}),l}var Vk=vw();function Uk(t=$o){const i=t===$o?Vk:vw(t),l=()=>i().dispatch;return Object.assign(l,{withTypes:()=>l}),l}var jk=Uk();Pk(Ek.useSyncExternalStoreWithSelector);const xw=jk,ww=Ak;function an(t){return`Minified Redux error #${t}; visit https://redux.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}var $k=(()=>typeof Symbol=="function"&&Symbol.observable||"@@observable")(),z0=$k,ym=()=>Math.random().toString(36).substring(7).split("").join("."),qk={INIT:`@@redux/INIT${ym()}`,REPLACE:`@@redux/REPLACE${ym()}`,PROBE_UNKNOWN_ACTION:()=>`@@redux/PROBE_UNKNOWN_ACTION${ym()}`},cp=qk;function Sy(t){if(typeof t!="object"||t===null)return!1;let i=t;for(;Object.getPrototypeOf(i)!==null;)i=Object.getPrototypeOf(i);return Object.getPrototypeOf(t)===i||Object.getPrototypeOf(t)===null}function Ty(t,i,l){if(typeof t!="function")throw new Error(an(2));if(typeof i=="function"&&typeof l=="function"||typeof l=="function"&&typeof arguments[3]=="function")throw new Error(an(0));if(typeof i=="function"&&typeof l>"u"&&(l=i,i=void 0),typeof l<"u"){if(typeof l!="function")throw new Error(an(1));return l(Ty)(t,i)}let p=t,_=i,b=new Map,I=b,u=0,B=!1;function D(){I===b&&(I=new Map,b.forEach((we,K)=>{I.set(K,we)}))}function ne(){if(B)throw new Error(an(3));return _}function re(we){if(typeof we!="function")throw new Error(an(4));if(B)throw new Error(an(5));let K=!0;D();const ee=u++;return I.set(ee,we),function(){if(K){if(B)throw new Error(an(6));K=!1,D(),I.delete(ee),b=null}}}function te(we){if(!Sy(we))throw new Error(an(7));if(typeof we.type>"u")throw new Error(an(8));if(typeof we.type!="string")throw new Error(an(17));if(B)throw new Error(an(9));try{B=!0,_=p(_,we)}finally{B=!1}return(b=I).forEach(ee=>{ee()}),we}function _e(we){if(typeof we!="function")throw new Error(an(10));p=we,te({type:cp.REPLACE})}function be(){const we=re;return{subscribe(K){if(typeof K!="object"||K===null)throw new Error(an(11));function ee(){const ye=K;ye.next&&ye.next(ne())}return ee(),{unsubscribe:we(ee)}},[z0](){return this}}}return te({type:cp.INIT}),{dispatch:te,subscribe:re,getState:ne,replaceReducer:_e,[z0]:be}}function Zk(t){Object.keys(t).forEach(i=>{const l=t[i];if(typeof l(void 0,{type:cp.INIT})>"u")throw new Error(an(12));if(typeof l(void 0,{type:cp.PROBE_UNKNOWN_ACTION()})>"u")throw new Error(an(13))})}function bw(t){const i=Object.keys(t),l={};for(let b=0;b<i.length;b++){const I=i[b];typeof t[I]=="function"&&(l[I]=t[I])}const p=Object.keys(l);let _;try{Zk(l)}catch(b){_=b}return function(I={},u){if(_)throw _;let B=!1;const D={};for(let ne=0;ne<p.length;ne++){const re=p[ne],te=l[re],_e=I[re],be=te(_e,u);if(typeof be>"u")throw u&&u.type,new Error(an(14));D[re]=be,B=B||be!==_e}return B=B||p.length!==Object.keys(I).length,B?D:I}}function hp(...t){return t.length===0?i=>i:t.length===1?t[0]:t.reduce((i,l)=>(...p)=>i(l(...p)))}function Gk(...t){return i=>(l,p)=>{const _=i(l,p);let b=()=>{throw new Error(an(15))};const I={getState:_.getState,dispatch:(B,...D)=>b(B,...D)},u=t.map(B=>B(I));return b=hp(...u)(_.dispatch),{..._,dispatch:b}}}function Wk(t){return Sy(t)&&"type"in t&&typeof t.type=="string"}var Sw=Symbol.for("immer-nothing"),M0=Symbol.for("immer-draftable"),fi=Symbol.for("immer-state");function Ji(t,...i){throw new Error(`[Immer] minified error nr: ${t}. Full error at: https://bit.ly/3cXEKWf`)}var Gl=Object.getPrototypeOf;function qo(t){return!!t&&!!t[fi]}function Js(t){var i;return t?Tw(t)||Array.isArray(t)||!!t[M0]||!!((i=t.constructor)!=null&&i[M0])||Ap(t)||Dp(t):!1}var Hk=Object.prototype.constructor.toString();function Tw(t){if(!t||typeof t!="object")return!1;const i=Gl(t);if(i===null)return!0;const l=Object.hasOwnProperty.call(i,"constructor")&&i.constructor;return l===Object?!0:typeof l=="function"&&Function.toString.call(l)===Hk}function Uc(t,i){Mp(t)===0?Object.entries(t).forEach(([l,p])=>{i(l,p,t)}):t.forEach((l,p)=>i(p,l,t))}function Mp(t){const i=t[fi];return i?i.type_:Array.isArray(t)?1:Ap(t)?2:Dp(t)?3:0}function gg(t,i){return Mp(t)===2?t.has(i):Object.prototype.hasOwnProperty.call(t,i)}function kw(t,i,l){const p=Mp(t);p===2?t.set(i,l):p===3?t.add(l):t[i]=l}function Xk(t,i){return t===i?t!==0||1/t===1/i:t!==t&&i!==i}function Ap(t){return t instanceof Map}function Dp(t){return t instanceof Set}function va(t){return t.copy_||t.base_}function yg(t,i){if(Ap(t))return new Map(t);if(Dp(t))return new Set(t);if(Array.isArray(t))return Array.prototype.slice.call(t);if(!i&&Tw(t))return Gl(t)?{...t}:Object.assign(Object.create(null),t);const l=Object.getOwnPropertyDescriptors(t);delete l[fi];let p=Reflect.ownKeys(l);for(let _=0;_<p.length;_++){const b=p[_],I=l[b];I.writable===!1&&(I.writable=!0,I.configurable=!0),(I.get||I.set)&&(l[b]={configurable:!0,writable:!0,enumerable:I.enumerable,value:t[b]})}return Object.create(Gl(t),l)}function ky(t,i=!1){return Lp(t)||qo(t)||!Js(t)||(Mp(t)>1&&(t.set=t.add=t.clear=t.delete=Kk),Object.freeze(t),i&&Uc(t,(l,p)=>ky(p,!0))),t}function Kk(){Ji(2)}function Lp(t){return Object.isFrozen(t)}var Yk={};function Ma(t){const i=Yk[t];return i||Ji(0,t),i}var jc;function Ew(){return jc}function Qk(t,i){return{drafts_:[],parent_:t,immer_:i,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function A0(t,i){i&&(Ma("Patches"),t.patches_=[],t.inversePatches_=[],t.patchListener_=i)}function _g(t){vg(t),t.drafts_.forEach(Jk),t.drafts_=null}function vg(t){t===jc&&(jc=t.parent_)}function D0(t){return jc=Qk(jc,t)}function Jk(t){const i=t[fi];i.type_===0||i.type_===1?i.revoke_():i.revoked_=!0}function L0(t,i){i.unfinalizedDrafts_=i.drafts_.length;const l=i.drafts_[0];return t!==void 0&&t!==l?(l[fi].modified_&&(_g(i),Ji(4)),Js(t)&&(t=dp(i,t),i.parent_||pp(i,t)),i.patches_&&Ma("Patches").generateReplacementPatches_(l[fi].base_,t,i.patches_,i.inversePatches_)):t=dp(i,l,[]),_g(i),i.patches_&&i.patchListener_(i.patches_,i.inversePatches_),t!==Sw?t:void 0}function dp(t,i,l){if(Lp(i))return i;const p=i[fi];if(!p)return Uc(i,(_,b)=>R0(t,p,i,_,b,l)),i;if(p.scope_!==t)return i;if(!p.modified_)return pp(t,p.base_,!0),p.base_;if(!p.finalized_){p.finalized_=!0,p.scope_.unfinalizedDrafts_--;const _=p.copy_;let b=_,I=!1;p.type_===3&&(b=new Set(_),_.clear(),I=!0),Uc(b,(u,B)=>R0(t,p,_,u,B,l,I)),pp(t,_,!1),l&&t.patches_&&Ma("Patches").generatePatches_(p,l,t.patches_,t.inversePatches_)}return p.copy_}function R0(t,i,l,p,_,b,I){if(qo(_)){const u=b&&i&&i.type_!==3&&!gg(i.assigned_,p)?b.concat(p):void 0,B=dp(t,_,u);if(kw(l,p,B),qo(B))t.canAutoFreeze_=!1;else return}else I&&l.add(_);if(Js(_)&&!Lp(_)){if(!t.immer_.autoFreeze_&&t.unfinalizedDrafts_<1)return;dp(t,_),(!i||!i.scope_.parent_)&&pp(t,_)}}function pp(t,i,l=!1){!t.parent_&&t.immer_.autoFreeze_&&t.canAutoFreeze_&&ky(i,l)}function eE(t,i){const l=Array.isArray(t),p={type_:l?1:0,scope_:i?i.scope_:Ew(),modified_:!1,finalized_:!1,assigned_:{},parent_:i,base_:t,draft_:null,copy_:null,revoke_:null,isManual_:!1};let _=p,b=Ey;l&&(_=[p],b=$c);const{revoke:I,proxy:u}=Proxy.revocable(_,b);return p.draft_=u,p.revoke_=I,u}var Ey={get(t,i){if(i===fi)return t;const l=va(t);if(!gg(l,i))return tE(t,l,i);const p=l[i];return t.finalized_||!Js(p)?p:p===_m(t.base_,i)?(vm(t),t.copy_[i]=wg(p,t)):p},has(t,i){return i in va(t)},ownKeys(t){return Reflect.ownKeys(va(t))},set(t,i,l){const p=Iw(va(t),i);if(p!=null&&p.set)return p.set.call(t.draft_,l),!0;if(!t.modified_){const _=_m(va(t),i),b=_==null?void 0:_[fi];if(b&&b.base_===l)return t.copy_[i]=l,t.assigned_[i]=!1,!0;if(Xk(l,_)&&(l!==void 0||gg(t.base_,i)))return!0;vm(t),xg(t)}return t.copy_[i]===l&&(l!==void 0||i in t.copy_)||Number.isNaN(l)&&Number.isNaN(t.copy_[i])||(t.copy_[i]=l,t.assigned_[i]=!0),!0},deleteProperty(t,i){return _m(t.base_,i)!==void 0||i in t.base_?(t.assigned_[i]=!1,vm(t),xg(t)):delete t.assigned_[i],t.copy_&&delete t.copy_[i],!0},getOwnPropertyDescriptor(t,i){const l=va(t),p=Reflect.getOwnPropertyDescriptor(l,i);return p&&{writable:!0,configurable:t.type_!==1||i!=="length",enumerable:p.enumerable,value:l[i]}},defineProperty(){Ji(11)},getPrototypeOf(t){return Gl(t.base_)},setPrototypeOf(){Ji(12)}},$c={};Uc(Ey,(t,i)=>{$c[t]=function(){return arguments[0]=arguments[0][0],i.apply(this,arguments)}});$c.deleteProperty=function(t,i){return $c.set.call(this,t,i,void 0)};$c.set=function(t,i,l){return Ey.set.call(this,t[0],i,l,t[0])};function _m(t,i){const l=t[fi];return(l?va(l):t)[i]}function tE(t,i,l){var _;const p=Iw(i,l);return p?"value"in p?p.value:(_=p.get)==null?void 0:_.call(t.draft_):void 0}function Iw(t,i){if(!(i in t))return;let l=Gl(t);for(;l;){const p=Object.getOwnPropertyDescriptor(l,i);if(p)return p;l=Gl(l)}}function xg(t){t.modified_||(t.modified_=!0,t.parent_&&xg(t.parent_))}function vm(t){t.copy_||(t.copy_=yg(t.base_,t.scope_.immer_.useStrictShallowCopy_))}var rE=class{constructor(t){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(i,l,p)=>{if(typeof i=="function"&&typeof l!="function"){const b=l;l=i;const I=this;return function(B=b,...D){return I.produce(B,ne=>l.call(this,ne,...D))}}typeof l!="function"&&Ji(6),p!==void 0&&typeof p!="function"&&Ji(7);let _;if(Js(i)){const b=D0(this),I=wg(i,void 0);let u=!0;try{_=l(I),u=!1}finally{u?_g(b):vg(b)}return A0(b,p),L0(_,b)}else if(!i||typeof i!="object"){if(_=l(i),_===void 0&&(_=i),_===Sw&&(_=void 0),this.autoFreeze_&&ky(_,!0),p){const b=[],I=[];Ma("Patches").generateReplacementPatches_(i,_,b,I),p(b,I)}return _}else Ji(1,i)},this.produceWithPatches=(i,l)=>{if(typeof i=="function")return(I,...u)=>this.produceWithPatches(I,B=>i(B,...u));let p,_;return[this.produce(i,l,(I,u)=>{p=I,_=u}),p,_]},typeof(t==null?void 0:t.autoFreeze)=="boolean"&&this.setAutoFreeze(t.autoFreeze),typeof(t==null?void 0:t.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(t.useStrictShallowCopy)}createDraft(t){Js(t)||Ji(8),qo(t)&&(t=Cw(t));const i=D0(this),l=wg(t,void 0);return l[fi].isManual_=!0,vg(i),l}finishDraft(t,i){const l=t&&t[fi];(!l||!l.isManual_)&&Ji(9);const{scope_:p}=l;return A0(p,i),L0(void 0,p)}setAutoFreeze(t){this.autoFreeze_=t}setUseStrictShallowCopy(t){this.useStrictShallowCopy_=t}applyPatches(t,i){let l;for(l=i.length-1;l>=0;l--){const _=i[l];if(_.path.length===0&&_.op==="replace"){t=_.value;break}}l>-1&&(i=i.slice(l+1));const p=Ma("Patches").applyPatches_;return qo(t)?p(t,i):this.produce(t,_=>p(_,i))}};function wg(t,i){const l=Ap(t)?Ma("MapSet").proxyMap_(t,i):Dp(t)?Ma("MapSet").proxySet_(t,i):eE(t,i);return(i?i.scope_:Ew()).drafts_.push(l),l}function Cw(t){return qo(t)||Ji(10,t),Pw(t)}function Pw(t){if(!Js(t)||Lp(t))return t;const i=t[fi];let l;if(i){if(!i.modified_)return i.base_;i.finalized_=!0,l=yg(t,i.scope_.immer_.useStrictShallowCopy_)}else l=yg(t,!0);return Uc(l,(p,_)=>{kw(l,p,Pw(_))}),i&&(i.finalized_=!1),l}var mi=new rE,zw=mi.produce;mi.produceWithPatches.bind(mi);mi.setAutoFreeze.bind(mi);mi.setUseStrictShallowCopy.bind(mi);mi.applyPatches.bind(mi);mi.createDraft.bind(mi);mi.finishDraft.bind(mi);function nE(t,i=`expected a function, instead received ${typeof t}`){if(typeof t!="function")throw new TypeError(i)}function iE(t,i=`expected an object, instead received ${typeof t}`){if(typeof t!="object")throw new TypeError(i)}function sE(t,i="expected all items to be functions, instead received the following types: "){if(!t.every(l=>typeof l=="function")){const l=t.map(p=>typeof p=="function"?`function ${p.name||"unnamed"}()`:typeof p).join(", ");throw new TypeError(`${i}[${l}]`)}}var F0=t=>Array.isArray(t)?t:[t];function oE(t){const i=Array.isArray(t[0])?t[0]:t;return sE(i,"createSelector expects all input-selectors to be functions, but received the following types: "),i}function aE(t,i){const l=[],{length:p}=t;for(let _=0;_<p;_++)l.push(t[_].apply(null,i));return l}var lE=class{constructor(t){this.value=t}deref(){return this.value}},uE=typeof WeakRef<"u"?WeakRef:lE,cE=0,B0=1;function xd(){return{s:cE,v:void 0,o:null,p:null}}function Iy(t,i={}){let l=xd();const{resultEqualityCheck:p}=i;let _,b=0;function I(){var re;let u=l;const{length:B}=arguments;for(let te=0,_e=B;te<_e;te++){const be=arguments[te];if(typeof be=="function"||typeof be=="object"&&be!==null){let ke=u.o;ke===null&&(u.o=ke=new WeakMap);const we=ke.get(be);we===void 0?(u=xd(),ke.set(be,u)):u=we}else{let ke=u.p;ke===null&&(u.p=ke=new Map);const we=ke.get(be);we===void 0?(u=xd(),ke.set(be,u)):u=we}}const D=u;let ne;if(u.s===B0?ne=u.v:(ne=t.apply(null,arguments),b++),D.s=B0,p){const te=((re=_==null?void 0:_.deref)==null?void 0:re.call(_))??_;te!=null&&p(te,ne)&&(ne=te,b!==0&&b--),_=typeof ne=="object"&&ne!==null||typeof ne=="function"?new uE(ne):ne}return D.v=ne,ne}return I.clearCache=()=>{l=xd(),I.resetResultsCount()},I.resultsCount=()=>b,I.resetResultsCount=()=>{b=0},I}function Mw(t,...i){const l=typeof t=="function"?{memoize:t,memoizeOptions:i}:t,p=(..._)=>{let b=0,I=0,u,B={},D=_.pop();typeof D=="object"&&(B=D,D=_.pop()),nE(D,`createSelector expects an output function after the inputs, but received: [${typeof D}]`);const ne={...l,...B},{memoize:re,memoizeOptions:te=[],argsMemoize:_e=Iy,argsMemoizeOptions:be=[],devModeChecks:ke={}}=ne,we=F0(te),K=F0(be),ee=oE(_),ce=re(function(){return b++,D.apply(null,arguments)},...we),ye=_e(function(){I++;const Le=aE(ee,arguments);return u=ce.apply(null,Le),u},...K);return Object.assign(ye,{resultFunc:D,memoizedResultFunc:ce,dependencies:ee,dependencyRecomputations:()=>I,resetDependencyRecomputations:()=>{I=0},lastResult:()=>u,recomputations:()=>b,resetRecomputations:()=>{b=0},memoize:re,argsMemoize:_e})};return Object.assign(p,{withTypes:()=>p}),p}var hE=Mw(Iy),dE=Object.assign((t,i=hE)=>{iE(t,`createStructuredSelector expects first argument to be an object where each property is a selector, instead received a ${typeof t}`);const l=Object.keys(t),p=l.map(b=>t[b]);return i(p,(...b)=>b.reduce((I,u,B)=>(I[l[B]]=u,I),{}))},{withTypes:()=>dE});function Aw(t){return({dispatch:l,getState:p})=>_=>b=>typeof b=="function"?b(l,p,t):_(b)}var pE=Aw(),fE=Aw,mE=(...t)=>{const i=Mw(...t);return(...l)=>{const p=i(...l),_=(b,...I)=>p(qo(b)?Cw(b):b,...I);return Object.assign(_,p),_}};mE(Iy);var gE=typeof window<"u"&&window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__:function(){if(arguments.length!==0)return typeof arguments[0]=="object"?hp:hp.apply(null,arguments)},yE=t=>t&&typeof t.match=="function";function Vo(t,i){function l(...p){if(i){let _=i(...p);if(!_)throw new Error(rs(0));return{type:t,payload:_.payload,..."meta"in _&&{meta:_.meta},..."error"in _&&{error:_.error}}}return{type:t,payload:p[0]}}return l.toString=()=>`${t}`,l.type=t,l.match=p=>Wk(p)&&p.type===t,l}var Dw=class fc extends Array{constructor(...i){super(...i),Object.setPrototypeOf(this,fc.prototype)}static get[Symbol.species](){return fc}concat(...i){return super.concat.apply(this,i)}prepend(...i){return i.length===1&&Array.isArray(i[0])?new fc(...i[0].concat(this)):new fc(...i.concat(this))}};function O0(t){return Js(t)?zw(t,()=>{}):t}function N0(t,i,l){if(t.has(i)){let _=t.get(i);return l.update&&(_=l.update(_,i,t),t.set(i,_)),_}if(!l.insert)throw new Error(rs(10));const p=l.insert(i,t);return t.set(i,p),p}function _E(t){return typeof t=="boolean"}var vE=()=>function(i){const{thunk:l=!0,immutableCheck:p=!0,serializableCheck:_=!0,actionCreatorCheck:b=!0}=i??{};let I=new Dw;return l&&(_E(l)?I.push(pE):I.push(fE(l.extraArgument))),I},xE="RTK_autoBatch",Lw=t=>i=>{setTimeout(i,t)},wE=typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame:Lw(10),bE=(t={type:"raf"})=>i=>(...l)=>{const p=i(...l);let _=!0,b=!1,I=!1;const u=new Set,B=t.type==="tick"?queueMicrotask:t.type==="raf"?wE:t.type==="callback"?t.queueNotification:Lw(t.timeout),D=()=>{I=!1,b&&(b=!1,u.forEach(ne=>ne()))};return Object.assign({},p,{subscribe(ne){const re=()=>_&&ne(),te=p.subscribe(re);return u.add(ne),()=>{te(),u.delete(ne)}},dispatch(ne){var re;try{return _=!((re=ne==null?void 0:ne.meta)!=null&&re[xE]),b=!_,b&&(I||(I=!0,B(D))),p.dispatch(ne)}finally{_=!0}}})},SE=t=>function(l){const{autoBatch:p=!0}=l??{};let _=new Dw(t);return p&&_.push(bE(typeof p=="object"?p:void 0)),_},TE=!0;function kE(t){const i=vE(),{reducer:l=void 0,middleware:p,devTools:_=!0,preloadedState:b=void 0,enhancers:I=void 0}=t||{};let u;if(typeof l=="function")u=l;else if(Sy(l))u=bw(l);else throw new Error(rs(1));let B;typeof p=="function"?B=p(i):B=i();let D=hp;_&&(D=gE({trace:!TE,...typeof _=="object"&&_}));const ne=Gk(...B),re=SE(ne);let te=typeof I=="function"?I(re):re();const _e=D(...te);return Ty(u,b,_e)}function Rw(t){const i={},l=[];let p;const _={addCase(b,I){const u=typeof b=="string"?b:b.type;if(!u)throw new Error(rs(28));if(u in i)throw new Error(rs(29));return i[u]=I,_},addMatcher(b,I){return l.push({matcher:b,reducer:I}),_},addDefaultCase(b){return p=b,_}};return t(_),[i,l,p]}function EE(t){return typeof t=="function"}function IE(t,i){let[l,p,_]=Rw(i),b;if(EE(t))b=()=>O0(t());else{const u=O0(t);b=()=>u}function I(u=b(),B){let D=[l[B.type],...p.filter(({matcher:ne})=>ne(B)).map(({reducer:ne})=>ne)];return D.filter(ne=>!!ne).length===0&&(D=[_]),D.reduce((ne,re)=>{if(re)if(qo(ne)){const _e=re(ne,B);return _e===void 0?ne:_e}else{if(Js(ne))return zw(ne,te=>re(te,B));{const te=re(ne,B);if(te===void 0){if(ne===null)return ne;throw new Error(rs(9))}return te}}return ne},u)}return I.getInitialState=b,I}var CE="ModuleSymbhasOwnPr-0123456789ABCDEFGHNRVfgctiUvz_KqYTJkLxpZXIjQW",PE=(t=21)=>{let i="",l=t;for(;l--;)i+=CE[Math.random()*64|0];return i},zE=(t,i)=>yE(t)?t.match(i):t(i);function ME(...t){return i=>t.some(l=>zE(l,i))}var AE=["name","message","stack","code"],xm=class{constructor(t,i){qf(this,"_type");this.payload=t,this.meta=i}},V0=class{constructor(t,i){qf(this,"_type");this.payload=t,this.meta=i}},DE=t=>{if(typeof t=="object"&&t!==null){const i={};for(const l of AE)typeof t[l]=="string"&&(i[l]=t[l]);return i}return{message:String(t)}},LE=(()=>{function t(i,l,p){const _=Vo(i+"/fulfilled",(B,D,ne,re)=>({payload:B,meta:{...re||{},arg:ne,requestId:D,requestStatus:"fulfilled"}})),b=Vo(i+"/pending",(B,D,ne)=>({payload:void 0,meta:{...ne||{},arg:D,requestId:B,requestStatus:"pending"}})),I=Vo(i+"/rejected",(B,D,ne,re,te)=>({payload:re,error:(p&&p.serializeError||DE)(B||"Rejected"),meta:{...te||{},arg:ne,requestId:D,rejectedWithValue:!!re,requestStatus:"rejected",aborted:(B==null?void 0:B.name)==="AbortError",condition:(B==null?void 0:B.name)==="ConditionError"}}));function u(B){return(D,ne,re)=>{const te=p!=null&&p.idGenerator?p.idGenerator(B):PE(),_e=new AbortController;let be;function ke(K){be=K,_e.abort()}const we=async function(){var ce,ye;let K;try{let Pe=(ce=p==null?void 0:p.condition)==null?void 0:ce.call(p,B,{getState:ne,extra:re});if(FE(Pe)&&(Pe=await Pe),Pe===!1||_e.signal.aborted)throw{name:"ConditionError",message:"Aborted due to condition callback returning false."};const Le=new Promise((je,Ze)=>_e.signal.addEventListener("abort",()=>Ze({name:"AbortError",message:be||"Aborted"})));D(b(te,B,(ye=p==null?void 0:p.getPendingMeta)==null?void 0:ye.call(p,{requestId:te,arg:B},{getState:ne,extra:re}))),K=await Promise.race([Le,Promise.resolve(l(B,{dispatch:D,getState:ne,extra:re,requestId:te,signal:_e.signal,abort:ke,rejectWithValue:(je,Ze)=>new xm(je,Ze),fulfillWithValue:(je,Ze)=>new V0(je,Ze)})).then(je=>{if(je instanceof xm)throw je;return je instanceof V0?_(je.payload,te,B,je.meta):_(je,te,B)})])}catch(Pe){K=Pe instanceof xm?I(null,te,B,Pe.payload,Pe.meta):I(Pe,te,B)}return p&&!p.dispatchConditionRejection&&I.match(K)&&K.meta.condition||D(K),K}();return Object.assign(we,{abort:ke,requestId:te,arg:B,unwrap(){return we.then(RE)}})}}return Object.assign(u,{pending:b,rejected:I,fulfilled:_,settled:ME(I,_),typePrefix:i})}return t.withTypes=()=>t,t})();function RE(t){if(t.meta&&t.meta.rejectedWithValue)throw t.payload;if(t.error)throw t.error;return t.payload}function FE(t){return t!==null&&typeof t=="object"&&typeof t.then=="function"}var BE=Symbol.for("rtk-slice-createasyncthunk");function OE(t,i){return`${t}/${i}`}function NE({creators:t}={}){var l;const i=(l=t==null?void 0:t.asyncThunk)==null?void 0:l[BE];return function(_){const{name:b,reducerPath:I=b}=_;if(!b)throw new Error(rs(11));typeof process<"u";const u=(typeof _.reducers=="function"?_.reducers(jE()):_.reducers)||{},B=Object.keys(u),D={sliceCaseReducersByName:{},sliceCaseReducersByType:{},actionCreators:{},sliceMatchers:[]},ne={addCase(we,K){const ee=typeof we=="string"?we:we.type;if(!ee)throw new Error(rs(12));if(ee in D.sliceCaseReducersByType)throw new Error(rs(13));return D.sliceCaseReducersByType[ee]=K,ne},addMatcher(we,K){return D.sliceMatchers.push({matcher:we,reducer:K}),ne},exposeAction(we,K){return D.actionCreators[we]=K,ne},exposeCaseReducer(we,K){return D.sliceCaseReducersByName[we]=K,ne}};B.forEach(we=>{const K=u[we],ee={reducerName:we,type:OE(b,we),createNotation:typeof _.reducers=="function"};qE(K)?GE(ee,K,ne,i):$E(ee,K,ne)});function re(){const[we={},K=[],ee=void 0]=typeof _.extraReducers=="function"?Rw(_.extraReducers):[_.extraReducers],ce={...we,...D.sliceCaseReducersByType};return IE(_.initialState,ye=>{for(let Pe in ce)ye.addCase(Pe,ce[Pe]);for(let Pe of D.sliceMatchers)ye.addMatcher(Pe.matcher,Pe.reducer);for(let Pe of K)ye.addMatcher(Pe.matcher,Pe.reducer);ee&&ye.addDefaultCase(ee)})}const te=we=>we,_e=new WeakMap;let be;const ke={name:b,reducerPath:I,reducer(we,K){return be||(be=re()),be(we,K)},actions:D.actionCreators,caseReducers:D.sliceCaseReducersByName,getInitialState(){return be||(be=re()),be.getInitialState()},getSelectors(we=te){const K=N0(_e,this,{insert:()=>new WeakMap});return N0(K,we,{insert:()=>{const ee={};for(const[ce,ye]of Object.entries(_.selectors??{}))ee[ce]=VE(this,ye,we,this!==ke);return ee}})},selectSlice(we){let K=we[this.reducerPath];return typeof K>"u"&&this!==ke&&(K=this.getInitialState()),K},get selectors(){return this.getSelectors(this.selectSlice)},injectInto(we,{reducerPath:K,...ee}={}){const ce=K??this.reducerPath;return we.inject({reducerPath:ce,reducer:this.reducer},ee),{...this,reducerPath:ce}}};return ke}}function VE(t,i,l,p){function _(b,...I){let u=l.call(t,b);return typeof u>"u"&&p&&(u=t.getInitialState()),i(u,...I)}return _.unwrapped=i,_}var UE=NE();function jE(){function t(i,l){return{_reducerDefinitionType:"asyncThunk",payloadCreator:i,...l}}return t.withTypes=()=>t,{reducer(i){return Object.assign({[i.name](...l){return i(...l)}}[i.name],{_reducerDefinitionType:"reducer"})},preparedReducer(i,l){return{_reducerDefinitionType:"reducerWithPrepare",prepare:i,reducer:l}},asyncThunk:t}}function $E({type:t,reducerName:i,createNotation:l},p,_){let b,I;if("reducer"in p){if(l&&!ZE(p))throw new Error(rs(17));b=p.reducer,I=p.prepare}else b=p;_.addCase(t,b).exposeCaseReducer(i,b).exposeAction(i,I?Vo(t,I):Vo(t))}function qE(t){return t._reducerDefinitionType==="asyncThunk"}function ZE(t){return t._reducerDefinitionType==="reducerWithPrepare"}function GE({type:t,reducerName:i},l,p,_){if(!_)throw new Error(rs(18));const{payloadCreator:b,fulfilled:I,pending:u,rejected:B,settled:D,options:ne}=l,re=_(t,b,ne);p.exposeAction(i,re),I&&p.addCase(re.fulfilled,I),u&&p.addCase(re.pending,u),B&&p.addCase(re.rejected,B),D&&p.addMatcher(re.settled,D),p.exposeCaseReducer(i,{fulfilled:I||wd,pending:u||wd,rejected:B||wd,settled:D||wd})}function wd(){}var Cy="listenerMiddleware";Vo(`${Cy}/add`);Vo(`${Cy}/removeAll`);Vo(`${Cy}/remove`);function rs(t){return`Minified Redux Toolkit error #${t}; visit https://redux-toolkit.js.org/Errors?code=${t} for the full message or use the non-minified dev environment for full errors. `}const Fw=t=>t.ok?t:Promise.reject(t),WE=(t,i)=>fetch(t,{method:i,headers:{"Content-Type":"application/json"}}).then(l=>Fw(l)),HE=t=>WE(`https://api.geoapify.com/v1/geocode/autocomplete?text=${t}&format=json&apiKey=2856b3c4c0964cb5b0f4bba275fe0eef`,"GET").then(i=>Fw(i)),Ld=LE("@@search/get",async(t,{fulfillWithValue:i,rejectWithValue:l})=>{try{const _=await(await HE(t)).json();return i(_)}catch(p){return l(p)}}),U0={status:"idle",error:"",address:{results:[],query:{text:""}}},Bw=UE({name:"@@search",initialState:U0,reducers:{resetSearch:()=>U0},extraReducers:t=>{t.addCase(Ld.fulfilled,(i,l)=>{i.status="success",i.address=l.payload}).addCase(Ld.pending,i=>{i.status="loading",i.error=""}).addCase(Ld.rejected,(i,l)=>{i.status="failed",i.error=l.error.message||"An error occurred"})}}),{resetSearch:Ow}=Bw.actions,XE=Bw.reducer;const KE=({onAddressSelect:t})=>{const i=xw(),l=ww(u=>u.search.address),[p,_]=hr.useState("");hr.useEffect(()=>{p.trim()!==""&&i(Ld(p))},[i,p]);const b=u=>{t(u),_(u.formatted)},I=()=>{_(""),i(Ow())};return Ur.jsxs("div",{className:"search",children:[Ur.jsxs("div",{className:"input__container",children:[Ur.jsx("input",{className:"input__search",type:"text",placeholder:" ",value:p,onChange:u=>_(u.target.value)}),Ur.jsx("button",{className:"search__button",type:"button",onClick:I,children:" "})]}),Ur.jsx("ul",{className:"element__container",children:l.results.length!==0&&l.results.map(u=>Ur.jsx("li",{className:"element",onClick:()=>b(u),children:u.formatted},u.place_id))})]})};const YE=()=>{const t=xw(),i=()=>{t(Ow())};return Ur.jsx("button",{className:"reset__button",onClick:i,type:"button",children:"  "})},QE=()=>{const t=ww(b=>b.search.address),[i,l]=hr.useState(null),p=b=>{l(b)},_=[(i==null?void 0:i.lon)||0,(i==null?void 0:i.lat)||0];return Ur.jsxs("div",{className:"app",children:[Ur.jsx("div",{className:"input-container",children:Ur.jsx(KE,{onAddressSelect:p})}),Ur.jsx(_k,{coordinates:_||[0,0]}),t.results.length!==0&&Ur.jsx(YE,{})]})};/**
 * @remix-run/router v1.14.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function fp(){return fp=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var l=arguments[i];for(var p in l)Object.prototype.hasOwnProperty.call(l,p)&&(t[p]=l[p])}return t},fp.apply(this,arguments)}var Sa;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(Sa||(Sa={}));const j0="popstate";function JE(t){t===void 0&&(t={});function i(p,_){let{pathname:b,search:I,hash:u}=p.location;return bg("",{pathname:b,search:I,hash:u},_.state&&_.state.usr||null,_.state&&_.state.key||"default")}function l(p,_){return typeof _=="string"?_:Vw(_)}return tI(i,l,null,t)}function Nw(t,i){if(t===!1||t===null||typeof t>"u")throw new Error(i)}function eI(){return Math.random().toString(36).substr(2,8)}function $0(t,i){return{usr:t.state,key:t.key,idx:i}}function bg(t,i,l,p){return l===void 0&&(l=null),fp({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof i=="string"?Uw(i):i,{state:l,key:i&&i.key||p||eI()})}function Vw(t){let{pathname:i="/",search:l="",hash:p=""}=t;return l&&l!=="?"&&(i+=l.charAt(0)==="?"?l:"?"+l),p&&p!=="#"&&(i+=p.charAt(0)==="#"?p:"#"+p),i}function Uw(t){let i={};if(t){let l=t.indexOf("#");l>=0&&(i.hash=t.substr(l),t=t.substr(0,l));let p=t.indexOf("?");p>=0&&(i.search=t.substr(p),t=t.substr(0,p)),t&&(i.pathname=t)}return i}function tI(t,i,l,p){p===void 0&&(p={});let{window:_=document.defaultView,v5Compat:b=!1}=p,I=_.history,u=Sa.Pop,B=null,D=ne();D==null&&(D=0,I.replaceState(fp({},I.state,{idx:D}),""));function ne(){return(I.state||{idx:null}).idx}function re(){u=Sa.Pop;let we=ne(),K=we==null?null:we-D;D=we,B&&B({action:u,location:ke.location,delta:K})}function te(we,K){u=Sa.Push;let ee=bg(ke.location,we,K);l&&l(ee,we),D=ne()+1;let ce=$0(ee,D),ye=ke.createHref(ee);try{I.pushState(ce,"",ye)}catch(Pe){if(Pe instanceof DOMException&&Pe.name==="DataCloneError")throw Pe;_.location.assign(ye)}b&&B&&B({action:u,location:ke.location,delta:1})}function _e(we,K){u=Sa.Replace;let ee=bg(ke.location,we,K);l&&l(ee,we),D=ne();let ce=$0(ee,D),ye=ke.createHref(ee);I.replaceState(ce,"",ye),b&&B&&B({action:u,location:ke.location,delta:0})}function be(we){let K=_.location.origin!=="null"?_.location.origin:_.location.href,ee=typeof we=="string"?we:Vw(we);return Nw(K,"No window.location.(origin|href) available to create URL for href: "+ee),new URL(ee,K)}let ke={get action(){return u},get location(){return t(_,I)},listen(we){if(B)throw new Error("A history only accepts one active listener");return _.addEventListener(j0,re),B=we,()=>{_.removeEventListener(j0,re),B=null}},createHref(we){return i(_,we)},createURL:be,encodeLocation(we){let K=be(we);return{pathname:K.pathname,search:K.search,hash:K.hash}},push:te,replace:_e,go(we){return I.go(we)}};return ke}var q0;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(q0||(q0={}));function rI(t,i){if(i==="/")return t;if(!t.toLowerCase().startsWith(i.toLowerCase()))return null;let l=i.endsWith("/")?i.length-1:i.length,p=t.charAt(l);return p&&p!=="/"?null:t.slice(l)||"/"}const jw=["post","put","patch","delete"];new Set(jw);const nI=["get",...jw];new Set(nI);/**
 * React Router v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Sg(){return Sg=Object.assign?Object.assign.bind():function(t){for(var i=1;i<arguments.length;i++){var l=arguments[i];for(var p in l)Object.prototype.hasOwnProperty.call(l,p)&&(t[p]=l[p])}return t},Sg.apply(this,arguments)}const iI=hr.createContext(null),$w=hr.createContext(null);function sI(){return hr.useContext($w)!=null}function oI(t){let{basename:i="/",children:l=null,location:p,navigationType:_=Sa.Pop,navigator:b,static:I=!1,future:u}=t;sI()&&Nw(!1);let B=i.replace(/^\/*/,"/"),D=hr.useMemo(()=>({basename:B,navigator:b,static:I,future:Sg({v7_relativeSplatPath:!1},u)}),[B,u,b,I]);typeof p=="string"&&(p=Uw(p));let{pathname:ne="/",search:re="",hash:te="",state:_e=null,key:be="default"}=p,ke=hr.useMemo(()=>{let we=rI(ne,B);return we==null?null:{location:{pathname:we,search:re,hash:te,state:_e,key:be},navigationType:_}},[B,ne,re,te,_e,be,_]);return ke==null?null:hr.createElement(iI.Provider,{value:D},hr.createElement($w.Provider,{children:l,value:ke}))}new Promise(()=>{});/**
 * React Router DOM v6.21.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */const aI="startTransition",Z0=bm[aI];function lI(t){let{basename:i,children:l,future:p,window:_}=t,b=hr.useRef();b.current==null&&(b.current=JE({window:_,v5Compat:!0}));let I=b.current,[u,B]=hr.useState({action:I.action,location:I.location}),{v7_startTransition:D}=p||{},ne=hr.useCallback(re=>{D&&Z0?Z0(()=>B(re)):B(re)},[B,D]);return hr.useLayoutEffect(()=>I.listen(ne),[I,ne]),hr.createElement(oI,{basename:i,children:l,location:u.location,navigationType:u.action,navigator:I,future:p})}var G0;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(G0||(G0={}));var W0;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(W0||(W0={}));var Py={},zy={};zy.__esModule=!0;zy.default=hI;function Rd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Rd=function(l){return typeof l}:Rd=function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},Rd(t)}function wm(){}var uI={getItem:wm,setItem:wm,removeItem:wm};function cI(t){if((typeof self>"u"?"undefined":Rd(self))!=="object"||!(t in self))return!1;try{var i=self[t],l="redux-persist ".concat(t," test");i.setItem(l,"test"),i.getItem(l),i.removeItem(l)}catch{return!1}return!0}function hI(t){var i="".concat(t,"Storage");return cI(i)?self[i]:uI}Py.__esModule=!0;Py.default=fI;var dI=pI(zy);function pI(t){return t&&t.__esModule?t:{default:t}}function fI(t){var i=(0,dI.default)(t);return{getItem:function(p){return new Promise(function(_,b){_(i.getItem(p))})},setItem:function(p,_){return new Promise(function(b,I){b(i.setItem(p,_))})},removeItem:function(p){return new Promise(function(_,b){_(i.removeItem(p))})}}}var qw=void 0,mI=gI(Py);function gI(t){return t&&t.__esModule?t:{default:t}}var yI=(0,mI.default)("local");qw=yI;var My="persist:",Ay="persist/FLUSH",Rp="persist/REHYDRATE",Dy="persist/PAUSE",Ly="persist/PERSIST",Ry="persist/PURGE",Fy="persist/REGISTER",_I=-1;function Fd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Fd=function(l){return typeof l}:Fd=function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},Fd(t)}function H0(t,i){var l=Object.keys(t);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(t);i&&(p=p.filter(function(_){return Object.getOwnPropertyDescriptor(t,_).enumerable})),l.push.apply(l,p)}return l}function vI(t){for(var i=1;i<arguments.length;i++){var l=arguments[i]!=null?arguments[i]:{};i%2?H0(l,!0).forEach(function(p){xI(t,p,l[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):H0(l).forEach(function(p){Object.defineProperty(t,p,Object.getOwnPropertyDescriptor(l,p))})}return t}function xI(t,i,l){return i in t?Object.defineProperty(t,i,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[i]=l,t}function wI(t,i,l,p){p.debug;var _=vI({},l);return t&&Fd(t)==="object"&&Object.keys(t).forEach(function(b){b!=="_persist"&&i[b]===l[b]&&(_[b]=t[b])}),_}function bI(t){var i=t.blacklist||null,l=t.whitelist||null,p=t.transforms||[],_=t.throttle||0,b="".concat(t.keyPrefix!==void 0?t.keyPrefix:My).concat(t.key),I=t.storage,u;t.serialize===!1?u=function(Pe){return Pe}:typeof t.serialize=="function"?u=t.serialize:u=SI;var B=t.writeFailHandler||null,D={},ne={},re=[],te=null,_e=null,be=function(Pe){Object.keys(Pe).forEach(function(Le){K(Le)&&D[Le]!==Pe[Le]&&re.indexOf(Le)===-1&&re.push(Le)}),Object.keys(D).forEach(function(Le){Pe[Le]===void 0&&K(Le)&&re.indexOf(Le)===-1&&D[Le]!==void 0&&re.push(Le)}),te===null&&(te=setInterval(ke,_)),D=Pe};function ke(){if(re.length===0){te&&clearInterval(te),te=null;return}var ye=re.shift(),Pe=p.reduce(function(Le,je){return je.in(Le,ye,D)},D[ye]);if(Pe!==void 0)try{ne[ye]=u(Pe)}catch(Le){console.error("redux-persist/createPersistoid: error serializing state",Le)}else delete ne[ye];re.length===0&&we()}function we(){Object.keys(ne).forEach(function(ye){D[ye]===void 0&&delete ne[ye]}),_e=I.setItem(b,u(ne)).catch(ee)}function K(ye){return!(l&&l.indexOf(ye)===-1&&ye!=="_persist"||i&&i.indexOf(ye)!==-1)}function ee(ye){B&&B(ye)}var ce=function(){for(;re.length!==0;)ke();return _e||Promise.resolve()};return{update:be,flush:ce}}function SI(t){return JSON.stringify(t)}function TI(t){var i=t.transforms||[],l="".concat(t.keyPrefix!==void 0?t.keyPrefix:My).concat(t.key),p=t.storage;t.debug;var _;return t.deserialize===!1?_=function(I){return I}:typeof t.deserialize=="function"?_=t.deserialize:_=kI,p.getItem(l).then(function(b){if(b)try{var I={},u=_(b);return Object.keys(u).forEach(function(B){I[B]=i.reduceRight(function(D,ne){return ne.out(D,B,u)},_(u[B]))}),I}catch(B){throw B}else return})}function kI(t){return JSON.parse(t)}function EI(t){var i=t.storage,l="".concat(t.keyPrefix!==void 0?t.keyPrefix:My).concat(t.key);return i.removeItem(l,II)}function II(t){}function X0(t,i){var l=Object.keys(t);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(t);i&&(p=p.filter(function(_){return Object.getOwnPropertyDescriptor(t,_).enumerable})),l.push.apply(l,p)}return l}function $s(t){for(var i=1;i<arguments.length;i++){var l=arguments[i]!=null?arguments[i]:{};i%2?X0(l,!0).forEach(function(p){CI(t,p,l[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):X0(l).forEach(function(p){Object.defineProperty(t,p,Object.getOwnPropertyDescriptor(l,p))})}return t}function CI(t,i,l){return i in t?Object.defineProperty(t,i,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[i]=l,t}function PI(t,i){if(t==null)return{};var l=zI(t,i),p,_;if(Object.getOwnPropertySymbols){var b=Object.getOwnPropertySymbols(t);for(_=0;_<b.length;_++)p=b[_],!(i.indexOf(p)>=0)&&Object.prototype.propertyIsEnumerable.call(t,p)&&(l[p]=t[p])}return l}function zI(t,i){if(t==null)return{};var l={},p=Object.keys(t),_,b;for(b=0;b<p.length;b++)_=p[b],!(i.indexOf(_)>=0)&&(l[_]=t[_]);return l}var MI=5e3;function AI(t,i){var l=t.version!==void 0?t.version:_I;t.debug;var p=t.stateReconciler===void 0?wI:t.stateReconciler,_=t.getStoredState||TI,b=t.timeout!==void 0?t.timeout:MI,I=null,u=!1,B=!0,D=function(re){return re._persist.rehydrated&&I&&!B&&I.update(re),re};return function(ne,re){var te=ne||{},_e=te._persist,be=PI(te,["_persist"]),ke=be;if(re.type===Ly){var we=!1,K=function(Ze,kt){we||(re.rehydrate(t.key,Ze,kt),we=!0)};if(b&&setTimeout(function(){!we&&K(void 0,new Error('redux-persist: persist timed out for persist key "'.concat(t.key,'"')))},b),B=!1,I||(I=bI(t)),_e)return $s({},i(ke,re),{_persist:_e});if(typeof re.rehydrate!="function"||typeof re.register!="function")throw new Error("redux-persist: either rehydrate or register is not a function on the PERSIST action. This can happen if the action is being replayed. This is an unexplored use case, please open an issue and we will figure out a resolution.");return re.register(t.key),_(t).then(function(je){var Ze=t.migrate||function(kt,rt){return Promise.resolve(kt)};Ze(je,l).then(function(kt){K(kt)},function(kt){K(void 0,kt)})},function(je){K(void 0,je)}),$s({},i(ke,re),{_persist:{version:l,rehydrated:!1}})}else{if(re.type===Ry)return u=!0,re.result(EI(t)),$s({},i(ke,re),{_persist:_e});if(re.type===Ay)return re.result(I&&I.flush()),$s({},i(ke,re),{_persist:_e});if(re.type===Dy)B=!0;else if(re.type===Rp){if(u)return $s({},ke,{_persist:$s({},_e,{rehydrated:!0})});if(re.key===t.key){var ee=i(ke,re),ce=re.payload,ye=p!==!1&&ce!==void 0?p(ce,ne,ee,t):ee,Pe=$s({},ye,{_persist:$s({},_e,{rehydrated:!0})});return D(Pe)}}}if(!_e)return i(ne,re);var Le=i(ke,re);return Le===ke?ne:D($s({},Le,{_persist:_e}))}}function K0(t){return RI(t)||LI(t)||DI()}function DI(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function LI(t){if(Symbol.iterator in Object(t)||Object.prototype.toString.call(t)==="[object Arguments]")return Array.from(t)}function RI(t){if(Array.isArray(t)){for(var i=0,l=new Array(t.length);i<t.length;i++)l[i]=t[i];return l}}function Y0(t,i){var l=Object.keys(t);if(Object.getOwnPropertySymbols){var p=Object.getOwnPropertySymbols(t);i&&(p=p.filter(function(_){return Object.getOwnPropertyDescriptor(t,_).enumerable})),l.push.apply(l,p)}return l}function Tg(t){for(var i=1;i<arguments.length;i++){var l=arguments[i]!=null?arguments[i]:{};i%2?Y0(l,!0).forEach(function(p){FI(t,p,l[p])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(l)):Y0(l).forEach(function(p){Object.defineProperty(t,p,Object.getOwnPropertyDescriptor(l,p))})}return t}function FI(t,i,l){return i in t?Object.defineProperty(t,i,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[i]=l,t}var Zw={registry:[],bootstrapped:!1},BI=function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Zw,l=arguments.length>1?arguments[1]:void 0;switch(l.type){case Fy:return Tg({},i,{registry:[].concat(K0(i.registry),[l.key])});case Rp:var p=i.registry.indexOf(l.key),_=K0(i.registry);return _.splice(p,1),Tg({},i,{registry:_,bootstrapped:_.length===0});default:return i}};function OI(t,i,l){var p=l||!1,_=Ty(BI,Zw,i&&i.enhancer?i.enhancer:void 0),b=function(D){_.dispatch({type:Fy,key:D})},I=function(D,ne,re){var te={type:Rp,payload:ne,err:re,key:D};t.dispatch(te),_.dispatch(te),p&&u.getState().bootstrapped&&(p(),p=!1)},u=Tg({},_,{purge:function(){var D=[];return t.dispatch({type:Ry,result:function(re){D.push(re)}}),Promise.all(D)},flush:function(){var D=[];return t.dispatch({type:Ay,result:function(re){D.push(re)}}),Promise.all(D)},pause:function(){t.dispatch({type:Dy})},persist:function(){t.dispatch({type:Ly,register:b,rehydrate:I})}});return i&&i.manualPersist||u.persist(),u}const NI=bw({search:XE}),VI={key:"root",storage:qw},UI=AI(VI,NI),Gw=kE({reducer:UI,middleware:t=>t({serializableCheck:{ignoredActions:[Ly,Rp,Ay,Dy,Ry,Fy]}})}),jI=OI(Gw);function Bd(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?Bd=function(l){return typeof l}:Bd=function(l){return l&&typeof Symbol=="function"&&l.constructor===Symbol&&l!==Symbol.prototype?"symbol":typeof l},Bd(t)}function $I(t,i){if(!(t instanceof i))throw new TypeError("Cannot call a class as a function")}function Q0(t,i){for(var l=0;l<i.length;l++){var p=i[l];p.enumerable=p.enumerable||!1,p.configurable=!0,"value"in p&&(p.writable=!0),Object.defineProperty(t,p.key,p)}}function qI(t,i,l){return i&&Q0(t.prototype,i),l&&Q0(t,l),t}function ZI(t,i){return i&&(Bd(i)==="object"||typeof i=="function")?i:Od(t)}function kg(t){return kg=Object.setPrototypeOf?Object.getPrototypeOf:function(l){return l.__proto__||Object.getPrototypeOf(l)},kg(t)}function Od(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function GI(t,i){if(typeof i!="function"&&i!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),i&&Eg(t,i)}function Eg(t,i){return Eg=Object.setPrototypeOf||function(p,_){return p.__proto__=_,p},Eg(t,i)}function Nd(t,i,l){return i in t?Object.defineProperty(t,i,{value:l,enumerable:!0,configurable:!0,writable:!0}):t[i]=l,t}var Ww=function(t){GI(i,t);function i(){var l,p;$I(this,i);for(var _=arguments.length,b=new Array(_),I=0;I<_;I++)b[I]=arguments[I];return p=ZI(this,(l=kg(i)).call.apply(l,[this].concat(b))),Nd(Od(p),"state",{bootstrapped:!1}),Nd(Od(p),"_unsubscribe",void 0),Nd(Od(p),"handlePersistorState",function(){var u=p.props.persistor,B=u.getState(),D=B.bootstrapped;D&&(p.props.onBeforeLift?Promise.resolve(p.props.onBeforeLift()).finally(function(){return p.setState({bootstrapped:!0})}):p.setState({bootstrapped:!0}),p._unsubscribe&&p._unsubscribe())}),p}return qI(i,[{key:"componentDidMount",value:function(){this._unsubscribe=this.props.persistor.subscribe(this.handlePersistorState),this.handlePersistorState()}},{key:"componentWillUnmount",value:function(){this._unsubscribe&&this._unsubscribe()}},{key:"render",value:function(){return typeof this.props.children=="function"?this.props.children(this.state.bootstrapped):this.state.bootstrapped?this.props.children:this.props.loading}}]),i}(hr.PureComponent);Nd(Ww,"defaultProps",{children:null,loading:null});Sm.createRoot(document.getElementById("root")).render(Ur.jsx(Mg.StrictMode,{children:Ur.jsx(Nk,{store:Gw,children:Ur.jsx(Ww,{loading:Ur.jsx("div",{children:"Loading..."}),persistor:jI,children:Ur.jsx(lI,{children:Ur.jsx(QE,{})})})})}));
